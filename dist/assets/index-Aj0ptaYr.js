var SS=Object.defineProperty;var CS=(t,e,r)=>e in t?SS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Hi=(t,e,r)=>CS(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function jy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ny={exports:{}},Hc={},Oy={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var la=Symbol.for("react.element"),kS=Symbol.for("react.portal"),ES=Symbol.for("react.fragment"),TS=Symbol.for("react.strict_mode"),jS=Symbol.for("react.profiler"),NS=Symbol.for("react.provider"),OS=Symbol.for("react.context"),PS=Symbol.for("react.forward_ref"),MS=Symbol.for("react.suspense"),DS=Symbol.for("react.memo"),AS=Symbol.for("react.lazy"),ip=Symbol.iterator;function FS(t){return t===null||typeof t!="object"?null:(t=ip&&t[ip]||t["@@iterator"],typeof t=="function"?t:null)}var Py={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},My=Object.assign,Dy={};function Pi(t,e,r){this.props=t,this.context=e,this.refs=Dy,this.updater=r||Py}Pi.prototype.isReactComponent={};Pi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Pi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ay(){}Ay.prototype=Pi.prototype;function pf(t,e,r){this.props=t,this.context=e,this.refs=Dy,this.updater=r||Py}var mf=pf.prototype=new Ay;mf.constructor=pf;My(mf,Pi.prototype);mf.isPureReactComponent=!0;var op=Array.isArray,Fy=Object.prototype.hasOwnProperty,yf={current:null},Ly={key:!0,ref:!0,__self:!0,__source:!0};function Ry(t,e,r){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Fy.call(e,n)&&!Ly.hasOwnProperty(n)&&(s[n]=e[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:la,type:t,key:i,ref:o,props:s,_owner:yf.current}}function LS(t,e){return{$$typeof:la,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function xf(t){return typeof t=="object"&&t!==null&&t.$$typeof===la}function RS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var ap=/\/+/g;function zu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?RS(""+t.key):e.toString(36)}function El(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case la:case kS:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+zu(o,0):n,op(s)?(r="",t!=null&&(r=t.replace(ap,"$&/")+"/"),El(s,e,r,"",function(c){return c})):s!=null&&(xf(s)&&(s=LS(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ap,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",op(t))for(var a=0;a<t.length;a++){i=t[a];var l=n+zu(i,a);o+=El(i,e,r,l,s)}else if(l=FS(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=n+zu(i,a++),o+=El(i,e,r,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Na(t,e,r){if(t==null)return t;var n=[],s=0;return El(t,n,"","",function(i){return e.call(r,i,s++)}),n}function IS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var gt={current:null},Tl={transition:null},$S={ReactCurrentDispatcher:gt,ReactCurrentBatchConfig:Tl,ReactCurrentOwner:yf};function Iy(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:Na,forEach:function(t,e,r){Na(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Na(t,function(){e++}),e},toArray:function(t){return Na(t,function(e){return e})||[]},only:function(t){if(!xf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=Pi;fe.Fragment=ES;fe.Profiler=jS;fe.PureComponent=pf;fe.StrictMode=TS;fe.Suspense=MS;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$S;fe.act=Iy;fe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=My({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=yf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Fy.call(e,l)&&!Ly.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:la,type:t.type,key:s,ref:i,props:n,_owner:o}};fe.createContext=function(t){return t={$$typeof:OS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:NS,_context:t},t.Consumer=t};fe.createElement=Ry;fe.createFactory=function(t){var e=Ry.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:PS,render:t}};fe.isValidElement=xf;fe.lazy=function(t){return{$$typeof:AS,_payload:{_status:-1,_result:t},_init:IS}};fe.memo=function(t,e){return{$$typeof:DS,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=Tl.transition;Tl.transition={};try{t()}finally{Tl.transition=e}};fe.unstable_act=Iy;fe.useCallback=function(t,e){return gt.current.useCallback(t,e)};fe.useContext=function(t){return gt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return gt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return gt.current.useEffect(t,e)};fe.useId=function(){return gt.current.useId()};fe.useImperativeHandle=function(t,e,r){return gt.current.useImperativeHandle(t,e,r)};fe.useInsertionEffect=function(t,e){return gt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return gt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return gt.current.useMemo(t,e)};fe.useReducer=function(t,e,r){return gt.current.useReducer(t,e,r)};fe.useRef=function(t){return gt.current.useRef(t)};fe.useState=function(t){return gt.current.useState(t)};fe.useSyncExternalStore=function(t,e,r){return gt.current.useSyncExternalStore(t,e,r)};fe.useTransition=function(){return gt.current.useTransition()};fe.version="18.3.1";Oy.exports=fe;var T=Oy.exports;const vf=jy(T);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zS=T,BS=Symbol.for("react.element"),WS=Symbol.for("react.fragment"),HS=Object.prototype.hasOwnProperty,VS=zS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,US={key:!0,ref:!0,__self:!0,__source:!0};function $y(t,e,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)HS.call(e,n)&&!US.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:BS,type:t,key:i,ref:o,props:s,_owner:VS.current}}Hc.Fragment=WS;Hc.jsx=$y;Hc.jsxs=$y;Ny.exports=Hc;var f=Ny.exports,Wd={},zy={exports:{}},$t={},By={exports:{}},Wy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,D){var z=j.length;j.push(D);e:for(;0<z;){var H=z-1>>>1,U=j[H];if(0<s(U,D))j[H]=D,j[z]=U,z=H;else break e}}function r(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var D=j[0],z=j.pop();if(z!==D){j[0]=z;e:for(var H=0,U=j.length,G=U>>>1;H<G;){var X=2*(H+1)-1,Q=j[X],B=X+1,Y=j[B];if(0>s(Q,z))B<U&&0>s(Y,Q)?(j[H]=Y,j[B]=z,H=B):(j[H]=Q,j[X]=z,H=X);else if(B<U&&0>s(Y,z))j[H]=Y,j[B]=z,H=B;else break e}}return D}function s(j,D){var z=j.sortIndex-D.sortIndex;return z!==0?z:j.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,g=!1,p=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(j){for(var D=r(c);D!==null;){if(D.callback===null)n(c);else if(D.startTime<=j)n(c),D.sortIndex=D.expirationTime,e(l,D);else break;D=r(c)}}function _(j){if(y=!1,x(j),!p)if(r(l)!==null)p=!0,N(b);else{var D=r(c);D!==null&&I(_,D.startTime-j)}}function b(j,D){p=!1,y&&(y=!1,m(S),S=-1),g=!0;var z=h;try{for(x(D),d=r(l);d!==null&&(!(d.expirationTime>D)||j&&!F());){var H=d.callback;if(typeof H=="function"){d.callback=null,h=d.priorityLevel;var U=H(d.expirationTime<=D);D=t.unstable_now(),typeof U=="function"?d.callback=U:d===r(l)&&n(l),x(D)}else n(l);d=r(l)}if(d!==null)var G=!0;else{var X=r(c);X!==null&&I(_,X.startTime-D),G=!1}return G}finally{d=null,h=z,g=!1}}var C=!1,k=null,S=-1,P=5,O=-1;function F(){return!(t.unstable_now()-O<P)}function A(){if(k!==null){var j=t.unstable_now();O=j;var D=!0;try{D=k(!0,j)}finally{D?L():(C=!1,k=null)}}else C=!1}var L;if(typeof w=="function")L=function(){w(A)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,M=E.port2;E.port1.onmessage=A,L=function(){M.postMessage(null)}}else L=function(){v(A,0)};function N(j){k=j,C||(C=!0,L())}function I(j,D){S=v(function(){j(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){p||g||(p=!0,N(b))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(j){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var z=h;h=D;try{return j()}finally{h=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,D){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var z=h;h=j;try{return D()}finally{h=z}},t.unstable_scheduleCallback=function(j,D,z){var H=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?H+z:H):z=H,j){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=z+U,j={id:u++,callback:D,priorityLevel:j,startTime:z,expirationTime:U,sortIndex:-1},z>H?(j.sortIndex=z,e(c,j),r(l)===null&&j===r(c)&&(y?(m(S),S=-1):y=!0,I(_,z-H))):(j.sortIndex=U,e(l,j),p||g||(p=!0,N(b))),j},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(j){var D=h;return function(){var z=h;h=D;try{return j.apply(this,arguments)}finally{h=z}}}})(Wy);By.exports=Wy;var XS=By.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS=T,Ft=XS;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hy=new Set,No={};function Ss(t,e){di(t,e),di(t+"Capture",e)}function di(t,e){for(No[t]=e,t=0;t<e.length;t++)Hy.add(e[t])}var Zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hd=Object.prototype.hasOwnProperty,GS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lp={},cp={};function qS(t){return Hd.call(cp,t)?!0:Hd.call(lp,t)?!1:GS.test(t)?cp[t]=!0:(lp[t]=!0,!1)}function KS(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QS(t,e,r,n){if(e===null||typeof e>"u"||KS(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pt(t,e,r,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){et[t]=new pt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];et[e]=new pt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){et[t]=new pt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){et[t]=new pt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){et[t]=new pt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){et[t]=new pt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){et[t]=new pt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){et[t]=new pt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){et[t]=new pt(t,5,!1,t.toLowerCase(),null,!1,!1)});var wf=/[\-:]([a-z])/g;function bf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wf,bf);et[e]=new pt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wf,bf);et[e]=new pt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wf,bf);et[e]=new pt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){et[t]=new pt(t,1,!1,t.toLowerCase(),null,!1,!1)});et.xlinkHref=new pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){et[t]=new pt(t,1,!1,t.toLowerCase(),null,!0,!0)});function _f(t,e,r,n){var s=et.hasOwnProperty(e)?et[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QS(e,r,s,n)&&(r=null),n||s===null?qS(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var on=YS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oa=Symbol.for("react.element"),Is=Symbol.for("react.portal"),$s=Symbol.for("react.fragment"),Sf=Symbol.for("react.strict_mode"),Vd=Symbol.for("react.profiler"),Vy=Symbol.for("react.provider"),Uy=Symbol.for("react.context"),Cf=Symbol.for("react.forward_ref"),Ud=Symbol.for("react.suspense"),Xd=Symbol.for("react.suspense_list"),kf=Symbol.for("react.memo"),mn=Symbol.for("react.lazy"),Xy=Symbol.for("react.offscreen"),up=Symbol.iterator;function Vi(t){return t===null||typeof t!="object"?null:(t=up&&t[up]||t["@@iterator"],typeof t=="function"?t:null)}var De=Object.assign,Bu;function no(t){if(Bu===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Bu=e&&e[1]||""}return`
`+Bu+t}var Wu=!1;function Hu(t,e){if(!t||Wu)return"";Wu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Wu=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?no(t):""}function JS(t){switch(t.tag){case 5:return no(t.type);case 16:return no("Lazy");case 13:return no("Suspense");case 19:return no("SuspenseList");case 0:case 2:case 15:return t=Hu(t.type,!1),t;case 11:return t=Hu(t.type.render,!1),t;case 1:return t=Hu(t.type,!0),t;default:return""}}function Yd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $s:return"Fragment";case Is:return"Portal";case Vd:return"Profiler";case Sf:return"StrictMode";case Ud:return"Suspense";case Xd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Uy:return(t.displayName||"Context")+".Consumer";case Vy:return(t._context.displayName||"Context")+".Provider";case Cf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case kf:return e=t.displayName||null,e!==null?e:Yd(t.type)||"Memo";case mn:e=t._payload,t=t._init;try{return Yd(t(e))}catch{}}return null}function ZS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yd(e);case 8:return e===Sf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Pn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Yy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eC(t){var e=Yy(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Pa(t){t._valueTracker||(t._valueTracker=eC(t))}function Gy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Yy(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Gl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gd(t,e){var r=e.checked;return De({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function dp(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Pn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qy(t,e){e=e.checked,e!=null&&_f(t,"checked",e,!1)}function qd(t,e){qy(t,e);var r=Pn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kd(t,e.type,r):e.hasOwnProperty("defaultValue")&&Kd(t,e.type,Pn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function hp(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Kd(t,e,r){(e!=="number"||Gl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var so=Array.isArray;function ti(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Pn(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Qd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return De({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function fp(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(q(92));if(so(r)){if(1<r.length)throw Error(q(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Pn(r)}}function Ky(t,e){var r=Pn(e.value),n=Pn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function gp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Qy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Qy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ma,Jy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ma=Ma||document.createElement("div"),Ma.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ma.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Oo(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var fo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tC=["Webkit","ms","Moz","O"];Object.keys(fo).forEach(function(t){tC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),fo[e]=fo[t]})});function Zy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||fo.hasOwnProperty(t)&&fo[t]?(""+e).trim():e+"px"}function ex(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Zy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var rC=De({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zd(t,e){if(e){if(rC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function eh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var th=null;function Ef(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var rh=null,ri=null,ni=null;function pp(t){if(t=da(t)){if(typeof rh!="function")throw Error(q(280));var e=t.stateNode;e&&(e=Gc(e),rh(t.stateNode,t.type,e))}}function tx(t){ri?ni?ni.push(t):ni=[t]:ri=t}function rx(){if(ri){var t=ri,e=ni;if(ni=ri=null,pp(t),e)for(t=0;t<e.length;t++)pp(e[t])}}function nx(t,e){return t(e)}function sx(){}var Vu=!1;function ix(t,e,r){if(Vu)return t(e,r);Vu=!0;try{return nx(t,e,r)}finally{Vu=!1,(ri!==null||ni!==null)&&(sx(),rx())}}function Po(t,e){var r=t.stateNode;if(r===null)return null;var n=Gc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(q(231,e,typeof r));return r}var nh=!1;if(Zr)try{var Ui={};Object.defineProperty(Ui,"passive",{get:function(){nh=!0}}),window.addEventListener("test",Ui,Ui),window.removeEventListener("test",Ui,Ui)}catch{nh=!1}function nC(t,e,r,n,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var go=!1,ql=null,Kl=!1,sh=null,sC={onError:function(t){go=!0,ql=t}};function iC(t,e,r,n,s,i,o,a,l){go=!1,ql=null,nC.apply(sC,arguments)}function oC(t,e,r,n,s,i,o,a,l){if(iC.apply(this,arguments),go){if(go){var c=ql;go=!1,ql=null}else throw Error(q(198));Kl||(Kl=!0,sh=c)}}function Cs(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function ox(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function mp(t){if(Cs(t)!==t)throw Error(q(188))}function aC(t){var e=t.alternate;if(!e){if(e=Cs(t),e===null)throw Error(q(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return mp(s),t;if(i===n)return mp(s),e;i=i.sibling}throw Error(q(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o)throw Error(q(189))}}if(r.alternate!==n)throw Error(q(190))}if(r.tag!==3)throw Error(q(188));return r.stateNode.current===r?t:e}function ax(t){return t=aC(t),t!==null?lx(t):null}function lx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lx(t);if(e!==null)return e;t=t.sibling}return null}var cx=Ft.unstable_scheduleCallback,yp=Ft.unstable_cancelCallback,lC=Ft.unstable_shouldYield,cC=Ft.unstable_requestPaint,Ie=Ft.unstable_now,uC=Ft.unstable_getCurrentPriorityLevel,Tf=Ft.unstable_ImmediatePriority,ux=Ft.unstable_UserBlockingPriority,Ql=Ft.unstable_NormalPriority,dC=Ft.unstable_LowPriority,dx=Ft.unstable_IdlePriority,Vc=null,jr=null;function hC(t){if(jr&&typeof jr.onCommitFiberRoot=="function")try{jr.onCommitFiberRoot(Vc,t,void 0,(t.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:pC,fC=Math.log,gC=Math.LN2;function pC(t){return t>>>=0,t===0?32:31-(fC(t)/gC|0)|0}var Da=64,Aa=4194304;function io(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Jl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~s;a!==0?n=io(a):(i&=o,i!==0&&(n=io(i)))}else o=r&~s,o!==0?n=io(o):i!==0&&(n=io(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ur(e),s=1<<r,n|=t[r],e&=~s;return n}function mC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ur(i),a=1<<o,l=s[o];l===-1?(!(a&r)||a&n)&&(s[o]=mC(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function ih(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hx(){var t=Da;return Da<<=1,!(Da&4194240)&&(Da=64),t}function Uu(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ca(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ur(e),t[e]=r}function xC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-ur(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function jf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ur(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var be=0;function fx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var gx,Nf,px,mx,yx,oh=!1,Fa=[],Sn=null,Cn=null,kn=null,Mo=new Map,Do=new Map,xn=[],vC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xp(t,e){switch(t){case"focusin":case"focusout":Sn=null;break;case"dragenter":case"dragleave":Cn=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":Mo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Do.delete(e.pointerId)}}function Xi(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=da(e),e!==null&&Nf(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function wC(t,e,r,n,s){switch(e){case"focusin":return Sn=Xi(Sn,t,e,r,n,s),!0;case"dragenter":return Cn=Xi(Cn,t,e,r,n,s),!0;case"mouseover":return kn=Xi(kn,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return Mo.set(i,Xi(Mo.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Do.set(i,Xi(Do.get(i)||null,t,e,r,n,s)),!0}return!1}function xx(t){var e=Kn(t.target);if(e!==null){var r=Cs(e);if(r!==null){if(e=r.tag,e===13){if(e=ox(r),e!==null){t.blockedOn=e,yx(t.priority,function(){px(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=ah(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);th=n,r.target.dispatchEvent(n),th=null}else return e=da(r),e!==null&&Nf(e),t.blockedOn=r,!1;e.shift()}return!0}function vp(t,e,r){jl(t)&&r.delete(e)}function bC(){oh=!1,Sn!==null&&jl(Sn)&&(Sn=null),Cn!==null&&jl(Cn)&&(Cn=null),kn!==null&&jl(kn)&&(kn=null),Mo.forEach(vp),Do.forEach(vp)}function Yi(t,e){t.blockedOn===e&&(t.blockedOn=null,oh||(oh=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,bC)))}function Ao(t){function e(s){return Yi(s,t)}if(0<Fa.length){Yi(Fa[0],t);for(var r=1;r<Fa.length;r++){var n=Fa[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Sn!==null&&Yi(Sn,t),Cn!==null&&Yi(Cn,t),kn!==null&&Yi(kn,t),Mo.forEach(e),Do.forEach(e),r=0;r<xn.length;r++)n=xn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<xn.length&&(r=xn[0],r.blockedOn===null);)xx(r),r.blockedOn===null&&xn.shift()}var si=on.ReactCurrentBatchConfig,Zl=!0;function _C(t,e,r,n){var s=be,i=si.transition;si.transition=null;try{be=1,Of(t,e,r,n)}finally{be=s,si.transition=i}}function SC(t,e,r,n){var s=be,i=si.transition;si.transition=null;try{be=4,Of(t,e,r,n)}finally{be=s,si.transition=i}}function Of(t,e,r,n){if(Zl){var s=ah(t,e,r,n);if(s===null)td(t,e,n,ec,r),xp(t,n);else if(wC(s,t,e,r,n))n.stopPropagation();else if(xp(t,n),e&4&&-1<vC.indexOf(t)){for(;s!==null;){var i=da(s);if(i!==null&&gx(i),i=ah(t,e,r,n),i===null&&td(t,e,n,ec,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else td(t,e,n,null,r)}}var ec=null;function ah(t,e,r,n){if(ec=null,t=Ef(n),t=Kn(t),t!==null)if(e=Cs(t),e===null)t=null;else if(r=e.tag,r===13){if(t=ox(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ec=t,null}function vx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uC()){case Tf:return 1;case ux:return 4;case Ql:case dC:return 16;case dx:return 536870912;default:return 16}default:return 16}}var bn=null,Pf=null,Nl=null;function wx(){if(Nl)return Nl;var t,e=Pf,r=e.length,n,s="value"in bn?bn.value:bn.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[i-n];n++);return Nl=s.slice(t,1<n?1-n:void 0)}function Ol(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function La(){return!0}function wp(){return!1}function zt(t){function e(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?La:wp,this.isPropagationStopped=wp,this}return De(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=La)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=La)},persist:function(){},isPersistent:La}),e}var Mi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mf=zt(Mi),ua=De({},Mi,{view:0,detail:0}),CC=zt(ua),Xu,Yu,Gi,Uc=De({},ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Df,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Gi&&(Gi&&t.type==="mousemove"?(Xu=t.screenX-Gi.screenX,Yu=t.screenY-Gi.screenY):Yu=Xu=0,Gi=t),Xu)},movementY:function(t){return"movementY"in t?t.movementY:Yu}}),bp=zt(Uc),kC=De({},Uc,{dataTransfer:0}),EC=zt(kC),TC=De({},ua,{relatedTarget:0}),Gu=zt(TC),jC=De({},Mi,{animationName:0,elapsedTime:0,pseudoElement:0}),NC=zt(jC),OC=De({},Mi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),PC=zt(OC),MC=De({},Mi,{data:0}),_p=zt(MC),DC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=FC[t])?!!e[t]:!1}function Df(){return LC}var RC=De({},ua,{key:function(t){if(t.key){var e=DC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ol(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?AC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Df,charCode:function(t){return t.type==="keypress"?Ol(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ol(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),IC=zt(RC),$C=De({},Uc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sp=zt($C),zC=De({},ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Df}),BC=zt(zC),WC=De({},Mi,{propertyName:0,elapsedTime:0,pseudoElement:0}),HC=zt(WC),VC=De({},Uc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),UC=zt(VC),XC=[9,13,27,32],Af=Zr&&"CompositionEvent"in window,po=null;Zr&&"documentMode"in document&&(po=document.documentMode);var YC=Zr&&"TextEvent"in window&&!po,bx=Zr&&(!Af||po&&8<po&&11>=po),Cp=" ",kp=!1;function _x(t,e){switch(t){case"keyup":return XC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zs=!1;function GC(t,e){switch(t){case"compositionend":return Sx(e);case"keypress":return e.which!==32?null:(kp=!0,Cp);case"textInput":return t=e.data,t===Cp&&kp?null:t;default:return null}}function qC(t,e){if(zs)return t==="compositionend"||!Af&&_x(t,e)?(t=wx(),Nl=Pf=bn=null,zs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return bx&&e.locale!=="ko"?null:e.data;default:return null}}var KC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ep(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!KC[t.type]:e==="textarea"}function Cx(t,e,r,n){tx(n),e=tc(e,"onChange"),0<e.length&&(r=new Mf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var mo=null,Fo=null;function QC(t){Fx(t,0)}function Xc(t){var e=Hs(t);if(Gy(e))return t}function JC(t,e){if(t==="change")return e}var kx=!1;if(Zr){var qu;if(Zr){var Ku="oninput"in document;if(!Ku){var Tp=document.createElement("div");Tp.setAttribute("oninput","return;"),Ku=typeof Tp.oninput=="function"}qu=Ku}else qu=!1;kx=qu&&(!document.documentMode||9<document.documentMode)}function jp(){mo&&(mo.detachEvent("onpropertychange",Ex),Fo=mo=null)}function Ex(t){if(t.propertyName==="value"&&Xc(Fo)){var e=[];Cx(e,Fo,t,Ef(t)),ix(QC,e)}}function ZC(t,e,r){t==="focusin"?(jp(),mo=e,Fo=r,mo.attachEvent("onpropertychange",Ex)):t==="focusout"&&jp()}function ek(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xc(Fo)}function tk(t,e){if(t==="click")return Xc(e)}function rk(t,e){if(t==="input"||t==="change")return Xc(e)}function nk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fr=typeof Object.is=="function"?Object.is:nk;function Lo(t,e){if(fr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Hd.call(e,s)||!fr(t[s],e[s]))return!1}return!0}function Np(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Op(t,e){var r=Np(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Np(r)}}function Tx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Tx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function jx(){for(var t=window,e=Gl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Gl(t.document)}return e}function Ff(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sk(t){var e=jx(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Tx(r.ownerDocument.documentElement,r)){if(n!==null&&Ff(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Op(r,i);var o=Op(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ik=Zr&&"documentMode"in document&&11>=document.documentMode,Bs=null,lh=null,yo=null,ch=!1;function Pp(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ch||Bs==null||Bs!==Gl(n)||(n=Bs,"selectionStart"in n&&Ff(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),yo&&Lo(yo,n)||(yo=n,n=tc(lh,"onSelect"),0<n.length&&(e=new Mf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Bs)))}function Ra(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ws={animationend:Ra("Animation","AnimationEnd"),animationiteration:Ra("Animation","AnimationIteration"),animationstart:Ra("Animation","AnimationStart"),transitionend:Ra("Transition","TransitionEnd")},Qu={},Nx={};Zr&&(Nx=document.createElement("div").style,"AnimationEvent"in window||(delete Ws.animationend.animation,delete Ws.animationiteration.animation,delete Ws.animationstart.animation),"TransitionEvent"in window||delete Ws.transitionend.transition);function Yc(t){if(Qu[t])return Qu[t];if(!Ws[t])return t;var e=Ws[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Nx)return Qu[t]=e[r];return t}var Ox=Yc("animationend"),Px=Yc("animationiteration"),Mx=Yc("animationstart"),Dx=Yc("transitionend"),Ax=new Map,Mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ln(t,e){Ax.set(t,e),Ss(e,[t])}for(var Ju=0;Ju<Mp.length;Ju++){var Zu=Mp[Ju],ok=Zu.toLowerCase(),ak=Zu[0].toUpperCase()+Zu.slice(1);Ln(ok,"on"+ak)}Ln(Ox,"onAnimationEnd");Ln(Px,"onAnimationIteration");Ln(Mx,"onAnimationStart");Ln("dblclick","onDoubleClick");Ln("focusin","onFocus");Ln("focusout","onBlur");Ln(Dx,"onTransitionEnd");di("onMouseEnter",["mouseout","mouseover"]);di("onMouseLeave",["mouseout","mouseover"]);di("onPointerEnter",["pointerout","pointerover"]);di("onPointerLeave",["pointerout","pointerover"]);Ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ss("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lk=new Set("cancel close invalid load scroll toggle".split(" ").concat(oo));function Dp(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,oC(n,e,void 0,t),t.currentTarget=null}function Fx(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Dp(s,a,c),i=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Dp(s,a,c),i=l}}}if(Kl)throw t=sh,Kl=!1,sh=null,t}function ke(t,e){var r=e[gh];r===void 0&&(r=e[gh]=new Set);var n=t+"__bubble";r.has(n)||(Lx(e,t,2,!1),r.add(n))}function ed(t,e,r){var n=0;e&&(n|=4),Lx(r,t,n,e)}var Ia="_reactListening"+Math.random().toString(36).slice(2);function Ro(t){if(!t[Ia]){t[Ia]=!0,Hy.forEach(function(r){r!=="selectionchange"&&(lk.has(r)||ed(r,!1,t),ed(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ia]||(e[Ia]=!0,ed("selectionchange",!1,e))}}function Lx(t,e,r,n){switch(vx(e)){case 1:var s=_C;break;case 4:s=SC;break;default:s=Of}r=s.bind(null,e,r,t),s=void 0,!nh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function td(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Kn(a),o===null)return;if(l=o.tag,l===5||l===6){n=i=o;continue e}a=a.parentNode}}n=n.return}ix(function(){var c=i,u=Ef(r),d=[];e:{var h=Ax.get(t);if(h!==void 0){var g=Mf,p=t;switch(t){case"keypress":if(Ol(r)===0)break e;case"keydown":case"keyup":g=IC;break;case"focusin":p="focus",g=Gu;break;case"focusout":p="blur",g=Gu;break;case"beforeblur":case"afterblur":g=Gu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=bp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=EC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=BC;break;case Ox:case Px:case Mx:g=NC;break;case Dx:g=HC;break;case"scroll":g=CC;break;case"wheel":g=UC;break;case"copy":case"cut":case"paste":g=PC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Sp}var y=(e&4)!==0,v=!y&&t==="scroll",m=y?h!==null?h+"Capture":null:h;y=[];for(var w=c,x;w!==null;){x=w;var _=x.stateNode;if(x.tag===5&&_!==null&&(x=_,m!==null&&(_=Po(w,m),_!=null&&y.push(Io(w,_,x)))),v)break;w=w.return}0<y.length&&(h=new g(h,p,null,r,u),d.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",h&&r!==th&&(p=r.relatedTarget||r.fromElement)&&(Kn(p)||p[en]))break e;if((g||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,g?(p=r.relatedTarget||r.toElement,g=c,p=p?Kn(p):null,p!==null&&(v=Cs(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(g=null,p=c),g!==p)){if(y=bp,_="onMouseLeave",m="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(y=Sp,_="onPointerLeave",m="onPointerEnter",w="pointer"),v=g==null?h:Hs(g),x=p==null?h:Hs(p),h=new y(_,w+"leave",g,r,u),h.target=v,h.relatedTarget=x,_=null,Kn(u)===c&&(y=new y(m,w+"enter",p,r,u),y.target=x,y.relatedTarget=v,_=y),v=_,g&&p)t:{for(y=g,m=p,w=0,x=y;x;x=Ds(x))w++;for(x=0,_=m;_;_=Ds(_))x++;for(;0<w-x;)y=Ds(y),w--;for(;0<x-w;)m=Ds(m),x--;for(;w--;){if(y===m||m!==null&&y===m.alternate)break t;y=Ds(y),m=Ds(m)}y=null}else y=null;g!==null&&Ap(d,h,g,y,!1),p!==null&&v!==null&&Ap(d,v,p,y,!0)}}e:{if(h=c?Hs(c):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var b=JC;else if(Ep(h))if(kx)b=rk;else{b=ek;var C=ZC}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=tk);if(b&&(b=b(t,c))){Cx(d,b,r,u);break e}C&&C(t,h,c),t==="focusout"&&(C=h._wrapperState)&&C.controlled&&h.type==="number"&&Kd(h,"number",h.value)}switch(C=c?Hs(c):window,t){case"focusin":(Ep(C)||C.contentEditable==="true")&&(Bs=C,lh=c,yo=null);break;case"focusout":yo=lh=Bs=null;break;case"mousedown":ch=!0;break;case"contextmenu":case"mouseup":case"dragend":ch=!1,Pp(d,r,u);break;case"selectionchange":if(ik)break;case"keydown":case"keyup":Pp(d,r,u)}var k;if(Af)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else zs?_x(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(bx&&r.locale!=="ko"&&(zs||S!=="onCompositionStart"?S==="onCompositionEnd"&&zs&&(k=wx()):(bn=u,Pf="value"in bn?bn.value:bn.textContent,zs=!0)),C=tc(c,S),0<C.length&&(S=new _p(S,t,null,r,u),d.push({event:S,listeners:C}),k?S.data=k:(k=Sx(r),k!==null&&(S.data=k)))),(k=YC?GC(t,r):qC(t,r))&&(c=tc(c,"onBeforeInput"),0<c.length&&(u=new _p("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=k))}Fx(d,e)})}function Io(t,e,r){return{instance:t,listener:e,currentTarget:r}}function tc(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Po(t,r),i!=null&&n.unshift(Io(t,i,s)),i=Po(t,e),i!=null&&n.push(Io(t,i,s))),t=t.return}return n}function Ds(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ap(t,e,r,n,s){for(var i=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,s?(l=Po(r,i),l!=null&&o.unshift(Io(r,l,a))):s||(l=Po(r,i),l!=null&&o.push(Io(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var ck=/\r\n?/g,uk=/\u0000|\uFFFD/g;function Fp(t){return(typeof t=="string"?t:""+t).replace(ck,`
`).replace(uk,"")}function $a(t,e,r){if(e=Fp(e),Fp(t)!==e&&r)throw Error(q(425))}function rc(){}var uh=null,dh=null;function hh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fh=typeof setTimeout=="function"?setTimeout:void 0,dk=typeof clearTimeout=="function"?clearTimeout:void 0,Lp=typeof Promise=="function"?Promise:void 0,hk=typeof queueMicrotask=="function"?queueMicrotask:typeof Lp<"u"?function(t){return Lp.resolve(null).then(t).catch(fk)}:fh;function fk(t){setTimeout(function(){throw t})}function rd(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Ao(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ao(e)}function En(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Rp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Di=Math.random().toString(36).slice(2),kr="__reactFiber$"+Di,$o="__reactProps$"+Di,en="__reactContainer$"+Di,gh="__reactEvents$"+Di,gk="__reactListeners$"+Di,pk="__reactHandles$"+Di;function Kn(t){var e=t[kr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[en]||r[kr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Rp(t);t!==null;){if(r=t[kr])return r;t=Rp(t)}return e}t=r,r=t.parentNode}return null}function da(t){return t=t[kr]||t[en],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function Gc(t){return t[$o]||null}var ph=[],Vs=-1;function Rn(t){return{current:t}}function Ee(t){0>Vs||(t.current=ph[Vs],ph[Vs]=null,Vs--)}function Ce(t,e){Vs++,ph[Vs]=t.current,t.current=e}var Mn={},at=Rn(Mn),wt=Rn(!1),hs=Mn;function hi(t,e){var r=t.type.contextTypes;if(!r)return Mn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function bt(t){return t=t.childContextTypes,t!=null}function nc(){Ee(wt),Ee(at)}function Ip(t,e,r){if(at.current!==Mn)throw Error(q(168));Ce(at,e),Ce(wt,r)}function Rx(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(q(108,ZS(t)||"Unknown",s));return De({},r,n)}function sc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mn,hs=at.current,Ce(at,t),Ce(wt,wt.current),!0}function $p(t,e,r){var n=t.stateNode;if(!n)throw Error(q(169));r?(t=Rx(t,e,hs),n.__reactInternalMemoizedMergedChildContext=t,Ee(wt),Ee(at),Ce(at,t)):Ee(wt),Ce(wt,r)}var Hr=null,qc=!1,nd=!1;function Ix(t){Hr===null?Hr=[t]:Hr.push(t)}function mk(t){qc=!0,Ix(t)}function In(){if(!nd&&Hr!==null){nd=!0;var t=0,e=be;try{var r=Hr;for(be=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Hr=null,qc=!1}catch(s){throw Hr!==null&&(Hr=Hr.slice(t+1)),cx(Tf,In),s}finally{be=e,nd=!1}}return null}var Us=[],Xs=0,ic=null,oc=0,Ht=[],Vt=0,fs=null,Ur=1,Xr="";function Hn(t,e){Us[Xs++]=oc,Us[Xs++]=ic,ic=t,oc=e}function $x(t,e,r){Ht[Vt++]=Ur,Ht[Vt++]=Xr,Ht[Vt++]=fs,fs=t;var n=Ur;t=Xr;var s=32-ur(n)-1;n&=~(1<<s),r+=1;var i=32-ur(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ur=1<<32-ur(e)+s|r<<s|n,Xr=i+t}else Ur=1<<i|r<<s|n,Xr=t}function Lf(t){t.return!==null&&(Hn(t,1),$x(t,1,0))}function Rf(t){for(;t===ic;)ic=Us[--Xs],Us[Xs]=null,oc=Us[--Xs],Us[Xs]=null;for(;t===fs;)fs=Ht[--Vt],Ht[Vt]=null,Xr=Ht[--Vt],Ht[Vt]=null,Ur=Ht[--Vt],Ht[Vt]=null}var At=null,Mt=null,Te=!1,sr=null;function zx(t,e){var r=Xt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function zp(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,At=t,Mt=En(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,At=t,Mt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=fs!==null?{id:Ur,overflow:Xr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Xt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,At=t,Mt=null,!0):!1;default:return!1}}function mh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function yh(t){if(Te){var e=Mt;if(e){var r=e;if(!zp(t,e)){if(mh(t))throw Error(q(418));e=En(r.nextSibling);var n=At;e&&zp(t,e)?zx(n,r):(t.flags=t.flags&-4097|2,Te=!1,At=t)}}else{if(mh(t))throw Error(q(418));t.flags=t.flags&-4097|2,Te=!1,At=t}}}function Bp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;At=t}function za(t){if(t!==At)return!1;if(!Te)return Bp(t),Te=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hh(t.type,t.memoizedProps)),e&&(e=Mt)){if(mh(t))throw Bx(),Error(q(418));for(;e;)zx(t,e),e=En(e.nextSibling)}if(Bp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Mt=En(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Mt=null}}else Mt=At?En(t.stateNode.nextSibling):null;return!0}function Bx(){for(var t=Mt;t;)t=En(t.nextSibling)}function fi(){Mt=At=null,Te=!1}function If(t){sr===null?sr=[t]:sr.push(t)}var yk=on.ReactCurrentBatchConfig;function qi(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(q(309));var n=r.stateNode}if(!n)throw Error(q(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(q(284));if(!r._owner)throw Error(q(290,t))}return t}function Ba(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Wp(t){var e=t._init;return e(t._payload)}function Wx(t){function e(m,w){if(t){var x=m.deletions;x===null?(m.deletions=[w],m.flags|=16):x.push(w)}}function r(m,w){if(!t)return null;for(;w!==null;)e(m,w),w=w.sibling;return null}function n(m,w){for(m=new Map;w!==null;)w.key!==null?m.set(w.key,w):m.set(w.index,w),w=w.sibling;return m}function s(m,w){return m=On(m,w),m.index=0,m.sibling=null,m}function i(m,w,x){return m.index=x,t?(x=m.alternate,x!==null?(x=x.index,x<w?(m.flags|=2,w):x):(m.flags|=2,w)):(m.flags|=1048576,w)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,w,x,_){return w===null||w.tag!==6?(w=ud(x,m.mode,_),w.return=m,w):(w=s(w,x),w.return=m,w)}function l(m,w,x,_){var b=x.type;return b===$s?u(m,w,x.props.children,_,x.key):w!==null&&(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===mn&&Wp(b)===w.type)?(_=s(w,x.props),_.ref=qi(m,w,x),_.return=m,_):(_=Rl(x.type,x.key,x.props,null,m.mode,_),_.ref=qi(m,w,x),_.return=m,_)}function c(m,w,x,_){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=dd(x,m.mode,_),w.return=m,w):(w=s(w,x.children||[]),w.return=m,w)}function u(m,w,x,_,b){return w===null||w.tag!==7?(w=is(x,m.mode,_,b),w.return=m,w):(w=s(w,x),w.return=m,w)}function d(m,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=ud(""+w,m.mode,x),w.return=m,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Oa:return x=Rl(w.type,w.key,w.props,null,m.mode,x),x.ref=qi(m,null,w),x.return=m,x;case Is:return w=dd(w,m.mode,x),w.return=m,w;case mn:var _=w._init;return d(m,_(w._payload),x)}if(so(w)||Vi(w))return w=is(w,m.mode,x,null),w.return=m,w;Ba(m,w)}return null}function h(m,w,x,_){var b=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:a(m,w,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Oa:return x.key===b?l(m,w,x,_):null;case Is:return x.key===b?c(m,w,x,_):null;case mn:return b=x._init,h(m,w,b(x._payload),_)}if(so(x)||Vi(x))return b!==null?null:u(m,w,x,_,null);Ba(m,x)}return null}function g(m,w,x,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return m=m.get(x)||null,a(w,m,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Oa:return m=m.get(_.key===null?x:_.key)||null,l(w,m,_,b);case Is:return m=m.get(_.key===null?x:_.key)||null,c(w,m,_,b);case mn:var C=_._init;return g(m,w,x,C(_._payload),b)}if(so(_)||Vi(_))return m=m.get(x)||null,u(w,m,_,b,null);Ba(w,_)}return null}function p(m,w,x,_){for(var b=null,C=null,k=w,S=w=0,P=null;k!==null&&S<x.length;S++){k.index>S?(P=k,k=null):P=k.sibling;var O=h(m,k,x[S],_);if(O===null){k===null&&(k=P);break}t&&k&&O.alternate===null&&e(m,k),w=i(O,w,S),C===null?b=O:C.sibling=O,C=O,k=P}if(S===x.length)return r(m,k),Te&&Hn(m,S),b;if(k===null){for(;S<x.length;S++)k=d(m,x[S],_),k!==null&&(w=i(k,w,S),C===null?b=k:C.sibling=k,C=k);return Te&&Hn(m,S),b}for(k=n(m,k);S<x.length;S++)P=g(k,m,S,x[S],_),P!==null&&(t&&P.alternate!==null&&k.delete(P.key===null?S:P.key),w=i(P,w,S),C===null?b=P:C.sibling=P,C=P);return t&&k.forEach(function(F){return e(m,F)}),Te&&Hn(m,S),b}function y(m,w,x,_){var b=Vi(x);if(typeof b!="function")throw Error(q(150));if(x=b.call(x),x==null)throw Error(q(151));for(var C=b=null,k=w,S=w=0,P=null,O=x.next();k!==null&&!O.done;S++,O=x.next()){k.index>S?(P=k,k=null):P=k.sibling;var F=h(m,k,O.value,_);if(F===null){k===null&&(k=P);break}t&&k&&F.alternate===null&&e(m,k),w=i(F,w,S),C===null?b=F:C.sibling=F,C=F,k=P}if(O.done)return r(m,k),Te&&Hn(m,S),b;if(k===null){for(;!O.done;S++,O=x.next())O=d(m,O.value,_),O!==null&&(w=i(O,w,S),C===null?b=O:C.sibling=O,C=O);return Te&&Hn(m,S),b}for(k=n(m,k);!O.done;S++,O=x.next())O=g(k,m,S,O.value,_),O!==null&&(t&&O.alternate!==null&&k.delete(O.key===null?S:O.key),w=i(O,w,S),C===null?b=O:C.sibling=O,C=O);return t&&k.forEach(function(A){return e(m,A)}),Te&&Hn(m,S),b}function v(m,w,x,_){if(typeof x=="object"&&x!==null&&x.type===$s&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Oa:e:{for(var b=x.key,C=w;C!==null;){if(C.key===b){if(b=x.type,b===$s){if(C.tag===7){r(m,C.sibling),w=s(C,x.props.children),w.return=m,m=w;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===mn&&Wp(b)===C.type){r(m,C.sibling),w=s(C,x.props),w.ref=qi(m,C,x),w.return=m,m=w;break e}r(m,C);break}else e(m,C);C=C.sibling}x.type===$s?(w=is(x.props.children,m.mode,_,x.key),w.return=m,m=w):(_=Rl(x.type,x.key,x.props,null,m.mode,_),_.ref=qi(m,w,x),_.return=m,m=_)}return o(m);case Is:e:{for(C=x.key;w!==null;){if(w.key===C)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(m,w.sibling),w=s(w,x.children||[]),w.return=m,m=w;break e}else{r(m,w);break}else e(m,w);w=w.sibling}w=dd(x,m.mode,_),w.return=m,m=w}return o(m);case mn:return C=x._init,v(m,w,C(x._payload),_)}if(so(x))return p(m,w,x,_);if(Vi(x))return y(m,w,x,_);Ba(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(m,w.sibling),w=s(w,x),w.return=m,m=w):(r(m,w),w=ud(x,m.mode,_),w.return=m,m=w),o(m)):r(m,w)}return v}var gi=Wx(!0),Hx=Wx(!1),ac=Rn(null),lc=null,Ys=null,$f=null;function zf(){$f=Ys=lc=null}function Bf(t){var e=ac.current;Ee(ac),t._currentValue=e}function xh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ii(t,e){lc=t,$f=Ys=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yt=!0),t.firstContext=null)}function Gt(t){var e=t._currentValue;if($f!==t)if(t={context:t,memoizedValue:e,next:null},Ys===null){if(lc===null)throw Error(q(308));Ys=t,lc.dependencies={lanes:0,firstContext:t}}else Ys=Ys.next=t;return e}var Qn=null;function Wf(t){Qn===null?Qn=[t]:Qn.push(t)}function Vx(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Wf(e)):(r.next=s.next,s.next=r),e.interleaved=r,tn(t,n)}function tn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var yn=!1;function Hf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ux(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Kr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Tn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,ye&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,tn(t,r)}return s=n.interleaved,s===null?(e.next=e,Wf(n)):(e.next=s.next,s.next=e),n.interleaved=e,tn(t,r)}function Pl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,jf(t,r)}}function Hp(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function cc(t,e,r,n){var s=t.updateQueue;yn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,g=a.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,y=a;switch(h=e,g=r,y.tag){case 1:if(p=y.payload,typeof p=="function"){d=p.call(g,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,h=typeof p=="function"?p.call(g,d,h):p,h==null)break e;d=De({},d,h);break e;case 2:yn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else g={eventTime:g,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=g,l=d):u=u.next=g,o|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ps|=o,t.lanes=o,t.memoizedState=d}}function Vp(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(q(191,s));s.call(n)}}}var ha={},Nr=Rn(ha),zo=Rn(ha),Bo=Rn(ha);function Jn(t){if(t===ha)throw Error(q(174));return t}function Vf(t,e){switch(Ce(Bo,e),Ce(zo,t),Ce(Nr,ha),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Jd(e,t)}Ee(Nr),Ce(Nr,e)}function pi(){Ee(Nr),Ee(zo),Ee(Bo)}function Xx(t){Jn(Bo.current);var e=Jn(Nr.current),r=Jd(e,t.type);e!==r&&(Ce(zo,t),Ce(Nr,r))}function Uf(t){zo.current===t&&(Ee(Nr),Ee(zo))}var Pe=Rn(0);function uc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var sd=[];function Xf(){for(var t=0;t<sd.length;t++)sd[t]._workInProgressVersionPrimary=null;sd.length=0}var Ml=on.ReactCurrentDispatcher,id=on.ReactCurrentBatchConfig,gs=0,Me=null,Ve=null,Ke=null,dc=!1,xo=!1,Wo=0,xk=0;function tt(){throw Error(q(321))}function Yf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!fr(t[r],e[r]))return!1;return!0}function Gf(t,e,r,n,s,i){if(gs=i,Me=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ml.current=t===null||t.memoizedState===null?_k:Sk,t=r(n,s),xo){i=0;do{if(xo=!1,Wo=0,25<=i)throw Error(q(301));i+=1,Ke=Ve=null,e.updateQueue=null,Ml.current=Ck,t=r(n,s)}while(xo)}if(Ml.current=hc,e=Ve!==null&&Ve.next!==null,gs=0,Ke=Ve=Me=null,dc=!1,e)throw Error(q(300));return t}function qf(){var t=Wo!==0;return Wo=0,t}function br(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ke===null?Me.memoizedState=Ke=t:Ke=Ke.next=t,Ke}function qt(){if(Ve===null){var t=Me.alternate;t=t!==null?t.memoizedState:null}else t=Ve.next;var e=Ke===null?Me.memoizedState:Ke.next;if(e!==null)Ke=e,Ve=t;else{if(t===null)throw Error(q(310));Ve=t,t={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},Ke===null?Me.memoizedState=Ke=t:Ke=Ke.next=t}return Ke}function Ho(t,e){return typeof e=="function"?e(t):e}function od(t){var e=qt(),r=e.queue;if(r===null)throw Error(q(311));r.lastRenderedReducer=t;var n=Ve,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((gs&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=n):l=l.next=d,Me.lanes|=u,ps|=u}c=c.next}while(c!==null&&c!==i);l===null?o=n:l.next=a,fr(n,e.memoizedState)||(yt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Me.lanes|=i,ps|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function ad(t){var e=qt(),r=e.queue;if(r===null)throw Error(q(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);fr(i,e.memoizedState)||(yt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function Yx(){}function Gx(t,e){var r=Me,n=qt(),s=e(),i=!fr(n.memoizedState,s);if(i&&(n.memoizedState=s,yt=!0),n=n.queue,Kf(Qx.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Ke!==null&&Ke.memoizedState.tag&1){if(r.flags|=2048,Vo(9,Kx.bind(null,r,n,s,e),void 0,null),Qe===null)throw Error(q(349));gs&30||qx(r,e,s)}return s}function qx(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Me.updateQueue,e===null?(e={lastEffect:null,stores:null},Me.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Kx(t,e,r,n){e.value=r,e.getSnapshot=n,Jx(e)&&Zx(t)}function Qx(t,e,r){return r(function(){Jx(e)&&Zx(t)})}function Jx(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!fr(t,r)}catch{return!0}}function Zx(t){var e=tn(t,1);e!==null&&dr(e,t,1,-1)}function Up(t){var e=br();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ho,lastRenderedState:t},e.queue=t,t=t.dispatch=bk.bind(null,Me,t),[e.memoizedState,t]}function Vo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Me.updateQueue,e===null?(e={lastEffect:null,stores:null},Me.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function ev(){return qt().memoizedState}function Dl(t,e,r,n){var s=br();Me.flags|=t,s.memoizedState=Vo(1|e,r,void 0,n===void 0?null:n)}function Kc(t,e,r,n){var s=qt();n=n===void 0?null:n;var i=void 0;if(Ve!==null){var o=Ve.memoizedState;if(i=o.destroy,n!==null&&Yf(n,o.deps)){s.memoizedState=Vo(e,r,i,n);return}}Me.flags|=t,s.memoizedState=Vo(1|e,r,i,n)}function Xp(t,e){return Dl(8390656,8,t,e)}function Kf(t,e){return Kc(2048,8,t,e)}function tv(t,e){return Kc(4,2,t,e)}function rv(t,e){return Kc(4,4,t,e)}function nv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sv(t,e,r){return r=r!=null?r.concat([t]):null,Kc(4,4,nv.bind(null,e,t),r)}function Qf(){}function iv(t,e){var r=qt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Yf(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function ov(t,e){var r=qt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Yf(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function av(t,e,r){return gs&21?(fr(r,e)||(r=hx(),Me.lanes|=r,ps|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yt=!0),t.memoizedState=r)}function vk(t,e){var r=be;be=r!==0&&4>r?r:4,t(!0);var n=id.transition;id.transition={};try{t(!1),e()}finally{be=r,id.transition=n}}function lv(){return qt().memoizedState}function wk(t,e,r){var n=Nn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},cv(t))uv(e,r);else if(r=Vx(t,e,r,n),r!==null){var s=dt();dr(r,t,n,s),dv(r,e,n)}}function bk(t,e,r){var n=Nn(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(cv(t))uv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,r);if(s.hasEagerState=!0,s.eagerState=a,fr(a,o)){var l=e.interleaved;l===null?(s.next=s,Wf(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=Vx(t,e,s,n),r!==null&&(s=dt(),dr(r,t,n,s),dv(r,e,n))}}function cv(t){var e=t.alternate;return t===Me||e!==null&&e===Me}function uv(t,e){xo=dc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function dv(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,jf(t,r)}}var hc={readContext:Gt,useCallback:tt,useContext:tt,useEffect:tt,useImperativeHandle:tt,useInsertionEffect:tt,useLayoutEffect:tt,useMemo:tt,useReducer:tt,useRef:tt,useState:tt,useDebugValue:tt,useDeferredValue:tt,useTransition:tt,useMutableSource:tt,useSyncExternalStore:tt,useId:tt,unstable_isNewReconciler:!1},_k={readContext:Gt,useCallback:function(t,e){return br().memoizedState=[t,e===void 0?null:e],t},useContext:Gt,useEffect:Xp,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Dl(4194308,4,nv.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Dl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Dl(4,2,t,e)},useMemo:function(t,e){var r=br();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=br();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=wk.bind(null,Me,t),[n.memoizedState,t]},useRef:function(t){var e=br();return t={current:t},e.memoizedState=t},useState:Up,useDebugValue:Qf,useDeferredValue:function(t){return br().memoizedState=t},useTransition:function(){var t=Up(!1),e=t[0];return t=vk.bind(null,t[1]),br().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Me,s=br();if(Te){if(r===void 0)throw Error(q(407));r=r()}else{if(r=e(),Qe===null)throw Error(q(349));gs&30||qx(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,Xp(Qx.bind(null,n,i,t),[t]),n.flags|=2048,Vo(9,Kx.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=br(),e=Qe.identifierPrefix;if(Te){var r=Xr,n=Ur;r=(n&~(1<<32-ur(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Wo++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=xk++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Sk={readContext:Gt,useCallback:iv,useContext:Gt,useEffect:Kf,useImperativeHandle:sv,useInsertionEffect:tv,useLayoutEffect:rv,useMemo:ov,useReducer:od,useRef:ev,useState:function(){return od(Ho)},useDebugValue:Qf,useDeferredValue:function(t){var e=qt();return av(e,Ve.memoizedState,t)},useTransition:function(){var t=od(Ho)[0],e=qt().memoizedState;return[t,e]},useMutableSource:Yx,useSyncExternalStore:Gx,useId:lv,unstable_isNewReconciler:!1},Ck={readContext:Gt,useCallback:iv,useContext:Gt,useEffect:Kf,useImperativeHandle:sv,useInsertionEffect:tv,useLayoutEffect:rv,useMemo:ov,useReducer:ad,useRef:ev,useState:function(){return ad(Ho)},useDebugValue:Qf,useDeferredValue:function(t){var e=qt();return Ve===null?e.memoizedState=t:av(e,Ve.memoizedState,t)},useTransition:function(){var t=ad(Ho)[0],e=qt().memoizedState;return[t,e]},useMutableSource:Yx,useSyncExternalStore:Gx,useId:lv,unstable_isNewReconciler:!1};function er(t,e){if(t&&t.defaultProps){e=De({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function vh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:De({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Qc={isMounted:function(t){return(t=t._reactInternals)?Cs(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=dt(),s=Nn(t),i=Kr(n,s);i.payload=e,r!=null&&(i.callback=r),e=Tn(t,i,s),e!==null&&(dr(e,t,s,n),Pl(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=dt(),s=Nn(t),i=Kr(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Tn(t,i,s),e!==null&&(dr(e,t,s,n),Pl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=dt(),n=Nn(t),s=Kr(r,n);s.tag=2,e!=null&&(s.callback=e),e=Tn(t,s,n),e!==null&&(dr(e,t,n,r),Pl(e,t,n))}};function Yp(t,e,r,n,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!Lo(r,n)||!Lo(s,i):!0}function hv(t,e,r){var n=!1,s=Mn,i=e.contextType;return typeof i=="object"&&i!==null?i=Gt(i):(s=bt(e)?hs:at.current,n=e.contextTypes,i=(n=n!=null)?hi(t,s):Mn),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Gp(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Qc.enqueueReplaceState(e,e.state,null)}function wh(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Hf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Gt(i):(i=bt(e)?hs:at.current,s.context=hi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(vh(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Qc.enqueueReplaceState(s,s.state,null),cc(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function mi(t,e){try{var r="",n=e;do r+=JS(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ld(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function bh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var kk=typeof WeakMap=="function"?WeakMap:Map;function fv(t,e,r){r=Kr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){gc||(gc=!0,Ph=n),bh(t,e)},r}function gv(t,e,r){r=Kr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){bh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){bh(t,e),typeof n!="function"&&(jn===null?jn=new Set([this]):jn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function qp(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new kk;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=$k.bind(null,t,e,r),e.then(t,t))}function Kp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qp(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Kr(-1,1),e.tag=2,Tn(r,e,1))),r.lanes|=1),t)}var Ek=on.ReactCurrentOwner,yt=!1;function lt(t,e,r,n){e.child=t===null?Hx(e,null,r,n):gi(e,t.child,r,n)}function Jp(t,e,r,n,s){r=r.render;var i=e.ref;return ii(e,s),n=Gf(t,e,r,n,i,s),r=qf(),t!==null&&!yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,rn(t,e,s)):(Te&&r&&Lf(e),e.flags|=1,lt(t,e,n,s),e.child)}function Zp(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!ig(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,pv(t,e,i,n,s)):(t=Rl(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Lo,r(o,n)&&t.ref===e.ref)return rn(t,e,s)}return e.flags|=1,t=On(i,n),t.ref=e.ref,t.return=e,e.child=t}function pv(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(Lo(i,n)&&t.ref===e.ref)if(yt=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(yt=!0);else return e.lanes=t.lanes,rn(t,e,s)}return _h(t,e,r,n,s)}function mv(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(qs,Nt),Nt|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ce(qs,Nt),Nt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Ce(qs,Nt),Nt|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Ce(qs,Nt),Nt|=n;return lt(t,e,s,r),e.child}function yv(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function _h(t,e,r,n,s){var i=bt(r)?hs:at.current;return i=hi(e,i),ii(e,s),r=Gf(t,e,r,n,i,s),n=qf(),t!==null&&!yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,rn(t,e,s)):(Te&&n&&Lf(e),e.flags|=1,lt(t,e,r,s),e.child)}function em(t,e,r,n,s){if(bt(r)){var i=!0;sc(e)}else i=!1;if(ii(e,s),e.stateNode===null)Al(t,e),hv(e,r,n),wh(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=Gt(c):(c=bt(r)?hs:at.current,c=hi(e,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&Gp(e,o,n,c),yn=!1;var h=e.memoizedState;o.state=h,cc(e,n,o,s),l=e.memoizedState,a!==n||h!==l||wt.current||yn?(typeof u=="function"&&(vh(e,r,u,n),l=e.memoizedState),(a=yn||Yp(e,r,a,n,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Ux(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:er(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=Gt(l):(l=bt(r)?hs:at.current,l=hi(e,l));var g=r.getDerivedStateFromProps;(u=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&Gp(e,o,n,l),yn=!1,h=e.memoizedState,o.state=h,cc(e,n,o,s);var p=e.memoizedState;a!==d||h!==p||wt.current||yn?(typeof g=="function"&&(vh(e,r,g,n),p=e.memoizedState),(c=yn||Yp(e,r,c,n,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),o.props=n,o.state=p,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return Sh(t,e,r,n,i,s)}function Sh(t,e,r,n,s,i){yv(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&$p(e,r,!1),rn(t,e,i);n=e.stateNode,Ek.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=gi(e,t.child,null,i),e.child=gi(e,null,a,i)):lt(t,e,a,i),e.memoizedState=n.state,s&&$p(e,r,!0),e.child}function xv(t){var e=t.stateNode;e.pendingContext?Ip(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ip(t,e.context,!1),Vf(t,e.containerInfo)}function tm(t,e,r,n,s){return fi(),If(s),e.flags|=256,lt(t,e,r,n),e.child}var Ch={dehydrated:null,treeContext:null,retryLane:0};function kh(t){return{baseLanes:t,cachePool:null,transitions:null}}function vv(t,e,r){var n=e.pendingProps,s=Pe.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ce(Pe,s&1),t===null)return yh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=eu(o,n,0,null),t=is(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=kh(r),e.memoizedState=Ch,t):Jf(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Tk(t,e,o,n,a,s,r);if(i){i=n.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=On(s,l),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=On(a,i):(i=is(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?kh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=Ch,n}return i=t.child,t=i.sibling,n=On(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Jf(t,e){return e=eu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wa(t,e,r,n){return n!==null&&If(n),gi(e,t.child,null,r),t=Jf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Tk(t,e,r,n,s,i,o){if(r)return e.flags&256?(e.flags&=-257,n=ld(Error(q(422))),Wa(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=eu({mode:"visible",children:n.children},s,0,null),i=is(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&gi(e,t.child,null,o),e.child.memoizedState=kh(o),e.memoizedState=Ch,i);if(!(e.mode&1))return Wa(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,i=Error(q(419)),n=ld(i,n,void 0),Wa(t,e,o,n)}if(a=(o&t.childLanes)!==0,yt||a){if(n=Qe,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tn(t,s),dr(n,t,s,-1))}return sg(),n=ld(Error(q(421))),Wa(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=zk.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Mt=En(s.nextSibling),At=e,Te=!0,sr=null,t!==null&&(Ht[Vt++]=Ur,Ht[Vt++]=Xr,Ht[Vt++]=fs,Ur=t.id,Xr=t.overflow,fs=e),e=Jf(e,n.children),e.flags|=4096,e)}function rm(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),xh(t.return,e,r)}function cd(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function wv(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(lt(t,e,n.children,r),n=Pe.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&rm(t,r,e);else if(t.tag===19)rm(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ce(Pe,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&uc(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),cd(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&uc(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}cd(e,!0,r,null,i);break;case"together":cd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Al(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function rn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ps|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,r=On(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=On(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function jk(t,e,r){switch(e.tag){case 3:xv(e),fi();break;case 5:Xx(e);break;case 1:bt(e.type)&&sc(e);break;case 4:Vf(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Ce(ac,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ce(Pe,Pe.current&1),e.flags|=128,null):r&e.child.childLanes?vv(t,e,r):(Ce(Pe,Pe.current&1),t=rn(t,e,r),t!==null?t.sibling:null);Ce(Pe,Pe.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return wv(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ce(Pe,Pe.current),n)break;return null;case 22:case 23:return e.lanes=0,mv(t,e,r)}return rn(t,e,r)}var bv,Eh,_v,Sv;bv=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Eh=function(){};_v=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Jn(Nr.current);var i=null;switch(r){case"input":s=Gd(t,s),n=Gd(t,n),i=[];break;case"select":s=De({},s,{value:void 0}),n=De({},n,{value:void 0}),i=[];break;case"textarea":s=Qd(t,s),n=Qd(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=rc)}Zd(r,n);var o;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(No.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(a=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(No.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ke("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};Sv=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ki(t,e){if(!Te)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function rt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Nk(t,e,r){var n=e.pendingProps;switch(Rf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(e),null;case 1:return bt(e.type)&&nc(),rt(e),null;case 3:return n=e.stateNode,pi(),Ee(wt),Ee(at),Xf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(za(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sr!==null&&(Ah(sr),sr=null))),Eh(t,e),rt(e),null;case 5:Uf(e);var s=Jn(Bo.current);if(r=e.type,t!==null&&e.stateNode!=null)_v(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(q(166));return rt(e),null}if(t=Jn(Nr.current),za(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[kr]=e,n[$o]=i,t=(e.mode&1)!==0,r){case"dialog":ke("cancel",n),ke("close",n);break;case"iframe":case"object":case"embed":ke("load",n);break;case"video":case"audio":for(s=0;s<oo.length;s++)ke(oo[s],n);break;case"source":ke("error",n);break;case"img":case"image":case"link":ke("error",n),ke("load",n);break;case"details":ke("toggle",n);break;case"input":dp(n,i),ke("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ke("invalid",n);break;case"textarea":fp(n,i),ke("invalid",n)}Zd(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?n.textContent!==a&&(i.suppressHydrationWarning!==!0&&$a(n.textContent,a,t),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&$a(n.textContent,a,t),s=["children",""+a]):No.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ke("scroll",n)}switch(r){case"input":Pa(n),hp(n,i,!0);break;case"textarea":Pa(n),gp(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=rc)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Qy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[kr]=e,t[$o]=n,bv(t,e,!1,!1),e.stateNode=t;e:{switch(o=eh(r,n),r){case"dialog":ke("cancel",t),ke("close",t),s=n;break;case"iframe":case"object":case"embed":ke("load",t),s=n;break;case"video":case"audio":for(s=0;s<oo.length;s++)ke(oo[s],t);s=n;break;case"source":ke("error",t),s=n;break;case"img":case"image":case"link":ke("error",t),ke("load",t),s=n;break;case"details":ke("toggle",t),s=n;break;case"input":dp(t,n),s=Gd(t,n),ke("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=De({},n,{value:void 0}),ke("invalid",t);break;case"textarea":fp(t,n),s=Qd(t,n),ke("invalid",t);break;default:s=n}Zd(r,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?ex(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Jy(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Oo(t,l):typeof l=="number"&&Oo(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(No.hasOwnProperty(i)?l!=null&&i==="onScroll"&&ke("scroll",t):l!=null&&_f(t,i,l,o))}switch(r){case"input":Pa(t),hp(t,n,!1);break;case"textarea":Pa(t),gp(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Pn(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?ti(t,!!n.multiple,i,!1):n.defaultValue!=null&&ti(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=rc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return rt(e),null;case 6:if(t&&e.stateNode!=null)Sv(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(q(166));if(r=Jn(Bo.current),Jn(Nr.current),za(e)){if(n=e.stateNode,r=e.memoizedProps,n[kr]=e,(i=n.nodeValue!==r)&&(t=At,t!==null))switch(t.tag){case 3:$a(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$a(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[kr]=e,e.stateNode=n}return rt(e),null;case 13:if(Ee(Pe),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Te&&Mt!==null&&e.mode&1&&!(e.flags&128))Bx(),fi(),e.flags|=98560,i=!1;else if(i=za(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(q(317));i[kr]=e}else fi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;rt(e),i=!1}else sr!==null&&(Ah(sr),sr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Pe.current&1?Ue===0&&(Ue=3):sg())),e.updateQueue!==null&&(e.flags|=4),rt(e),null);case 4:return pi(),Eh(t,e),t===null&&Ro(e.stateNode.containerInfo),rt(e),null;case 10:return Bf(e.type._context),rt(e),null;case 17:return bt(e.type)&&nc(),rt(e),null;case 19:if(Ee(Pe),i=e.memoizedState,i===null)return rt(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)Ki(i,!1);else{if(Ue!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=uc(t),o!==null){for(e.flags|=128,Ki(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ce(Pe,Pe.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ie()>yi&&(e.flags|=128,n=!0,Ki(i,!1),e.lanes=4194304)}else{if(!n)if(t=uc(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ki(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Te)return rt(e),null}else 2*Ie()-i.renderingStartTime>yi&&r!==1073741824&&(e.flags|=128,n=!0,Ki(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ie(),e.sibling=null,r=Pe.current,Ce(Pe,n?r&1|2:r&1),e):(rt(e),null);case 22:case 23:return ng(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Nt&1073741824&&(rt(e),e.subtreeFlags&6&&(e.flags|=8192)):rt(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function Ok(t,e){switch(Rf(e),e.tag){case 1:return bt(e.type)&&nc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pi(),Ee(wt),Ee(at),Xf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Uf(e),null;case 13:if(Ee(Pe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));fi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ee(Pe),null;case 4:return pi(),null;case 10:return Bf(e.type._context),null;case 22:case 23:return ng(),null;case 24:return null;default:return null}}var Ha=!1,st=!1,Pk=typeof WeakSet=="function"?WeakSet:Set,te=null;function Gs(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Fe(t,e,n)}else r.current=null}function Th(t,e,r){try{r()}catch(n){Fe(t,e,n)}}var nm=!1;function Mk(t,e){if(uh=Zl,t=jx(),Ff(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var g;d!==r||s!==0&&d.nodeType!==3||(a=o+s),d!==i||n!==0&&d.nodeType!==3||(l=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(g=d.firstChild)!==null;)h=d,d=g;for(;;){if(d===t)break t;if(h===r&&++c===s&&(a=o),h===i&&++u===n&&(l=o),(g=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=g}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(dh={focusedElem:t,selectionRange:r},Zl=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,v=p.memoizedState,m=e.stateNode,w=m.getSnapshotBeforeUpdate(e.elementType===e.type?y:er(e.type,y),v);m.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(_){Fe(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return p=nm,nm=!1,p}function vo(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Th(e,r,i)}s=s.next}while(s!==n)}}function Jc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function jh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Cv(t){var e=t.alternate;e!==null&&(t.alternate=null,Cv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[kr],delete e[$o],delete e[gh],delete e[gk],delete e[pk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function kv(t){return t.tag===5||t.tag===3||t.tag===4}function sm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||kv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Nh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=rc));else if(n!==4&&(t=t.child,t!==null))for(Nh(t,e,r),t=t.sibling;t!==null;)Nh(t,e,r),t=t.sibling}function Oh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Oh(t,e,r),t=t.sibling;t!==null;)Oh(t,e,r),t=t.sibling}var Je=null,tr=!1;function dn(t,e,r){for(r=r.child;r!==null;)Ev(t,e,r),r=r.sibling}function Ev(t,e,r){if(jr&&typeof jr.onCommitFiberUnmount=="function")try{jr.onCommitFiberUnmount(Vc,r)}catch{}switch(r.tag){case 5:st||Gs(r,e);case 6:var n=Je,s=tr;Je=null,dn(t,e,r),Je=n,tr=s,Je!==null&&(tr?(t=Je,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Je.removeChild(r.stateNode));break;case 18:Je!==null&&(tr?(t=Je,r=r.stateNode,t.nodeType===8?rd(t.parentNode,r):t.nodeType===1&&rd(t,r),Ao(t)):rd(Je,r.stateNode));break;case 4:n=Je,s=tr,Je=r.stateNode.containerInfo,tr=!0,dn(t,e,r),Je=n,tr=s;break;case 0:case 11:case 14:case 15:if(!st&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Th(r,e,o),s=s.next}while(s!==n)}dn(t,e,r);break;case 1:if(!st&&(Gs(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Fe(r,e,a)}dn(t,e,r);break;case 21:dn(t,e,r);break;case 22:r.mode&1?(st=(n=st)||r.memoizedState!==null,dn(t,e,r),st=n):dn(t,e,r);break;default:dn(t,e,r)}}function im(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Pk),e.forEach(function(n){var s=Bk.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Jt(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Je=a.stateNode,tr=!1;break e;case 3:Je=a.stateNode.containerInfo,tr=!0;break e;case 4:Je=a.stateNode.containerInfo,tr=!0;break e}a=a.return}if(Je===null)throw Error(q(160));Ev(i,o,s),Je=null,tr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Fe(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Tv(e,t),e=e.sibling}function Tv(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Jt(e,t),vr(t),n&4){try{vo(3,t,t.return),Jc(3,t)}catch(y){Fe(t,t.return,y)}try{vo(5,t,t.return)}catch(y){Fe(t,t.return,y)}}break;case 1:Jt(e,t),vr(t),n&512&&r!==null&&Gs(r,r.return);break;case 5:if(Jt(e,t),vr(t),n&512&&r!==null&&Gs(r,r.return),t.flags&32){var s=t.stateNode;try{Oo(s,"")}catch(y){Fe(t,t.return,y)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&qy(s,i),eh(a,o);var c=eh(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?ex(s,d):u==="dangerouslySetInnerHTML"?Jy(s,d):u==="children"?Oo(s,d):_f(s,u,d,c)}switch(a){case"input":qd(s,i);break;case"textarea":Ky(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?ti(s,!!i.multiple,g,!1):h!==!!i.multiple&&(i.defaultValue!=null?ti(s,!!i.multiple,i.defaultValue,!0):ti(s,!!i.multiple,i.multiple?[]:"",!1))}s[$o]=i}catch(y){Fe(t,t.return,y)}}break;case 6:if(Jt(e,t),vr(t),n&4){if(t.stateNode===null)throw Error(q(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(y){Fe(t,t.return,y)}}break;case 3:if(Jt(e,t),vr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ao(e.containerInfo)}catch(y){Fe(t,t.return,y)}break;case 4:Jt(e,t),vr(t);break;case 13:Jt(e,t),vr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(tg=Ie())),n&4&&im(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(st=(c=st)||u,Jt(e,t),st=c):Jt(e,t),vr(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(te=t,u=t.child;u!==null;){for(d=te=u;te!==null;){switch(h=te,g=h.child,h.tag){case 0:case 11:case 14:case 15:vo(4,h,h.return);break;case 1:Gs(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){Fe(n,r,y)}}break;case 5:Gs(h,h.return);break;case 22:if(h.memoizedState!==null){am(d);continue}}g!==null?(g.return=h,te=g):am(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Zy("display",o))}catch(y){Fe(t,t.return,y)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(y){Fe(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Jt(e,t),vr(t),n&4&&im(t);break;case 21:break;default:Jt(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(kv(r)){var n=r;break e}r=r.return}throw Error(q(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Oo(s,""),n.flags&=-33);var i=sm(t);Oh(t,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,a=sm(t);Nh(t,a,o);break;default:throw Error(q(161))}}catch(l){Fe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Dk(t,e,r){te=t,jv(t)}function jv(t,e,r){for(var n=(t.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Ha;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||st;a=Ha;var c=st;if(Ha=o,(st=l)&&!c)for(te=s;te!==null;)o=te,l=o.child,o.tag===22&&o.memoizedState!==null?lm(s):l!==null?(l.return=o,te=l):lm(s);for(;i!==null;)te=i,jv(i),i=i.sibling;te=s,Ha=a,st=c}om(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):om(t)}}function om(t){for(;te!==null;){var e=te;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:st||Jc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!st)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:er(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Vp(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Vp(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ao(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}st||e.flags&512&&jh(e)}catch(h){Fe(e,e.return,h)}}if(e===t){te=null;break}if(r=e.sibling,r!==null){r.return=e.return,te=r;break}te=e.return}}function am(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var r=e.sibling;if(r!==null){r.return=e.return,te=r;break}te=e.return}}function lm(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Jc(4,e)}catch(l){Fe(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){Fe(e,s,l)}}var i=e.return;try{jh(e)}catch(l){Fe(e,i,l)}break;case 5:var o=e.return;try{jh(e)}catch(l){Fe(e,o,l)}}}catch(l){Fe(e,e.return,l)}if(e===t){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var Ak=Math.ceil,fc=on.ReactCurrentDispatcher,Zf=on.ReactCurrentOwner,Yt=on.ReactCurrentBatchConfig,ye=0,Qe=null,Be=null,Ze=0,Nt=0,qs=Rn(0),Ue=0,Uo=null,ps=0,Zc=0,eg=0,wo=null,mt=null,tg=0,yi=1/0,Wr=null,gc=!1,Ph=null,jn=null,Va=!1,_n=null,pc=0,bo=0,Mh=null,Fl=-1,Ll=0;function dt(){return ye&6?Ie():Fl!==-1?Fl:Fl=Ie()}function Nn(t){return t.mode&1?ye&2&&Ze!==0?Ze&-Ze:yk.transition!==null?(Ll===0&&(Ll=hx()),Ll):(t=be,t!==0||(t=window.event,t=t===void 0?16:vx(t.type)),t):1}function dr(t,e,r,n){if(50<bo)throw bo=0,Mh=null,Error(q(185));ca(t,r,n),(!(ye&2)||t!==Qe)&&(t===Qe&&(!(ye&2)&&(Zc|=r),Ue===4&&vn(t,Ze)),_t(t,n),r===1&&ye===0&&!(e.mode&1)&&(yi=Ie()+500,qc&&In()))}function _t(t,e){var r=t.callbackNode;yC(t,e);var n=Jl(t,t===Qe?Ze:0);if(n===0)r!==null&&yp(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&yp(r),e===1)t.tag===0?mk(cm.bind(null,t)):Ix(cm.bind(null,t)),hk(function(){!(ye&6)&&In()}),r=null;else{switch(fx(n)){case 1:r=Tf;break;case 4:r=ux;break;case 16:r=Ql;break;case 536870912:r=dx;break;default:r=Ql}r=Lv(r,Nv.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Nv(t,e){if(Fl=-1,Ll=0,ye&6)throw Error(q(327));var r=t.callbackNode;if(oi()&&t.callbackNode!==r)return null;var n=Jl(t,t===Qe?Ze:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=mc(t,n);else{e=n;var s=ye;ye|=2;var i=Pv();(Qe!==t||Ze!==e)&&(Wr=null,yi=Ie()+500,ss(t,e));do try{Rk();break}catch(a){Ov(t,a)}while(!0);zf(),fc.current=i,ye=s,Be!==null?e=0:(Qe=null,Ze=0,e=Ue)}if(e!==0){if(e===2&&(s=ih(t),s!==0&&(n=s,e=Dh(t,s))),e===1)throw r=Uo,ss(t,0),vn(t,n),_t(t,Ie()),r;if(e===6)vn(t,n);else{if(s=t.current.alternate,!(n&30)&&!Fk(s)&&(e=mc(t,n),e===2&&(i=ih(t),i!==0&&(n=i,e=Dh(t,i))),e===1))throw r=Uo,ss(t,0),vn(t,n),_t(t,Ie()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(q(345));case 2:Vn(t,mt,Wr);break;case 3:if(vn(t,n),(n&130023424)===n&&(e=tg+500-Ie(),10<e)){if(Jl(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){dt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=fh(Vn.bind(null,t,mt,Wr),e);break}Vn(t,mt,Wr);break;case 4:if(vn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-ur(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=Ie()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ak(n/1960))-n,10<n){t.timeoutHandle=fh(Vn.bind(null,t,mt,Wr),n);break}Vn(t,mt,Wr);break;case 5:Vn(t,mt,Wr);break;default:throw Error(q(329))}}}return _t(t,Ie()),t.callbackNode===r?Nv.bind(null,t):null}function Dh(t,e){var r=wo;return t.current.memoizedState.isDehydrated&&(ss(t,e).flags|=256),t=mc(t,e),t!==2&&(e=mt,mt=r,e!==null&&Ah(e)),t}function Ah(t){mt===null?mt=t:mt.push.apply(mt,t)}function Fk(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!fr(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vn(t,e){for(e&=~eg,e&=~Zc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ur(e),n=1<<r;t[r]=-1,e&=~n}}function cm(t){if(ye&6)throw Error(q(327));oi();var e=Jl(t,0);if(!(e&1))return _t(t,Ie()),null;var r=mc(t,e);if(t.tag!==0&&r===2){var n=ih(t);n!==0&&(e=n,r=Dh(t,n))}if(r===1)throw r=Uo,ss(t,0),vn(t,e),_t(t,Ie()),r;if(r===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Vn(t,mt,Wr),_t(t,Ie()),null}function rg(t,e){var r=ye;ye|=1;try{return t(e)}finally{ye=r,ye===0&&(yi=Ie()+500,qc&&In())}}function ms(t){_n!==null&&_n.tag===0&&!(ye&6)&&oi();var e=ye;ye|=1;var r=Yt.transition,n=be;try{if(Yt.transition=null,be=1,t)return t()}finally{be=n,Yt.transition=r,ye=e,!(ye&6)&&In()}}function ng(){Nt=qs.current,Ee(qs)}function ss(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,dk(r)),Be!==null)for(r=Be.return;r!==null;){var n=r;switch(Rf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&nc();break;case 3:pi(),Ee(wt),Ee(at),Xf();break;case 5:Uf(n);break;case 4:pi();break;case 13:Ee(Pe);break;case 19:Ee(Pe);break;case 10:Bf(n.type._context);break;case 22:case 23:ng()}r=r.return}if(Qe=t,Be=t=On(t.current,null),Ze=Nt=e,Ue=0,Uo=null,eg=Zc=ps=0,mt=wo=null,Qn!==null){for(e=0;e<Qn.length;e++)if(r=Qn[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}Qn=null}return t}function Ov(t,e){do{var r=Be;try{if(zf(),Ml.current=hc,dc){for(var n=Me.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}dc=!1}if(gs=0,Ke=Ve=Me=null,xo=!1,Wo=0,Zf.current=null,r===null||r.return===null){Ue=1,Uo=e,Be=null;break}e:{var i=t,o=r.return,a=r,l=e;if(e=Ze,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=Kp(o);if(g!==null){g.flags&=-257,Qp(g,o,a,i,e),g.mode&1&&qp(i,c,e),e=g,l=c;var p=e.updateQueue;if(p===null){var y=new Set;y.add(l),e.updateQueue=y}else p.add(l);break e}else{if(!(e&1)){qp(i,c,e),sg();break e}l=Error(q(426))}}else if(Te&&a.mode&1){var v=Kp(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Qp(v,o,a,i,e),If(mi(l,a));break e}}i=l=mi(l,a),Ue!==4&&(Ue=2),wo===null?wo=[i]:wo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var m=fv(i,l,e);Hp(i,m);break e;case 1:a=l;var w=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(jn===null||!jn.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var _=gv(i,a,e);Hp(i,_);break e}}i=i.return}while(i!==null)}Dv(r)}catch(b){e=b,Be===r&&r!==null&&(Be=r=r.return);continue}break}while(!0)}function Pv(){var t=fc.current;return fc.current=hc,t===null?hc:t}function sg(){(Ue===0||Ue===3||Ue===2)&&(Ue=4),Qe===null||!(ps&268435455)&&!(Zc&268435455)||vn(Qe,Ze)}function mc(t,e){var r=ye;ye|=2;var n=Pv();(Qe!==t||Ze!==e)&&(Wr=null,ss(t,e));do try{Lk();break}catch(s){Ov(t,s)}while(!0);if(zf(),ye=r,fc.current=n,Be!==null)throw Error(q(261));return Qe=null,Ze=0,Ue}function Lk(){for(;Be!==null;)Mv(Be)}function Rk(){for(;Be!==null&&!lC();)Mv(Be)}function Mv(t){var e=Fv(t.alternate,t,Nt);t.memoizedProps=t.pendingProps,e===null?Dv(t):Be=e,Zf.current=null}function Dv(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Ok(r,e),r!==null){r.flags&=32767,Be=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ue=6,Be=null;return}}else if(r=Nk(r,e,Nt),r!==null){Be=r;return}if(e=e.sibling,e!==null){Be=e;return}Be=e=t}while(e!==null);Ue===0&&(Ue=5)}function Vn(t,e,r){var n=be,s=Yt.transition;try{Yt.transition=null,be=1,Ik(t,e,r,n)}finally{Yt.transition=s,be=n}return null}function Ik(t,e,r,n){do oi();while(_n!==null);if(ye&6)throw Error(q(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(xC(t,i),t===Qe&&(Be=Qe=null,Ze=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Va||(Va=!0,Lv(Ql,function(){return oi(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Yt.transition,Yt.transition=null;var o=be;be=1;var a=ye;ye|=4,Zf.current=null,Mk(t,r),Tv(r,t),sk(dh),Zl=!!uh,dh=uh=null,t.current=r,Dk(r),cC(),ye=a,be=o,Yt.transition=i}else t.current=r;if(Va&&(Va=!1,_n=t,pc=s),i=t.pendingLanes,i===0&&(jn=null),hC(r.stateNode),_t(t,Ie()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(gc)throw gc=!1,t=Ph,Ph=null,t;return pc&1&&t.tag!==0&&oi(),i=t.pendingLanes,i&1?t===Mh?bo++:(bo=0,Mh=t):bo=0,In(),null}function oi(){if(_n!==null){var t=fx(pc),e=Yt.transition,r=be;try{if(Yt.transition=null,be=16>t?16:t,_n===null)var n=!1;else{if(t=_n,_n=null,pc=0,ye&6)throw Error(q(331));var s=ye;for(ye|=4,te=t.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(te=c;te!==null;){var u=te;switch(u.tag){case 0:case 11:case 15:vo(8,u,i)}var d=u.child;if(d!==null)d.return=u,te=d;else for(;te!==null;){u=te;var h=u.sibling,g=u.return;if(Cv(u),u===c){te=null;break}if(h!==null){h.return=g,te=h;break}te=g}}}var p=i.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:vo(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,te=m;break e}te=i.return}}var w=t.current;for(te=w;te!==null;){o=te;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,te=x;else e:for(o=w;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Jc(9,a)}}catch(b){Fe(a,a.return,b)}if(a===o){te=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,te=_;break e}te=a.return}}if(ye=s,In(),jr&&typeof jr.onPostCommitFiberRoot=="function")try{jr.onPostCommitFiberRoot(Vc,t)}catch{}n=!0}return n}finally{be=r,Yt.transition=e}}return!1}function um(t,e,r){e=mi(r,e),e=fv(t,e,1),t=Tn(t,e,1),e=dt(),t!==null&&(ca(t,1,e),_t(t,e))}function Fe(t,e,r){if(t.tag===3)um(t,t,r);else for(;e!==null;){if(e.tag===3){um(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(jn===null||!jn.has(n))){t=mi(r,t),t=gv(e,t,1),e=Tn(e,t,1),t=dt(),e!==null&&(ca(e,1,t),_t(e,t));break}}e=e.return}}function $k(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=dt(),t.pingedLanes|=t.suspendedLanes&r,Qe===t&&(Ze&r)===r&&(Ue===4||Ue===3&&(Ze&130023424)===Ze&&500>Ie()-tg?ss(t,0):eg|=r),_t(t,e)}function Av(t,e){e===0&&(t.mode&1?(e=Aa,Aa<<=1,!(Aa&130023424)&&(Aa=4194304)):e=1);var r=dt();t=tn(t,e),t!==null&&(ca(t,e,r),_t(t,r))}function zk(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Av(t,r)}function Bk(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(q(314))}n!==null&&n.delete(e),Av(t,r)}var Fv;Fv=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||wt.current)yt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return yt=!1,jk(t,e,r);yt=!!(t.flags&131072)}else yt=!1,Te&&e.flags&1048576&&$x(e,oc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Al(t,e),t=e.pendingProps;var s=hi(e,at.current);ii(e,r),s=Gf(null,e,n,t,s,r);var i=qf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bt(n)?(i=!0,sc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hf(e),s.updater=Qc,e.stateNode=s,s._reactInternals=e,wh(e,n,t,r),e=Sh(null,e,n,!0,i,r)):(e.tag=0,Te&&i&&Lf(e),lt(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Al(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=Hk(n),t=er(n,t),s){case 0:e=_h(null,e,n,t,r);break e;case 1:e=em(null,e,n,t,r);break e;case 11:e=Jp(null,e,n,t,r);break e;case 14:e=Zp(null,e,n,er(n.type,t),r);break e}throw Error(q(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:er(n,s),_h(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:er(n,s),em(t,e,n,s,r);case 3:e:{if(xv(e),t===null)throw Error(q(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Ux(t,e),cc(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=mi(Error(q(423)),e),e=tm(t,e,n,r,s);break e}else if(n!==s){s=mi(Error(q(424)),e),e=tm(t,e,n,r,s);break e}else for(Mt=En(e.stateNode.containerInfo.firstChild),At=e,Te=!0,sr=null,r=Hx(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(fi(),n===s){e=rn(t,e,r);break e}lt(t,e,n,r)}e=e.child}return e;case 5:return Xx(e),t===null&&yh(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,hh(n,s)?o=null:i!==null&&hh(n,i)&&(e.flags|=32),yv(t,e),lt(t,e,o,r),e.child;case 6:return t===null&&yh(e),null;case 13:return vv(t,e,r);case 4:return Vf(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=gi(e,null,n,r):lt(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:er(n,s),Jp(t,e,n,s,r);case 7:return lt(t,e,e.pendingProps,r),e.child;case 8:return lt(t,e,e.pendingProps.children,r),e.child;case 12:return lt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ce(ac,n._currentValue),n._currentValue=o,i!==null)if(fr(i.value,o)){if(i.children===s.children&&!wt.current){e=rn(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Kr(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),xh(i.return,r,e),a.lanes|=r;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(q(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),xh(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}lt(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,ii(e,r),s=Gt(s),n=n(s),e.flags|=1,lt(t,e,n,r),e.child;case 14:return n=e.type,s=er(n,e.pendingProps),s=er(n.type,s),Zp(t,e,n,s,r);case 15:return pv(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:er(n,s),Al(t,e),e.tag=1,bt(n)?(t=!0,sc(e)):t=!1,ii(e,r),hv(e,n,s),wh(e,n,s,r),Sh(null,e,n,!0,t,r);case 19:return wv(t,e,r);case 22:return mv(t,e,r)}throw Error(q(156,e.tag))};function Lv(t,e){return cx(t,e)}function Wk(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,e,r,n){return new Wk(t,e,r,n)}function ig(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Hk(t){if(typeof t=="function")return ig(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Cf)return 11;if(t===kf)return 14}return 2}function On(t,e){var r=t.alternate;return r===null?(r=Xt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Rl(t,e,r,n,s,i){var o=2;if(n=t,typeof t=="function")ig(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case $s:return is(r.children,s,i,e);case Sf:o=8,s|=8;break;case Vd:return t=Xt(12,r,e,s|2),t.elementType=Vd,t.lanes=i,t;case Ud:return t=Xt(13,r,e,s),t.elementType=Ud,t.lanes=i,t;case Xd:return t=Xt(19,r,e,s),t.elementType=Xd,t.lanes=i,t;case Xy:return eu(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Vy:o=10;break e;case Uy:o=9;break e;case Cf:o=11;break e;case kf:o=14;break e;case mn:o=16,n=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=Xt(o,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function is(t,e,r,n){return t=Xt(7,t,n,e),t.lanes=r,t}function eu(t,e,r,n){return t=Xt(22,t,n,e),t.elementType=Xy,t.lanes=r,t.stateNode={isHidden:!1},t}function ud(t,e,r){return t=Xt(6,t,null,e),t.lanes=r,t}function dd(t,e,r){return e=Xt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Vk(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uu(0),this.expirationTimes=Uu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uu(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function og(t,e,r,n,s,i,o,a,l){return t=new Vk(t,e,r,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hf(i),t}function Uk(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Is,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Rv(t){if(!t)return Mn;t=t._reactInternals;e:{if(Cs(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var r=t.type;if(bt(r))return Rx(t,r,e)}return e}function Iv(t,e,r,n,s,i,o,a,l){return t=og(r,n,!0,t,s,i,o,a,l),t.context=Rv(null),r=t.current,n=dt(),s=Nn(r),i=Kr(n,s),i.callback=e??null,Tn(r,i,s),t.current.lanes=s,ca(t,s,n),_t(t,n),t}function tu(t,e,r,n){var s=e.current,i=dt(),o=Nn(s);return r=Rv(r),e.context===null?e.context=r:e.pendingContext=r,e=Kr(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Tn(s,e,o),t!==null&&(dr(t,s,o,i),Pl(t,s,o)),o}function yc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function dm(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function ag(t,e){dm(t,e),(t=t.alternate)&&dm(t,e)}function Xk(){return null}var $v=typeof reportError=="function"?reportError:function(t){console.error(t)};function lg(t){this._internalRoot=t}ru.prototype.render=lg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));tu(t,e,null,null)};ru.prototype.unmount=lg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ms(function(){tu(null,t,null,null)}),e[en]=null}};function ru(t){this._internalRoot=t}ru.prototype.unstable_scheduleHydration=function(t){if(t){var e=mx();t={blockedOn:null,target:t,priority:e};for(var r=0;r<xn.length&&e!==0&&e<xn[r].priority;r++);xn.splice(r,0,t),r===0&&xx(t)}};function cg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function nu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function hm(){}function Yk(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=yc(o);i.call(c)}}var o=Iv(e,n,t,0,null,!1,!1,"",hm);return t._reactRootContainer=o,t[en]=o.current,Ro(t.nodeType===8?t.parentNode:t),ms(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var c=yc(l);a.call(c)}}var l=og(t,0,!1,null,null,!1,!1,"",hm);return t._reactRootContainer=l,t[en]=l.current,Ro(t.nodeType===8?t.parentNode:t),ms(function(){tu(e,l,r,n)}),l}function su(t,e,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=yc(o);a.call(l)}}tu(e,o,t,s)}else o=Yk(r,e,t,s,n);return yc(o)}gx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=io(e.pendingLanes);r!==0&&(jf(e,r|1),_t(e,Ie()),!(ye&6)&&(yi=Ie()+500,In()))}break;case 13:ms(function(){var n=tn(t,1);if(n!==null){var s=dt();dr(n,t,1,s)}}),ag(t,1)}};Nf=function(t){if(t.tag===13){var e=tn(t,134217728);if(e!==null){var r=dt();dr(e,t,134217728,r)}ag(t,134217728)}};px=function(t){if(t.tag===13){var e=Nn(t),r=tn(t,e);if(r!==null){var n=dt();dr(r,t,e,n)}ag(t,e)}};mx=function(){return be};yx=function(t,e){var r=be;try{return be=t,e()}finally{be=r}};rh=function(t,e,r){switch(e){case"input":if(qd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Gc(n);if(!s)throw Error(q(90));Gy(n),qd(n,s)}}}break;case"textarea":Ky(t,r);break;case"select":e=r.value,e!=null&&ti(t,!!r.multiple,e,!1)}};nx=rg;sx=ms;var Gk={usingClientEntryPoint:!1,Events:[da,Hs,Gc,tx,rx,rg]},Qi={findFiberByHostInstance:Kn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qk={bundleType:Qi.bundleType,version:Qi.version,rendererPackageName:Qi.rendererPackageName,rendererConfig:Qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:on.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ax(t),t===null?null:t.stateNode},findFiberByHostInstance:Qi.findFiberByHostInstance||Xk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ua=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ua.isDisabled&&Ua.supportsFiber)try{Vc=Ua.inject(qk),jr=Ua}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gk;$t.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cg(e))throw Error(q(200));return Uk(t,e,null,r)};$t.createRoot=function(t,e){if(!cg(t))throw Error(q(299));var r=!1,n="",s=$v;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=og(t,1,!1,null,null,r,!1,n,s),t[en]=e.current,Ro(t.nodeType===8?t.parentNode:t),new lg(e)};$t.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=ax(e),t=t===null?null:t.stateNode,t};$t.flushSync=function(t){return ms(t)};$t.hydrate=function(t,e,r){if(!nu(e))throw Error(q(200));return su(null,t,e,!0,r)};$t.hydrateRoot=function(t,e,r){if(!cg(t))throw Error(q(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=$v;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Iv(e,null,t,1,r??null,s,!1,i,o),t[en]=e.current,Ro(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new ru(e)};$t.render=function(t,e,r){if(!nu(e))throw Error(q(200));return su(null,t,e,!1,r)};$t.unmountComponentAtNode=function(t){if(!nu(t))throw Error(q(40));return t._reactRootContainer?(ms(function(){su(null,null,t,!1,function(){t._reactRootContainer=null,t[en]=null})}),!0):!1};$t.unstable_batchedUpdates=rg;$t.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!nu(r))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return su(t,e,r,!1,n)};$t.version="18.3.1-next-f1338f8080-20240426";function zv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zv)}catch(t){console.error(t)}}zv(),zy.exports=$t;var Kk=zy.exports,fm=Kk;Wd.createRoot=fm.createRoot,Wd.hydrateRoot=fm.hydrateRoot;function He(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let r=0,n;r<t.length;r++)(n=He(t[r]))!==""&&(e+=(e&&" ")+n);else for(let r in t)t[r]&&(e+=(e&&" ")+r);return e}var Qk={value:()=>{}};function iu(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Il(r)}function Il(t){this._=t}function Jk(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Il.prototype=iu.prototype={constructor:Il,on:function(t,e){var r=this._,n=Jk(t+"",r),s,i=-1,o=n.length;if(arguments.length<2){for(;++i<o;)if((s=(t=n[i]).type)&&(s=Zk(r[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<o;)if(s=(t=n[i]).type)r[s]=gm(r[s],t.name,e);else if(e==null)for(s in r)r[s]=gm(r[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Il(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,i;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],n=0,s=i.length;n<s;++n)i[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],s=0,i=n.length;s<i;++s)n[s].value.apply(e,r)}};function Zk(t,e){for(var r=0,n=t.length,s;r<n;++r)if((s=t[r]).name===e)return s.value}function gm(t,e,r){for(var n=0,s=t.length;n<s;++n)if(t[n].name===e){t[n]=Qk,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var Fh="http://www.w3.org/1999/xhtml";const pm={svg:"http://www.w3.org/2000/svg",xhtml:Fh,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ou(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),pm.hasOwnProperty(e)?{space:pm[e],local:t}:t}function e2(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===Fh&&e.documentElement.namespaceURI===Fh?e.createElement(t):e.createElementNS(r,t)}}function t2(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Bv(t){var e=ou(t);return(e.local?t2:e2)(e)}function r2(){}function ug(t){return t==null?r2:function(){return this.querySelector(t)}}function n2(t){typeof t!="function"&&(t=ug(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var i=e[s],o=i.length,a=n[s]=new Array(o),l,c,u=0;u<o;++u)(l=i[u])&&(c=t.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new Lt(n,this._parents)}function s2(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function i2(){return[]}function Wv(t){return t==null?i2:function(){return this.querySelectorAll(t)}}function o2(t){return function(){return s2(t.apply(this,arguments))}}function a2(t){typeof t=="function"?t=o2(t):t=Wv(t);for(var e=this._groups,r=e.length,n=[],s=[],i=0;i<r;++i)for(var o=e[i],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(n.push(t.call(l,l.__data__,c,o)),s.push(l));return new Lt(n,s)}function Hv(t){return function(){return this.matches(t)}}function Vv(t){return function(e){return e.matches(t)}}var l2=Array.prototype.find;function c2(t){return function(){return l2.call(this.children,t)}}function u2(){return this.firstElementChild}function d2(t){return this.select(t==null?u2:c2(typeof t=="function"?t:Vv(t)))}var h2=Array.prototype.filter;function f2(){return Array.from(this.children)}function g2(t){return function(){return h2.call(this.children,t)}}function p2(t){return this.selectAll(t==null?f2:g2(typeof t=="function"?t:Vv(t)))}function m2(t){typeof t!="function"&&(t=Hv(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var i=e[s],o=i.length,a=n[s]=[],l,c=0;c<o;++c)(l=i[c])&&t.call(l,l.__data__,c,i)&&a.push(l);return new Lt(n,this._parents)}function Uv(t){return new Array(t.length)}function y2(){return new Lt(this._enter||this._groups.map(Uv),this._parents)}function xc(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}xc.prototype={constructor:xc,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function x2(t){return function(){return t}}function v2(t,e,r,n,s,i){for(var o=0,a,l=e.length,c=i.length;o<c;++o)(a=e[o])?(a.__data__=i[o],n[o]=a):r[o]=new xc(t,i[o]);for(;o<l;++o)(a=e[o])&&(s[o]=a)}function w2(t,e,r,n,s,i,o){var a,l,c=new Map,u=e.length,d=i.length,h=new Array(u),g;for(a=0;a<u;++a)(l=e[a])&&(h[a]=g=o.call(l,l.__data__,a,e)+"",c.has(g)?s[a]=l:c.set(g,l));for(a=0;a<d;++a)g=o.call(t,i[a],a,i)+"",(l=c.get(g))?(n[a]=l,l.__data__=i[a],c.delete(g)):r[a]=new xc(t,i[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(h[a])===l&&(s[a]=l)}function b2(t){return t.__data__}function _2(t,e){if(!arguments.length)return Array.from(this,b2);var r=e?w2:v2,n=this._parents,s=this._groups;typeof t!="function"&&(t=x2(t));for(var i=s.length,o=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=n[c],d=s[c],h=d.length,g=S2(t.call(u,u&&u.__data__,c,n)),p=g.length,y=a[c]=new Array(p),v=o[c]=new Array(p),m=l[c]=new Array(h);r(u,d,y,v,m,g,e);for(var w=0,x=0,_,b;w<p;++w)if(_=y[w]){for(w>=x&&(x=w+1);!(b=v[x])&&++x<p;);_._next=b||null}}return o=new Lt(o,n),o._enter=a,o._exit=l,o}function S2(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function C2(){return new Lt(this._exit||this._groups.map(Uv),this._parents)}function k2(t,e,r){var n=this.enter(),s=this,i=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),r==null?i.remove():r(i),n&&s?n.merge(s).order():s}function E2(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,s=r.length,i=n.length,o=Math.min(s,i),a=new Array(s),l=0;l<o;++l)for(var c=r[l],u=n[l],d=c.length,h=a[l]=new Array(d),g,p=0;p<d;++p)(g=c[p]||u[p])&&(h[p]=g);for(;l<s;++l)a[l]=r[l];return new Lt(a,this._parents)}function T2(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],s=n.length-1,i=n[s],o;--s>=0;)(o=n[s])&&(i&&o.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(o,i),i=o);return this}function j2(t){t||(t=N2);function e(d,h){return d&&h?t(d.__data__,h.__data__):!d-!h}for(var r=this._groups,n=r.length,s=new Array(n),i=0;i<n;++i){for(var o=r[i],a=o.length,l=s[i]=new Array(a),c,u=0;u<a;++u)(c=o[u])&&(l[u]=c);l.sort(e)}return new Lt(s,this._parents).order()}function N2(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function O2(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function P2(){return Array.from(this)}function M2(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],s=0,i=n.length;s<i;++s){var o=n[s];if(o)return o}return null}function D2(){let t=0;for(const e of this)++t;return t}function A2(){return!this.node()}function F2(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var s=e[r],i=0,o=s.length,a;i<o;++i)(a=s[i])&&t.call(a,a.__data__,i,s);return this}function L2(t){return function(){this.removeAttribute(t)}}function R2(t){return function(){this.removeAttributeNS(t.space,t.local)}}function I2(t,e){return function(){this.setAttribute(t,e)}}function $2(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function z2(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function B2(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function W2(t,e){var r=ou(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?R2:L2:typeof e=="function"?r.local?B2:z2:r.local?$2:I2)(r,e))}function Xv(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function H2(t){return function(){this.style.removeProperty(t)}}function V2(t,e,r){return function(){this.style.setProperty(t,e,r)}}function U2(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function X2(t,e,r){return arguments.length>1?this.each((e==null?H2:typeof e=="function"?U2:V2)(t,e,r??"")):xi(this.node(),t)}function xi(t,e){return t.style.getPropertyValue(e)||Xv(t).getComputedStyle(t,null).getPropertyValue(e)}function Y2(t){return function(){delete this[t]}}function G2(t,e){return function(){this[t]=e}}function q2(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function K2(t,e){return arguments.length>1?this.each((e==null?Y2:typeof e=="function"?q2:G2)(t,e)):this.node()[t]}function Yv(t){return t.trim().split(/^|\s+/)}function dg(t){return t.classList||new Gv(t)}function Gv(t){this._node=t,this._names=Yv(t.getAttribute("class")||"")}Gv.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function qv(t,e){for(var r=dg(t),n=-1,s=e.length;++n<s;)r.add(e[n])}function Kv(t,e){for(var r=dg(t),n=-1,s=e.length;++n<s;)r.remove(e[n])}function Q2(t){return function(){qv(this,t)}}function J2(t){return function(){Kv(this,t)}}function Z2(t,e){return function(){(e.apply(this,arguments)?qv:Kv)(this,t)}}function eE(t,e){var r=Yv(t+"");if(arguments.length<2){for(var n=dg(this.node()),s=-1,i=r.length;++s<i;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof e=="function"?Z2:e?Q2:J2)(r,e))}function tE(){this.textContent=""}function rE(t){return function(){this.textContent=t}}function nE(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function sE(t){return arguments.length?this.each(t==null?tE:(typeof t=="function"?nE:rE)(t)):this.node().textContent}function iE(){this.innerHTML=""}function oE(t){return function(){this.innerHTML=t}}function aE(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function lE(t){return arguments.length?this.each(t==null?iE:(typeof t=="function"?aE:oE)(t)):this.node().innerHTML}function cE(){this.nextSibling&&this.parentNode.appendChild(this)}function uE(){return this.each(cE)}function dE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hE(){return this.each(dE)}function fE(t){var e=typeof t=="function"?t:Bv(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function gE(){return null}function pE(t,e){var r=typeof t=="function"?t:Bv(t),n=e==null?gE:typeof e=="function"?e:ug(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function mE(){var t=this.parentNode;t&&t.removeChild(this)}function yE(){return this.each(mE)}function xE(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vE(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wE(t){return this.select(t?vE:xE)}function bE(t){return arguments.length?this.property("__data__",t):this.node().__data__}function _E(t){return function(e){t.call(this,e,this.__data__)}}function SE(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function CE(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,s=e.length,i;r<s;++r)i=e[r],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++n]=i;++n?e.length=n:delete this.__on}}}function kE(t,e,r){return function(){var n=this.__on,s,i=_E(e);if(n){for(var o=0,a=n.length;o<a;++o)if((s=n[o]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=r),s.value=e;return}}this.addEventListener(t.type,i,r),s={type:t.type,name:t.name,value:e,listener:i,options:r},n?n.push(s):this.__on=[s]}}function EE(t,e,r){var n=SE(t+""),s,i=n.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(s=0,u=a[l];s<i;++s)if((o=n[s]).type===u.type&&o.name===u.name)return u.value}return}for(a=e?kE:CE,s=0;s<i;++s)this.each(a(n[s],e,r));return this}function Qv(t,e,r){var n=Xv(t),s=n.CustomEvent;typeof s=="function"?s=new s(e,r):(s=n.document.createEvent("Event"),r?(s.initEvent(e,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function TE(t,e){return function(){return Qv(this,t,e)}}function jE(t,e){return function(){return Qv(this,t,e.apply(this,arguments))}}function NE(t,e){return this.each((typeof e=="function"?jE:TE)(t,e))}function*OE(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],s=0,i=n.length,o;s<i;++s)(o=n[s])&&(yield o)}var Jv=[null];function Lt(t,e){this._groups=t,this._parents=e}function fa(){return new Lt([[document.documentElement]],Jv)}function PE(){return this}Lt.prototype=fa.prototype={constructor:Lt,select:n2,selectAll:a2,selectChild:d2,selectChildren:p2,filter:m2,data:_2,enter:y2,exit:C2,join:k2,merge:E2,selection:PE,order:T2,sort:j2,call:O2,nodes:P2,node:M2,size:D2,empty:A2,each:F2,attr:W2,style:X2,property:K2,classed:eE,text:sE,html:lE,raise:uE,lower:hE,append:fE,insert:pE,remove:yE,clone:wE,datum:bE,on:EE,dispatch:NE,[Symbol.iterator]:OE};function Pt(t){return typeof t=="string"?new Lt([[document.querySelector(t)]],[document.documentElement]):new Lt([[t]],Jv)}function ME(t){let e;for(;e=t.sourceEvent;)t=e;return t}function rr(t,e){if(t=ME(t),e===void 0&&(e=t.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}const DE={passive:!1},Xo={capture:!0,passive:!1};function hd(t){t.stopImmediatePropagation()}function ai(t){t.preventDefault(),t.stopImmediatePropagation()}function Zv(t){var e=t.document.documentElement,r=Pt(t).on("dragstart.drag",ai,Xo);"onselectstart"in e?r.on("selectstart.drag",ai,Xo):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ew(t,e){var r=t.document.documentElement,n=Pt(t).on("dragstart.drag",null);e&&(n.on("click.drag",ai,Xo),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Xa=t=>()=>t;function Lh(t,{sourceEvent:e,subject:r,target:n,identifier:s,active:i,x:o,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}Lh.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function AE(t){return!t.ctrlKey&&!t.button}function FE(){return this.parentNode}function LE(t,e){return e??{x:t.x,y:t.y}}function RE(){return navigator.maxTouchPoints||"ontouchstart"in this}function tw(){var t=AE,e=FE,r=LE,n=RE,s={},i=iu("start","drag","end"),o=0,a,l,c,u,d=0;function h(_){_.on("mousedown.drag",g).filter(n).on("touchstart.drag",v).on("touchmove.drag",m,DE).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(_,b){if(!(u||!t.call(this,_,b))){var C=x(this,e.call(this,_,b),_,b,"mouse");C&&(Pt(_.view).on("mousemove.drag",p,Xo).on("mouseup.drag",y,Xo),Zv(_.view),hd(_),c=!1,a=_.clientX,l=_.clientY,C("start",_))}}function p(_){if(ai(_),!c){var b=_.clientX-a,C=_.clientY-l;c=b*b+C*C>d}s.mouse("drag",_)}function y(_){Pt(_.view).on("mousemove.drag mouseup.drag",null),ew(_.view,c),ai(_),s.mouse("end",_)}function v(_,b){if(t.call(this,_,b)){var C=_.changedTouches,k=e.call(this,_,b),S=C.length,P,O;for(P=0;P<S;++P)(O=x(this,k,_,b,C[P].identifier,C[P]))&&(hd(_),O("start",_,C[P]))}}function m(_){var b=_.changedTouches,C=b.length,k,S;for(k=0;k<C;++k)(S=s[b[k].identifier])&&(ai(_),S("drag",_,b[k]))}function w(_){var b=_.changedTouches,C=b.length,k,S;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),k=0;k<C;++k)(S=s[b[k].identifier])&&(hd(_),S("end",_,b[k]))}function x(_,b,C,k,S,P){var O=i.copy(),F=rr(P||C,b),A,L,E;if((E=r.call(_,new Lh("beforestart",{sourceEvent:C,target:h,identifier:S,active:o,x:F[0],y:F[1],dx:0,dy:0,dispatch:O}),k))!=null)return A=E.x-F[0]||0,L=E.y-F[1]||0,function M(N,I,j){var D=F,z;switch(N){case"start":s[S]=M,z=o++;break;case"end":delete s[S],--o;case"drag":F=rr(j||I,b),z=o;break}O.call(N,_,new Lh(N,{sourceEvent:I,subject:E,target:h,identifier:S,active:z,x:F[0]+A,y:F[1]+L,dx:F[0]-D[0],dy:F[1]-D[1],dispatch:O}),k)}}return h.filter=function(_){return arguments.length?(t=typeof _=="function"?_:Xa(!!_),h):t},h.container=function(_){return arguments.length?(e=typeof _=="function"?_:Xa(_),h):e},h.subject=function(_){return arguments.length?(r=typeof _=="function"?_:Xa(_),h):r},h.touchable=function(_){return arguments.length?(n=typeof _=="function"?_:Xa(!!_),h):n},h.on=function(){var _=i.on.apply(i,arguments);return _===i?h:_},h.clickDistance=function(_){return arguments.length?(d=(_=+_)*_,h):Math.sqrt(d)},h}function hg(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function rw(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function ga(){}var Yo=.7,vc=1/Yo,li="\\s*([+-]?\\d+)\\s*",Go="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Or="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",IE=/^#([0-9a-f]{3,8})$/,$E=new RegExp(`^rgb\\(${li},${li},${li}\\)$`),zE=new RegExp(`^rgb\\(${Or},${Or},${Or}\\)$`),BE=new RegExp(`^rgba\\(${li},${li},${li},${Go}\\)$`),WE=new RegExp(`^rgba\\(${Or},${Or},${Or},${Go}\\)$`),HE=new RegExp(`^hsl\\(${Go},${Or},${Or}\\)$`),VE=new RegExp(`^hsla\\(${Go},${Or},${Or},${Go}\\)$`),mm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hg(ga,ys,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ym,formatHex:ym,formatHex8:UE,formatHsl:XE,formatRgb:xm,toString:xm});function ym(){return this.rgb().formatHex()}function UE(){return this.rgb().formatHex8()}function XE(){return nw(this).formatHsl()}function xm(){return this.rgb().formatRgb()}function ys(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=IE.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?vm(e):r===3?new xt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Ya(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Ya(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=$E.exec(t))?new xt(e[1],e[2],e[3],1):(e=zE.exec(t))?new xt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=BE.exec(t))?Ya(e[1],e[2],e[3],e[4]):(e=WE.exec(t))?Ya(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=HE.exec(t))?_m(e[1],e[2]/100,e[3]/100,1):(e=VE.exec(t))?_m(e[1],e[2]/100,e[3]/100,e[4]):mm.hasOwnProperty(t)?vm(mm[t]):t==="transparent"?new xt(NaN,NaN,NaN,0):null}function vm(t){return new xt(t>>16&255,t>>8&255,t&255,1)}function Ya(t,e,r,n){return n<=0&&(t=e=r=NaN),new xt(t,e,r,n)}function YE(t){return t instanceof ga||(t=ys(t)),t?(t=t.rgb(),new xt(t.r,t.g,t.b,t.opacity)):new xt}function Rh(t,e,r,n){return arguments.length===1?YE(t):new xt(t,e,r,n??1)}function xt(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}hg(xt,Rh,rw(ga,{brighter(t){return t=t==null?vc:Math.pow(vc,t),new xt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Yo:Math.pow(Yo,t),new xt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new xt(os(this.r),os(this.g),os(this.b),wc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wm,formatHex:wm,formatHex8:GE,formatRgb:bm,toString:bm}));function wm(){return`#${Zn(this.r)}${Zn(this.g)}${Zn(this.b)}`}function GE(){return`#${Zn(this.r)}${Zn(this.g)}${Zn(this.b)}${Zn((isNaN(this.opacity)?1:this.opacity)*255)}`}function bm(){const t=wc(this.opacity);return`${t===1?"rgb(":"rgba("}${os(this.r)}, ${os(this.g)}, ${os(this.b)}${t===1?")":`, ${t})`}`}function wc(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function os(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Zn(t){return t=os(t),(t<16?"0":"")+t.toString(16)}function _m(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new ir(t,e,r,n)}function nw(t){if(t instanceof ir)return new ir(t.h,t.s,t.l,t.opacity);if(t instanceof ga||(t=ys(t)),!t)return new ir;if(t instanceof ir)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,s=Math.min(e,r,n),i=Math.max(e,r,n),o=NaN,a=i-s,l=(i+s)/2;return a?(e===i?o=(r-n)/a+(r<n)*6:r===i?o=(n-e)/a+2:o=(e-r)/a+4,a/=l<.5?i+s:2-i-s,o*=60):a=l>0&&l<1?0:o,new ir(o,a,l,t.opacity)}function qE(t,e,r,n){return arguments.length===1?nw(t):new ir(t,e,r,n??1)}function ir(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}hg(ir,qE,rw(ga,{brighter(t){return t=t==null?vc:Math.pow(vc,t),new ir(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Yo:Math.pow(Yo,t),new ir(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,s=2*r-n;return new xt(fd(t>=240?t-240:t+120,s,n),fd(t,s,n),fd(t<120?t+240:t-120,s,n),this.opacity)},clamp(){return new ir(Sm(this.h),Ga(this.s),Ga(this.l),wc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=wc(this.opacity);return`${t===1?"hsl(":"hsla("}${Sm(this.h)}, ${Ga(this.s)*100}%, ${Ga(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Sm(t){return t=(t||0)%360,t<0?t+360:t}function Ga(t){return Math.max(0,Math.min(1,t||0))}function fd(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const fg=t=>()=>t;function KE(t,e){return function(r){return t+r*e}}function QE(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function JE(t){return(t=+t)==1?sw:function(e,r){return r-e?QE(e,r,t):fg(isNaN(e)?r:e)}}function sw(t,e){var r=e-t;return r?KE(t,r):fg(isNaN(t)?e:t)}const bc=function t(e){var r=JE(e);function n(s,i){var o=r((s=Rh(s)).r,(i=Rh(i)).r),a=r(s.g,i.g),l=r(s.b,i.b),c=sw(s.opacity,i.opacity);return function(u){return s.r=o(u),s.g=a(u),s.b=l(u),s.opacity=c(u),s+""}}return n.gamma=t,n}(1);function ZE(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),s;return function(i){for(s=0;s<r;++s)n[s]=t[s]*(1-i)+e[s]*i;return n}}function eT(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function tT(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,s=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)s[o]=_o(t[o],e[o]);for(;o<r;++o)i[o]=e[o];return function(a){for(o=0;o<n;++o)i[o]=s[o](a);return i}}function rT(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function _r(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function nT(t,e){var r={},n={},s;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in t?r[s]=_o(t[s],e[s]):n[s]=e[s];return function(i){for(s in r)n[s]=r[s](i);return n}}var Ih=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gd=new RegExp(Ih.source,"g");function sT(t){return function(){return t}}function iT(t){return function(e){return t(e)+""}}function iw(t,e){var r=Ih.lastIndex=gd.lastIndex=0,n,s,i,o=-1,a=[],l=[];for(t=t+"",e=e+"";(n=Ih.exec(t))&&(s=gd.exec(e));)(i=s.index)>r&&(i=e.slice(r,i),a[o]?a[o]+=i:a[++o]=i),(n=n[0])===(s=s[0])?a[o]?a[o]+=s:a[++o]=s:(a[++o]=null,l.push({i:o,x:_r(n,s)})),r=gd.lastIndex;return r<e.length&&(i=e.slice(r),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?iT(l[0].x):sT(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}function _o(t,e){var r=typeof e,n;return e==null||r==="boolean"?fg(e):(r==="number"?_r:r==="string"?(n=ys(e))?(e=n,bc):iw:e instanceof ys?bc:e instanceof Date?rT:eT(e)?ZE:Array.isArray(e)?tT:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?nT:_r)(t,e)}var Cm=180/Math.PI,$h={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ow(t,e,r,n,s,i){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*r+e*n)&&(r-=t*l,n-=e*l),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,l/=a),t*n<e*r&&(t=-t,e=-e,l=-l,o=-o),{translateX:s,translateY:i,rotate:Math.atan2(e,t)*Cm,skewX:Math.atan(l)*Cm,scaleX:o,scaleY:a}}var qa;function oT(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?$h:ow(e.a,e.b,e.c,e.d,e.e,e.f)}function aT(t){return t==null||(qa||(qa=document.createElementNS("http://www.w3.org/2000/svg","g")),qa.setAttribute("transform",t),!(t=qa.transform.baseVal.consolidate()))?$h:(t=t.matrix,ow(t.a,t.b,t.c,t.d,t.e,t.f))}function aw(t,e,r,n){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,g,p){if(c!==d||u!==h){var y=g.push("translate(",null,e,null,r);p.push({i:y-4,x:_r(c,d)},{i:y-2,x:_r(u,h)})}else(d||h)&&g.push("translate("+d+e+h+r)}function o(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,n)-2,x:_r(c,u)})):u&&d.push(s(d)+"rotate("+u+n)}function a(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,n)-2,x:_r(c,u)}):u&&d.push(s(d)+"skewX("+u+n)}function l(c,u,d,h,g,p){if(c!==d||u!==h){var y=g.push(s(g)+"scale(",null,",",null,")");p.push({i:y-4,x:_r(c,d)},{i:y-2,x:_r(u,h)})}else(d!==1||h!==1)&&g.push(s(g)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=t(c),u=t(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),o(c.rotate,u.rotate,d,h),a(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(g){for(var p=-1,y=h.length,v;++p<y;)d[(v=h[p]).i]=v.x(g);return d.join("")}}}var lT=aw(oT,"px, ","px)","deg)"),cT=aw(aT,", ",")",")"),uT=1e-12;function km(t){return((t=Math.exp(t))+1/t)/2}function dT(t){return((t=Math.exp(t))-1/t)/2}function hT(t){return((t=Math.exp(2*t))-1)/(t+1)}const $l=function t(e,r,n){function s(i,o){var a=i[0],l=i[1],c=i[2],u=o[0],d=o[1],h=o[2],g=u-a,p=d-l,y=g*g+p*p,v,m;if(y<uT)m=Math.log(h/c)/e,v=function(k){return[a+k*g,l+k*p,c*Math.exp(e*k*m)]};else{var w=Math.sqrt(y),x=(h*h-c*c+n*y)/(2*c*r*w),_=(h*h-c*c-n*y)/(2*h*r*w),b=Math.log(Math.sqrt(x*x+1)-x),C=Math.log(Math.sqrt(_*_+1)-_);m=(C-b)/e,v=function(k){var S=k*m,P=km(b),O=c/(r*w)*(P*hT(e*S+b)-dT(b));return[a+O*g,l+O*p,c*P/km(e*S+b)]}}return v.duration=m*1e3*e/Math.SQRT2,v}return s.rho=function(i){var o=Math.max(.001,+i),a=o*o,l=a*a;return t(o,a,l)},s}(Math.SQRT2,2,4);var vi=0,ao=0,Ji=0,lw=1e3,_c,lo,Sc=0,xs=0,au=0,qo=typeof performance=="object"&&performance.now?performance:Date,cw=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function gg(){return xs||(cw(fT),xs=qo.now()+au)}function fT(){xs=0}function Cc(){this._call=this._time=this._next=null}Cc.prototype=uw.prototype={constructor:Cc,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?gg():+r)+(e==null?0:+e),!this._next&&lo!==this&&(lo?lo._next=this:_c=this,lo=this),this._call=t,this._time=r,zh()},stop:function(){this._call&&(this._call=null,this._time=1/0,zh())}};function uw(t,e,r){var n=new Cc;return n.restart(t,e,r),n}function gT(){gg(),++vi;for(var t=_c,e;t;)(e=xs-t._time)>=0&&t._call.call(void 0,e),t=t._next;--vi}function Em(){xs=(Sc=qo.now())+au,vi=ao=0;try{gT()}finally{vi=0,mT(),xs=0}}function pT(){var t=qo.now(),e=t-Sc;e>lw&&(au-=e,Sc=t)}function mT(){for(var t,e=_c,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:_c=r);lo=t,zh(n)}function zh(t){if(!vi){ao&&(ao=clearTimeout(ao));var e=t-xs;e>24?(t<1/0&&(ao=setTimeout(Em,t-qo.now()-au)),Ji&&(Ji=clearInterval(Ji))):(Ji||(Sc=qo.now(),Ji=setInterval(pT,lw)),vi=1,cw(Em))}}function Tm(t,e,r){var n=new Cc;return e=e==null?0:+e,n.restart(s=>{n.stop(),t(s+e)},e,r),n}var yT=iu("start","end","cancel","interrupt"),xT=[],dw=0,jm=1,Bh=2,zl=3,Nm=4,Wh=5,Bl=6;function lu(t,e,r,n,s,i){var o=t.__transition;if(!o)t.__transition={};else if(r in o)return;vT(t,r,{name:e,index:n,group:s,on:yT,tween:xT,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:dw})}function pg(t,e){var r=mr(t,e);if(r.state>dw)throw new Error("too late; already scheduled");return r}function Rr(t,e){var r=mr(t,e);if(r.state>zl)throw new Error("too late; already running");return r}function mr(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function vT(t,e,r){var n=t.__transition,s;n[e]=r,r.timer=uw(i,0,r.time);function i(c){r.state=jm,r.timer.restart(o,r.delay,r.time),r.delay<=c&&o(c-r.delay)}function o(c){var u,d,h,g;if(r.state!==jm)return l();for(u in n)if(g=n[u],g.name===r.name){if(g.state===zl)return Tm(o);g.state===Nm?(g.state=Bl,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete n[u]):+u<e&&(g.state=Bl,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete n[u])}if(Tm(function(){r.state===zl&&(r.state=Nm,r.timer.restart(a,r.delay,r.time),a(c))}),r.state=Bh,r.on.call("start",t,t.__data__,r.index,r.group),r.state===Bh){for(r.state=zl,s=new Array(h=r.tween.length),u=0,d=-1;u<h;++u)(g=r.tween[u].value.call(t,t.__data__,r.index,r.group))&&(s[++d]=g);s.length=d+1}}function a(c){for(var u=c<r.duration?r.ease.call(null,c/r.duration):(r.timer.restart(l),r.state=Wh,1),d=-1,h=s.length;++d<h;)s[d].call(t,u);r.state===Wh&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){r.state=Bl,r.timer.stop(),delete n[e];for(var c in n)return;delete t.__transition}}function Wl(t,e){var r=t.__transition,n,s,i=!0,o;if(r){e=e==null?null:e+"";for(o in r){if((n=r[o]).name!==e){i=!1;continue}s=n.state>Bh&&n.state<Wh,n.state=Bl,n.timer.stop(),n.on.call(s?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[o]}i&&delete t.__transition}}function wT(t){return this.each(function(){Wl(this,t)})}function bT(t,e){var r,n;return function(){var s=Rr(this,t),i=s.tween;if(i!==r){n=r=i;for(var o=0,a=n.length;o<a;++o)if(n[o].name===e){n=n.slice(),n.splice(o,1);break}}s.tween=n}}function _T(t,e,r){var n,s;if(typeof r!="function")throw new Error;return function(){var i=Rr(this,t),o=i.tween;if(o!==n){s=(n=o).slice();for(var a={name:e,value:r},l=0,c=s.length;l<c;++l)if(s[l].name===e){s[l]=a;break}l===c&&s.push(a)}i.tween=s}}function ST(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=mr(this.node(),r).tween,s=0,i=n.length,o;s<i;++s)if((o=n[s]).name===t)return o.value;return null}return this.each((e==null?bT:_T)(r,t,e))}function mg(t,e,r){var n=t._id;return t.each(function(){var s=Rr(this,n);(s.value||(s.value={}))[e]=r.apply(this,arguments)}),function(s){return mr(s,n).value[e]}}function hw(t,e){var r;return(typeof e=="number"?_r:e instanceof ys?bc:(r=ys(e))?(e=r,bc):iw)(t,e)}function CT(t){return function(){this.removeAttribute(t)}}function kT(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ET(t,e,r){var n,s=r+"",i;return function(){var o=this.getAttribute(t);return o===s?null:o===n?i:i=e(n=o,r)}}function TT(t,e,r){var n,s=r+"",i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===n?i:i=e(n=o,r)}}function jT(t,e,r){var n,s,i;return function(){var o,a=r(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===n&&l===s?i:(s=l,i=e(n=o,a)))}}function NT(t,e,r){var n,s,i;return function(){var o,a=r(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===n&&l===s?i:(s=l,i=e(n=o,a)))}}function OT(t,e){var r=ou(t),n=r==="transform"?cT:hw;return this.attrTween(t,typeof e=="function"?(r.local?NT:jT)(r,n,mg(this,"attr."+t,e)):e==null?(r.local?kT:CT)(r):(r.local?TT:ET)(r,n,e))}function PT(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function MT(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function DT(t,e){var r,n;function s(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&MT(t,i)),r}return s._value=e,s}function AT(t,e){var r,n;function s(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&PT(t,i)),r}return s._value=e,s}function FT(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=ou(t);return this.tween(r,(n.local?DT:AT)(n,e))}function LT(t,e){return function(){pg(this,t).delay=+e.apply(this,arguments)}}function RT(t,e){return e=+e,function(){pg(this,t).delay=e}}function IT(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?LT:RT)(e,t)):mr(this.node(),e).delay}function $T(t,e){return function(){Rr(this,t).duration=+e.apply(this,arguments)}}function zT(t,e){return e=+e,function(){Rr(this,t).duration=e}}function BT(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?$T:zT)(e,t)):mr(this.node(),e).duration}function WT(t,e){if(typeof e!="function")throw new Error;return function(){Rr(this,t).ease=e}}function HT(t){var e=this._id;return arguments.length?this.each(WT(e,t)):mr(this.node(),e).ease}function VT(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;Rr(this,t).ease=r}}function UT(t){if(typeof t!="function")throw new Error;return this.each(VT(this._id,t))}function XT(t){typeof t!="function"&&(t=Hv(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var i=e[s],o=i.length,a=n[s]=[],l,c=0;c<o;++c)(l=i[c])&&t.call(l,l.__data__,c,i)&&a.push(l);return new nn(n,this._parents,this._name,this._id)}function YT(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,s=r.length,i=Math.min(n,s),o=new Array(n),a=0;a<i;++a)for(var l=e[a],c=r[a],u=l.length,d=o[a]=new Array(u),h,g=0;g<u;++g)(h=l[g]||c[g])&&(d[g]=h);for(;a<n;++a)o[a]=e[a];return new nn(o,this._parents,this._name,this._id)}function GT(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function qT(t,e,r){var n,s,i=GT(e)?pg:Rr;return function(){var o=i(this,t),a=o.on;a!==n&&(s=(n=a).copy()).on(e,r),o.on=s}}function KT(t,e){var r=this._id;return arguments.length<2?mr(this.node(),r).on.on(t):this.each(qT(r,t,e))}function QT(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function JT(){return this.on("end.remove",QT(this._id))}function ZT(t){var e=this._name,r=this._id;typeof t!="function"&&(t=ug(t));for(var n=this._groups,s=n.length,i=new Array(s),o=0;o<s;++o)for(var a=n[o],l=a.length,c=i[o]=new Array(l),u,d,h=0;h<l;++h)(u=a[h])&&(d=t.call(u,u.__data__,h,a))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,lu(c[h],e,r,h,c,mr(u,r)));return new nn(i,this._parents,e,r)}function ej(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Wv(t));for(var n=this._groups,s=n.length,i=[],o=[],a=0;a<s;++a)for(var l=n[a],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=t.call(u,u.__data__,d,l),g,p=mr(u,r),y=0,v=h.length;y<v;++y)(g=h[y])&&lu(g,e,r,y,h,p);i.push(h),o.push(u)}return new nn(i,o,e,r)}var tj=fa.prototype.constructor;function rj(){return new tj(this._groups,this._parents)}function nj(t,e){var r,n,s;return function(){var i=xi(this,t),o=(this.style.removeProperty(t),xi(this,t));return i===o?null:i===r&&o===n?s:s=e(r=i,n=o)}}function fw(t){return function(){this.style.removeProperty(t)}}function sj(t,e,r){var n,s=r+"",i;return function(){var o=xi(this,t);return o===s?null:o===n?i:i=e(n=o,r)}}function ij(t,e,r){var n,s,i;return function(){var o=xi(this,t),a=r(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),xi(this,t))),o===l?null:o===n&&l===s?i:(s=l,i=e(n=o,a))}}function oj(t,e){var r,n,s,i="style."+e,o="end."+i,a;return function(){var l=Rr(this,t),c=l.on,u=l.value[i]==null?a||(a=fw(e)):void 0;(c!==r||s!==u)&&(n=(r=c).copy()).on(o,s=u),l.on=n}}function aj(t,e,r){var n=(t+="")=="transform"?lT:hw;return e==null?this.styleTween(t,nj(t,n)).on("end.style."+t,fw(t)):typeof e=="function"?this.styleTween(t,ij(t,n,mg(this,"style."+t,e))).each(oj(this._id,t)):this.styleTween(t,sj(t,n,e),r).on("end.style."+t,null)}function lj(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function cj(t,e,r){var n,s;function i(){var o=e.apply(this,arguments);return o!==s&&(n=(s=o)&&lj(t,o,r)),n}return i._value=e,i}function uj(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,cj(t,e,r??""))}function dj(t){return function(){this.textContent=t}}function hj(t){return function(){var e=t(this);this.textContent=e??""}}function fj(t){return this.tween("text",typeof t=="function"?hj(mg(this,"text",t)):dj(t==null?"":t+""))}function gj(t){return function(e){this.textContent=t.call(this,e)}}function pj(t){var e,r;function n(){var s=t.apply(this,arguments);return s!==r&&(e=(r=s)&&gj(s)),e}return n._value=t,n}function mj(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,pj(t))}function yj(){for(var t=this._name,e=this._id,r=gw(),n=this._groups,s=n.length,i=0;i<s;++i)for(var o=n[i],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var u=mr(l,e);lu(l,t,r,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new nn(n,this._parents,t,r)}function xj(){var t,e,r=this,n=r._id,s=r.size();return new Promise(function(i,o){var a={value:o},l={value:function(){--s===0&&i()}};r.each(function(){var c=Rr(this,n),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),s===0&&i()})}var vj=0;function nn(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function gw(){return++vj}var zr=fa.prototype;nn.prototype={constructor:nn,select:ZT,selectAll:ej,selectChild:zr.selectChild,selectChildren:zr.selectChildren,filter:XT,merge:YT,selection:rj,transition:yj,call:zr.call,nodes:zr.nodes,node:zr.node,size:zr.size,empty:zr.empty,each:zr.each,on:KT,attr:OT,attrTween:FT,style:aj,styleTween:uj,text:fj,textTween:mj,remove:JT,tween:ST,delay:IT,duration:BT,ease:HT,easeVarying:UT,end:xj,[Symbol.iterator]:zr[Symbol.iterator]};function wj(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var bj={time:null,delay:0,duration:250,ease:wj};function _j(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Sj(t){var e,r;t instanceof nn?(e=t._id,t=t._name):(e=gw(),(r=bj).time=gg(),t=t==null?null:t+"");for(var n=this._groups,s=n.length,i=0;i<s;++i)for(var o=n[i],a=o.length,l,c=0;c<a;++c)(l=o[c])&&lu(l,t,e,c,o,r||_j(l,e));return new nn(n,this._parents,t,e)}fa.prototype.interrupt=wT;fa.prototype.transition=Sj;const Ka=t=>()=>t;function Cj(t,{sourceEvent:e,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function Yr(t,e,r){this.k=t,this.x=e,this.y=r}Yr.prototype={constructor:Yr,scale:function(t){return t===1?this:new Yr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Yr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var cu=new Yr(1,0,0);pw.prototype=Yr.prototype;function pw(t){for(;!t.__zoom;)if(!(t=t.parentNode))return cu;return t.__zoom}function pd(t){t.stopImmediatePropagation()}function Zi(t){t.preventDefault(),t.stopImmediatePropagation()}function kj(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Ej(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Om(){return this.__zoom||cu}function Tj(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function jj(){return navigator.maxTouchPoints||"ontouchstart"in this}function Nj(t,e,r){var n=t.invertX(e[0][0])-r[0][0],s=t.invertX(e[1][0])-r[1][0],i=t.invertY(e[0][1])-r[0][1],o=t.invertY(e[1][1])-r[1][1];return t.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o))}function mw(){var t=kj,e=Ej,r=Nj,n=Tj,s=jj,i=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=$l,c=iu("start","zoom","end"),u,d,h,g=500,p=150,y=0,v=10;function m(E){E.property("__zoom",Om).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",O).filter(s).on("touchstart.zoom",F).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(E,M,N,I){var j=E.selection?E.selection():E;j.property("__zoom",Om),E!==j?b(E,M,N,I):j.interrupt().each(function(){C(this,arguments).event(I).start().zoom(null,typeof M=="function"?M.apply(this,arguments):M).end()})},m.scaleBy=function(E,M,N,I){m.scaleTo(E,function(){var j=this.__zoom.k,D=typeof M=="function"?M.apply(this,arguments):M;return j*D},N,I)},m.scaleTo=function(E,M,N,I){m.transform(E,function(){var j=e.apply(this,arguments),D=this.__zoom,z=N==null?_(j):typeof N=="function"?N.apply(this,arguments):N,H=D.invert(z),U=typeof M=="function"?M.apply(this,arguments):M;return r(x(w(D,U),z,H),j,o)},N,I)},m.translateBy=function(E,M,N,I){m.transform(E,function(){return r(this.__zoom.translate(typeof M=="function"?M.apply(this,arguments):M,typeof N=="function"?N.apply(this,arguments):N),e.apply(this,arguments),o)},null,I)},m.translateTo=function(E,M,N,I,j){m.transform(E,function(){var D=e.apply(this,arguments),z=this.__zoom,H=I==null?_(D):typeof I=="function"?I.apply(this,arguments):I;return r(cu.translate(H[0],H[1]).scale(z.k).translate(typeof M=="function"?-M.apply(this,arguments):-M,typeof N=="function"?-N.apply(this,arguments):-N),D,o)},I,j)};function w(E,M){return M=Math.max(i[0],Math.min(i[1],M)),M===E.k?E:new Yr(M,E.x,E.y)}function x(E,M,N){var I=M[0]-N[0]*E.k,j=M[1]-N[1]*E.k;return I===E.x&&j===E.y?E:new Yr(E.k,I,j)}function _(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function b(E,M,N,I){E.on("start.zoom",function(){C(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(I).end()}).tween("zoom",function(){var j=this,D=arguments,z=C(j,D).event(I),H=e.apply(j,D),U=N==null?_(H):typeof N=="function"?N.apply(j,D):N,G=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),X=j.__zoom,Q=typeof M=="function"?M.apply(j,D):M,B=l(X.invert(U).concat(G/X.k),Q.invert(U).concat(G/Q.k));return function(Y){if(Y===1)Y=Q;else{var K=B(Y),ne=G/K[2];Y=new Yr(ne,U[0]-K[0]*ne,U[1]-K[1]*ne)}z.zoom(null,Y)}})}function C(E,M,N){return!N&&E.__zooming||new k(E,M)}function k(E,M){this.that=E,this.args=M,this.active=0,this.sourceEvent=null,this.extent=e.apply(E,M),this.taps=0}k.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,M){return this.mouse&&E!=="mouse"&&(this.mouse[1]=M.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=M.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=M.invert(this.touch1[0])),this.that.__zoom=M,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var M=Pt(this.that).datum();c.call(E,this.that,new Cj(E,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:c}),M)}};function S(E,...M){if(!t.apply(this,arguments))return;var N=C(this,M).event(E),I=this.__zoom,j=Math.max(i[0],Math.min(i[1],I.k*Math.pow(2,n.apply(this,arguments)))),D=rr(E);if(N.wheel)(N.mouse[0][0]!==D[0]||N.mouse[0][1]!==D[1])&&(N.mouse[1]=I.invert(N.mouse[0]=D)),clearTimeout(N.wheel);else{if(I.k===j)return;N.mouse=[D,I.invert(D)],Wl(this),N.start()}Zi(E),N.wheel=setTimeout(z,p),N.zoom("mouse",r(x(w(I,j),N.mouse[0],N.mouse[1]),N.extent,o));function z(){N.wheel=null,N.end()}}function P(E,...M){if(h||!t.apply(this,arguments))return;var N=E.currentTarget,I=C(this,M,!0).event(E),j=Pt(E.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",G,!0),D=rr(E,N),z=E.clientX,H=E.clientY;Zv(E.view),pd(E),I.mouse=[D,this.__zoom.invert(D)],Wl(this),I.start();function U(X){if(Zi(X),!I.moved){var Q=X.clientX-z,B=X.clientY-H;I.moved=Q*Q+B*B>y}I.event(X).zoom("mouse",r(x(I.that.__zoom,I.mouse[0]=rr(X,N),I.mouse[1]),I.extent,o))}function G(X){j.on("mousemove.zoom mouseup.zoom",null),ew(X.view,I.moved),Zi(X),I.event(X).end()}}function O(E,...M){if(t.apply(this,arguments)){var N=this.__zoom,I=rr(E.changedTouches?E.changedTouches[0]:E,this),j=N.invert(I),D=N.k*(E.shiftKey?.5:2),z=r(x(w(N,D),I,j),e.apply(this,M),o);Zi(E),a>0?Pt(this).transition().duration(a).call(b,z,I,E):Pt(this).call(m.transform,z,I,E)}}function F(E,...M){if(t.apply(this,arguments)){var N=E.touches,I=N.length,j=C(this,M,E.changedTouches.length===I).event(E),D,z,H,U;for(pd(E),z=0;z<I;++z)H=N[z],U=rr(H,this),U=[U,this.__zoom.invert(U),H.identifier],j.touch0?!j.touch1&&j.touch0[2]!==U[2]&&(j.touch1=U,j.taps=0):(j.touch0=U,D=!0,j.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(j.taps<2&&(d=U[0],u=setTimeout(function(){u=null},g)),Wl(this),j.start())}}function A(E,...M){if(this.__zooming){var N=C(this,M).event(E),I=E.changedTouches,j=I.length,D,z,H,U;for(Zi(E),D=0;D<j;++D)z=I[D],H=rr(z,this),N.touch0&&N.touch0[2]===z.identifier?N.touch0[0]=H:N.touch1&&N.touch1[2]===z.identifier&&(N.touch1[0]=H);if(z=N.that.__zoom,N.touch1){var G=N.touch0[0],X=N.touch0[1],Q=N.touch1[0],B=N.touch1[1],Y=(Y=Q[0]-G[0])*Y+(Y=Q[1]-G[1])*Y,K=(K=B[0]-X[0])*K+(K=B[1]-X[1])*K;z=w(z,Math.sqrt(Y/K)),H=[(G[0]+Q[0])/2,(G[1]+Q[1])/2],U=[(X[0]+B[0])/2,(X[1]+B[1])/2]}else if(N.touch0)H=N.touch0[0],U=N.touch0[1];else return;N.zoom("touch",r(x(z,H,U),N.extent,o))}}function L(E,...M){if(this.__zooming){var N=C(this,M).event(E),I=E.changedTouches,j=I.length,D,z;for(pd(E),h&&clearTimeout(h),h=setTimeout(function(){h=null},g),D=0;D<j;++D)z=I[D],N.touch0&&N.touch0[2]===z.identifier?delete N.touch0:N.touch1&&N.touch1[2]===z.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(z=rr(z,this),Math.hypot(d[0]-z[0],d[1]-z[1])<v)){var H=Pt(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return m.wheelDelta=function(E){return arguments.length?(n=typeof E=="function"?E:Ka(+E),m):n},m.filter=function(E){return arguments.length?(t=typeof E=="function"?E:Ka(!!E),m):t},m.touchable=function(E){return arguments.length?(s=typeof E=="function"?E:Ka(!!E),m):s},m.extent=function(E){return arguments.length?(e=typeof E=="function"?E:Ka([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),m):e},m.scaleExtent=function(E){return arguments.length?(i[0]=+E[0],i[1]=+E[1],m):[i[0],i[1]]},m.translateExtent=function(E){return arguments.length?(o[0][0]=+E[0][0],o[1][0]=+E[1][0],o[0][1]=+E[0][1],o[1][1]=+E[1][1],m):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},m.constrain=function(E){return arguments.length?(r=E,m):r},m.duration=function(E){return arguments.length?(a=+E,m):a},m.interpolate=function(E){return arguments.length?(l=E,m):l},m.on=function(){var E=c.on.apply(c,arguments);return E===c?m:E},m.clickDistance=function(E){return arguments.length?(y=(E=+E)*E,m):Math.sqrt(y)},m.tapDistance=function(E){return arguments.length?(v=+E,m):v},m}const Dr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:r,targetHandle:n})=>`Couldn't create edge for ${t} handle id: "${t==="source"?r:n}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Ko=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],yw=["Enter"," ","Escape"],xw={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:r})=>`Moved selected node ${t}. New position, x: ${e}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var wi;(function(t){t.Strict="strict",t.Loose="loose"})(wi||(wi={}));var as;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(as||(as={}));var Qo;(function(t){t.Partial="partial",t.Full="full"})(Qo||(Qo={}));const vw={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var wn;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(wn||(wn={}));var Jo;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Jo||(Jo={}));var re;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(re||(re={}));const Pm={[re.Left]:re.Right,[re.Right]:re.Left,[re.Top]:re.Bottom,[re.Bottom]:re.Top};function ww(t){return t===null?null:t?"valid":"invalid"}const bw=t=>"id"in t&&"source"in t&&"target"in t,Oj=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),yg=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),pa=(t,e=[0,0])=>{const{width:r,height:n}=an(t),s=t.origin??e,i=r*s[0],o=n*s[1];return{x:t.position.x-i,y:t.position.y-o}},Pj=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const r=t.reduce((n,s)=>{const i=typeof s=="string";let o=!e.nodeLookup&&!i?s:void 0;e.nodeLookup&&(o=i?e.nodeLookup.get(s):yg(s)?s:e.nodeLookup.get(s.id));const a=o?kc(o,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return uu(n,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return du(r)},ma=(t,e={})=>{let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0},n=!1;return t.forEach(s=>{(e.filter===void 0||e.filter(s))&&(r=uu(r,kc(s)),n=!0)}),n?du(r):{x:0,y:0,width:0,height:0}},xg=(t,e,[r,n,s]=[0,0,1],i=!1,o=!1)=>{const a={...xa(e,[r,n,s]),width:e.width/s,height:e.height/s},l=[];for(const c of t.values()){const{measured:u,selectable:d=!0,hidden:h=!1}=c;if(o&&!d||h)continue;const g=u.width??c.width??c.initialWidth??null,p=u.height??c.height??c.initialHeight??null,y=Zo(a,_i(c)),v=(g??0)*(p??0),m=i&&y>0;(!c.internals.handleBounds||m||y>=v||c.dragging)&&l.push(c)}return l},Mj=(t,e)=>{const r=new Set;return t.forEach(n=>{r.add(n.id)}),e.filter(n=>r.has(n.source)||r.has(n.target))};function Dj(t,e){const r=new Map,n=e!=null&&e.nodes?new Set(e.nodes.map(s=>s.id)):null;return t.forEach(s=>{s.measured.width&&s.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!s.hidden)&&(!n||n.has(s.id))&&r.set(s.id,s)}),r}async function Aj({nodes:t,width:e,height:r,panZoom:n,minZoom:s,maxZoom:i},o){if(t.size===0)return Promise.resolve(!0);const a=Dj(t,o),l=ma(a),c=vg(l,e,r,(o==null?void 0:o.minZoom)??s,(o==null?void 0:o.maxZoom)??i,(o==null?void 0:o.padding)??.1);return await n.setViewport(c,{duration:o==null?void 0:o.duration,ease:o==null?void 0:o.ease,interpolate:o==null?void 0:o.interpolate}),Promise.resolve(!0)}function _w({nodeId:t,nextPosition:e,nodeLookup:r,nodeOrigin:n=[0,0],nodeExtent:s,onError:i}){const o=r.get(t),a=o.parentId?r.get(o.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},u=o.origin??n;let d=o.extent||s;if(o.extent==="parent"&&!o.expandParent)if(!a)i==null||i("005",Dr.error005());else{const g=a.measured.width,p=a.measured.height;g&&p&&(d=[[l,c],[l+g,c+p]])}else a&&Si(o.extent)&&(d=[[o.extent[0][0]+l,o.extent[0][1]+c],[o.extent[1][0]+l,o.extent[1][1]+c]]);const h=Si(d)?vs(e,d,o.measured):e;return(o.measured.width===void 0||o.measured.height===void 0)&&(i==null||i("015",Dr.error015())),{position:{x:h.x-l+(o.measured.width??0)*u[0],y:h.y-c+(o.measured.height??0)*u[1]},positionAbsolute:h}}async function Fj({nodesToRemove:t=[],edgesToRemove:e=[],nodes:r,edges:n,onBeforeDelete:s}){const i=new Set(t.map(h=>h.id)),o=[];for(const h of r){if(h.deletable===!1)continue;const g=i.has(h.id),p=!g&&h.parentId&&o.find(y=>y.id===h.parentId);(g||p)&&o.push(h)}const a=new Set(e.map(h=>h.id)),l=n.filter(h=>h.deletable!==!1),u=Mj(o,l);for(const h of l)a.has(h.id)&&!u.find(p=>p.id===h.id)&&u.push(h);if(!s)return{edges:u,nodes:o};const d=await s({nodes:o,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:o}:{edges:[],nodes:[]}:d}const bi=(t,e=0,r=1)=>Math.min(Math.max(t,e),r),vs=(t={x:0,y:0},e,r)=>({x:bi(t.x,e[0][0],e[1][0]-((r==null?void 0:r.width)??0)),y:bi(t.y,e[0][1],e[1][1]-((r==null?void 0:r.height)??0))});function Sw(t,e,r){const{width:n,height:s}=an(r),{x:i,y:o}=r.internals.positionAbsolute;return vs(t,[[i,o],[i+n,o+s]],e)}const Mm=(t,e,r)=>t<e?bi(Math.abs(t-e),1,e)/e:t>r?-bi(Math.abs(t-r),1,e)/e:0,Cw=(t,e,r=15,n=40)=>{const s=Mm(t.x,n,e.width-n)*r,i=Mm(t.y,n,e.height-n)*r;return[s,i]},uu=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Hh=({x:t,y:e,width:r,height:n})=>({x:t,y:e,x2:t+r,y2:e+n}),du=({x:t,y:e,x2:r,y2:n})=>({x:t,y:e,width:r-t,height:n-e}),_i=(t,e=[0,0])=>{var s,i;const{x:r,y:n}=yg(t)?t.internals.positionAbsolute:pa(t,e);return{x:r,y:n,width:((s=t.measured)==null?void 0:s.width)??t.width??t.initialWidth??0,height:((i=t.measured)==null?void 0:i.height)??t.height??t.initialHeight??0}},kc=(t,e=[0,0])=>{var s,i;const{x:r,y:n}=yg(t)?t.internals.positionAbsolute:pa(t,e);return{x:r,y:n,x2:r+(((s=t.measured)==null?void 0:s.width)??t.width??t.initialWidth??0),y2:n+(((i=t.measured)==null?void 0:i.height)??t.height??t.initialHeight??0)}},kw=(t,e)=>du(uu(Hh(t),Hh(e))),Zo=(t,e)=>{const r=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),n=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(r*n)},Dm=t=>ar(t.width)&&ar(t.height)&&ar(t.x)&&ar(t.y),ar=t=>!isNaN(t)&&isFinite(t),Lj=(t,e)=>{},ya=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),xa=({x:t,y:e},[r,n,s],i=!1,o=[1,1])=>{const a={x:(t-r)/s,y:(e-n)/s};return i?ya(a,o):a},Ec=({x:t,y:e},[r,n,s])=>({x:t*s+r,y:e*s+n});function As(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const r=parseFloat(t);if(!Number.isNaN(r))return Math.floor(r)}if(typeof t=="string"&&t.endsWith("%")){const r=parseFloat(t);if(!Number.isNaN(r))return Math.floor(e*r*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Rj(t,e,r){if(typeof t=="string"||typeof t=="number"){const n=As(t,r),s=As(t,e);return{top:n,right:s,bottom:n,left:s,x:s*2,y:n*2}}if(typeof t=="object"){const n=As(t.top??t.y??0,r),s=As(t.bottom??t.y??0,r),i=As(t.left??t.x??0,e),o=As(t.right??t.x??0,e);return{top:n,right:o,bottom:s,left:i,x:i+o,y:n+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Ij(t,e,r,n,s,i){const{x:o,y:a}=Ec(t,[e,r,n]),{x:l,y:c}=Ec({x:t.x+t.width,y:t.y+t.height},[e,r,n]),u=s-l,d=i-c;return{left:Math.floor(o),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(d)}}const vg=(t,e,r,n,s,i)=>{const o=Rj(i,e,r),a=(e-o.x)/t.width,l=(r-o.y)/t.height,c=Math.min(a,l),u=bi(c,n,s),d=t.x+t.width/2,h=t.y+t.height/2,g=e/2-d*u,p=r/2-h*u,y=Ij(t,g,p,u,e,r),v={left:Math.min(y.left-o.left,0),top:Math.min(y.top-o.top,0),right:Math.min(y.right-o.right,0),bottom:Math.min(y.bottom-o.bottom,0)};return{x:g-v.left+v.right,y:p-v.top+v.bottom,zoom:u}},ea=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0};function Si(t){return t!=null&&t!=="parent"}function an(t){var e,r;return{width:((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth??0,height:((r=t.measured)==null?void 0:r.height)??t.height??t.initialHeight??0}}function Ew(t){var e,r;return(((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth)!==void 0&&(((r=t.measured)==null?void 0:r.height)??t.height??t.initialHeight)!==void 0}function Tw(t,e={width:0,height:0},r,n,s){const i={...t},o=n.get(r);if(o){const a=o.origin||s;i.x+=o.internals.positionAbsolute.x-(e.width??0)*a[0],i.y+=o.internals.positionAbsolute.y-(e.height??0)*a[1]}return i}function Am(t,e){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}function $j(){let t,e;return{promise:new Promise((n,s)=>{t=n,e=s}),resolve:t,reject:e}}function zj(t){return{...xw,...t||{}}}function So(t,{snapGrid:e=[0,0],snapToGrid:r=!1,transform:n,containerBounds:s}){const{x:i,y:o}=lr(t),a=xa({x:i-((s==null?void 0:s.left)??0),y:o-((s==null?void 0:s.top)??0)},n),{x:l,y:c}=r?ya(a,e):a;return{xSnapped:l,ySnapped:c,...a}}const wg=t=>({width:t.offsetWidth,height:t.offsetHeight}),jw=t=>{var e;return((e=t==null?void 0:t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},Bj=["INPUT","SELECT","TEXTAREA"];function Nw(t){var n,s;const e=((s=(n=t.composedPath)==null?void 0:n.call(t))==null?void 0:s[0])||t.target;return(e==null?void 0:e.nodeType)!==1?!1:Bj.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const Ow=t=>"clientX"in t,lr=(t,e)=>{var i,o;const r=Ow(t),n=r?t.clientX:(i=t.touches)==null?void 0:i[0].clientX,s=r?t.clientY:(o=t.touches)==null?void 0:o[0].clientY;return{x:n-((e==null?void 0:e.left)??0),y:s-((e==null?void 0:e.top)??0)}},Fm=(t,e,r,n,s)=>{const i=e.querySelectorAll(`.${t}`);return!i||!i.length?null:Array.from(i).map(o=>{const a=o.getBoundingClientRect();return{id:o.getAttribute("data-handleid"),type:t,nodeId:s,position:o.getAttribute("data-handlepos"),x:(a.left-r.left)/n,y:(a.top-r.top)/n,...wg(o)}})};function Pw({sourceX:t,sourceY:e,targetX:r,targetY:n,sourceControlX:s,sourceControlY:i,targetControlX:o,targetControlY:a}){const l=t*.125+s*.375+o*.375+r*.125,c=e*.125+i*.375+a*.375+n*.125,u=Math.abs(l-t),d=Math.abs(c-e);return[l,c,u,d]}function Qa(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Lm({pos:t,x1:e,y1:r,x2:n,y2:s,c:i}){switch(t){case re.Left:return[e-Qa(e-n,i),r];case re.Right:return[e+Qa(n-e,i),r];case re.Top:return[e,r-Qa(r-s,i)];case re.Bottom:return[e,r+Qa(s-r,i)]}}function Mw({sourceX:t,sourceY:e,sourcePosition:r=re.Bottom,targetX:n,targetY:s,targetPosition:i=re.Top,curvature:o=.25}){const[a,l]=Lm({pos:r,x1:t,y1:e,x2:n,y2:s,c:o}),[c,u]=Lm({pos:i,x1:n,y1:s,x2:t,y2:e,c:o}),[d,h,g,p]=Pw({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${t},${e} C${a},${l} ${c},${u} ${n},${s}`,d,h,g,p]}function Dw({sourceX:t,sourceY:e,targetX:r,targetY:n}){const s=Math.abs(r-t)/2,i=r<t?r+s:r-s,o=Math.abs(n-e)/2,a=n<e?n+o:n-o;return[i,a,s,o]}function Wj({sourceNode:t,targetNode:e,selected:r=!1,zIndex:n,elevateOnSelect:s=!1}){if(n!==void 0)return n;const i=s&&r?1e3:0,o=Math.max(t.parentId||s&&t.selected?t.internals.z:0,e.parentId||s&&e.selected?e.internals.z:0);return i+o}function Hj({sourceNode:t,targetNode:e,width:r,height:n,transform:s}){const i=uu(kc(t),kc(e));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const o={x:-s[0]/s[2],y:-s[1]/s[2],width:r/s[2],height:n/s[2]};return Zo(o,du(i))>0}const Vj=({source:t,sourceHandle:e,target:r,targetHandle:n})=>`xy-edge__${t}${e||""}-${r}${n||""}`,Uj=(t,e)=>e.some(r=>r.source===t.source&&r.target===t.target&&(r.sourceHandle===t.sourceHandle||!r.sourceHandle&&!t.sourceHandle)&&(r.targetHandle===t.targetHandle||!r.targetHandle&&!t.targetHandle)),Xj=(t,e)=>{if(!t.source||!t.target)return e;let r;return bw(t)?r={...t}:r={...t,id:Vj(t)},Uj(r,e)?e:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,e.concat(r))};function Aw({sourceX:t,sourceY:e,targetX:r,targetY:n}){const[s,i,o,a]=Dw({sourceX:t,sourceY:e,targetX:r,targetY:n});return[`M ${t},${e}L ${r},${n}`,s,i,o,a]}const Rm={[re.Left]:{x:-1,y:0},[re.Right]:{x:1,y:0},[re.Top]:{x:0,y:-1},[re.Bottom]:{x:0,y:1}},Yj=({source:t,sourcePosition:e=re.Bottom,target:r})=>e===re.Left||e===re.Right?t.x<r.x?{x:1,y:0}:{x:-1,y:0}:t.y<r.y?{x:0,y:1}:{x:0,y:-1},Im=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function Gj({source:t,sourcePosition:e=re.Bottom,target:r,targetPosition:n=re.Top,center:s,offset:i,stepPosition:o}){const a=Rm[e],l=Rm[n],c={x:t.x+a.x*i,y:t.y+a.y*i},u={x:r.x+l.x*i,y:r.y+l.y*i},d=Yj({source:c,sourcePosition:e,target:u}),h=d.x!==0?"x":"y",g=d[h];let p=[],y,v;const m={x:0,y:0},w={x:0,y:0},[,,x,_]=Dw({sourceX:t.x,sourceY:t.y,targetX:r.x,targetY:r.y});if(a[h]*l[h]===-1){h==="x"?(y=s.x??c.x+(u.x-c.x)*o,v=s.y??(c.y+u.y)/2):(y=s.x??(c.x+u.x)/2,v=s.y??c.y+(u.y-c.y)*o);const C=[{x:y,y:c.y},{x:y,y:u.y}],k=[{x:c.x,y:v},{x:u.x,y:v}];a[h]===g?p=h==="x"?C:k:p=h==="x"?k:C}else{const C=[{x:c.x,y:u.y}],k=[{x:u.x,y:c.y}];if(h==="x"?p=a.x===g?k:C:p=a.y===g?C:k,e===n){const A=Math.abs(t[h]-r[h]);if(A<=i){const L=Math.min(i-1,i-A);a[h]===g?m[h]=(c[h]>t[h]?-1:1)*L:w[h]=(u[h]>r[h]?-1:1)*L}}if(e!==n){const A=h==="x"?"y":"x",L=a[h]===l[A],E=c[A]>u[A],M=c[A]<u[A];(a[h]===1&&(!L&&E||L&&M)||a[h]!==1&&(!L&&M||L&&E))&&(p=h==="x"?C:k)}const S={x:c.x+m.x,y:c.y+m.y},P={x:u.x+w.x,y:u.y+w.y},O=Math.max(Math.abs(S.x-p[0].x),Math.abs(P.x-p[0].x)),F=Math.max(Math.abs(S.y-p[0].y),Math.abs(P.y-p[0].y));O>=F?(y=(S.x+P.x)/2,v=p[0].y):(y=p[0].x,v=(S.y+P.y)/2)}return[[t,{x:c.x+m.x,y:c.y+m.y},...p,{x:u.x+w.x,y:u.y+w.y},r],y,v,x,_]}function qj(t,e,r,n){const s=Math.min(Im(t,e)/2,Im(e,r)/2,n),{x:i,y:o}=e;if(t.x===i&&i===r.x||t.y===o&&o===r.y)return`L${i} ${o}`;if(t.y===o){const c=t.x<r.x?-1:1,u=t.y<r.y?1:-1;return`L ${i+s*c},${o}Q ${i},${o} ${i},${o+s*u}`}const a=t.x<r.x?1:-1,l=t.y<r.y?-1:1;return`L ${i},${o+s*l}Q ${i},${o} ${i+s*a},${o}`}function Vh({sourceX:t,sourceY:e,sourcePosition:r=re.Bottom,targetX:n,targetY:s,targetPosition:i=re.Top,borderRadius:o=5,centerX:a,centerY:l,offset:c=20,stepPosition:u=.5}){const[d,h,g,p,y]=Gj({source:{x:t,y:e},sourcePosition:r,target:{x:n,y:s},targetPosition:i,center:{x:a,y:l},offset:c,stepPosition:u});return[d.reduce((m,w,x)=>{let _="";return x>0&&x<d.length-1?_=qj(d[x-1],w,d[x+1],o):_=`${x===0?"M":"L"}${w.x} ${w.y}`,m+=_,m},""),h,g,p,y]}function $m(t){var e;return t&&!!(t.internals.handleBounds||(e=t.handles)!=null&&e.length)&&!!(t.measured.width||t.width||t.initialWidth)}function Kj(t){var d;const{sourceNode:e,targetNode:r}=t;if(!$m(e)||!$m(r))return null;const n=e.internals.handleBounds||zm(e.handles),s=r.internals.handleBounds||zm(r.handles),i=Bm((n==null?void 0:n.source)??[],t.sourceHandle),o=Bm(t.connectionMode===wi.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),t.targetHandle);if(!i||!o)return(d=t.onError)==null||d.call(t,"008",Dr.error008(i?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const a=(i==null?void 0:i.position)||re.Bottom,l=(o==null?void 0:o.position)||re.Top,c=ta(e,i,a),u=ta(r,o,l);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:l}}function zm(t){if(!t)return null;const e=[],r=[];for(const n of t)n.width=n.width??1,n.height=n.height??1,n.type==="source"?e.push(n):n.type==="target"&&r.push(n);return{source:e,target:r}}function ta(t,e,r=re.Left,n=!1){const s=((e==null?void 0:e.x)??0)+t.internals.positionAbsolute.x,i=((e==null?void 0:e.y)??0)+t.internals.positionAbsolute.y,{width:o,height:a}=e??an(t);if(n)return{x:s+o/2,y:i+a/2};switch((e==null?void 0:e.position)??r){case re.Top:return{x:s+o/2,y:i};case re.Right:return{x:s+o,y:i+a/2};case re.Bottom:return{x:s+o/2,y:i+a};case re.Left:return{x:s,y:i+a/2}}}function Bm(t,e){return t&&(e?t.find(r=>r.id===e):t[0])||null}function Uh(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("&")}`:""}function Qj(t,{id:e,defaultColor:r,defaultMarkerStart:n,defaultMarkerEnd:s}){const i=new Set;return t.reduce((o,a)=>([a.markerStart||n,a.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const c=Uh(l,e);i.has(c)||(o.push({id:c,color:l.color||r,...l}),i.add(c))}}),o),[]).sort((o,a)=>o.id.localeCompare(a.id))}const Fw=1e3,Jj=10,bg={nodeOrigin:[0,0],nodeExtent:Ko,elevateNodesOnSelect:!0,defaults:{}},Zj={...bg,checkEquality:!0};function _g(t,e){const r={...t};for(const n in e)e[n]!==void 0&&(r[n]=e[n]);return r}function eN(t,e,r){const n=_g(bg,r);for(const s of t.values())if(s.parentId)Sg(s,t,e,n);else{const i=pa(s,n.nodeOrigin),o=Si(s.extent)?s.extent:n.nodeExtent,a=vs(i,o,an(s));s.internals.positionAbsolute=a}}function tN(t,e){if(!t.handles)return t.measured?e==null?void 0:e.internals.handleBounds:void 0;const r=[],n=[];for(const s of t.handles){const i={id:s.id,width:s.width??1,height:s.height??1,nodeId:t.id,x:s.x,y:s.y,position:s.position,type:s.type};s.type==="source"?r.push(i):s.type==="target"&&n.push(i)}return{source:r,target:n}}function Xh(t,e,r,n){var c,u;const s=_g(Zj,n);let i={i:-1},o=t.length>0;const a=new Map(e),l=s!=null&&s.elevateNodesOnSelect?Fw:0;e.clear(),r.clear();for(const d of t){let h=a.get(d.id);if(s.checkEquality&&d===(h==null?void 0:h.internals.userNode))e.set(d.id,h);else{const g=pa(d,s.nodeOrigin),p=Si(d.extent)?d.extent:s.nodeExtent,y=vs(g,p,an(d));h={...s.defaults,...d,measured:{width:(c=d.measured)==null?void 0:c.width,height:(u=d.measured)==null?void 0:u.height},internals:{positionAbsolute:y,handleBounds:tN(d,h),z:Lw(d,l),userNode:d}},e.set(d.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(o=!1),d.parentId&&Sg(h,e,r,n,i)}return o}function rN(t,e){if(!t.parentId)return;const r=e.get(t.parentId);r?r.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function Sg(t,e,r,n,s){const{elevateNodesOnSelect:i,nodeOrigin:o,nodeExtent:a}=_g(bg,n),l=t.parentId,c=e.get(l);if(!c){console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}rN(t,r),s&&!c.parentId&&c.internals.rootParentIndex===void 0&&(c.internals.rootParentIndex=++s.i,c.internals.z=c.internals.z+s.i*Jj),s&&c.internals.rootParentIndex!==void 0&&(s.i=c.internals.rootParentIndex);const u=i?Fw:0,{x:d,y:h,z:g}=nN(t,c,o,a,u),{positionAbsolute:p}=t.internals,y=d!==p.x||h!==p.y;(y||g!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:y?{x:d,y:h}:p,z:g}})}function Lw(t,e){return(ar(t.zIndex)?t.zIndex:0)+(t.selected?e:0)}function nN(t,e,r,n,s){const{x:i,y:o}=e.internals.positionAbsolute,a=an(t),l=pa(t,r),c=Si(t.extent)?vs(l,t.extent,a):l;let u=vs({x:i+c.x,y:o+c.y},n,a);t.extent==="parent"&&(u=Sw(u,a,e));const d=Lw(t,s),h=e.internals.z??0;return{x:u.x,y:u.y,z:h>=d?h+1:d}}function Cg(t,e,r,n=[0,0]){var o;const s=[],i=new Map;for(const a of t){const l=e.get(a.parentId);if(!l)continue;const c=((o=i.get(a.parentId))==null?void 0:o.expandedRect)??_i(l),u=kw(c,a.rect);i.set(a.parentId,{expandedRect:u,parent:l})}return i.size>0&&i.forEach(({expandedRect:a,parent:l},c)=>{var x;const u=l.internals.positionAbsolute,d=an(l),h=l.origin??n,g=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,p=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,y=Math.max(d.width,Math.round(a.width)),v=Math.max(d.height,Math.round(a.height)),m=(y-d.width)*h[0],w=(v-d.height)*h[1];(g>0||p>0||m||w)&&(s.push({id:c,type:"position",position:{x:l.position.x-g+m,y:l.position.y-p+w}}),(x=r.get(c))==null||x.forEach(_=>{t.some(b=>b.id===_.id)||s.push({id:_.id,type:"position",position:{x:_.position.x+g,y:_.position.y+p}})})),(d.width<a.width||d.height<a.height||g||p)&&s.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:y+(g?h[0]*g-m:0),height:v+(p?h[1]*p-w:0)}})}),s}function sN(t,e,r,n,s,i){const o=n==null?void 0:n.querySelector(".xyflow__viewport");let a=!1;if(!o)return{changes:[],updatedInternals:a};const l=[],c=window.getComputedStyle(o),{m22:u}=new window.DOMMatrixReadOnly(c.transform),d=[];for(const h of t.values()){const g=e.get(h.id);if(!g)continue;if(g.hidden){e.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),a=!0;continue}const p=wg(h.nodeElement),y=g.measured.width!==p.width||g.measured.height!==p.height;if(!!(p.width&&p.height&&(y||!g.internals.handleBounds||h.force))){const m=h.nodeElement.getBoundingClientRect(),w=Si(g.extent)?g.extent:i;let{positionAbsolute:x}=g.internals;g.parentId&&g.extent==="parent"?x=Sw(x,p,e.get(g.parentId)):w&&(x=vs(x,w,p));const _={...g,measured:p,internals:{...g.internals,positionAbsolute:x,handleBounds:{source:Fm("source",h.nodeElement,m,u,g.id),target:Fm("target",h.nodeElement,m,u,g.id)}}};e.set(g.id,_),g.parentId&&Sg(_,e,r,{nodeOrigin:s}),a=!0,y&&(l.push({id:g.id,type:"dimensions",dimensions:p}),g.expandParent&&g.parentId&&d.push({id:g.id,parentId:g.parentId,rect:_i(_,s)}))}}if(d.length>0){const h=Cg(d,e,r,s);l.push(...h)}return{changes:l,updatedInternals:a}}async function iN({delta:t,panZoom:e,transform:r,translateExtent:n,width:s,height:i}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const o=await e.setViewportConstrained({x:r[0]+t.x,y:r[1]+t.y,zoom:r[2]},[[0,0],[s,i]],n),a=!!o&&(o.x!==r[0]||o.y!==r[1]||o.k!==r[2]);return Promise.resolve(a)}function Wm(t,e,r,n,s,i){let o=s;const a=n.get(o)||new Map;n.set(o,a.set(r,e)),o=`${s}-${t}`;const l=n.get(o)||new Map;if(n.set(o,l.set(r,e)),i){o=`${s}-${t}-${i}`;const c=n.get(o)||new Map;n.set(o,c.set(r,e))}}function Rw(t,e,r){t.clear(),e.clear();for(const n of r){const{source:s,target:i,sourceHandle:o=null,targetHandle:a=null}=n,l={edgeId:n.id,source:s,target:i,sourceHandle:o,targetHandle:a},c=`${s}-${o}--${i}-${a}`,u=`${i}-${a}--${s}-${o}`;Wm("source",l,u,t,s,o),Wm("target",l,c,t,i,a),e.set(n.id,n)}}function Iw(t,e){if(!t.parentId)return!1;const r=e.get(t.parentId);return r?r.selected?!0:Iw(r,e):!1}function Hm(t,e,r){var s;let n=t;do{if((s=n==null?void 0:n.matches)!=null&&s.call(n,e))return!0;if(n===r)return!1;n=n==null?void 0:n.parentElement}while(n);return!1}function oN(t,e,r,n){const s=new Map;for(const[i,o]of t)if((o.selected||o.id===n)&&(!o.parentId||!Iw(o,t))&&(o.draggable||e&&typeof o.draggable>"u")){const a=t.get(i);a&&s.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:r.x-a.internals.positionAbsolute.x,y:r.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return s}function md({nodeId:t,dragItems:e,nodeLookup:r,dragging:n=!0}){var o,a,l;const s=[];for(const[c,u]of e){const d=(o=r.get(c))==null?void 0:o.internals.userNode;d&&s.push({...d,position:u.position,dragging:n})}if(!t)return[s[0],s];const i=(a=r.get(t))==null?void 0:a.internals.userNode;return[i?{...i,position:((l=e.get(t))==null?void 0:l.position)||i.position,dragging:n}:s[0],s]}function aN({dragItems:t,snapGrid:e,x:r,y:n}){const s=t.values().next().value;if(!s)return null;const i={x:r-s.distance.x,y:n-s.distance.y},o=ya(i,e);return{x:o.x-i.x,y:o.y-i.y}}function lN({onNodeMouseDown:t,getStoreItems:e,onDragStart:r,onDrag:n,onDragStop:s}){let i={x:null,y:null},o=0,a=new Map,l=!1,c={x:0,y:0},u=null,d=!1,h=null,g=!1,p=!1,y=null;function v({noDragClassName:w,handleSelector:x,domNode:_,isSelectable:b,nodeId:C,nodeClickDistance:k=0}){h=Pt(_);function S({x:A,y:L}){const{nodeLookup:E,nodeExtent:M,snapGrid:N,snapToGrid:I,nodeOrigin:j,onNodeDrag:D,onSelectionDrag:z,onError:H,updateNodePositions:U}=e();i={x:A,y:L};let G=!1;const X=a.size>1,Q=X&&M?Hh(ma(a)):null,B=X&&I?aN({dragItems:a,snapGrid:N,x:A,y:L}):null;for(const[Y,K]of a){if(!E.has(Y))continue;let ne={x:A-K.distance.x,y:L-K.distance.y};I&&(ne=B?{x:Math.round(ne.x+B.x),y:Math.round(ne.y+B.y)}:ya(ne,N));let oe=null;if(X&&M&&!K.extent&&Q){const{positionAbsolute:ie}=K.internals,he=ie.x-Q.x+M[0][0],pe=ie.x+K.measured.width-Q.x2+M[1][0],Se=ie.y-Q.y+M[0][1],Ge=ie.y+K.measured.height-Q.y2+M[1][1];oe=[[he,Se],[pe,Ge]]}const{position:ae,positionAbsolute:se}=_w({nodeId:Y,nextPosition:ne,nodeLookup:E,nodeExtent:oe||M,nodeOrigin:j,onError:H});G=G||K.position.x!==ae.x||K.position.y!==ae.y,K.position=ae,K.internals.positionAbsolute=se}if(p=p||G,!!G&&(U(a,!0),y&&(n||D||!C&&z))){const[Y,K]=md({nodeId:C,dragItems:a,nodeLookup:E});n==null||n(y,a,Y,K),D==null||D(y,Y,K),C||z==null||z(y,K)}}async function P(){if(!u)return;const{transform:A,panBy:L,autoPanSpeed:E,autoPanOnNodeDrag:M}=e();if(!M){l=!1,cancelAnimationFrame(o);return}const[N,I]=Cw(c,u,E);(N!==0||I!==0)&&(i.x=(i.x??0)-N/A[2],i.y=(i.y??0)-I/A[2],await L({x:N,y:I})&&S(i)),o=requestAnimationFrame(P)}function O(A){var X;const{nodeLookup:L,multiSelectionActive:E,nodesDraggable:M,transform:N,snapGrid:I,snapToGrid:j,selectNodesOnDrag:D,onNodeDragStart:z,onSelectionDragStart:H,unselectNodesAndEdges:U}=e();d=!0,(!D||!b)&&!E&&C&&((X=L.get(C))!=null&&X.selected||U()),b&&D&&C&&(t==null||t(C));const G=So(A.sourceEvent,{transform:N,snapGrid:I,snapToGrid:j,containerBounds:u});if(i=G,a=oN(L,M,G,C),a.size>0&&(r||z||!C&&H)){const[Q,B]=md({nodeId:C,dragItems:a,nodeLookup:L});r==null||r(A.sourceEvent,a,Q,B),z==null||z(A.sourceEvent,Q,B),C||H==null||H(A.sourceEvent,B)}}const F=tw().clickDistance(k).on("start",A=>{const{domNode:L,nodeDragThreshold:E,transform:M,snapGrid:N,snapToGrid:I}=e();u=(L==null?void 0:L.getBoundingClientRect())||null,g=!1,p=!1,y=A.sourceEvent,E===0&&O(A),i=So(A.sourceEvent,{transform:M,snapGrid:N,snapToGrid:I,containerBounds:u}),c=lr(A.sourceEvent,u)}).on("drag",A=>{const{autoPanOnNodeDrag:L,transform:E,snapGrid:M,snapToGrid:N,nodeDragThreshold:I,nodeLookup:j}=e(),D=So(A.sourceEvent,{transform:E,snapGrid:M,snapToGrid:N,containerBounds:u});if(y=A.sourceEvent,(A.sourceEvent.type==="touchmove"&&A.sourceEvent.touches.length>1||C&&!j.has(C))&&(g=!0),!g){if(!l&&L&&d&&(l=!0,P()),!d){const z=lr(A.sourceEvent,u),H=z.x-c.x,U=z.y-c.y;Math.sqrt(H*H+U*U)>I&&O(A)}(i.x!==D.xSnapped||i.y!==D.ySnapped)&&a&&d&&(c=lr(A.sourceEvent,u),S(D))}}).on("end",A=>{if(!(!d||g)&&(l=!1,d=!1,cancelAnimationFrame(o),a.size>0)){const{nodeLookup:L,updateNodePositions:E,onNodeDragStop:M,onSelectionDragStop:N}=e();if(p&&(E(a,!1),p=!1),s||M||!C&&N){const[I,j]=md({nodeId:C,dragItems:a,nodeLookup:L,dragging:!1});s==null||s(A.sourceEvent,a,I,j),M==null||M(A.sourceEvent,I,j),C||N==null||N(A.sourceEvent,j)}}}).filter(A=>{const L=A.target;return!A.button&&(!w||!Hm(L,`.${w}`,_))&&(!x||Hm(L,x,_))});h.call(F)}function m(){h==null||h.on(".drag",null)}return{update:v,destroy:m}}function cN(t,e,r){const n=[],s={x:t.x-r,y:t.y-r,width:r*2,height:r*2};for(const i of e.values())Zo(s,_i(i))>0&&n.push(i);return n}const uN=250;function dN(t,e,r,n){var a,l;let s=[],i=1/0;const o=cN(t,r,e+uN);for(const c of o){const u=[...((a=c.internals.handleBounds)==null?void 0:a.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const d of u){if(n.nodeId===d.nodeId&&n.type===d.type&&n.id===d.id)continue;const{x:h,y:g}=ta(c,d,d.position,!0),p=Math.sqrt(Math.pow(h-t.x,2)+Math.pow(g-t.y,2));p>e||(p<i?(s=[{...d,x:h,y:g}],i=p):p===i&&s.push({...d,x:h,y:g}))}}if(!s.length)return null;if(s.length>1){const c=n.type==="source"?"target":"source";return s.find(u=>u.type===c)??s[0]}return s[0]}function $w(t,e,r,n,s,i=!1){var c,u,d;const o=n.get(t);if(!o)return null;const a=s==="strict"?(c=o.internals.handleBounds)==null?void 0:c[e]:[...((u=o.internals.handleBounds)==null?void 0:u.source)??[],...((d=o.internals.handleBounds)==null?void 0:d.target)??[]],l=(r?a==null?void 0:a.find(h=>h.id===r):a==null?void 0:a[0])??null;return l&&i?{...l,...ta(o,l,l.position,!0)}:l}function zw(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function hN(t,e){let r=null;return e?r=!0:t&&!e&&(r=!1),r}const Bw=()=>!0;function fN(t,{connectionMode:e,connectionRadius:r,handleId:n,nodeId:s,edgeUpdaterType:i,isTarget:o,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:d,panBy:h,cancelConnection:g,onConnectStart:p,onConnect:y,onConnectEnd:v,isValidConnection:m=Bw,onReconnectEnd:w,updateConnection:x,getTransform:_,getFromHandle:b,autoPanSpeed:C,dragThreshold:k=1,handleDomNode:S}){const P=jw(t.target);let O=0,F;const{x:A,y:L}=lr(t),E=zw(i,S),M=a==null?void 0:a.getBoundingClientRect();let N=!1;if(!M||!E)return;const I=$w(s,E,n,l,e);if(!I)return;let j=lr(t,M),D=!1,z=null,H=!1,U=null;function G(){if(!u||!M)return;const[ae,se]=Cw(j,M,C);h({x:ae,y:se}),O=requestAnimationFrame(G)}const X={...I,nodeId:s,type:E,position:I.position},Q=l.get(s);let Y={inProgress:!0,isValid:null,from:ta(Q,X,re.Left,!0),fromHandle:X,fromPosition:X.position,fromNode:Q,to:j,toHandle:null,toPosition:Pm[X.position],toNode:null};function K(){N=!0,x(Y),p==null||p(t,{nodeId:s,handleId:n,handleType:E})}k===0&&K();function ne(ae){if(!N){const{x:pe,y:Se}=lr(ae),Ge=pe-A,Kt=Se-L;if(!(Ge*Ge+Kt*Kt>k*k))return;K()}if(!b()||!X){oe(ae);return}const se=_();j=lr(ae,M),F=dN(xa(j,se,!1,[1,1]),r,l,X),D||(G(),D=!0);const ie=Ww(ae,{handle:F,connectionMode:e,fromNodeId:s,fromHandleId:n,fromType:o?"target":"source",isValidConnection:m,doc:P,lib:c,flowId:d,nodeLookup:l});U=ie.handleDomNode,z=ie.connection,H=hN(!!F,ie.isValid);const he={...Y,isValid:H,to:ie.toHandle&&H?Ec({x:ie.toHandle.x,y:ie.toHandle.y},se):j,toHandle:ie.toHandle,toPosition:H&&ie.toHandle?ie.toHandle.position:Pm[X.position],toNode:ie.toHandle?l.get(ie.toHandle.nodeId):null};H&&F&&Y.toHandle&&he.toHandle&&Y.toHandle.type===he.toHandle.type&&Y.toHandle.nodeId===he.toHandle.nodeId&&Y.toHandle.id===he.toHandle.id&&Y.to.x===he.to.x&&Y.to.y===he.to.y||(x(he),Y=he)}function oe(ae){if(!("touches"in ae&&ae.touches.length>0)){if(N){(F||U)&&z&&H&&(y==null||y(z));const{inProgress:se,...ie}=Y,he={...ie,toPosition:Y.toHandle?Y.toPosition:null};v==null||v(ae,he),i&&(w==null||w(ae,he))}g(),cancelAnimationFrame(O),D=!1,H=!1,z=null,U=null,P.removeEventListener("mousemove",ne),P.removeEventListener("mouseup",oe),P.removeEventListener("touchmove",ne),P.removeEventListener("touchend",oe)}}P.addEventListener("mousemove",ne),P.addEventListener("mouseup",oe),P.addEventListener("touchmove",ne),P.addEventListener("touchend",oe)}function Ww(t,{handle:e,connectionMode:r,fromNodeId:n,fromHandleId:s,fromType:i,doc:o,lib:a,flowId:l,isValidConnection:c=Bw,nodeLookup:u}){const d=i==="target",h=e?o.querySelector(`.${a}-flow__handle[data-id="${l}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:g,y:p}=lr(t),y=o.elementFromPoint(g,p),v=y!=null&&y.classList.contains(`${a}-flow__handle`)?y:h,m={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=zw(void 0,v),x=v.getAttribute("data-nodeid"),_=v.getAttribute("data-handleid"),b=v.classList.contains("connectable"),C=v.classList.contains("connectableend");if(!x||!w)return m;const k={source:d?x:n,sourceHandle:d?_:s,target:d?n:x,targetHandle:d?s:_};m.connection=k;const P=b&&C&&(r===wi.Strict?d&&w==="source"||!d&&w==="target":x!==n||_!==s);m.isValid=P&&c(k),m.toHandle=$w(x,w,_,u,r,!0)}return m}const Yh={onPointerDown:fN,isValid:Ww};function gN({domNode:t,panZoom:e,getTransform:r,getViewScale:n}){const s=Pt(t);function i({translateExtent:a,width:l,height:c,zoomStep:u=1,pannable:d=!0,zoomable:h=!0,inversePan:g=!1}){const p=x=>{if(x.sourceEvent.type!=="wheel"||!e)return;const _=r(),b=x.sourceEvent.ctrlKey&&ea()?10:1,C=-x.sourceEvent.deltaY*(x.sourceEvent.deltaMode===1?.05:x.sourceEvent.deltaMode?1:.002)*u,k=_[2]*Math.pow(2,C*b);e.scaleTo(k)};let y=[0,0];const v=x=>{(x.sourceEvent.type==="mousedown"||x.sourceEvent.type==="touchstart")&&(y=[x.sourceEvent.clientX??x.sourceEvent.touches[0].clientX,x.sourceEvent.clientY??x.sourceEvent.touches[0].clientY])},m=x=>{const _=r();if(x.sourceEvent.type!=="mousemove"&&x.sourceEvent.type!=="touchmove"||!e)return;const b=[x.sourceEvent.clientX??x.sourceEvent.touches[0].clientX,x.sourceEvent.clientY??x.sourceEvent.touches[0].clientY],C=[b[0]-y[0],b[1]-y[1]];y=b;const k=n()*Math.max(_[2],Math.log(_[2]))*(g?-1:1),S={x:_[0]-C[0]*k,y:_[1]-C[1]*k},P=[[0,0],[l,c]];e.setViewportConstrained({x:S.x,y:S.y,zoom:_[2]},P,a)},w=mw().on("start",v).on("zoom",d?m:null).on("zoom.wheel",h?p:null);s.call(w,{})}function o(){s.on("zoom",null)}return{update:i,destroy:o,pointer:rr}}const hu=t=>({x:t.x,y:t.y,zoom:t.k}),yd=({x:t,y:e,zoom:r})=>cu.translate(t,e).scale(r),Ks=(t,e)=>t.target.closest(`.${e}`),Hw=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),pN=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,xd=(t,e=0,r=pN,n=()=>{})=>{const s=typeof e=="number"&&e>0;return s||n(),s?t.transition().duration(e).ease(r).on("end",n):t},Vw=t=>{const e=t.ctrlKey&&ea()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function mN({zoomPanValues:t,noWheelClassName:e,d3Selection:r,d3Zoom:n,panOnScrollMode:s,panOnScrollSpeed:i,zoomOnPinch:o,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(Ks(u,e))return u.ctrlKey&&u.preventDefault(),!1;u.preventDefault(),u.stopImmediatePropagation();const d=r.property("__zoom").k||1;if(u.ctrlKey&&o){const v=rr(u),m=Vw(u),w=d*Math.pow(2,m);n.scaleTo(r,w,v,u);return}const h=u.deltaMode===1?20:1;let g=s===as.Vertical?0:u.deltaX*h,p=s===as.Horizontal?0:u.deltaY*h;!ea()&&u.shiftKey&&s!==as.Vertical&&(g=u.deltaY*h,p=0),n.translateBy(r,-(g/d)*i,-(p/d)*i,{internal:!0});const y=hu(r.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(l==null||l(u,y),t.panScrollTimeout=setTimeout(()=>{c==null||c(u,y),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,a==null||a(u,y))}}function yN({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:r}){return function(n,s){const i=n.type==="wheel",o=!e&&i&&!n.ctrlKey,a=Ks(n,t);if(n.ctrlKey&&i&&a&&n.preventDefault(),o||a)return null;n.preventDefault(),r.call(this,n,s)}}function xN({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:r}){return n=>{var i,o,a;if((i=n.sourceEvent)!=null&&i.internal)return;const s=hu(n.transform);t.mouseButton=((o=n.sourceEvent)==null?void 0:o.button)||0,t.isZoomingOrPanning=!0,t.prevViewport=s,((a=n.sourceEvent)==null?void 0:a.type)==="mousedown"&&e(!0),r&&(r==null||r(n.sourceEvent,s))}}function vN({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:r,onTransformChange:n,onPanZoom:s}){return i=>{var o,a;t.usedRightMouseButton=!!(r&&Hw(e,t.mouseButton??0)),(o=i.sourceEvent)!=null&&o.sync||n([i.transform.x,i.transform.y,i.transform.k]),s&&!((a=i.sourceEvent)!=null&&a.internal)&&(s==null||s(i.sourceEvent,hu(i.transform)))}}function wN({zoomPanValues:t,panOnDrag:e,panOnScroll:r,onDraggingChange:n,onPanZoomEnd:s,onPaneContextMenu:i}){return o=>{var a;if(!((a=o.sourceEvent)!=null&&a.internal)&&(t.isZoomingOrPanning=!1,i&&Hw(e,t.mouseButton??0)&&!t.usedRightMouseButton&&o.sourceEvent&&i(o.sourceEvent),t.usedRightMouseButton=!1,n(!1),s)){const l=hu(o.transform);t.prevViewport=l,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{s==null||s(o.sourceEvent,l)},r?150:0)}}}function bN({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:r,panOnDrag:n,panOnScroll:s,zoomOnDoubleClick:i,userSelectionActive:o,noWheelClassName:a,noPanClassName:l,lib:c,connectionInProgress:u}){return d=>{var v;const h=t||e,g=r&&d.ctrlKey,p=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(Ks(d,`${c}-flow__node`)||Ks(d,`${c}-flow__edge`)))return!0;if(!n&&!h&&!s&&!i&&!r||o||u&&!p||Ks(d,a)&&p||Ks(d,l)&&(!p||s&&p&&!t)||!r&&d.ctrlKey&&p)return!1;if(!r&&d.type==="touchstart"&&((v=d.touches)==null?void 0:v.length)>1)return d.preventDefault(),!1;if(!h&&!s&&!g&&p||!n&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(n)&&!n.includes(d.button)&&d.type==="mousedown")return!1;const y=Array.isArray(n)&&n.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||p)&&y}}function _N({domNode:t,minZoom:e,maxZoom:r,paneClickDistance:n,translateExtent:s,viewport:i,onPanZoom:o,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=t.getBoundingClientRect(),h=mw().clickDistance(!ar(n)||n<0?0:n).scaleExtent([e,r]).translateExtent(s),g=Pt(t).call(h);x({x:i.x,y:i.y,zoom:bi(i.zoom,e,r)},[[0,0],[d.width,d.height]],s);const p=g.on("wheel.zoom"),y=g.on("dblclick.zoom");h.wheelDelta(Vw);function v(A,L){return g?new Promise(E=>{h==null||h.interpolate((L==null?void 0:L.interpolate)==="linear"?_o:$l).transform(xd(g,L==null?void 0:L.duration,L==null?void 0:L.ease,()=>E(!0)),A)}):Promise.resolve(!1)}function m({noWheelClassName:A,noPanClassName:L,onPaneContextMenu:E,userSelectionActive:M,panOnScroll:N,panOnDrag:I,panOnScrollMode:j,panOnScrollSpeed:D,preventScrolling:z,zoomOnPinch:H,zoomOnScroll:U,zoomOnDoubleClick:G,zoomActivationKeyPressed:X,lib:Q,onTransformChange:B,connectionInProgress:Y}){M&&!u.isZoomingOrPanning&&w();const ne=N&&!X&&!M?mN({zoomPanValues:u,noWheelClassName:A,d3Selection:g,d3Zoom:h,panOnScrollMode:j,panOnScrollSpeed:D,zoomOnPinch:H,onPanZoomStart:a,onPanZoom:o,onPanZoomEnd:l}):yN({noWheelClassName:A,preventScrolling:z,d3ZoomHandler:p});if(g.on("wheel.zoom",ne,{passive:!1}),!M){const ae=xN({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:a});h.on("start",ae);const se=vN({zoomPanValues:u,panOnDrag:I,onPaneContextMenu:!!E,onPanZoom:o,onTransformChange:B});h.on("zoom",se);const ie=wN({zoomPanValues:u,panOnDrag:I,panOnScroll:N,onPaneContextMenu:E,onPanZoomEnd:l,onDraggingChange:c});h.on("end",ie)}const oe=bN({zoomActivationKeyPressed:X,panOnDrag:I,zoomOnScroll:U,panOnScroll:N,zoomOnDoubleClick:G,zoomOnPinch:H,userSelectionActive:M,noPanClassName:L,noWheelClassName:A,lib:Q,connectionInProgress:Y});h.filter(oe),G?g.on("dblclick.zoom",y):g.on("dblclick.zoom",null)}function w(){h.on("zoom",null)}async function x(A,L,E){const M=yd(A),N=h==null?void 0:h.constrain()(M,L,E);return N&&await v(N),new Promise(I=>I(N))}async function _(A,L){const E=yd(A);return await v(E,L),new Promise(M=>M(E))}function b(A){if(g){const L=yd(A),E=g.property("__zoom");(E.k!==A.zoom||E.x!==A.x||E.y!==A.y)&&(h==null||h.transform(g,L,null,{sync:!0}))}}function C(){const A=g?pw(g.node()):{x:0,y:0,k:1};return{x:A.x,y:A.y,zoom:A.k}}function k(A,L){return g?new Promise(E=>{h==null||h.interpolate((L==null?void 0:L.interpolate)==="linear"?_o:$l).scaleTo(xd(g,L==null?void 0:L.duration,L==null?void 0:L.ease,()=>E(!0)),A)}):Promise.resolve(!1)}function S(A,L){return g?new Promise(E=>{h==null||h.interpolate((L==null?void 0:L.interpolate)==="linear"?_o:$l).scaleBy(xd(g,L==null?void 0:L.duration,L==null?void 0:L.ease,()=>E(!0)),A)}):Promise.resolve(!1)}function P(A){h==null||h.scaleExtent(A)}function O(A){h==null||h.translateExtent(A)}function F(A){const L=!ar(A)||A<0?0:A;h==null||h.clickDistance(L)}return{update:m,destroy:w,setViewport:_,setViewportConstrained:x,getViewport:C,scaleTo:k,scaleBy:S,setScaleExtent:P,setTranslateExtent:O,syncViewport:b,setClickDistance:F}}var Ci;(function(t){t.Line="line",t.Handle="handle"})(Ci||(Ci={}));function SN({width:t,prevWidth:e,height:r,prevHeight:n,affectsX:s,affectsY:i}){const o=t-e,a=r-n,l=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&s&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function Vm(t){const e=t.includes("right")||t.includes("left"),r=t.includes("bottom")||t.includes("top"),n=t.includes("left"),s=t.includes("top");return{isHorizontal:e,isVertical:r,affectsX:n,affectsY:s}}function hn(t,e){return Math.max(0,e-t)}function fn(t,e){return Math.max(0,t-e)}function Ja(t,e,r){return Math.max(0,e-t,t-r)}function Um(t,e){return t?!e:e}function CN(t,e,r,n,s,i,o,a){let{affectsX:l,affectsY:c}=e;const{isHorizontal:u,isVertical:d}=e,h=u&&d,{xSnapped:g,ySnapped:p}=r,{minWidth:y,maxWidth:v,minHeight:m,maxHeight:w}=n,{x,y:_,width:b,height:C,aspectRatio:k}=t;let S=Math.floor(u?g-t.pointerX:0),P=Math.floor(d?p-t.pointerY:0);const O=b+(l?-S:S),F=C+(c?-P:P),A=-i[0]*b,L=-i[1]*C;let E=Ja(O,y,v),M=Ja(F,m,w);if(o){let j=0,D=0;l&&S<0?j=hn(x+S+A,o[0][0]):!l&&S>0&&(j=fn(x+O+A,o[1][0])),c&&P<0?D=hn(_+P+L,o[0][1]):!c&&P>0&&(D=fn(_+F+L,o[1][1])),E=Math.max(E,j),M=Math.max(M,D)}if(a){let j=0,D=0;l&&S>0?j=fn(x+S,a[0][0]):!l&&S<0&&(j=hn(x+O,a[1][0])),c&&P>0?D=fn(_+P,a[0][1]):!c&&P<0&&(D=hn(_+F,a[1][1])),E=Math.max(E,j),M=Math.max(M,D)}if(s){if(u){const j=Ja(O/k,m,w)*k;if(E=Math.max(E,j),o){let D=0;!l&&!c||l&&!c&&h?D=fn(_+L+O/k,o[1][1])*k:D=hn(_+L+(l?S:-S)/k,o[0][1])*k,E=Math.max(E,D)}if(a){let D=0;!l&&!c||l&&!c&&h?D=hn(_+O/k,a[1][1])*k:D=fn(_+(l?S:-S)/k,a[0][1])*k,E=Math.max(E,D)}}if(d){const j=Ja(F*k,y,v)/k;if(M=Math.max(M,j),o){let D=0;!l&&!c||c&&!l&&h?D=fn(x+F*k+A,o[1][0])/k:D=hn(x+(c?P:-P)*k+A,o[0][0])/k,M=Math.max(M,D)}if(a){let D=0;!l&&!c||c&&!l&&h?D=hn(x+F*k,a[1][0])/k:D=fn(x+(c?P:-P)*k,a[0][0])/k,M=Math.max(M,D)}}}P=P+(P<0?M:-M),S=S+(S<0?E:-E),s&&(h?O>F*k?P=(Um(l,c)?-S:S)/k:S=(Um(l,c)?-P:P)*k:u?(P=S/k,c=l):(S=P*k,l=c));const N=l?x+S:x,I=c?_+P:_;return{width:b+(l?-S:S),height:C+(c?-P:P),x:i[0]*S*(l?-1:1)+N,y:i[1]*P*(c?-1:1)+I}}const Uw={width:0,height:0,x:0,y:0},kN={...Uw,pointerX:0,pointerY:0,aspectRatio:1};function EN(t){return[[0,0],[t.measured.width,t.measured.height]]}function TN(t,e,r){const n=e.position.x+t.position.x,s=e.position.y+t.position.y,i=t.measured.width??0,o=t.measured.height??0,a=r[0]*i,l=r[1]*o;return[[n-a,s-l],[n+i-a,s+o-l]]}function jN({domNode:t,nodeId:e,getStoreItems:r,onChange:n,onEnd:s}){const i=Pt(t);let o={controlDirection:Vm("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:c,boundaries:u,keepAspectRatio:d,resizeDirection:h,onResizeStart:g,onResize:p,onResizeEnd:y,shouldResize:v}){let m={...Uw},w={...kN};o={boundaries:u,resizeDirection:h,keepAspectRatio:d,controlDirection:Vm(c)};let x,_=null,b=[],C,k,S,P=!1;const O=tw().on("start",F=>{const{nodeLookup:A,transform:L,snapGrid:E,snapToGrid:M,nodeOrigin:N,paneDomNode:I}=r();if(x=A.get(e),!x)return;_=(I==null?void 0:I.getBoundingClientRect())??null;const{xSnapped:j,ySnapped:D}=So(F.sourceEvent,{transform:L,snapGrid:E,snapToGrid:M,containerBounds:_});m={width:x.measured.width??0,height:x.measured.height??0,x:x.position.x??0,y:x.position.y??0},w={...m,pointerX:j,pointerY:D,aspectRatio:m.width/m.height},C=void 0,x.parentId&&(x.extent==="parent"||x.expandParent)&&(C=A.get(x.parentId),k=C&&x.extent==="parent"?EN(C):void 0),b=[],S=void 0;for(const[z,H]of A)if(H.parentId===e&&(b.push({id:z,position:{...H.position},extent:H.extent}),H.extent==="parent"||H.expandParent)){const U=TN(H,x,H.origin??N);S?S=[[Math.min(U[0][0],S[0][0]),Math.min(U[0][1],S[0][1])],[Math.max(U[1][0],S[1][0]),Math.max(U[1][1],S[1][1])]]:S=U}g==null||g(F,{...m})}).on("drag",F=>{const{transform:A,snapGrid:L,snapToGrid:E,nodeOrigin:M}=r(),N=So(F.sourceEvent,{transform:A,snapGrid:L,snapToGrid:E,containerBounds:_}),I=[];if(!x)return;const{x:j,y:D,width:z,height:H}=m,U={},G=x.origin??M,{width:X,height:Q,x:B,y:Y}=CN(w,o.controlDirection,N,o.boundaries,o.keepAspectRatio,G,k,S),K=X!==z,ne=Q!==H,oe=B!==j&&K,ae=Y!==D&&ne;if(!oe&&!ae&&!K&&!ne)return;if((oe||ae||G[0]===1||G[1]===1)&&(U.x=oe?B:m.x,U.y=ae?Y:m.y,m.x=U.x,m.y=U.y,b.length>0)){const pe=B-j,Se=Y-D;for(const Ge of b)Ge.position={x:Ge.position.x-pe+G[0]*(X-z),y:Ge.position.y-Se+G[1]*(Q-H)},I.push(Ge)}if((K||ne)&&(U.width=K&&(!o.resizeDirection||o.resizeDirection==="horizontal")?X:m.width,U.height=ne&&(!o.resizeDirection||o.resizeDirection==="vertical")?Q:m.height,m.width=U.width,m.height=U.height),C&&x.expandParent){const pe=G[0]*(U.width??0);U.x&&U.x<pe&&(m.x=pe,w.x=w.x-(U.x-pe));const Se=G[1]*(U.height??0);U.y&&U.y<Se&&(m.y=Se,w.y=w.y-(U.y-Se))}const se=SN({width:m.width,prevWidth:z,height:m.height,prevHeight:H,affectsX:o.controlDirection.affectsX,affectsY:o.controlDirection.affectsY}),ie={...m,direction:se};(v==null?void 0:v(F,ie))!==!1&&(P=!0,p==null||p(F,ie),n(U,I))}).on("end",F=>{P&&(y==null||y(F,{...m}),s==null||s({...m}),P=!1)});i.call(O)}function l(){i.on(".drag",null)}return{update:a,destroy:l}}var Xw={exports:{}},Yw={},Gw={exports:{}},qw={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ki=T;function NN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ON=typeof Object.is=="function"?Object.is:NN,PN=ki.useState,MN=ki.useEffect,DN=ki.useLayoutEffect,AN=ki.useDebugValue;function FN(t,e){var r=e(),n=PN({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return DN(function(){s.value=r,s.getSnapshot=e,vd(s)&&i({inst:s})},[t,r,e]),MN(function(){return vd(s)&&i({inst:s}),t(function(){vd(s)&&i({inst:s})})},[t]),AN(r),r}function vd(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ON(t,r)}catch{return!0}}function LN(t,e){return e()}var RN=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?LN:FN;qw.useSyncExternalStore=ki.useSyncExternalStore!==void 0?ki.useSyncExternalStore:RN;Gw.exports=qw;var IN=Gw.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fu=T,$N=IN;function zN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var BN=typeof Object.is=="function"?Object.is:zN,WN=$N.useSyncExternalStore,HN=fu.useRef,VN=fu.useEffect,UN=fu.useMemo,XN=fu.useDebugValue;Yw.useSyncExternalStoreWithSelector=function(t,e,r,n,s){var i=HN(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=UN(function(){function l(g){if(!c){if(c=!0,u=g,g=n(g),s!==void 0&&o.hasValue){var p=o.value;if(s(p,g))return d=p}return d=g}if(p=d,BN(u,g))return p;var y=n(g);return s!==void 0&&s(p,y)?(u=g,p):(u=g,d=y)}var c=!1,u,d,h=r===void 0?null:r;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,r,n,s]);var a=WN(t,i[0],i[1]);return VN(function(){o.hasValue=!0,o.value=a},[a]),XN(a),a};Xw.exports=Yw;var YN=Xw.exports;const Kw=jy(YN),GN={},Xm=t=>{let e;const r=new Set,n=(u,d)=>{const h=typeof u=="function"?u(e):u;if(!Object.is(h,e)){const g=e;e=d??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,g))}},s=()=>e,l={setState:n,getState:s,getInitialState:()=>c,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(GN?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=e=t(n,s,l);return l},Qw=t=>t?Xm(t):Xm,{useDebugValue:qN}=vf,{useSyncExternalStoreWithSelector:KN}=Kw,QN=t=>t;function Jw(t,e=QN,r){const n=KN(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return qN(n),n}const Ym=(t,e)=>{const r=Qw(t),n=(s,i=e)=>Jw(r,s,i);return Object.assign(n,r),n},JN=(t,e)=>t?Ym(t,e):Ym;function Ae(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[n,s]of t)if(!Object.is(s,e.get(n)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(e,n)||!Object.is(t[n],e[n]))return!1;return!0}const gu=T.createContext(null),ZN=gu.Provider,Zw=Dr.error001();function ge(t,e){const r=T.useContext(gu);if(r===null)throw new Error(Zw);return Jw(r,t,e)}function Ne(){const t=T.useContext(gu);if(t===null)throw new Error(Zw);return T.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe}),[t])}const Gm={display:"none"},eO={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},eb="react-flow__node-desc",tb="react-flow__edge-desc",tO="react-flow__aria-live",rO=t=>t.ariaLiveMessage,nO=t=>t.ariaLabelConfig;function sO({rfId:t}){const e=ge(rO);return f.jsx("div",{id:`${tO}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:eO,children:e})}function iO({rfId:t,disableKeyboardA11y:e}){const r=ge(nO);return f.jsxs(f.Fragment,{children:[f.jsx("div",{id:`${eb}-${t}`,style:Gm,children:e?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),f.jsx("div",{id:`${tb}-${t}`,style:Gm,children:r["edge.a11yDescription.default"]}),!e&&f.jsx(sO,{rfId:t})]})}const pu=T.forwardRef(({position:t="top-left",children:e,className:r,style:n,...s},i)=>{const o=`${t}`.split("-");return f.jsx("div",{className:He(["react-flow__panel",r,...o]),style:n,ref:i,...s,children:e})});pu.displayName="Panel";function oO({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:f.jsx(pu,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:f.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const aO=t=>{const e=[],r=[];for(const[,n]of t.nodeLookup)n.selected&&e.push(n.internals.userNode);for(const[,n]of t.edgeLookup)n.selected&&r.push(n);return{selectedNodes:e,selectedEdges:r}},Za=t=>t.id;function lO(t,e){return Ae(t.selectedNodes.map(Za),e.selectedNodes.map(Za))&&Ae(t.selectedEdges.map(Za),e.selectedEdges.map(Za))}function cO({onSelectionChange:t}){const e=Ne(),{selectedNodes:r,selectedEdges:n}=ge(aO,lO);return T.useEffect(()=>{const s={nodes:r,edges:n};t==null||t(s),e.getState().onSelectionChangeHandlers.forEach(i=>i(s))},[r,n,t]),null}const uO=t=>!!t.onSelectionChangeHandlers;function dO({onSelectionChange:t}){const e=ge(uO);return t||e?f.jsx(cO,{onSelectionChange:t}):null}const rb=[0,0],hO={x:0,y:0,zoom:1},fO=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],qm=[...fO,"rfId"],gO=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setPaneClickDistance:t.setPaneClickDistance}),Km={translateExtent:Ko,nodeOrigin:rb,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function pO(t){const{setNodes:e,setEdges:r,setMinZoom:n,setMaxZoom:s,setTranslateExtent:i,setNodeExtent:o,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:c}=ge(gO,Ae),u=Ne();T.useEffect(()=>(l(t.defaultNodes,t.defaultEdges),()=>{d.current=Km,a()}),[]);const d=T.useRef(Km);return T.useEffect(()=>{for(const h of qm){const g=t[h],p=d.current[h];g!==p&&(typeof t[h]>"u"||(h==="nodes"?e(g):h==="edges"?r(g):h==="minZoom"?n(g):h==="maxZoom"?s(g):h==="translateExtent"?i(g):h==="nodeExtent"?o(g):h==="paneClickDistance"?c(g):h==="ariaLabelConfig"?u.setState({ariaLabelConfig:zj(g)}):h==="fitView"?u.setState({fitViewQueued:g}):h==="fitViewOptions"?u.setState({fitViewOptions:g}):u.setState({[h]:g})))}d.current=t},qm.map(h=>t[h])),null}function Qm(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function mO(t){var n;const[e,r]=T.useState(t==="system"?null:t);return T.useEffect(()=>{if(t!=="system"){r(t);return}const s=Qm(),i=()=>r(s!=null&&s.matches?"dark":"light");return i(),s==null||s.addEventListener("change",i),()=>{s==null||s.removeEventListener("change",i)}},[t]),e!==null?e:(n=Qm())!=null&&n.matches?"dark":"light"}const Jm=typeof document<"u"?document:null;function ra(t=null,e={target:Jm,actInsideInputWithModifier:!0}){const[r,n]=T.useState(!1),s=T.useRef(!1),i=T.useRef(new Set([])),[o,a]=T.useMemo(()=>{if(t!==null){const c=(Array.isArray(t)?t:[t]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=c.reduce((d,h)=>d.concat(...h),[]);return[c,u]}return[[],[]]},[t]);return T.useEffect(()=>{const l=(e==null?void 0:e.target)??Jm,c=(e==null?void 0:e.actInsideInputWithModifier)??!0;if(t!==null){const u=g=>{var v,m;if(s.current=g.ctrlKey||g.metaKey||g.shiftKey||g.altKey,(!s.current||s.current&&!c)&&Nw(g))return!1;const y=e0(g.code,a);if(i.current.add(g[y]),Zm(o,i.current,!1)){const w=((m=(v=g.composedPath)==null?void 0:v.call(g))==null?void 0:m[0])||g.target,x=(w==null?void 0:w.nodeName)==="BUTTON"||(w==null?void 0:w.nodeName)==="A";e.preventDefault!==!1&&(s.current||!x)&&g.preventDefault(),n(!0)}},d=g=>{const p=e0(g.code,a);Zm(o,i.current,!0)?(n(!1),i.current.clear()):i.current.delete(g[p]),g.key==="Meta"&&i.current.clear(),s.current=!1},h=()=>{i.current.clear(),n(!1)};return l==null||l.addEventListener("keydown",u),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",h),window.addEventListener("contextmenu",h),()=>{l==null||l.removeEventListener("keydown",u),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",h),window.removeEventListener("contextmenu",h)}}},[t,n]),r}function Zm(t,e,r){return t.filter(n=>r||n.length===e.size).some(n=>n.every(s=>e.has(s)))}function e0(t,e){return e.includes(t)?"code":"key"}const yO=()=>{const t=Ne();return T.useMemo(()=>({zoomIn:e=>{const{panZoom:r}=t.getState();return r?r.scaleBy(1.2,{duration:e==null?void 0:e.duration}):Promise.resolve(!1)},zoomOut:e=>{const{panZoom:r}=t.getState();return r?r.scaleBy(1/1.2,{duration:e==null?void 0:e.duration}):Promise.resolve(!1)},zoomTo:(e,r)=>{const{panZoom:n}=t.getState();return n?n.scaleTo(e,{duration:r==null?void 0:r.duration}):Promise.resolve(!1)},getZoom:()=>t.getState().transform[2],setViewport:async(e,r)=>{const{transform:[n,s,i],panZoom:o}=t.getState();return o?(await o.setViewport({x:e.x??n,y:e.y??s,zoom:e.zoom??i},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[e,r,n]=t.getState().transform;return{x:e,y:r,zoom:n}},setCenter:async(e,r,n)=>t.getState().setCenter(e,r,n),fitBounds:async(e,r)=>{const{width:n,height:s,minZoom:i,maxZoom:o,panZoom:a}=t.getState(),l=vg(e,n,s,i,o,(r==null?void 0:r.padding)??.1);return a?(await a.setViewport(l,{duration:r==null?void 0:r.duration,ease:r==null?void 0:r.ease,interpolate:r==null?void 0:r.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(e,r={})=>{const{transform:n,snapGrid:s,snapToGrid:i,domNode:o}=t.getState();if(!o)return e;const{x:a,y:l}=o.getBoundingClientRect(),c={x:e.x-a,y:e.y-l},u=r.snapGrid??s,d=r.snapToGrid??i;return xa(c,n,d,u)},flowToScreenPosition:e=>{const{transform:r,domNode:n}=t.getState();if(!n)return e;const{x:s,y:i}=n.getBoundingClientRect(),o=Ec(e,r);return{x:o.x+s,y:o.y+i}}}),[])};function nb(t,e){const r=[],n=new Map,s=[];for(const i of t)if(i.type==="add"){s.push(i);continue}else if(i.type==="remove"||i.type==="replace")n.set(i.id,[i]);else{const o=n.get(i.id);o?o.push(i):n.set(i.id,[i])}for(const i of e){const o=n.get(i.id);if(!o){r.push(i);continue}if(o[0].type==="remove")continue;if(o[0].type==="replace"){r.push({...o[0].item});continue}const a={...i};for(const l of o)xO(l,a);r.push(a)}return s.length&&s.forEach(i=>{i.index!==void 0?r.splice(i.index,0,{...i.item}):r.push({...i.item})}),r}function xO(t,e){switch(t.type){case"select":{e.selected=t.selected;break}case"position":{typeof t.position<"u"&&(e.position=t.position),typeof t.dragging<"u"&&(e.dragging=t.dragging);break}case"dimensions":{typeof t.dimensions<"u"&&(e.measured??(e.measured={}),e.measured.width=t.dimensions.width,e.measured.height=t.dimensions.height,t.setAttributes&&((t.setAttributes===!0||t.setAttributes==="width")&&(e.width=t.dimensions.width),(t.setAttributes===!0||t.setAttributes==="height")&&(e.height=t.dimensions.height))),typeof t.resizing=="boolean"&&(e.resizing=t.resizing);break}}}function vO(t,e){return nb(t,e)}function wO(t,e){return nb(t,e)}function Un(t,e){return{id:t,type:"select",selected:e}}function Qs(t,e=new Set,r=!1){const n=[];for(const[s,i]of t){const o=e.has(s);!(i.selected===void 0&&!o)&&i.selected!==o&&(r&&(i.selected=o),n.push(Un(i.id,o)))}return n}function t0({items:t=[],lookup:e}){var s;const r=[],n=new Map(t.map(i=>[i.id,i]));for(const[i,o]of t.entries()){const a=e.get(o.id),l=((s=a==null?void 0:a.internals)==null?void 0:s.userNode)??a;l!==void 0&&l!==o&&r.push({id:o.id,item:o,type:"replace"}),l===void 0&&r.push({item:o,type:"add",index:i})}for(const[i]of e)n.get(i)===void 0&&r.push({id:i,type:"remove"});return r}function r0(t){return{id:t.id,type:"remove"}}const n0=t=>Oj(t),bO=t=>bw(t);function sb(t){return T.forwardRef(t)}const _O=typeof window<"u"?T.useLayoutEffect:T.useEffect;function s0(t){const[e,r]=T.useState(BigInt(0)),[n]=T.useState(()=>SO(()=>r(s=>s+BigInt(1))));return _O(()=>{const s=n.get();s.length&&(t(s),n.reset())},[e]),n}function SO(t){let e=[];return{get:()=>e,reset:()=>{e=[]},push:r=>{e.push(r),t()}}}const ib=T.createContext(null);function CO({children:t}){const e=Ne(),r=T.useCallback(a=>{const{nodes:l=[],setNodes:c,hasDefaultNodes:u,onNodesChange:d,nodeLookup:h,fitViewQueued:g}=e.getState();let p=l;for(const v of a)p=typeof v=="function"?v(p):v;const y=t0({items:p,lookup:h});u&&c(p),y.length>0?d==null||d(y):g&&window.requestAnimationFrame(()=>{const{fitViewQueued:v,nodes:m,setNodes:w}=e.getState();v&&w(m)})},[]),n=s0(r),s=T.useCallback(a=>{const{edges:l=[],setEdges:c,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:h}=e.getState();let g=l;for(const p of a)g=typeof p=="function"?p(g):p;u?c(g):d&&d(t0({items:g,lookup:h}))},[]),i=s0(s),o=T.useMemo(()=>({nodeQueue:n,edgeQueue:i}),[]);return f.jsx(ib.Provider,{value:o,children:t})}function kO(){const t=T.useContext(ib);if(!t)throw new Error("useBatchContext must be used within a BatchProvider");return t}const EO=t=>!!t.panZoom;function mu(){const t=yO(),e=Ne(),r=kO(),n=ge(EO),s=T.useMemo(()=>{const i=d=>e.getState().nodeLookup.get(d),o=d=>{r.nodeQueue.push(d)},a=d=>{r.edgeQueue.push(d)},l=d=>{var m,w;const{nodeLookup:h,nodeOrigin:g}=e.getState(),p=n0(d)?d:h.get(d.id),y=p.parentId?Tw(p.position,p.measured,p.parentId,h,g):p.position,v={...p,position:y,width:((m=p.measured)==null?void 0:m.width)??p.width,height:((w=p.measured)==null?void 0:w.height)??p.height};return _i(v)},c=(d,h,g={replace:!1})=>{o(p=>p.map(y=>{if(y.id===d){const v=typeof h=="function"?h(y):h;return g.replace&&n0(v)?v:{...y,...v}}return y}))},u=(d,h,g={replace:!1})=>{a(p=>p.map(y=>{if(y.id===d){const v=typeof h=="function"?h(y):h;return g.replace&&bO(v)?v:{...y,...v}}return y}))};return{getNodes:()=>e.getState().nodes.map(d=>({...d})),getNode:d=>{var h;return(h=i(d))==null?void 0:h.internals.userNode},getInternalNode:i,getEdges:()=>{const{edges:d=[]}=e.getState();return d.map(h=>({...h}))},getEdge:d=>e.getState().edgeLookup.get(d),setNodes:o,setEdges:a,addNodes:d=>{const h=Array.isArray(d)?d:[d];r.nodeQueue.push(g=>[...g,...h])},addEdges:d=>{const h=Array.isArray(d)?d:[d];r.edgeQueue.push(g=>[...g,...h])},toObject:()=>{const{nodes:d=[],edges:h=[],transform:g}=e.getState(),[p,y,v]=g;return{nodes:d.map(m=>({...m})),edges:h.map(m=>({...m})),viewport:{x:p,y,zoom:v}}},deleteElements:async({nodes:d=[],edges:h=[]})=>{const{nodes:g,edges:p,onNodesDelete:y,onEdgesDelete:v,triggerNodeChanges:m,triggerEdgeChanges:w,onDelete:x,onBeforeDelete:_}=e.getState(),{nodes:b,edges:C}=await Fj({nodesToRemove:d,edgesToRemove:h,nodes:g,edges:p,onBeforeDelete:_}),k=C.length>0,S=b.length>0;if(k){const P=C.map(r0);v==null||v(C),w(P)}if(S){const P=b.map(r0);y==null||y(b),m(P)}return(S||k)&&(x==null||x({nodes:b,edges:C})),{deletedNodes:b,deletedEdges:C}},getIntersectingNodes:(d,h=!0,g)=>{const p=Dm(d),y=p?d:l(d),v=g!==void 0;return y?(g||e.getState().nodes).filter(m=>{const w=e.getState().nodeLookup.get(m.id);if(w&&!p&&(m.id===d.id||!w.internals.positionAbsolute))return!1;const x=_i(v?m:w),_=Zo(x,y);return h&&_>0||_>=x.width*x.height||_>=y.width*y.height}):[]},isNodeIntersecting:(d,h,g=!0)=>{const y=Dm(d)?d:l(d);if(!y)return!1;const v=Zo(y,h);return g&&v>0||v>=h.width*h.height||v>=y.width*y.height},updateNode:c,updateNodeData:(d,h,g={replace:!1})=>{c(d,p=>{const y=typeof h=="function"?h(p):h;return g.replace?{...p,data:y}:{...p,data:{...p.data,...y}}},g)},updateEdge:u,updateEdgeData:(d,h,g={replace:!1})=>{u(d,p=>{const y=typeof h=="function"?h(p):h;return g.replace?{...p,data:y}:{...p,data:{...p.data,...y}}},g)},getNodesBounds:d=>{const{nodeLookup:h,nodeOrigin:g}=e.getState();return Pj(d,{nodeLookup:h,nodeOrigin:g})},getHandleConnections:({type:d,id:h,nodeId:g})=>{var p;return Array.from(((p=e.getState().connectionLookup.get(`${g}-${d}${h?`-${h}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:d,handleId:h,nodeId:g})=>{var p;return Array.from(((p=e.getState().connectionLookup.get(`${g}${d?h?`-${d}-${h}`:`-${d}`:""}`))==null?void 0:p.values())??[])},fitView:async d=>{const h=e.getState().fitViewResolver??$j();return e.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:h}),r.nodeQueue.push(g=>[...g]),h.promise}}},[]);return T.useMemo(()=>({...s,...t,viewportInitialized:n}),[n])}const i0=t=>t.selected,TO=typeof window<"u"?window:void 0;function jO({deleteKeyCode:t,multiSelectionKeyCode:e}){const r=Ne(),{deleteElements:n}=mu(),s=ra(t,{actInsideInputWithModifier:!1}),i=ra(e,{target:TO});T.useEffect(()=>{if(s){const{edges:o,nodes:a}=r.getState();n({nodes:a.filter(i0),edges:o.filter(i0)}),r.setState({nodesSelectionActive:!1})}},[s]),T.useEffect(()=>{r.setState({multiSelectionActive:i})},[i])}function NO(t){const e=Ne();T.useEffect(()=>{const r=()=>{var s,i,o,a;if(!t.current||!(((i=(s=t.current).checkVisibility)==null?void 0:i.call(s))??!0))return!1;const n=wg(t.current);(n.height===0||n.width===0)&&((a=(o=e.getState()).onError)==null||a.call(o,"004",Dr.error004())),e.setState({width:n.width||500,height:n.height||500})};if(t.current){r(),window.addEventListener("resize",r);const n=new ResizeObserver(()=>r());return n.observe(t.current),()=>{window.removeEventListener("resize",r),n&&t.current&&n.unobserve(t.current)}}},[])}const yu={position:"absolute",width:"100%",height:"100%",top:0,left:0},OO=t=>({userSelectionActive:t.userSelectionActive,lib:t.lib,connectionInProgress:t.connection.inProgress});function PO({onPaneContextMenu:t,zoomOnScroll:e=!0,zoomOnPinch:r=!0,panOnScroll:n=!1,panOnScrollSpeed:s=.5,panOnScrollMode:i=as.Free,zoomOnDoubleClick:o=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:u,maxZoom:d,zoomActivationKeyCode:h,preventScrolling:g=!0,children:p,noWheelClassName:y,noPanClassName:v,onViewportChange:m,isControlledViewport:w,paneClickDistance:x}){const _=Ne(),b=T.useRef(null),{userSelectionActive:C,lib:k,connectionInProgress:S}=ge(OO,Ae),P=ra(h),O=T.useRef();NO(b);const F=T.useCallback(A=>{m==null||m({x:A[0],y:A[1],zoom:A[2]}),w||_.setState({transform:A})},[m,w]);return T.useEffect(()=>{if(b.current){O.current=_N({domNode:b.current,minZoom:u,maxZoom:d,translateExtent:c,viewport:l,paneClickDistance:x,onDraggingChange:M=>_.setState({paneDragging:M}),onPanZoomStart:(M,N)=>{const{onViewportChangeStart:I,onMoveStart:j}=_.getState();j==null||j(M,N),I==null||I(N)},onPanZoom:(M,N)=>{const{onViewportChange:I,onMove:j}=_.getState();j==null||j(M,N),I==null||I(N)},onPanZoomEnd:(M,N)=>{const{onViewportChangeEnd:I,onMoveEnd:j}=_.getState();j==null||j(M,N),I==null||I(N)}});const{x:A,y:L,zoom:E}=O.current.getViewport();return _.setState({panZoom:O.current,transform:[A,L,E],domNode:b.current.closest(".react-flow")}),()=>{var M;(M=O.current)==null||M.destroy()}}},[]),T.useEffect(()=>{var A;(A=O.current)==null||A.update({onPaneContextMenu:t,zoomOnScroll:e,zoomOnPinch:r,panOnScroll:n,panOnScrollSpeed:s,panOnScrollMode:i,zoomOnDoubleClick:o,panOnDrag:a,zoomActivationKeyPressed:P,preventScrolling:g,noPanClassName:v,userSelectionActive:C,noWheelClassName:y,lib:k,onTransformChange:F,connectionInProgress:S})},[t,e,r,n,s,i,o,a,P,g,v,C,y,k,F,S]),f.jsx("div",{className:"react-flow__renderer",ref:b,style:yu,children:p})}const MO=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function DO(){const{userSelectionActive:t,userSelectionRect:e}=ge(MO,Ae);return t&&e?f.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}const wd=(t,e)=>r=>{r.target===e.current&&(t==null||t(r))},AO=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,connectionInProgress:t.connection.inProgress,dragging:t.paneDragging});function FO({isSelecting:t,selectionKeyPressed:e,selectionMode:r=Qo.Full,panOnDrag:n,selectionOnDrag:s,onSelectionStart:i,onSelectionEnd:o,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:h,children:g}){const p=Ne(),{userSelectionActive:y,elementsSelectable:v,dragging:m,connectionInProgress:w}=ge(AO,Ae),x=v&&(t||y),_=T.useRef(null),b=T.useRef(),C=T.useRef(new Set),k=T.useRef(new Set),S=T.useRef(!1),P=T.useRef(!1),O=j=>{if(S.current||w){S.current=!1;return}a==null||a(j),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},F=j=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){j.preventDefault();return}l==null||l(j)},A=c?j=>c(j):void 0,L=j=>{(s&&_.current===j.target||!s||e)&&j.stopPropagation()},E=j=>{var Q,B;const{resetSelectedElements:D,domNode:z}=p.getState();b.current=z==null?void 0:z.getBoundingClientRect();const H=j.target!==_.current&&!!j.target.closest(".nokey"),U=s&&_.current===j.target||!s||e;if(!v||!t||j.button!==0||!b.current||H||!U||!j.isPrimary)return;j.stopPropagation(),j.preventDefault(),(B=(Q=j.target)==null?void 0:Q.setPointerCapture)==null||B.call(Q,j.pointerId),P.current=!0,S.current=!1;const{x:G,y:X}=lr(j.nativeEvent,b.current);D(),p.setState({userSelectionRect:{width:0,height:0,startX:G,startY:X,x:G,y:X}}),i==null||i(j)},M=j=>{const{userSelectionRect:D,transform:z,nodeLookup:H,edgeLookup:U,connectionLookup:G,triggerNodeChanges:X,triggerEdgeChanges:Q,defaultEdgeOptions:B}=p.getState();if(!b.current||!D)return;S.current=!0;const{x:Y,y:K}=lr(j.nativeEvent,b.current),{startX:ne,startY:oe}=D,ae={startX:ne,startY:oe,x:Y<ne?Y:ne,y:K<oe?K:oe,width:Math.abs(Y-ne),height:Math.abs(K-oe)},se=C.current,ie=k.current;C.current=new Set(xg(H,ae,z,r===Qo.Partial,!0).map(pe=>pe.id)),k.current=new Set;const he=(B==null?void 0:B.selectable)??!0;for(const pe of C.current){const Se=G.get(pe);if(Se)for(const{edgeId:Ge}of Se.values()){const Kt=U.get(Ge);Kt&&(Kt.selectable??he)&&k.current.add(Ge)}}if(!Am(se,C.current)){const pe=Qs(H,C.current,!0);X(pe)}if(!Am(ie,k.current)){const pe=Qs(U,k.current);Q(pe)}p.setState({userSelectionRect:ae,userSelectionActive:!0,nodesSelectionActive:!1})},N=j=>{var z,H;if(j.button!==0||!P.current)return;(H=(z=j.target)==null?void 0:z.releasePointerCapture)==null||H.call(z,j.pointerId);const{userSelectionRect:D}=p.getState();!y&&D&&j.target===_.current&&(O==null||O(j)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:C.current.size>0}),o==null||o(j),(e||s)&&(S.current=!1),P.current=!1},I=n===!0||Array.isArray(n)&&n.includes(0);return f.jsxs("div",{className:He(["react-flow__pane",{draggable:I,dragging:m,selection:t}]),onClick:x?void 0:wd(O,_),onContextMenu:wd(F,_),onWheel:wd(A,_),onPointerEnter:x?void 0:u,onPointerMove:x?M:d,onPointerUp:x?N:void 0,onPointerDownCapture:x?E:void 0,onClickCapture:x?L:void 0,onPointerLeave:h,ref:_,style:yu,children:[g,f.jsx(DO,{})]})}function Gh({id:t,store:e,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:o,nodeLookup:a,onError:l}=e.getState(),c=a.get(t);if(!c){l==null||l("012",Dr.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(r||c.selected&&o)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var u;return(u=n==null?void 0:n.current)==null?void 0:u.blur()})):s([t])}function ob({nodeRef:t,disabled:e=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:i,nodeClickDistance:o}){const a=Ne(),[l,c]=T.useState(!1),u=T.useRef();return T.useEffect(()=>{u.current=lN({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{Gh({id:d,store:a,nodeRef:t})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),T.useEffect(()=>{var d,h;if(e)(d=u.current)==null||d.destroy();else if(t.current)return(h=u.current)==null||h.update({noDragClassName:r,handleSelector:n,domNode:t.current,isSelectable:i,nodeId:s,nodeClickDistance:o}),()=>{var g;(g=u.current)==null||g.destroy()}},[r,n,e,i,t,s]),l}const LO=t=>e=>e.selected&&(e.draggable||t&&typeof e.draggable>"u");function ab(){const t=Ne();return T.useCallback(r=>{const{nodeExtent:n,snapToGrid:s,snapGrid:i,nodesDraggable:o,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:u}=t.getState(),d=new Map,h=LO(o),g=s?i[0]:5,p=s?i[1]:5,y=r.direction.x*g*r.factor,v=r.direction.y*p*r.factor;for(const[,m]of c){if(!h(m))continue;let w={x:m.internals.positionAbsolute.x+y,y:m.internals.positionAbsolute.y+v};s&&(w=ya(w,i));const{position:x,positionAbsolute:_}=_w({nodeId:m.id,nextPosition:w,nodeLookup:c,nodeExtent:n,nodeOrigin:u,onError:a});m.position=x,m.internals.positionAbsolute=_,d.set(m.id,m)}l(d)},[])}const kg=T.createContext(null),RO=kg.Provider;kg.Consumer;const lb=()=>T.useContext(kg),IO=t=>({connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName,rfId:t.rfId}),$O=(t,e,r)=>n=>{const{connectionClickStartHandle:s,connectionMode:i,connection:o}=n,{fromHandle:a,toHandle:l,isValid:c}=o,u=(l==null?void 0:l.nodeId)===t&&(l==null?void 0:l.id)===e&&(l==null?void 0:l.type)===r;return{connectingFrom:(a==null?void 0:a.nodeId)===t&&(a==null?void 0:a.id)===e&&(a==null?void 0:a.type)===r,connectingTo:u,clickConnecting:(s==null?void 0:s.nodeId)===t&&(s==null?void 0:s.id)===e&&(s==null?void 0:s.type)===r,isPossibleEndHandle:i===wi.Strict?(a==null?void 0:a.type)!==r:t!==(a==null?void 0:a.nodeId)||e!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!s,valid:u&&c}};function zO({type:t="source",position:e=re.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:o,onConnect:a,children:l,className:c,onMouseDown:u,onTouchStart:d,...h},g){var M,N;const p=o||null,y=t==="target",v=Ne(),m=lb(),{connectOnClick:w,noPanClassName:x,rfId:_}=ge(IO,Ae),{connectingFrom:b,connectingTo:C,clickConnecting:k,isPossibleEndHandle:S,connectionInProcess:P,clickConnectionInProcess:O,valid:F}=ge($O(m,p,t),Ae);m||(N=(M=v.getState()).onError)==null||N.call(M,"010",Dr.error010());const A=I=>{const{defaultEdgeOptions:j,onConnect:D,hasDefaultEdges:z}=v.getState(),H={...j,...I};if(z){const{edges:U,setEdges:G}=v.getState();G(Xj(H,U))}D==null||D(H),a==null||a(H)},L=I=>{if(!m)return;const j=Ow(I.nativeEvent);if(s&&(j&&I.button===0||!j)){const D=v.getState();Yh.onPointerDown(I.nativeEvent,{handleDomNode:I.currentTarget,autoPanOnConnect:D.autoPanOnConnect,connectionMode:D.connectionMode,connectionRadius:D.connectionRadius,domNode:D.domNode,nodeLookup:D.nodeLookup,lib:D.lib,isTarget:y,handleId:p,nodeId:m,flowId:D.rfId,panBy:D.panBy,cancelConnection:D.cancelConnection,onConnectStart:D.onConnectStart,onConnectEnd:D.onConnectEnd,updateConnection:D.updateConnection,onConnect:A,isValidConnection:r||D.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:D.autoPanSpeed,dragThreshold:D.connectionDragThreshold})}j?u==null||u(I):d==null||d(I)},E=I=>{const{onClickConnectStart:j,onClickConnectEnd:D,connectionClickStartHandle:z,connectionMode:H,isValidConnection:U,lib:G,rfId:X,nodeLookup:Q,connection:B}=v.getState();if(!m||!z&&!s)return;if(!z){j==null||j(I.nativeEvent,{nodeId:m,handleId:p,handleType:t}),v.setState({connectionClickStartHandle:{nodeId:m,type:t,id:p}});return}const Y=jw(I.target),K=r||U,{connection:ne,isValid:oe}=Yh.isValid(I.nativeEvent,{handle:{nodeId:m,id:p,type:t},connectionMode:H,fromNodeId:z.nodeId,fromHandleId:z.id||null,fromType:z.type,isValidConnection:K,flowId:X,doc:Y,lib:G,nodeLookup:Q});oe&&ne&&A(ne);const ae=structuredClone(B);delete ae.inProgress,ae.toPosition=ae.toHandle?ae.toHandle.position:null,D==null||D(I,ae),v.setState({connectionClickStartHandle:null})};return f.jsx("div",{"data-handleid":p,"data-nodeid":m,"data-handlepos":e,"data-id":`${_}-${m}-${p}-${t}`,className:He(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",x,c,{source:!y,target:y,connectable:n,connectablestart:s,connectableend:i,clickconnecting:k,connectingfrom:b,connectingto:C,valid:F,connectionindicator:n&&(!P||S)&&(P||O?i:s)}]),onMouseDown:L,onTouchStart:L,onClick:w?E:void 0,ref:g,...h,children:l})}const qe=T.memo(sb(zO));function BO({data:t,isConnectable:e,sourcePosition:r=re.Bottom}){return f.jsxs(f.Fragment,{children:[t==null?void 0:t.label,f.jsx(qe,{type:"source",position:r,isConnectable:e})]})}function WO({data:t,isConnectable:e,targetPosition:r=re.Top,sourcePosition:n=re.Bottom}){return f.jsxs(f.Fragment,{children:[f.jsx(qe,{type:"target",position:r,isConnectable:e}),t==null?void 0:t.label,f.jsx(qe,{type:"source",position:n,isConnectable:e})]})}function HO(){return null}function VO({data:t,isConnectable:e,targetPosition:r=re.Top}){return f.jsxs(f.Fragment,{children:[f.jsx(qe,{type:"target",position:r,isConnectable:e}),t==null?void 0:t.label]})}const Tc={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},o0={input:BO,default:WO,output:VO,group:HO};function UO(t){var e,r,n,s;return t.internals.handleBounds===void 0?{width:t.width??t.initialWidth??((e=t.style)==null?void 0:e.width),height:t.height??t.initialHeight??((r=t.style)==null?void 0:r.height)}:{width:t.width??((n=t.style)==null?void 0:n.width),height:t.height??((s=t.style)==null?void 0:s.height)}}const XO=t=>{const{width:e,height:r,x:n,y:s}=ma(t.nodeLookup,{filter:i=>!!i.selected});return{width:ar(e)?e:null,height:ar(r)?r:null,userSelectionActive:t.userSelectionActive,transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]}) translate(${n}px,${s}px)`}};function YO({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:r}){const n=Ne(),{width:s,height:i,transformString:o,userSelectionActive:a}=ge(XO,Ae),l=ab(),c=T.useRef(null);if(T.useEffect(()=>{var h;r||(h=c.current)==null||h.focus({preventScroll:!0})},[r]),ob({nodeRef:c}),a||!s||!i)return null;const u=t?h=>{const g=n.getState().nodes.filter(p=>p.selected);t(h,g)}:void 0,d=h=>{Object.prototype.hasOwnProperty.call(Tc,h.key)&&(h.preventDefault(),l({direction:Tc[h.key],factor:h.shiftKey?4:1}))};return f.jsx("div",{className:He(["react-flow__nodesselection","react-flow__container",e]),style:{transform:o},children:f.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:r?void 0:-1,onKeyDown:r?void 0:d,style:{width:s,height:i}})})}const a0=typeof window<"u"?window:void 0,GO=t=>({nodesSelectionActive:t.nodesSelectionActive,userSelectionActive:t.userSelectionActive});function cb({children:t,onPaneClick:e,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:o,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:u,selectionMode:d,onSelectionStart:h,onSelectionEnd:g,multiSelectionKeyCode:p,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:m,zoomOnScroll:w,zoomOnPinch:x,panOnScroll:_,panOnScrollSpeed:b,panOnScrollMode:C,zoomOnDoubleClick:k,panOnDrag:S,defaultViewport:P,translateExtent:O,minZoom:F,maxZoom:A,preventScrolling:L,onSelectionContextMenu:E,noWheelClassName:M,noPanClassName:N,disableKeyboardA11y:I,onViewportChange:j,isControlledViewport:D}){const{nodesSelectionActive:z,userSelectionActive:H}=ge(GO),U=ra(c,{target:a0}),G=ra(y,{target:a0}),X=G||S,Q=G||_,B=u&&X!==!0,Y=U||H||B;return jO({deleteKeyCode:l,multiSelectionKeyCode:p}),f.jsx(PO,{onPaneContextMenu:i,elementsSelectable:m,zoomOnScroll:w,zoomOnPinch:x,panOnScroll:Q,panOnScrollSpeed:b,panOnScrollMode:C,zoomOnDoubleClick:k,panOnDrag:!U&&X,defaultViewport:P,translateExtent:O,minZoom:F,maxZoom:A,zoomActivationKeyCode:v,preventScrolling:L,noWheelClassName:M,noPanClassName:N,onViewportChange:j,isControlledViewport:D,paneClickDistance:a,children:f.jsxs(FO,{onSelectionStart:h,onSelectionEnd:g,onPaneClick:e,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:o,panOnDrag:X,isSelecting:!!Y,selectionMode:d,selectionKeyPressed:U,selectionOnDrag:B,children:[t,z&&f.jsx(YO,{onSelectionContextMenu:E,noPanClassName:N,disableKeyboardA11y:I})]})})}cb.displayName="FlowRenderer";const qO=T.memo(cb),KO=t=>e=>t?xg(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(r=>r.id):Array.from(e.nodeLookup.keys());function QO(t){return ge(T.useCallback(KO(t),[t]),Ae)}const JO=t=>t.updateNodeInternals;function ZO(){const t=ge(JO),[e]=T.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const n=new Map;r.forEach(s=>{const i=s.target.getAttribute("data-id");n.set(i,{id:i,nodeElement:s.target,force:!0})}),t(n)}));return T.useEffect(()=>()=>{e==null||e.disconnect()},[e]),e}function eP({node:t,nodeType:e,hasDimensions:r,resizeObserver:n}){const s=Ne(),i=T.useRef(null),o=T.useRef(null),a=T.useRef(t.sourcePosition),l=T.useRef(t.targetPosition),c=T.useRef(e),u=r&&!!t.internals.handleBounds;return T.useEffect(()=>{i.current&&!t.hidden&&(!u||o.current!==i.current)&&(o.current&&(n==null||n.unobserve(o.current)),n==null||n.observe(i.current),o.current=i.current)},[u,t.hidden]),T.useEffect(()=>()=>{o.current&&(n==null||n.unobserve(o.current),o.current=null)},[]),T.useEffect(()=>{if(i.current){const d=c.current!==e,h=a.current!==t.sourcePosition,g=l.current!==t.targetPosition;(d||h||g)&&(c.current=e,a.current=t.sourcePosition,l.current=t.targetPosition,s.getState().updateNodeInternals(new Map([[t.id,{id:t.id,nodeElement:i.current,force:!0}]])))}},[t.id,e,t.sourcePosition,t.targetPosition]),i}function tP({id:t,onClick:e,onMouseEnter:r,onMouseMove:n,onMouseLeave:s,onContextMenu:i,onDoubleClick:o,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:u,resizeObserver:d,noDragClassName:h,noPanClassName:g,disableKeyboardA11y:p,rfId:y,nodeTypes:v,nodeClickDistance:m,onError:w}){const{node:x,internals:_,isParent:b}=ge(K=>{const ne=K.nodeLookup.get(t),oe=K.parentLookup.has(t);return{node:ne,internals:ne.internals,isParent:oe}},Ae);let C=x.type||"default",k=(v==null?void 0:v[C])||o0[C];k===void 0&&(w==null||w("003",Dr.error003(C)),C="default",k=(v==null?void 0:v.default)||o0.default);const S=!!(x.draggable||a&&typeof x.draggable>"u"),P=!!(x.selectable||l&&typeof x.selectable>"u"),O=!!(x.connectable||c&&typeof x.connectable>"u"),F=!!(x.focusable||u&&typeof x.focusable>"u"),A=Ne(),L=Ew(x),E=eP({node:x,nodeType:C,hasDimensions:L,resizeObserver:d}),M=ob({nodeRef:E,disabled:x.hidden||!S,noDragClassName:h,handleSelector:x.dragHandle,nodeId:t,isSelectable:P,nodeClickDistance:m}),N=ab();if(x.hidden)return null;const I=an(x),j=UO(x),D=P||S||e||r||n||s,z=r?K=>r(K,{..._.userNode}):void 0,H=n?K=>n(K,{..._.userNode}):void 0,U=s?K=>s(K,{..._.userNode}):void 0,G=i?K=>i(K,{..._.userNode}):void 0,X=o?K=>o(K,{..._.userNode}):void 0,Q=K=>{const{selectNodesOnDrag:ne,nodeDragThreshold:oe}=A.getState();P&&(!ne||!S||oe>0)&&Gh({id:t,store:A,nodeRef:E}),e&&e(K,{..._.userNode})},B=K=>{if(!(Nw(K.nativeEvent)||p)){if(yw.includes(K.key)&&P){const ne=K.key==="Escape";Gh({id:t,store:A,unselect:ne,nodeRef:E})}else if(S&&x.selected&&Object.prototype.hasOwnProperty.call(Tc,K.key)){K.preventDefault();const{ariaLabelConfig:ne}=A.getState();A.setState({ariaLiveMessage:ne["node.a11yDescription.ariaLiveMessage"]({direction:K.key.replace("Arrow","").toLowerCase(),x:~~_.positionAbsolute.x,y:~~_.positionAbsolute.y})}),N({direction:Tc[K.key],factor:K.shiftKey?4:1})}}},Y=()=>{var he;if(p||!((he=E.current)!=null&&he.matches(":focus-visible")))return;const{transform:K,width:ne,height:oe,autoPanOnNodeFocus:ae,setCenter:se}=A.getState();if(!ae)return;xg(new Map([[t,x]]),{x:0,y:0,width:ne,height:oe},K,!0).length>0||se(x.position.x+I.width/2,x.position.y+I.height/2,{zoom:K[2]})};return f.jsx("div",{className:He(["react-flow__node",`react-flow__node-${C}`,{[g]:S},x.className,{selected:x.selected,selectable:P,parent:b,draggable:S,dragging:M}]),ref:E,style:{zIndex:_.z,transform:`translate(${_.positionAbsolute.x}px,${_.positionAbsolute.y}px)`,pointerEvents:D?"all":"none",visibility:L?"visible":"hidden",...x.style,...j},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:z,onMouseMove:H,onMouseLeave:U,onContextMenu:G,onClick:Q,onDoubleClick:X,onKeyDown:F?B:void 0,tabIndex:F?0:void 0,onFocus:F?Y:void 0,role:x.ariaRole??(F?"group":void 0),"aria-roledescription":"node","aria-describedby":p?void 0:`${eb}-${y}`,"aria-label":x.ariaLabel,...x.domAttributes,children:f.jsx(RO,{value:t,children:f.jsx(k,{id:t,data:x.data,type:C,positionAbsoluteX:_.positionAbsolute.x,positionAbsoluteY:_.positionAbsolute.y,selected:x.selected??!1,selectable:P,draggable:S,deletable:x.deletable??!0,isConnectable:O,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:M,dragHandle:x.dragHandle,zIndex:_.z,parentId:x.parentId,...I})})})}var rP=T.memo(tP);const nP=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,onError:t.onError});function ub(t){const{nodesDraggable:e,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,onError:i}=ge(nP,Ae),o=QO(t.onlyRenderVisibleElements),a=ZO();return f.jsx("div",{className:"react-flow__nodes",style:yu,children:o.map(l=>f.jsx(rP,{id:l,nodeTypes:t.nodeTypes,nodeExtent:t.nodeExtent,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,resizeObserver:a,nodesDraggable:e,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,nodeClickDistance:t.nodeClickDistance,onError:i},l))})}ub.displayName="NodeRenderer";const sP=T.memo(ub);function iP(t){return ge(T.useCallback(r=>{if(!t)return r.edges.map(s=>s.id);const n=[];if(r.width&&r.height)for(const s of r.edges){const i=r.nodeLookup.get(s.source),o=r.nodeLookup.get(s.target);i&&o&&Hj({sourceNode:i,targetNode:o,width:r.width,height:r.height,transform:r.transform})&&n.push(s.id)}return n},[t]),Ae)}const oP=({color:t="none",strokeWidth:e=1})=>{const r={strokeWidth:e,...t&&{stroke:t}};return f.jsx("polyline",{className:"arrow",style:r,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},aP=({color:t="none",strokeWidth:e=1})=>{const r={strokeWidth:e,...t&&{stroke:t,fill:t}};return f.jsx("polyline",{className:"arrowclosed",style:r,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},l0={[Jo.Arrow]:oP,[Jo.ArrowClosed]:aP};function lP(t){const e=Ne();return T.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(l0,t)?l0[t]:((i=(s=e.getState()).onError)==null||i.call(s,"009",Dr.error009(t)),null)},[t])}const cP=({id:t,type:e,color:r,width:n=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const l=lP(e);return l?f.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:f.jsx(l,{color:r,strokeWidth:o})}):null},db=({defaultColor:t,rfId:e})=>{const r=ge(i=>i.edges),n=ge(i=>i.defaultEdgeOptions),s=T.useMemo(()=>Qj(r,{id:e,defaultColor:t,defaultMarkerStart:n==null?void 0:n.markerStart,defaultMarkerEnd:n==null?void 0:n.markerEnd}),[r,n,e,t]);return s.length?f.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:f.jsx("defs",{children:s.map(i=>f.jsx(cP,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};db.displayName="MarkerDefinitions";var uP=T.memo(db);function hb({x:t,y:e,label:r,labelStyle:n,labelShowBg:s=!0,labelBgStyle:i,labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...u}){const[d,h]=T.useState({x:1,y:0,width:0,height:0}),g=He(["react-flow__edge-textwrapper",c]),p=T.useRef(null);return T.useEffect(()=>{if(p.current){const y=p.current.getBBox();h({x:y.x,y:y.y,width:y.width,height:y.height})}},[r]),r?f.jsxs("g",{transform:`translate(${t-d.width/2} ${e-d.height/2})`,className:g,visibility:d.width?"visible":"hidden",...u,children:[s&&f.jsx("rect",{width:d.width+2*o[0],x:-o[0],y:-o[1],height:d.height+2*o[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),f.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:p,style:n,children:r}),l]}):null}hb.displayName="EdgeText";const dP=T.memo(hb);function xu({path:t,labelX:e,labelY:r,label:n,labelStyle:s,labelShowBg:i,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...u}){return f.jsxs(f.Fragment,{children:[f.jsx("path",{...u,d:t,fill:"none",className:He(["react-flow__edge-path",u.className])}),c?f.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}):null,n&&ar(e)&&ar(r)?f.jsx(dP,{x:e,y:r,label:n,labelStyle:s,labelShowBg:i,labelBgStyle:o,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function c0({pos:t,x1:e,y1:r,x2:n,y2:s}){return t===re.Left||t===re.Right?[.5*(e+n),r]:[e,.5*(r+s)]}function fb({sourceX:t,sourceY:e,sourcePosition:r=re.Bottom,targetX:n,targetY:s,targetPosition:i=re.Top}){const[o,a]=c0({pos:r,x1:t,y1:e,x2:n,y2:s}),[l,c]=c0({pos:i,x1:n,y1:s,x2:t,y2:e}),[u,d,h,g]=Pw({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:o,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${t},${e} C${o},${a} ${l},${c} ${n},${s}`,u,d,h,g]}function gb(t){return T.memo(({id:e,sourceX:r,sourceY:n,targetX:s,targetY:i,sourcePosition:o,targetPosition:a,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:g,style:p,markerEnd:y,markerStart:v,interactionWidth:m})=>{const[w,x,_]=fb({sourceX:r,sourceY:n,sourcePosition:o,targetX:s,targetY:i,targetPosition:a}),b=t.isInternal?void 0:e;return f.jsx(xu,{id:b,path:w,labelX:x,labelY:_,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:g,style:p,markerEnd:y,markerStart:v,interactionWidth:m})})}const hP=gb({isInternal:!1}),pb=gb({isInternal:!0});hP.displayName="SimpleBezierEdge";pb.displayName="SimpleBezierEdgeInternal";function mb(t){return T.memo(({id:e,sourceX:r,sourceY:n,targetX:s,targetY:i,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,sourcePosition:g=re.Bottom,targetPosition:p=re.Top,markerEnd:y,markerStart:v,pathOptions:m,interactionWidth:w})=>{const[x,_,b]=Vh({sourceX:r,sourceY:n,sourcePosition:g,targetX:s,targetY:i,targetPosition:p,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset,stepPosition:m==null?void 0:m.stepPosition}),C=t.isInternal?void 0:e;return f.jsx(xu,{id:C,path:x,labelX:_,labelY:b,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:y,markerStart:v,interactionWidth:w})})}const yb=mb({isInternal:!1}),xb=mb({isInternal:!0});yb.displayName="SmoothStepEdge";xb.displayName="SmoothStepEdgeInternal";function vb(t){return T.memo(({id:e,...r})=>{var s;const n=t.isInternal?void 0:e;return f.jsx(yb,{...r,id:n,pathOptions:T.useMemo(()=>{var i;return{borderRadius:0,offset:(i=r.pathOptions)==null?void 0:i.offset}},[(s=r.pathOptions)==null?void 0:s.offset])})})}const fP=vb({isInternal:!1}),wb=vb({isInternal:!0});fP.displayName="StepEdge";wb.displayName="StepEdgeInternal";function bb(t){return T.memo(({id:e,sourceX:r,sourceY:n,targetX:s,targetY:i,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:g,markerStart:p,interactionWidth:y})=>{const[v,m,w]=Aw({sourceX:r,sourceY:n,targetX:s,targetY:i}),x=t.isInternal?void 0:e;return f.jsx(xu,{id:x,path:v,labelX:m,labelY:w,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:g,markerStart:p,interactionWidth:y})})}const gP=bb({isInternal:!1}),_b=bb({isInternal:!0});gP.displayName="StraightEdge";_b.displayName="StraightEdgeInternal";function Sb(t){return T.memo(({id:e,sourceX:r,sourceY:n,targetX:s,targetY:i,sourcePosition:o=re.Bottom,targetPosition:a=re.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:g,style:p,markerEnd:y,markerStart:v,pathOptions:m,interactionWidth:w})=>{const[x,_,b]=Mw({sourceX:r,sourceY:n,sourcePosition:o,targetX:s,targetY:i,targetPosition:a,curvature:m==null?void 0:m.curvature}),C=t.isInternal?void 0:e;return f.jsx(xu,{id:C,path:x,labelX:_,labelY:b,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:g,style:p,markerEnd:y,markerStart:v,interactionWidth:w})})}const pP=Sb({isInternal:!1}),Cb=Sb({isInternal:!0});pP.displayName="BezierEdge";Cb.displayName="BezierEdgeInternal";const u0={default:Cb,straight:_b,step:wb,smoothstep:xb,simplebezier:pb},d0={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},mP=(t,e,r)=>r===re.Left?t-e:r===re.Right?t+e:t,yP=(t,e,r)=>r===re.Top?t-e:r===re.Bottom?t+e:t,h0="react-flow__edgeupdater";function f0({position:t,centerX:e,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:i,onMouseOut:o,type:a}){return f.jsx("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:o,className:He([h0,`${h0}-${a}`]),cx:mP(e,n,t),cy:yP(r,n,t),r:n,stroke:"transparent",fill:"transparent"})}function xP({isReconnectable:t,reconnectRadius:e,edge:r,sourceX:n,sourceY:s,targetX:i,targetY:o,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:u,onReconnectEnd:d,setReconnecting:h,setUpdateHover:g}){const p=Ne(),y=(_,b)=>{if(_.button!==0)return;const{autoPanOnConnect:C,domNode:k,isValidConnection:S,connectionMode:P,connectionRadius:O,lib:F,onConnectStart:A,onConnectEnd:L,cancelConnection:E,nodeLookup:M,rfId:N,panBy:I,updateConnection:j}=p.getState(),D=b.type==="target",z=(G,X)=>{h(!1),d==null||d(G,r,b.type,X)},H=G=>c==null?void 0:c(r,G),U=(G,X)=>{h(!0),u==null||u(_,r,b.type),A==null||A(G,X)};Yh.onPointerDown(_.nativeEvent,{autoPanOnConnect:C,connectionMode:P,connectionRadius:O,domNode:k,handleId:b.id,nodeId:b.nodeId,nodeLookup:M,isTarget:D,edgeUpdaterType:b.type,lib:F,flowId:N,cancelConnection:E,panBy:I,isValidConnection:S,onConnect:H,onConnectStart:U,onConnectEnd:L,onReconnectEnd:z,updateConnection:j,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle,dragThreshold:p.getState().connectionDragThreshold,handleDomNode:_.currentTarget})},v=_=>y(_,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),m=_=>y(_,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),w=()=>g(!0),x=()=>g(!1);return f.jsxs(f.Fragment,{children:[(t===!0||t==="source")&&f.jsx(f0,{position:a,centerX:n,centerY:s,radius:e,onMouseDown:v,onMouseEnter:w,onMouseOut:x,type:"source"}),(t===!0||t==="target")&&f.jsx(f0,{position:l,centerX:i,centerY:o,radius:e,onMouseDown:m,onMouseEnter:w,onMouseOut:x,type:"target"})]})}function vP({id:t,edgesFocusable:e,edgesReconnectable:r,elementsSelectable:n,onClick:s,onDoubleClick:i,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:u,onReconnect:d,onReconnectStart:h,onReconnectEnd:g,rfId:p,edgeTypes:y,noPanClassName:v,onError:m,disableKeyboardA11y:w}){let x=ge(se=>se.edgeLookup.get(t));const _=ge(se=>se.defaultEdgeOptions);x=_?{..._,...x}:x;let b=x.type||"default",C=(y==null?void 0:y[b])||u0[b];C===void 0&&(m==null||m("011",Dr.error011(b)),b="default",C=(y==null?void 0:y.default)||u0.default);const k=!!(x.focusable||e&&typeof x.focusable>"u"),S=typeof d<"u"&&(x.reconnectable||r&&typeof x.reconnectable>"u"),P=!!(x.selectable||n&&typeof x.selectable>"u"),O=T.useRef(null),[F,A]=T.useState(!1),[L,E]=T.useState(!1),M=Ne(),{zIndex:N,sourceX:I,sourceY:j,targetX:D,targetY:z,sourcePosition:H,targetPosition:U}=ge(T.useCallback(se=>{const ie=se.nodeLookup.get(x.source),he=se.nodeLookup.get(x.target);if(!ie||!he)return{zIndex:x.zIndex,...d0};const pe=Kj({id:t,sourceNode:ie,targetNode:he,sourceHandle:x.sourceHandle||null,targetHandle:x.targetHandle||null,connectionMode:se.connectionMode,onError:m});return{zIndex:Wj({selected:x.selected,zIndex:x.zIndex,sourceNode:ie,targetNode:he,elevateOnSelect:se.elevateEdgesOnSelect}),...pe||d0}},[x.source,x.target,x.sourceHandle,x.targetHandle,x.selected,x.zIndex]),Ae),G=T.useMemo(()=>x.markerStart?`url('#${Uh(x.markerStart,p)}')`:void 0,[x.markerStart,p]),X=T.useMemo(()=>x.markerEnd?`url('#${Uh(x.markerEnd,p)}')`:void 0,[x.markerEnd,p]);if(x.hidden||I===null||j===null||D===null||z===null)return null;const Q=se=>{var Se;const{addSelectedEdges:ie,unselectNodesAndEdges:he,multiSelectionActive:pe}=M.getState();P&&(M.setState({nodesSelectionActive:!1}),x.selected&&pe?(he({nodes:[],edges:[x]}),(Se=O.current)==null||Se.blur()):ie([t])),s&&s(se,x)},B=i?se=>{i(se,{...x})}:void 0,Y=o?se=>{o(se,{...x})}:void 0,K=a?se=>{a(se,{...x})}:void 0,ne=l?se=>{l(se,{...x})}:void 0,oe=c?se=>{c(se,{...x})}:void 0,ae=se=>{var ie;if(!w&&yw.includes(se.key)&&P){const{unselectNodesAndEdges:he,addSelectedEdges:pe}=M.getState();se.key==="Escape"?((ie=O.current)==null||ie.blur(),he({edges:[x]})):pe([t])}};return f.jsx("svg",{style:{zIndex:N},children:f.jsxs("g",{className:He(["react-flow__edge",`react-flow__edge-${b}`,x.className,v,{selected:x.selected,animated:x.animated,inactive:!P&&!s,updating:F,selectable:P}]),onClick:Q,onDoubleClick:B,onContextMenu:Y,onMouseEnter:K,onMouseMove:ne,onMouseLeave:oe,onKeyDown:k?ae:void 0,tabIndex:k?0:void 0,role:x.ariaRole??(k?"group":"img"),"aria-roledescription":"edge","data-id":t,"data-testid":`rf__edge-${t}`,"aria-label":x.ariaLabel===null?void 0:x.ariaLabel||`Edge from ${x.source} to ${x.target}`,"aria-describedby":k?`${tb}-${p}`:void 0,ref:O,...x.domAttributes,children:[!L&&f.jsx(C,{id:t,source:x.source,target:x.target,type:x.type,selected:x.selected,animated:x.animated,selectable:P,deletable:x.deletable??!0,label:x.label,labelStyle:x.labelStyle,labelShowBg:x.labelShowBg,labelBgStyle:x.labelBgStyle,labelBgPadding:x.labelBgPadding,labelBgBorderRadius:x.labelBgBorderRadius,sourceX:I,sourceY:j,targetX:D,targetY:z,sourcePosition:H,targetPosition:U,data:x.data,style:x.style,sourceHandleId:x.sourceHandle,targetHandleId:x.targetHandle,markerStart:G,markerEnd:X,pathOptions:"pathOptions"in x?x.pathOptions:void 0,interactionWidth:x.interactionWidth}),S&&f.jsx(xP,{edge:x,isReconnectable:S,reconnectRadius:u,onReconnect:d,onReconnectStart:h,onReconnectEnd:g,sourceX:I,sourceY:j,targetX:D,targetY:z,sourcePosition:H,targetPosition:U,setUpdateHover:A,setReconnecting:E})]})})}var wP=T.memo(vP);const bP=t=>({edgesFocusable:t.edgesFocusable,edgesReconnectable:t.edgesReconnectable,elementsSelectable:t.elementsSelectable,connectionMode:t.connectionMode,onError:t.onError});function kb({defaultMarkerColor:t,onlyRenderVisibleElements:e,rfId:r,edgeTypes:n,noPanClassName:s,onReconnect:i,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:h,onReconnectStart:g,onReconnectEnd:p,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:m,elementsSelectable:w,onError:x}=ge(bP,Ae),_=iP(e);return f.jsxs("div",{className:"react-flow__edges",children:[f.jsx(uP,{defaultColor:t,rfId:r}),_.map(b=>f.jsx(wP,{id:b,edgesFocusable:v,edgesReconnectable:m,elementsSelectable:w,noPanClassName:s,onReconnect:i,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:u,reconnectRadius:d,onDoubleClick:h,onReconnectStart:g,onReconnectEnd:p,rfId:r,onError:x,edgeTypes:n,disableKeyboardA11y:y},b))]})}kb.displayName="EdgeRenderer";const _P=T.memo(kb),SP=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function CP({children:t}){const e=ge(SP);return f.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:e},children:t})}function kP(t){const e=mu(),r=T.useRef(!1);T.useEffect(()=>{!r.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),r.current=!0)},[t,e.viewportInitialized])}const EP=t=>{var e;return(e=t.panZoom)==null?void 0:e.syncViewport};function TP(t){const e=ge(EP),r=Ne();return T.useEffect(()=>{t&&(e==null||e(t),r.setState({transform:[t.x,t.y,t.zoom]}))},[t,e]),null}function jP(t){return t.connection.inProgress?{...t.connection,to:xa(t.connection.to,t.transform)}:{...t.connection}}function NP(t){return jP}function OP(t){const e=NP();return ge(e,Ae)}const PP=t=>({nodesConnectable:t.nodesConnectable,isValid:t.connection.isValid,inProgress:t.connection.inProgress,width:t.width,height:t.height});function MP({containerStyle:t,style:e,type:r,component:n}){const{nodesConnectable:s,width:i,height:o,isValid:a,inProgress:l}=ge(PP,Ae);return!(i&&s&&l)?null:f.jsx("svg",{style:t,width:i,height:o,className:"react-flow__connectionline react-flow__container",children:f.jsx("g",{className:He(["react-flow__connection",ww(a)]),children:f.jsx(Eb,{style:e,type:r,CustomComponent:n,isValid:a})})})}const Eb=({style:t,type:e=wn.Bezier,CustomComponent:r,isValid:n})=>{const{inProgress:s,from:i,fromNode:o,fromHandle:a,fromPosition:l,to:c,toNode:u,toHandle:d,toPosition:h}=OP();if(!s)return;if(r)return f.jsx(r,{connectionLineType:e,connectionLineStyle:t,fromNode:o,fromHandle:a,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:h,connectionStatus:ww(n),toNode:u,toHandle:d});let g="";const p={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:h};switch(e){case wn.Bezier:[g]=Mw(p);break;case wn.SimpleBezier:[g]=fb(p);break;case wn.Step:[g]=Vh({...p,borderRadius:0});break;case wn.SmoothStep:[g]=Vh(p);break;default:[g]=Aw(p)}return f.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:t})};Eb.displayName="ConnectionLine";const DP={};function g0(t=DP){T.useRef(t),Ne(),T.useEffect(()=>{},[t])}function AP(){Ne(),T.useRef(!1),T.useEffect(()=>{},[])}function Tb({nodeTypes:t,edgeTypes:e,onInit:r,onNodeClick:n,onEdgeClick:s,onNodeDoubleClick:i,onEdgeDoubleClick:o,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:h,onSelectionEnd:g,connectionLineType:p,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:m,selectionKeyCode:w,selectionOnDrag:x,selectionMode:_,multiSelectionKeyCode:b,panActivationKeyCode:C,zoomActivationKeyCode:k,deleteKeyCode:S,onlyRenderVisibleElements:P,elementsSelectable:O,defaultViewport:F,translateExtent:A,minZoom:L,maxZoom:E,preventScrolling:M,defaultMarkerColor:N,zoomOnScroll:I,zoomOnPinch:j,panOnScroll:D,panOnScrollSpeed:z,panOnScrollMode:H,zoomOnDoubleClick:U,panOnDrag:G,onPaneClick:X,onPaneMouseEnter:Q,onPaneMouseMove:B,onPaneMouseLeave:Y,onPaneScroll:K,onPaneContextMenu:ne,paneClickDistance:oe,nodeClickDistance:ae,onEdgeContextMenu:se,onEdgeMouseEnter:ie,onEdgeMouseMove:he,onEdgeMouseLeave:pe,reconnectRadius:Se,onReconnect:Ge,onReconnectStart:Kt,onReconnectEnd:js,noDragClassName:Ns,noWheelClassName:Os,noPanClassName:zn,disableKeyboardA11y:Bn,nodeExtent:Ps,rfId:Wn,viewport:$r,onViewportChange:un}){return g0(t),g0(e),AP(),kP(r),TP($r),f.jsx(qO,{onPaneClick:X,onPaneMouseEnter:Q,onPaneMouseMove:B,onPaneMouseLeave:Y,onPaneContextMenu:ne,onPaneScroll:K,paneClickDistance:oe,deleteKeyCode:S,selectionKeyCode:w,selectionOnDrag:x,selectionMode:_,onSelectionStart:h,onSelectionEnd:g,multiSelectionKeyCode:b,panActivationKeyCode:C,zoomActivationKeyCode:k,elementsSelectable:O,zoomOnScroll:I,zoomOnPinch:j,zoomOnDoubleClick:U,panOnScroll:D,panOnScrollSpeed:z,panOnScrollMode:H,panOnDrag:G,defaultViewport:F,translateExtent:A,minZoom:L,maxZoom:E,onSelectionContextMenu:d,preventScrolling:M,noDragClassName:Ns,noWheelClassName:Os,noPanClassName:zn,disableKeyboardA11y:Bn,onViewportChange:un,isControlledViewport:!!$r,children:f.jsxs(CP,{children:[f.jsx(_P,{edgeTypes:e,onEdgeClick:s,onEdgeDoubleClick:o,onReconnect:Ge,onReconnectStart:Kt,onReconnectEnd:js,onlyRenderVisibleElements:P,onEdgeContextMenu:se,onEdgeMouseEnter:ie,onEdgeMouseMove:he,onEdgeMouseLeave:pe,reconnectRadius:Se,defaultMarkerColor:N,noPanClassName:zn,disableKeyboardA11y:Bn,rfId:Wn}),f.jsx(MP,{style:y,type:p,component:v,containerStyle:m}),f.jsx("div",{className:"react-flow__edgelabel-renderer"}),f.jsx(sP,{nodeTypes:t,onNodeClick:n,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,nodeClickDistance:ae,onlyRenderVisibleElements:P,noPanClassName:zn,noDragClassName:Ns,disableKeyboardA11y:Bn,nodeExtent:Ps,rfId:Wn}),f.jsx("div",{className:"react-flow__viewport-portal"})]})})}Tb.displayName="GraphView";const FP=T.memo(Tb),p0=({nodes:t,edges:e,defaultNodes:r,defaultEdges:n,width:s,height:i,fitView:o,fitViewOptions:a,minZoom:l=.5,maxZoom:c=2,nodeOrigin:u,nodeExtent:d}={})=>{const h=new Map,g=new Map,p=new Map,y=new Map,v=n??e??[],m=r??t??[],w=u??[0,0],x=d??Ko;Rw(p,y,v);const _=Xh(m,h,g,{nodeOrigin:w,nodeExtent:x,elevateNodesOnSelect:!1});let b=[0,0,1];if(o&&s&&i){const C=ma(h,{filter:O=>!!((O.width||O.initialWidth)&&(O.height||O.initialHeight))}),{x:k,y:S,zoom:P}=vg(C,s,i,l,c,(a==null?void 0:a.padding)??.1);b=[k,S,P]}return{rfId:"1",width:s??0,height:i??0,transform:b,nodes:m,nodesInitialized:_,nodeLookup:h,parentLookup:g,edges:v,edgeLookup:y,connectionLookup:p,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:n!==void 0,panZoom:null,minZoom:l,maxZoom:c,translateExtent:Ko,nodeExtent:x,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:wi.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:w,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:o??!1,fitViewOptions:a,fitViewResolver:null,connection:{...vw},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Lj,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:xw}},LP=({nodes:t,edges:e,defaultNodes:r,defaultEdges:n,width:s,height:i,fitView:o,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:u,nodeExtent:d})=>JN((h,g)=>{async function p(){const{nodeLookup:y,panZoom:v,fitViewOptions:m,fitViewResolver:w,width:x,height:_,minZoom:b,maxZoom:C}=g();v&&(await Aj({nodes:y,width:x,height:_,panZoom:v,minZoom:b,maxZoom:C},m),w==null||w.resolve(!0),h({fitViewResolver:null}))}return{...p0({nodes:t,edges:e,width:s,height:i,fitView:o,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:u,nodeExtent:d,defaultNodes:r,defaultEdges:n}),setNodes:y=>{const{nodeLookup:v,parentLookup:m,nodeOrigin:w,elevateNodesOnSelect:x,fitViewQueued:_}=g(),b=Xh(y,v,m,{nodeOrigin:w,nodeExtent:d,elevateNodesOnSelect:x,checkEquality:!0});_&&b?(p(),h({nodes:y,nodesInitialized:b,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:y,nodesInitialized:b})},setEdges:y=>{const{connectionLookup:v,edgeLookup:m}=g();Rw(v,m,y),h({edges:y})},setDefaultNodesAndEdges:(y,v)=>{if(y){const{setNodes:m}=g();m(y),h({hasDefaultNodes:!0})}if(v){const{setEdges:m}=g();m(v),h({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:v,nodeLookup:m,parentLookup:w,domNode:x,nodeOrigin:_,nodeExtent:b,debug:C,fitViewQueued:k}=g(),{changes:S,updatedInternals:P}=sN(y,m,w,x,_,b);P&&(eN(m,w,{nodeOrigin:_,nodeExtent:b}),k?(p(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),(S==null?void 0:S.length)>0&&(C&&console.log("React Flow: trigger node changes",S),v==null||v(S)))},updateNodePositions:(y,v=!1)=>{const m=[],w=[],{nodeLookup:x,triggerNodeChanges:_}=g();for(const[b,C]of y){const k=x.get(b),S=!!(k!=null&&k.expandParent&&(k!=null&&k.parentId)&&(C!=null&&C.position)),P={id:b,type:"position",position:S?{x:Math.max(0,C.position.x),y:Math.max(0,C.position.y)}:C.position,dragging:v};S&&k.parentId&&m.push({id:b,parentId:k.parentId,rect:{...C.internals.positionAbsolute,width:C.measured.width??0,height:C.measured.height??0}}),w.push(P)}if(m.length>0){const{parentLookup:b,nodeOrigin:C}=g(),k=Cg(m,x,b,C);w.push(...k)}_(w)},triggerNodeChanges:y=>{const{onNodesChange:v,setNodes:m,nodes:w,hasDefaultNodes:x,debug:_}=g();if(y!=null&&y.length){if(x){const b=vO(y,w);m(b)}_&&console.log("React Flow: trigger node changes",y),v==null||v(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:v,setEdges:m,edges:w,hasDefaultEdges:x,debug:_}=g();if(y!=null&&y.length){if(x){const b=wO(y,w);m(b)}_&&console.log("React Flow: trigger edge changes",y),v==null||v(y)}},addSelectedNodes:y=>{const{multiSelectionActive:v,edgeLookup:m,nodeLookup:w,triggerNodeChanges:x,triggerEdgeChanges:_}=g();if(v){const b=y.map(C=>Un(C,!0));x(b);return}x(Qs(w,new Set([...y]),!0)),_(Qs(m))},addSelectedEdges:y=>{const{multiSelectionActive:v,edgeLookup:m,nodeLookup:w,triggerNodeChanges:x,triggerEdgeChanges:_}=g();if(v){const b=y.map(C=>Un(C,!0));_(b);return}_(Qs(m,new Set([...y]))),x(Qs(w,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:v}={})=>{const{edges:m,nodes:w,nodeLookup:x,triggerNodeChanges:_,triggerEdgeChanges:b}=g(),C=y||w,k=v||m,S=C.map(O=>{const F=x.get(O.id);return F&&(F.selected=!1),Un(O.id,!1)}),P=k.map(O=>Un(O.id,!1));_(S),b(P)},setMinZoom:y=>{const{panZoom:v,maxZoom:m}=g();v==null||v.setScaleExtent([y,m]),h({minZoom:y})},setMaxZoom:y=>{const{panZoom:v,minZoom:m}=g();v==null||v.setScaleExtent([m,y]),h({maxZoom:y})},setTranslateExtent:y=>{var v;(v=g().panZoom)==null||v.setTranslateExtent(y),h({translateExtent:y})},setPaneClickDistance:y=>{var v;(v=g().panZoom)==null||v.setClickDistance(y)},resetSelectedElements:()=>{const{edges:y,nodes:v,triggerNodeChanges:m,triggerEdgeChanges:w,elementsSelectable:x}=g();if(!x)return;const _=v.reduce((C,k)=>k.selected?[...C,Un(k.id,!1)]:C,[]),b=y.reduce((C,k)=>k.selected?[...C,Un(k.id,!1)]:C,[]);m(_),w(b)},setNodeExtent:y=>{const{nodes:v,nodeLookup:m,parentLookup:w,nodeOrigin:x,elevateNodesOnSelect:_,nodeExtent:b}=g();y[0][0]===b[0][0]&&y[0][1]===b[0][1]&&y[1][0]===b[1][0]&&y[1][1]===b[1][1]||(Xh(v,m,w,{nodeOrigin:x,nodeExtent:y,elevateNodesOnSelect:_,checkEquality:!1}),h({nodeExtent:y}))},panBy:y=>{const{transform:v,width:m,height:w,panZoom:x,translateExtent:_}=g();return iN({delta:y,panZoom:x,transform:v,translateExtent:_,width:m,height:w})},setCenter:async(y,v,m)=>{const{width:w,height:x,maxZoom:_,panZoom:b}=g();if(!b)return Promise.resolve(!1);const C=typeof(m==null?void 0:m.zoom)<"u"?m.zoom:_;return await b.setViewport({x:w/2-y*C,y:x/2-v*C,zoom:C},{duration:m==null?void 0:m.duration,ease:m==null?void 0:m.ease,interpolate:m==null?void 0:m.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{h({connection:{...vw}})},updateConnection:y=>{h({connection:y})},reset:()=>h({...p0()})}},Object.is);function jb({initialNodes:t,initialEdges:e,defaultNodes:r,defaultEdges:n,initialWidth:s,initialHeight:i,initialMinZoom:o,initialMaxZoom:a,initialFitViewOptions:l,fitView:c,nodeOrigin:u,nodeExtent:d,children:h}){const[g]=T.useState(()=>LP({nodes:t,edges:e,defaultNodes:r,defaultEdges:n,width:s,height:i,fitView:c,minZoom:o,maxZoom:a,fitViewOptions:l,nodeOrigin:u,nodeExtent:d}));return f.jsx(ZN,{value:g,children:f.jsx(CO,{children:h})})}function RP({children:t,nodes:e,edges:r,defaultNodes:n,defaultEdges:s,width:i,height:o,fitView:a,fitViewOptions:l,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:h}){return T.useContext(gu)?f.jsx(f.Fragment,{children:t}):f.jsx(jb,{initialNodes:e,initialEdges:r,defaultNodes:n,defaultEdges:s,initialWidth:i,initialHeight:o,fitView:a,initialFitViewOptions:l,initialMinZoom:c,initialMaxZoom:u,nodeOrigin:d,nodeExtent:h,children:t})}const IP={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function $P({nodes:t,edges:e,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:i,edgeTypes:o,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:u,onMoveStart:d,onMoveEnd:h,onConnect:g,onConnectStart:p,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:m,onNodeMouseEnter:w,onNodeMouseMove:x,onNodeMouseLeave:_,onNodeContextMenu:b,onNodeDoubleClick:C,onNodeDragStart:k,onNodeDrag:S,onNodeDragStop:P,onNodesDelete:O,onEdgesDelete:F,onDelete:A,onSelectionChange:L,onSelectionDragStart:E,onSelectionDrag:M,onSelectionDragStop:N,onSelectionContextMenu:I,onSelectionStart:j,onSelectionEnd:D,onBeforeDelete:z,connectionMode:H,connectionLineType:U=wn.Bezier,connectionLineStyle:G,connectionLineComponent:X,connectionLineContainerStyle:Q,deleteKeyCode:B="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:K=!1,selectionMode:ne=Qo.Full,panActivationKeyCode:oe="Space",multiSelectionKeyCode:ae=ea()?"Meta":"Control",zoomActivationKeyCode:se=ea()?"Meta":"Control",snapToGrid:ie,snapGrid:he,onlyRenderVisibleElements:pe=!1,selectNodesOnDrag:Se,nodesDraggable:Ge,autoPanOnNodeFocus:Kt,nodesConnectable:js,nodesFocusable:Ns,nodeOrigin:Os=rb,edgesFocusable:zn,edgesReconnectable:Bn,elementsSelectable:Ps=!0,defaultViewport:Wn=hO,minZoom:$r=.5,maxZoom:un=2,translateExtent:J=Ko,preventScrolling:Z=!0,nodeExtent:le,defaultMarkerColor:me="#b1b1b7",zoomOnScroll:Qt=!0,zoomOnPinch:Ms=!0,panOnScroll:xr=!1,panOnScrollSpeed:Ru=.5,panOnScrollMode:Wi=as.Free,zoomOnDoubleClick:Iu=!0,panOnDrag:N_=!0,onPaneClick:O_,onPaneMouseEnter:P_,onPaneMouseMove:M_,onPaneMouseLeave:D_,onPaneScroll:A_,onPaneContextMenu:F_,paneClickDistance:Jg=0,nodeClickDistance:L_=0,children:R_,onReconnect:I_,onReconnectStart:$_,onReconnectEnd:z_,onEdgeContextMenu:B_,onEdgeDoubleClick:W_,onEdgeMouseEnter:H_,onEdgeMouseMove:V_,onEdgeMouseLeave:U_,reconnectRadius:X_=10,onNodesChange:Y_,onEdgesChange:G_,noDragClassName:q_="nodrag",noWheelClassName:K_="nowheel",noPanClassName:Zg="nopan",fitView:ep,fitViewOptions:tp,connectOnClick:Q_,attributionPosition:J_,proOptions:Z_,defaultEdgeOptions:eS,elevateNodesOnSelect:tS,elevateEdgesOnSelect:rS,disableKeyboardA11y:rp=!1,autoPanOnConnect:nS,autoPanOnNodeDrag:sS,autoPanSpeed:iS,connectionRadius:oS,isValidConnection:aS,onError:lS,style:cS,id:np,nodeDragThreshold:uS,connectionDragThreshold:dS,viewport:hS,onViewportChange:fS,width:gS,height:pS,colorMode:mS="light",debug:yS,onScroll:ja,ariaLabelConfig:xS,...vS},wS){const $u=np||"1",bS=mO(mS),_S=T.useCallback(sp=>{sp.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),ja==null||ja(sp)},[ja]);return f.jsx("div",{"data-testid":"rf__wrapper",...vS,onScroll:_S,style:{...cS,...IP},ref:wS,className:He(["react-flow",s,bS]),id:np,role:"application",children:f.jsxs(RP,{nodes:t,edges:e,width:gS,height:pS,fitView:ep,fitViewOptions:tp,minZoom:$r,maxZoom:un,nodeOrigin:Os,nodeExtent:le,children:[f.jsx(FP,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:x,onNodeMouseLeave:_,onNodeContextMenu:b,onNodeDoubleClick:C,nodeTypes:i,edgeTypes:o,connectionLineType:U,connectionLineStyle:G,connectionLineComponent:X,connectionLineContainerStyle:Q,selectionKeyCode:Y,selectionOnDrag:K,selectionMode:ne,deleteKeyCode:B,multiSelectionKeyCode:ae,panActivationKeyCode:oe,zoomActivationKeyCode:se,onlyRenderVisibleElements:pe,defaultViewport:Wn,translateExtent:J,minZoom:$r,maxZoom:un,preventScrolling:Z,zoomOnScroll:Qt,zoomOnPinch:Ms,zoomOnDoubleClick:Iu,panOnScroll:xr,panOnScrollSpeed:Ru,panOnScrollMode:Wi,panOnDrag:N_,onPaneClick:O_,onPaneMouseEnter:P_,onPaneMouseMove:M_,onPaneMouseLeave:D_,onPaneScroll:A_,onPaneContextMenu:F_,paneClickDistance:Jg,nodeClickDistance:L_,onSelectionContextMenu:I,onSelectionStart:j,onSelectionEnd:D,onReconnect:I_,onReconnectStart:$_,onReconnectEnd:z_,onEdgeContextMenu:B_,onEdgeDoubleClick:W_,onEdgeMouseEnter:H_,onEdgeMouseMove:V_,onEdgeMouseLeave:U_,reconnectRadius:X_,defaultMarkerColor:me,noDragClassName:q_,noWheelClassName:K_,noPanClassName:Zg,rfId:$u,disableKeyboardA11y:rp,nodeExtent:le,viewport:hS,onViewportChange:fS}),f.jsx(pO,{nodes:t,edges:e,defaultNodes:r,defaultEdges:n,onConnect:g,onConnectStart:p,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:m,nodesDraggable:Ge,autoPanOnNodeFocus:Kt,nodesConnectable:js,nodesFocusable:Ns,edgesFocusable:zn,edgesReconnectable:Bn,elementsSelectable:Ps,elevateNodesOnSelect:tS,elevateEdgesOnSelect:rS,minZoom:$r,maxZoom:un,nodeExtent:le,onNodesChange:Y_,onEdgesChange:G_,snapToGrid:ie,snapGrid:he,connectionMode:H,translateExtent:J,connectOnClick:Q_,defaultEdgeOptions:eS,fitView:ep,fitViewOptions:tp,onNodesDelete:O,onEdgesDelete:F,onDelete:A,onNodeDragStart:k,onNodeDrag:S,onNodeDragStop:P,onSelectionDrag:M,onSelectionDragStart:E,onSelectionDragStop:N,onMove:u,onMoveStart:d,onMoveEnd:h,noPanClassName:Zg,nodeOrigin:Os,rfId:$u,autoPanOnConnect:nS,autoPanOnNodeDrag:sS,autoPanSpeed:iS,onError:lS,connectionRadius:oS,isValidConnection:aS,selectNodesOnDrag:Se,nodeDragThreshold:uS,connectionDragThreshold:dS,onBeforeDelete:z,paneClickDistance:Jg,debug:yS,ariaLabelConfig:xS}),f.jsx(dO,{onSelectionChange:L}),R_,f.jsx(oO,{proOptions:Z_,position:J_}),f.jsx(iO,{rfId:$u,disableKeyboardA11y:rp})]})})}var zP=sb($P);function BP({dimensions:t,lineWidth:e,variant:r,className:n}){return f.jsx("path",{strokeWidth:e,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`,className:He(["react-flow__background-pattern",r,n])})}function WP({radius:t,className:e}){return f.jsx("circle",{cx:t,cy:t,r:t,className:He(["react-flow__background-pattern","dots",e])})}var Qr;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(Qr||(Qr={}));const HP={[Qr.Dots]:1,[Qr.Lines]:1,[Qr.Cross]:6},VP=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Nb({id:t,variant:e=Qr.Dots,gap:r=20,size:n,lineWidth:s=1,offset:i=0,color:o,bgColor:a,style:l,className:c,patternClassName:u}){const d=T.useRef(null),{transform:h,patternId:g}=ge(VP,Ae),p=n||HP[e],y=e===Qr.Dots,v=e===Qr.Cross,m=Array.isArray(r)?r:[r,r],w=[m[0]*h[2]||1,m[1]*h[2]||1],x=p*h[2],_=Array.isArray(i)?i:[i,i],b=v?[x,x]:w,C=[_[0]*h[2]||1+b[0]/2,_[1]*h[2]||1+b[1]/2],k=`${g}${t||""}`;return f.jsxs("svg",{className:He(["react-flow__background",c]),style:{...l,...yu,"--xy-background-color-props":a,"--xy-background-pattern-color-props":o},ref:d,"data-testid":"rf__background",children:[f.jsx("pattern",{id:k,x:h[0]%w[0],y:h[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`,children:y?f.jsx(WP,{radius:x/2,className:u}):f.jsx(BP,{dimensions:b,lineWidth:s,variant:e,className:u})}),f.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${k})`})]})}Nb.displayName="Background";const UP=T.memo(Nb);function XP(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:f.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function YP(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:f.jsx("path",{d:"M0 0h32v4.2H0z"})})}function GP(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:f.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function qP(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:f.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function KP(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:f.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function el({children:t,className:e,...r}){return f.jsx("button",{type:"button",className:He(["react-flow__controls-button",e]),...r,children:t})}const QP=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom,ariaLabelConfig:t.ariaLabelConfig});function Ob({style:t,showZoom:e=!0,showFitView:r=!0,showInteractive:n=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:o,onFitView:a,onInteractiveChange:l,className:c,children:u,position:d="bottom-left",orientation:h="vertical","aria-label":g}){const p=Ne(),{isInteractive:y,minZoomReached:v,maxZoomReached:m,ariaLabelConfig:w}=ge(QP,Ae),{zoomIn:x,zoomOut:_,fitView:b}=mu(),C=()=>{x(),i==null||i()},k=()=>{_(),o==null||o()},S=()=>{b(s),a==null||a()},P=()=>{p.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),l==null||l(!y)},O=h==="horizontal"?"horizontal":"vertical";return f.jsxs(pu,{className:He(["react-flow__controls",O,c]),position:d,style:t,"data-testid":"rf__controls","aria-label":g??w["controls.ariaLabel"],children:[e&&f.jsxs(f.Fragment,{children:[f.jsx(el,{onClick:C,className:"react-flow__controls-zoomin",title:w["controls.zoomIn.ariaLabel"],"aria-label":w["controls.zoomIn.ariaLabel"],disabled:m,children:f.jsx(XP,{})}),f.jsx(el,{onClick:k,className:"react-flow__controls-zoomout",title:w["controls.zoomOut.ariaLabel"],"aria-label":w["controls.zoomOut.ariaLabel"],disabled:v,children:f.jsx(YP,{})})]}),r&&f.jsx(el,{className:"react-flow__controls-fitview",onClick:S,title:w["controls.fitView.ariaLabel"],"aria-label":w["controls.fitView.ariaLabel"],children:f.jsx(GP,{})}),n&&f.jsx(el,{className:"react-flow__controls-interactive",onClick:P,title:w["controls.interactive.ariaLabel"],"aria-label":w["controls.interactive.ariaLabel"],children:y?f.jsx(KP,{}):f.jsx(qP,{})}),u]})}Ob.displayName="Controls";const JP=T.memo(Ob);function ZP({id:t,x:e,y:r,width:n,height:s,style:i,color:o,strokeColor:a,strokeWidth:l,className:c,borderRadius:u,shapeRendering:d,selected:h,onClick:g}){const{background:p,backgroundColor:y}=i||{},v=o||p||y;return f.jsx("rect",{className:He(["react-flow__minimap-node",{selected:h},c]),x:e,y:r,rx:u,ry:u,width:n,height:s,style:{fill:v,stroke:a,strokeWidth:l},shapeRendering:d,onClick:g?m=>g(m,t):void 0})}const eM=T.memo(ZP),tM=t=>t.nodes.map(e=>e.id),bd=t=>t instanceof Function?t:()=>t;function rM({nodeStrokeColor:t,nodeColor:e,nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:s,nodeComponent:i=eM,onClick:o}){const a=ge(tM,Ae),l=bd(e),c=bd(t),u=bd(r),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return f.jsx(f.Fragment,{children:a.map(h=>f.jsx(sM,{id:h,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:u,nodeBorderRadius:n,nodeStrokeWidth:s,NodeComponent:i,onClick:o,shapeRendering:d},h))})}function nM({id:t,nodeColorFunc:e,nodeStrokeColorFunc:r,nodeClassNameFunc:n,nodeBorderRadius:s,nodeStrokeWidth:i,shapeRendering:o,NodeComponent:a,onClick:l}){const{node:c,x:u,y:d,width:h,height:g}=ge(p=>{const{internals:y}=p.nodeLookup.get(t),v=y.userNode,{x:m,y:w}=y.positionAbsolute,{width:x,height:_}=an(v);return{node:v,x:m,y:w,width:x,height:_}},Ae);return!c||c.hidden||!Ew(c)?null:f.jsx(a,{x:u,y:d,width:h,height:g,style:c.style,selected:!!c.selected,className:n(c),color:e(c),borderRadius:s,strokeColor:r(c),strokeWidth:i,shapeRendering:o,onClick:l,id:c.id})}const sM=T.memo(nM);var iM=T.memo(rM);const oM=200,aM=150,lM=t=>!t.hidden,cM=t=>{const e={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:e,boundingRect:t.nodeLookup.size>0?kw(ma(t.nodeLookup,{filter:lM}),e):e,rfId:t.rfId,panZoom:t.panZoom,translateExtent:t.translateExtent,flowWidth:t.width,flowHeight:t.height,ariaLabelConfig:t.ariaLabelConfig}},uM="react-flow__minimap-desc";function Pb({style:t,className:e,nodeStrokeColor:r,nodeColor:n,nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:o,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:u,maskStrokeWidth:d,position:h="bottom-right",onClick:g,onNodeClick:p,pannable:y=!1,zoomable:v=!1,ariaLabel:m,inversePan:w,zoomStep:x=1,offsetScale:_=5}){const b=Ne(),C=T.useRef(null),{boundingRect:k,viewBB:S,rfId:P,panZoom:O,translateExtent:F,flowWidth:A,flowHeight:L,ariaLabelConfig:E}=ge(cM,Ae),M=(t==null?void 0:t.width)??oM,N=(t==null?void 0:t.height)??aM,I=k.width/M,j=k.height/N,D=Math.max(I,j),z=D*M,H=D*N,U=_*D,G=k.x-(z-k.width)/2-U,X=k.y-(H-k.height)/2-U,Q=z+U*2,B=H+U*2,Y=`${uM}-${P}`,K=T.useRef(0),ne=T.useRef();K.current=D,T.useEffect(()=>{if(C.current&&O)return ne.current=gN({domNode:C.current,panZoom:O,getTransform:()=>b.getState().transform,getViewScale:()=>K.current}),()=>{var ie;(ie=ne.current)==null||ie.destroy()}},[O]),T.useEffect(()=>{var ie;(ie=ne.current)==null||ie.update({translateExtent:F,width:A,height:L,inversePan:w,pannable:y,zoomStep:x,zoomable:v})},[y,v,w,x,F,A,L]);const oe=g?ie=>{var Se;const[he,pe]=((Se=ne.current)==null?void 0:Se.pointer(ie))||[0,0];g(ie,{x:he,y:pe})}:void 0,ae=p?T.useCallback((ie,he)=>{const pe=b.getState().nodeLookup.get(he).internals.userNode;p(ie,pe)},[]):void 0,se=m??E["minimap.ariaLabel"];return f.jsx(pu,{position:h,style:{...t,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*D:void 0,"--xy-minimap-node-background-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof o=="number"?o:void 0},className:He(["react-flow__minimap",e]),"data-testid":"rf__minimap",children:f.jsxs("svg",{width:M,height:N,viewBox:`${G} ${X} ${Q} ${B}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:C,onClick:oe,children:[se&&f.jsx("title",{id:Y,children:se}),f.jsx(iM,{onClick:ae,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:o,nodeComponent:a}),f.jsx("path",{className:"react-flow__minimap-mask",d:`M${G-U},${X-U}h${Q+U*2}v${B+U*2}h${-Q-U*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Pb.displayName="MiniMap";const dM=T.memo(Pb),hM=t=>e=>t?`${Math.max(1/e.transform[2],1)}`:void 0,fM={[Ci.Line]:"right",[Ci.Handle]:"bottom-right"};function gM({nodeId:t,position:e,variant:r=Ci.Handle,className:n,style:s=void 0,children:i,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:h,autoScale:g=!0,shouldResize:p,onResizeStart:y,onResize:v,onResizeEnd:m}){const w=lb(),x=typeof t=="string"?t:w,_=Ne(),b=T.useRef(null),C=r===Ci.Handle,k=ge(T.useCallback(hM(C&&g),[C,g]),Ae),S=T.useRef(null),P=e??fM[r];T.useEffect(()=>{if(!(!b.current||!x))return S.current||(S.current=jN({domNode:b.current,nodeId:x,getStoreItems:()=>{const{nodeLookup:F,transform:A,snapGrid:L,snapToGrid:E,nodeOrigin:M,domNode:N}=_.getState();return{nodeLookup:F,transform:A,snapGrid:L,snapToGrid:E,nodeOrigin:M,paneDomNode:N}},onChange:(F,A)=>{const{triggerNodeChanges:L,nodeLookup:E,parentLookup:M,nodeOrigin:N}=_.getState(),I=[],j={x:F.x,y:F.y},D=E.get(x);if(D&&D.expandParent&&D.parentId){const z=D.origin??N,H=F.width??D.measured.width??0,U=F.height??D.measured.height??0,G={id:D.id,parentId:D.parentId,rect:{width:H,height:U,...Tw({x:F.x??D.position.x,y:F.y??D.position.y},{width:H,height:U},D.parentId,E,z)}},X=Cg([G],E,M,N);I.push(...X),j.x=F.x?Math.max(z[0]*H,F.x):void 0,j.y=F.y?Math.max(z[1]*U,F.y):void 0}if(j.x!==void 0&&j.y!==void 0){const z={id:x,type:"position",position:{...j}};I.push(z)}if(F.width!==void 0&&F.height!==void 0){const H={id:x,type:"dimensions",resizing:!0,setAttributes:h?h==="horizontal"?"width":"height":!0,dimensions:{width:F.width,height:F.height}};I.push(H)}for(const z of A){const H={...z,type:"position"};I.push(H)}L(I)},onEnd:({width:F,height:A})=>{const L={id:x,type:"dimensions",resizing:!1,dimensions:{width:F,height:A}};_.getState().triggerNodeChanges([L])}})),S.current.update({controlPosition:P,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:u},keepAspectRatio:d,resizeDirection:h,onResizeStart:y,onResize:v,onResizeEnd:m,shouldResize:p}),()=>{var F;(F=S.current)==null||F.destroy()}},[P,a,l,c,u,d,y,v,m,p]);const O=P.split("-");return f.jsx("div",{className:He(["react-flow__resize-control","nodrag",...O,r,n]),ref:b,style:{...s,scale:k,...o&&{[C?"backgroundColor":"borderColor"]:o}},children:i})}T.memo(gM);const Mb={},{useDebugValue:pM}=vf,{useSyncExternalStoreWithSelector:mM}=Kw;let m0=!1;const yM=t=>t;function xM(t,e=yM,r){(Mb?"production":void 0)!=="production"&&r&&!m0&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),m0=!0);const n=mM(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return pM(n),n}const y0=t=>{(Mb?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?Qw(t):t,r=(n,s)=>xM(e,n,s);return Object.assign(r,e),r},Eg=t=>t?y0(t):y0,vM={};function wM(t,e){let r;try{r=t()}catch{return}return{getItem:s=>{var i;const o=l=>l===null?null:JSON.parse(l,void 0),a=(i=r.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>r.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>r.removeItem(s)}}const na=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return na(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return na(n)(r)}}}},bM=(t,e)=>(r,n,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,m)=>({...m,...v}),...e},o=!1;const a=new Set,l=new Set;let c;try{c=i.getStorage()}catch{}if(!c)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...v)},n,s);const u=na(i.serialize),d=()=>{const v=i.partialize({...n()});let m;const w=u({state:v,version:i.version}).then(x=>c.setItem(i.name,x)).catch(x=>{m=x});if(m)throw m;return w},h=s.setState;s.setState=(v,m)=>{h(v,m),d()};const g=t((...v)=>{r(...v),d()},n,s);let p;const y=()=>{var v;if(!c)return;o=!1,a.forEach(w=>w(n()));const m=((v=i.onRehydrateStorage)==null?void 0:v.call(i,n()))||void 0;return na(c.getItem.bind(c))(i.name).then(w=>{if(w)return i.deserialize(w)}).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate)return i.migrate(w.state,w.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return w.state}).then(w=>{var x;return p=i.merge(w,(x=n())!=null?x:g),r(p,!0),d()}).then(()=>{m==null||m(p,void 0),o=!0,l.forEach(w=>w(p))}).catch(w=>{m==null||m(void 0,w)})};return s.persist={setOptions:v=>{i={...i,...v},v.getStorage&&(c=v.getStorage())},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:v=>(a.add(v),()=>{a.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},y(),p||g},_M=(t,e)=>(r,n,s)=>{let i={storage:wM(()=>localStorage),partialize:y=>y,version:0,merge:(y,v)=>({...v,...y}),...e},o=!1;const a=new Set,l=new Set;let c=i.storage;if(!c)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...y)},n,s);const u=()=>{const y=i.partialize({...n()});return c.setItem(i.name,{state:y,version:i.version})},d=s.setState;s.setState=(y,v)=>{d(y,v),u()};const h=t((...y)=>{r(...y),u()},n,s);s.getInitialState=()=>h;let g;const p=()=>{var y,v;if(!c)return;o=!1,a.forEach(w=>{var x;return w((x=n())!=null?x:h)});const m=((v=i.onRehydrateStorage)==null?void 0:v.call(i,(y=n())!=null?y:h))||void 0;return na(c.getItem.bind(c))(i.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate)return[!0,i.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var x;const[_,b]=w;if(g=i.merge(b,(x=n())!=null?x:h),r(g,!0),_)return u()}).then(()=>{m==null||m(g,void 0),g=n(),o=!0,l.forEach(w=>w(g))}).catch(w=>{m==null||m(void 0,w)})};return s.persist={setOptions:y=>{i={...i,...y},y.storage&&(c=y.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:y=>(a.add(y),()=>{a.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},i.skipHydration||p(),g||h},SM=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((vM?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),bM(t,e)):_M(t,e),Db=SM;var Ab=(t=>(t.IDLE="idle",t.RUNNING="running",t.COMPLETED="completed",t.ERROR="error",t.PAUSED="paused",t))(Ab||{});const vt=Eg()(Db((t,e)=>({currentWorkflow:null,workflows:[],nodes:[],edges:[],selectedNode:null,execution:null,isExecuting:!1,nodeDefinitions:[],viewMode:"single-node",activeNodeInSingleMode:null,setCurrentWorkflow:r=>{t({currentWorkflow:r}),r&&t({nodes:r.nodes,edges:r.edges})},setNodes:r=>{t({nodes:r});const{currentWorkflow:n}=e();n&&t({currentWorkflow:{...n,nodes:r,updated_at:new Date().toISOString()}})},setEdges:r=>{t({edges:r});const{currentWorkflow:n}=e();n&&t({currentWorkflow:{...n,edges:r,updated_at:new Date().toISOString()}})},addNode:r=>{const{nodes:n}=e();t({nodes:[...n,r]});const{currentWorkflow:s}=e();s&&t({currentWorkflow:{...s,nodes:[...n,r],updated_at:new Date().toISOString()}})},updateNode:(r,n)=>{const{nodes:s}=e(),i=s.map(c=>c.id===r?{...c,...n}:c);t({nodes:i});const{selectedNode:o}=e();o&&o.id===r&&t({selectedNode:{...o,...n}});const{activeNodeInSingleMode:a}=e();a&&a.id===r&&t({activeNodeInSingleMode:{...a,...n}});const{currentWorkflow:l}=e();l&&t({currentWorkflow:{...l,nodes:i,updated_at:new Date().toISOString()}})},removeNode:r=>{const{nodes:n,edges:s}=e(),i=n.filter(c=>c.id!==r),o=s.filter(c=>c.source!==r&&c.target!==r);t({nodes:i,edges:o});const{selectedNode:a}=e();a&&a.id===r&&t({selectedNode:null});const{currentWorkflow:l}=e();l&&t({currentWorkflow:{...l,nodes:i,edges:o,updated_at:new Date().toISOString()}})},addEdge:r=>{const{edges:n}=e();t({edges:[...n,r]});const{currentWorkflow:s}=e();s&&t({currentWorkflow:{...s,edges:[...n,r],updated_at:new Date().toISOString()}})},removeEdge:r=>{const{edges:n}=e(),s=n.filter(o=>o.id!==r);t({edges:s});const{currentWorkflow:i}=e();i&&t({currentWorkflow:{...i,edges:s,updated_at:new Date().toISOString()}})},setSelectedNode:r=>{t({selectedNode:r})},setExecution:r=>{t({execution:r})},setIsExecuting:r=>{t({isExecuting:r})},updateNodeStatus:(r,n,s=0,i="")=>{const{nodes:o}=e(),a=o.map(c=>c.id===r?{...c,status:n,progress:s,message:i}:c);t({nodes:a});const{selectedNode:l}=e();l&&l.id===r&&t({selectedNode:{...l,status:n,progress:s,message:i}})},setNodeDefinitions:r=>{t({nodeDefinitions:r})},saveWorkflow:async()=>{const{currentWorkflow:r}=e();if(r)try{console.log("Saving workflow:",r)}catch(n){console.error("Failed to save workflow:",n)}},loadWorkflow:async r=>{try{console.log("Loading workflow:",r)}catch(n){console.error("Failed to load workflow:",n)}},createNewWorkflow:()=>{const r={id:"",name:"New Workflow",description:"",nodes:[],edges:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),version:"1.0"};t({currentWorkflow:r,nodes:[],edges:[],selectedNode:null})},saveWorkflowToFile:async()=>{const{currentWorkflow:r}=e();if(r)try{const n=JSON.stringify(r,null,2);if(globalThis.electronAPI){const s=await globalThis.electronAPI.showSaveDialog({title:"Save Workflow",defaultPath:`${r.name||"workflow"}.json`,filters:[{name:"JSON Files",extensions:["json"]},{name:"All Files",extensions:["*"]}]});!s.canceled&&s.filePath&&(await globalThis.electronAPI.writeFile(s.filePath,n),console.log("Workflow saved to:",s.filePath))}else{const s=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=`${r.name||"workflow"}.json`,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(i)}}catch(n){console.error("Failed to save workflow to file:",n)}},loadWorkflowFromFile:async()=>{try{let r;if(globalThis.electronAPI){const n=await globalThis.electronAPI.showOpenDialog({title:"Load Workflow",filters:[{name:"JSON Files",extensions:["json"]},{name:"All Files",extensions:["*"]}],properties:["openFile"]});if(!n.canceled&&n.filePaths.length>0)r=await globalThis.electronAPI.readFile(n.filePaths[0]);else return}else return new Promise(n=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=async i=>{var a;const o=(a=i.target.files)==null?void 0:a[0];o&&(r=await o.text(),n(r))},s.click()});if(r){const n=JSON.parse(r);t({currentWorkflow:n,nodes:n.nodes,edges:n.edges,selectedNode:null}),console.log("Workflow loaded from file")}}catch(r){console.error("Failed to load workflow from file:",r)}},exportWorkflow:async()=>{const{currentWorkflow:r}=e();return r?JSON.stringify(r,null,2):""},importWorkflow:async r=>{try{const n=JSON.parse(r);t({currentWorkflow:n,nodes:n.nodes,edges:n.edges,selectedNode:null}),console.log("Workflow imported successfully")}catch(n){throw console.error("Failed to import workflow:",n),n}},loadTemplate:async r=>{try{const s={"basic-face-swap":{id:"",name:"Basic Face Swap",description:"A simple face swap workflow with video input, face extraction, training, and output",nodes:[{id:"video-input-1",type:"video_input",position:{x:100,y:100},parameters:{input_file:"",output_dir:"",fps:0,output_ext:"png"},status:"idle",progress:0,message:"",inputs:{},outputs:{video_frames:null}},{id:"extract-faces-1",type:"extract_faces",position:{x:300,y:100},parameters:{detector:"s3fd",face_type:"full_face",image_size:512},status:"idle",progress:0,message:"",inputs:{video:null},outputs:{faces:null}},{id:"train-model-1",type:"train_model",position:{x:500,y:100},parameters:{model_type:"SAEHD",batch_size:4,resolution:256},status:"idle",progress:0,message:"",inputs:{src_faces:null,dst_faces:null},outputs:{model:null}},{id:"merge-faces-1",type:"merge_faces",position:{x:700,y:100},parameters:{face_enhancer:"none",color_transfer:"none"},status:"idle",progress:0,message:"",inputs:{model:null,dst_video:null,dst_faces:null},outputs:{merged_video:null}},{id:"video-output-1",type:"video_output",position:{x:900,y:100},parameters:{input_dir:"",output_file:"",ext:"png",include_audio:!0},status:"idle",progress:0,message:"",inputs:{image_sequence:null},outputs:{output_video:null}}],edges:[{id:"edge-1",source:"video-input-1",target:"extract-faces-1",sourceHandle:"video_frames",targetHandle:"images"},{id:"edge-2",source:"extract-faces-1",target:"train-model-1",sourceHandle:"faces",targetHandle:"src_faces"},{id:"edge-3",source:"train-model-1",target:"merge-faces-1",sourceHandle:"model",targetHandle:"model"},{id:"edge-4",source:"merge-faces-1",target:"video-output-1",sourceHandle:"merged_images",targetHandle:"image_sequence"}],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),version:"1.0"}}[r];if(s)t({currentWorkflow:s,nodes:s.nodes,edges:s.edges,selectedNode:null}),console.log(`Template '${r}' loaded successfully`);else throw new Error(`Template '${r}' not found`)}catch(n){throw console.error("Failed to load template:",n),n}},saveAsTemplate:async r=>{const{currentWorkflow:n}=e();if(n)try{const s=JSON.parse(localStorage.getItem("workflow-templates")||"{}");s[r]={...n,name:r,id:`template-${r}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},localStorage.setItem("workflow-templates",JSON.stringify(s)),console.log(`Template '${r}' saved successfully`)}catch(s){throw console.error("Failed to save template:",s),s}},setViewMode:r=>{t({viewMode:r})},setActiveNodeInSingleMode:r=>{t({activeNodeInSingleMode:r})},createNodeForSingleMode:r=>{const n=`single-node-${Date.now()}`;let s={};r==="xseg_editor"&&(s={input_dir:"/tmp/faces",face_type:"full_face",detection_model:"VGGFace2",similarity_threshold:.6});const i={id:n,type:r,position:{x:0,y:0},parameters:s,status:Ab.IDLE,progress:0,message:"",inputs:{},outputs:{}};t({activeNodeInSingleMode:i})}}),{name:"workflow-store",partialize:t=>({workflows:t.workflows,nodeDefinitions:t.nodeDefinitions})})),CM=({data:t,selected:e})=>{const r=o=>{switch(o){case"idle":return"border-gray-300 bg-gray-50";case"running":return"border-blue-400 bg-blue-50";case"completed":return"border-green-400 bg-green-50";case"error":return"border-red-400 bg-red-50";case"paused":return"border-yellow-400 bg-yellow-50";default:return"border-gray-300 bg-gray-50"}},n=o=>{switch(o){case"idle":return"⏸️";case"running":return"▶️";case"completed":return"✅";case"error":return"❌";case"paused":return"⏸️";default:return"⏸️"}},s=o=>{switch(o){case"video_input":return"🎥";case"image_input":return"🖼️";case"extract_faces":return"👤";case"train_model":return"🧠";case"merge_faces":return"🔄";case"video_output":return"📹";case"image_output":return"🖼️";case"xseg_editor":return"✂️";case"denoise":return"🔧";case"enhance_faces":return"✨";default:return"📦"}},i=o=>{switch(o){case"video_input":return"Video Input";case"image_input":return"Image Input";case"extract_faces":return"Extract Faces";case"train_model":return"Train Model";case"merge_faces":return"Merge Faces";case"video_output":return"Video Output";case"image_output":return"Image Output";case"xseg_editor":return"XSeg Editor";case"denoise":return"Denoise";case"enhance_faces":return"Enhance Faces";default:return"Unknown Node"}};return f.jsxs("div",{className:`min-w-[200px] rounded-lg border-2 p-3 shadow-sm transition-all ${e?"ring-2 ring-blue-500":""} ${r(t.status)}`,onClick:()=>{var o;return(o=t.onSelect)==null?void 0:o.call(t)},children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-lg",children:s(t.type)}),f.jsx("span",{className:"font-medium text-sm",children:i(t.type)})]}),f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx("span",{className:"text-xs",children:n(t.status)}),t.progress>0&&f.jsxs("span",{className:"text-xs text-gray-600",children:[Math.round(t.progress),"%"]})]})]}),t.status==="running"&&t.progress>0&&f.jsx("div",{className:"mb-2",children:f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:f.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${t.progress}%`}})})}),t.message&&f.jsx("div",{className:"text-xs text-gray-600 mb-2 truncate",title:t.message,children:t.message}),t.type!=="video_input"&&t.type!=="image_input"&&f.jsx(qe,{type:"target",position:re.Left,id:"input",className:"w-3 h-3 bg-blue-500 border-2 border-white"}),t.type!=="video_output"&&t.type!=="image_output"&&f.jsx(qe,{type:"source",position:re.Right,id:"output",className:"w-3 h-3 bg-green-500 border-2 border-white"}),t.type==="extract_faces"&&f.jsxs(f.Fragment,{children:[f.jsx(qe,{type:"target",position:re.Left,id:"video",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"30%"}}),f.jsx(qe,{type:"target",position:re.Left,id:"images",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"70%"}}),f.jsx(qe,{type:"source",position:re.Right,id:"faces",className:"w-3 h-3 bg-green-500 border-2 border-white"})]}),t.type==="train_model"&&f.jsxs(f.Fragment,{children:[f.jsx(qe,{type:"target",position:re.Left,id:"src_faces",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"30%"}}),f.jsx(qe,{type:"target",position:re.Left,id:"dst_faces",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"70%"}}),f.jsx(qe,{type:"source",position:re.Right,id:"model",className:"w-3 h-3 bg-green-500 border-2 border-white"})]}),t.type==="merge_faces"&&f.jsxs(f.Fragment,{children:[f.jsx(qe,{type:"target",position:re.Left,id:"model",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"20%"}}),f.jsx(qe,{type:"target",position:re.Left,id:"dst_video",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"40%"}}),f.jsx(qe,{type:"target",position:re.Left,id:"dst_faces",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"60%"}}),f.jsx(qe,{type:"target",position:re.Left,id:"mask",className:"w-3 h-3 bg-blue-500 border-2 border-white",style:{top:"80%"}}),f.jsx(qe,{type:"source",position:re.Right,id:"merged_video",className:"w-3 h-3 bg-green-500 border-2 border-white",style:{top:"30%"}}),f.jsx(qe,{type:"source",position:re.Right,id:"merged_images",className:"w-3 h-3 bg-green-500 border-2 border-white",style:{top:"70%"}})]})]})};function Fb(t,e){return function(){return t.apply(e,arguments)}}const{toString:kM}=Object.prototype,{getPrototypeOf:Tg}=Object,{iterator:vu,toStringTag:Lb}=Symbol,wu=(t=>e=>{const r=kM.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),yr=t=>(t=t.toLowerCase(),e=>wu(e)===t),bu=t=>e=>typeof e===t,{isArray:Ai}=Array,Ei=bu("undefined");function va(t){return t!==null&&!Ei(t)&&t.constructor!==null&&!Ei(t.constructor)&&St(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Rb=yr("ArrayBuffer");function EM(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Rb(t.buffer),e}const TM=bu("string"),St=bu("function"),Ib=bu("number"),wa=t=>t!==null&&typeof t=="object",jM=t=>t===!0||t===!1,Hl=t=>{if(wu(t)!=="object")return!1;const e=Tg(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Lb in t)&&!(vu in t)},NM=t=>{if(!wa(t)||va(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},OM=yr("Date"),PM=yr("File"),MM=yr("Blob"),DM=yr("FileList"),AM=t=>wa(t)&&St(t.pipe),FM=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||St(t.append)&&((e=wu(t))==="formdata"||e==="object"&&St(t.toString)&&t.toString()==="[object FormData]"))},LM=yr("URLSearchParams"),[RM,IM,$M,zM]=["ReadableStream","Request","Response","Headers"].map(yr),BM=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ba(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,s;if(typeof t!="object"&&(t=[t]),Ai(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{if(va(t))return;const i=r?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(n=0;n<o;n++)a=i[n],e.call(null,t[a],a,t)}}function $b(t,e){if(va(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}const es=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,zb=t=>!Ei(t)&&t!==es;function qh(){const{caseless:t,skipUndefined:e}=zb(this)&&this||{},r={},n=(s,i)=>{const o=t&&$b(r,i)||i;Hl(r[o])&&Hl(s)?r[o]=qh(r[o],s):Hl(s)?r[o]=qh({},s):Ai(s)?r[o]=s.slice():(!e||!Ei(s))&&(r[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&ba(arguments[s],n);return r}const WM=(t,e,r,{allOwnKeys:n}={})=>(ba(e,(s,i)=>{r&&St(s)?t[i]=Fb(s,r):t[i]=s},{allOwnKeys:n}),t),HM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),VM=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},UM=(t,e,r,n)=>{let s,i,o;const a={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!n||n(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&Tg(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},XM=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},YM=t=>{if(!t)return null;if(Ai(t))return t;let e=t.length;if(!Ib(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},GM=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Tg(Uint8Array)),qM=(t,e)=>{const n=(t&&t[vu]).call(t);let s;for(;(s=n.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},KM=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},QM=yr("HTMLFormElement"),JM=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),x0=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),ZM=yr("RegExp"),Bb=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};ba(r,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(n[i]=o||s)}),Object.defineProperties(t,n)},eD=t=>{Bb(t,(e,r)=>{if(St(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(St(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},tD=(t,e)=>{const r={},n=s=>{s.forEach(i=>{r[i]=!0})};return Ai(t)?n(t):n(String(t).split(e)),r},rD=()=>{},nD=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function sD(t){return!!(t&&St(t.append)&&t[Lb]==="FormData"&&t[vu])}const iD=t=>{const e=new Array(10),r=(n,s)=>{if(wa(n)){if(e.indexOf(n)>=0)return;if(va(n))return n;if(!("toJSON"in n)){e[s]=n;const i=Ai(n)?[]:{};return ba(n,(o,a)=>{const l=r(o,s+1);!Ei(l)&&(i[a]=l)}),e[s]=void 0,i}}return n};return r(t,0)},oD=yr("AsyncFunction"),aD=t=>t&&(wa(t)||St(t))&&St(t.then)&&St(t.catch),Wb=((t,e)=>t?setImmediate:e?((r,n)=>(es.addEventListener("message",({source:s,data:i})=>{s===es&&i===r&&n.length&&n.shift()()},!1),s=>{n.push(s),es.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",St(es.postMessage)),lD=typeof queueMicrotask<"u"?queueMicrotask.bind(es):typeof process<"u"&&process.nextTick||Wb,cD=t=>t!=null&&St(t[vu]),V={isArray:Ai,isArrayBuffer:Rb,isBuffer:va,isFormData:FM,isArrayBufferView:EM,isString:TM,isNumber:Ib,isBoolean:jM,isObject:wa,isPlainObject:Hl,isEmptyObject:NM,isReadableStream:RM,isRequest:IM,isResponse:$M,isHeaders:zM,isUndefined:Ei,isDate:OM,isFile:PM,isBlob:MM,isRegExp:ZM,isFunction:St,isStream:AM,isURLSearchParams:LM,isTypedArray:GM,isFileList:DM,forEach:ba,merge:qh,extend:WM,trim:BM,stripBOM:HM,inherits:VM,toFlatObject:UM,kindOf:wu,kindOfTest:yr,endsWith:XM,toArray:YM,forEachEntry:qM,matchAll:KM,isHTMLForm:QM,hasOwnProperty:x0,hasOwnProp:x0,reduceDescriptors:Bb,freezeMethods:eD,toObjectSet:tD,toCamelCase:JM,noop:rD,toFiniteNumber:nD,findKey:$b,global:es,isContextDefined:zb,isSpecCompliantForm:sD,toJSONObject:iD,isAsyncFn:oD,isThenable:aD,setImmediate:Wb,asap:lD,isIterable:cD};function ue(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}V.inherits(ue,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:V.toJSONObject(this.config),code:this.code,status:this.status}}});const Hb=ue.prototype,Vb={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Vb[t]={value:t}});Object.defineProperties(ue,Vb);Object.defineProperty(Hb,"isAxiosError",{value:!0});ue.from=(t,e,r,n,s,i)=>{const o=Object.create(Hb);V.toFlatObject(t,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const a=t&&t.message?t.message:"Error",l=e==null&&t?t.code:e;return ue.call(o,a,l,r,n,s),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",i&&Object.assign(o,i),o};const uD=null;function Kh(t){return V.isPlainObject(t)||V.isArray(t)}function Ub(t){return V.endsWith(t,"[]")?t.slice(0,-2):t}function v0(t,e,r){return t?t.concat(e).map(function(s,i){return s=Ub(s),!r&&i?"["+s+"]":s}).join(r?".":""):e}function dD(t){return V.isArray(t)&&!t.some(Kh)}const hD=V.toFlatObject(V,{},null,function(e){return/^is[A-Z]/.test(e)});function _u(t,e,r){if(!V.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=V.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,v){return!V.isUndefined(v[y])});const n=r.metaTokens,s=r.visitor||u,i=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&V.isSpecCompliantForm(e);if(!V.isFunction(s))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(V.isDate(p))return p.toISOString();if(V.isBoolean(p))return p.toString();if(!l&&V.isBlob(p))throw new ue("Blob is not supported. Use a Buffer instead.");return V.isArrayBuffer(p)||V.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,y,v){let m=p;if(p&&!v&&typeof p=="object"){if(V.endsWith(y,"{}"))y=n?y:y.slice(0,-2),p=JSON.stringify(p);else if(V.isArray(p)&&dD(p)||(V.isFileList(p)||V.endsWith(y,"[]"))&&(m=V.toArray(p)))return y=Ub(y),m.forEach(function(x,_){!(V.isUndefined(x)||x===null)&&e.append(o===!0?v0([y],_,i):o===null?y:y+"[]",c(x))}),!1}return Kh(p)?!0:(e.append(v0(v,y,i),c(p)),!1)}const d=[],h=Object.assign(hD,{defaultVisitor:u,convertValue:c,isVisitable:Kh});function g(p,y){if(!V.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+y.join("."));d.push(p),V.forEach(p,function(m,w){(!(V.isUndefined(m)||m===null)&&s.call(e,m,V.isString(w)?w.trim():w,y,h))===!0&&g(m,y?y.concat(w):[w])}),d.pop()}}if(!V.isObject(t))throw new TypeError("data must be an object");return g(t),e}function w0(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function jg(t,e){this._pairs=[],t&&_u(t,this,e)}const Xb=jg.prototype;Xb.append=function(e,r){this._pairs.push([e,r])};Xb.toString=function(e){const r=e?function(n){return e.call(this,n,w0)}:w0;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function fD(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Yb(t,e,r){if(!e)return t;const n=r&&r.encode||fD;V.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let i;if(s?i=s(e,r):i=V.isURLSearchParams(e)?e.toString():new jg(e,r).toString(n),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class b0{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){V.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Gb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gD=typeof URLSearchParams<"u"?URLSearchParams:jg,pD=typeof FormData<"u"?FormData:null,mD=typeof Blob<"u"?Blob:null,yD={isBrowser:!0,classes:{URLSearchParams:gD,FormData:pD,Blob:mD},protocols:["http","https","file","blob","url","data"]},Ng=typeof window<"u"&&typeof document<"u",Qh=typeof navigator=="object"&&navigator||void 0,xD=Ng&&(!Qh||["ReactNative","NativeScript","NS"].indexOf(Qh.product)<0),vD=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wD=Ng&&window.location.href||"http://localhost",bD=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ng,hasStandardBrowserEnv:xD,hasStandardBrowserWebWorkerEnv:vD,navigator:Qh,origin:wD},Symbol.toStringTag,{value:"Module"})),it={...bD,...yD};function _D(t,e){return _u(t,new it.classes.URLSearchParams,{visitor:function(r,n,s,i){return it.isNode&&V.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function SD(t){return V.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function CD(t){const e={},r=Object.keys(t);let n;const s=r.length;let i;for(n=0;n<s;n++)i=r[n],e[i]=t[i];return e}function qb(t){function e(r,n,s,i){let o=r[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=r.length;return o=!o&&V.isArray(s)?s.length:o,l?(V.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!a):((!s[o]||!V.isObject(s[o]))&&(s[o]=[]),e(r,n,s[o],i)&&V.isArray(s[o])&&(s[o]=CD(s[o])),!a)}if(V.isFormData(t)&&V.isFunction(t.entries)){const r={};return V.forEachEntry(t,(n,s)=>{e(SD(n),s,r,0)}),r}return null}function kD(t,e,r){if(V.isString(t))try{return(e||JSON.parse)(t),V.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const _a={transitional:Gb,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,i=V.isObject(e);if(i&&V.isHTMLForm(e)&&(e=new FormData(e)),V.isFormData(e))return s?JSON.stringify(qb(e)):e;if(V.isArrayBuffer(e)||V.isBuffer(e)||V.isStream(e)||V.isFile(e)||V.isBlob(e)||V.isReadableStream(e))return e;if(V.isArrayBufferView(e))return e.buffer;if(V.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return _D(e,this.formSerializer).toString();if((a=V.isFileList(e))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return _u(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(r.setContentType("application/json",!1),kD(e)):e}],transformResponse:[function(e){const r=this.transitional||_a.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(V.isResponse(e)||V.isReadableStream(e))return e;if(e&&V.isString(e)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?ue.from(a,ue.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:it.classes.FormData,Blob:it.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};V.forEach(["delete","get","head","post","put","patch"],t=>{_a.headers[t]={}});const ED=V.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),TD=t=>{const e={};let r,n,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||e[r]&&ED[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},_0=Symbol("internals");function eo(t){return t&&String(t).trim().toLowerCase()}function Vl(t){return t===!1||t==null?t:V.isArray(t)?t.map(Vl):String(t)}function jD(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const ND=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function _d(t,e,r,n,s){if(V.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!V.isString(e)){if(V.isString(n))return e.indexOf(n)!==-1;if(V.isRegExp(n))return n.test(e)}}function OD(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function PD(t,e){const r=V.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,i,o){return this[n].call(this,e,s,i,o)},configurable:!0})})}let Ct=class{constructor(e){e&&this.set(e)}set(e,r,n){const s=this;function i(a,l,c){const u=eo(l);if(!u)throw new Error("header name must be a non-empty string");const d=V.findKey(s,u);(!d||s[d]===void 0||c===!0||c===void 0&&s[d]!==!1)&&(s[d||l]=Vl(a))}const o=(a,l)=>V.forEach(a,(c,u)=>i(c,u,l));if(V.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(V.isString(e)&&(e=e.trim())&&!ND(e))o(TD(e),r);else if(V.isObject(e)&&V.isIterable(e)){let a={},l,c;for(const u of e){if(!V.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?V.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,r)}else e!=null&&i(r,e,n);return this}get(e,r){if(e=eo(e),e){const n=V.findKey(this,e);if(n){const s=this[n];if(!r)return s;if(r===!0)return jD(s);if(V.isFunction(r))return r.call(this,s,n);if(V.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=eo(e),e){const n=V.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||_d(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let s=!1;function i(o){if(o=eo(o),o){const a=V.findKey(n,o);a&&(!r||_d(n,n[a],a,r))&&(delete n[a],s=!0)}}return V.isArray(e)?e.forEach(i):i(e),s}clear(e){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const i=r[n];(!e||_d(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const r=this,n={};return V.forEach(this,(s,i)=>{const o=V.findKey(n,i);if(o){r[o]=Vl(s),delete r[i];return}const a=e?OD(i):String(i).trim();a!==i&&delete r[i],r[a]=Vl(s),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return V.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&V.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[_0]=this[_0]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=eo(o);n[a]||(PD(s,o),n[a]=!0)}return V.isArray(e)?e.forEach(i):i(e),this}};Ct.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);V.reduceDescriptors(Ct.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});V.freezeMethods(Ct);function Sd(t,e){const r=this||_a,n=e||r,s=Ct.from(n.headers);let i=n.data;return V.forEach(t,function(a){i=a.call(r,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Kb(t){return!!(t&&t.__CANCEL__)}function Fi(t,e,r){ue.call(this,t??"canceled",ue.ERR_CANCELED,e,r),this.name="CanceledError"}V.inherits(Fi,ue,{__CANCEL__:!0});function Qb(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new ue("Request failed with status code "+r.status,[ue.ERR_BAD_REQUEST,ue.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function MD(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function DD(t,e){t=t||10;const r=new Array(t),n=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=n[i];o||(o=c),r[s]=l,n[s]=c;let d=i,h=0;for(;d!==s;)h+=r[d++],d=d%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),c-o<e)return;const g=u&&c-u;return g?Math.round(h*1e3/g):void 0}}function AD(t,e){let r=0,n=1e3/e,s,i;const o=(c,u=Date.now())=>{r=u,s=null,i&&(clearTimeout(i),i=null),t(...c)};return[(...c)=>{const u=Date.now(),d=u-r;d>=n?o(c,u):(s=c,i||(i=setTimeout(()=>{i=null,o(s)},n-d)))},()=>s&&o(s)]}const jc=(t,e,r=3)=>{let n=0;const s=DD(50,250);return AD(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-n,c=s(l),u=o<=a;n=o;const d={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(d)},r)},S0=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},C0=t=>(...e)=>V.asap(()=>t(...e)),FD=it.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,it.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(it.origin),it.navigator&&/(msie|trident)/i.test(it.navigator.userAgent)):()=>!0,LD=it.hasStandardBrowserEnv?{write(t,e,r,n,s,i){const o=[t+"="+encodeURIComponent(e)];V.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),V.isString(n)&&o.push("path="+n),V.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function RD(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function ID(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Jb(t,e,r){let n=!RD(e);return t&&(n||r==!1)?ID(t,e):e}const k0=t=>t instanceof Ct?{...t}:t;function ws(t,e){e=e||{};const r={};function n(c,u,d,h){return V.isPlainObject(c)&&V.isPlainObject(u)?V.merge.call({caseless:h},c,u):V.isPlainObject(u)?V.merge({},u):V.isArray(u)?u.slice():u}function s(c,u,d,h){if(V.isUndefined(u)){if(!V.isUndefined(c))return n(void 0,c,d,h)}else return n(c,u,d,h)}function i(c,u){if(!V.isUndefined(u))return n(void 0,u)}function o(c,u){if(V.isUndefined(u)){if(!V.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function a(c,u,d){if(d in e)return n(c,u);if(d in t)return n(void 0,c)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,d)=>s(k0(c),k0(u),d,!0)};return V.forEach(Object.keys({...t,...e}),function(u){const d=l[u]||s,h=d(t[u],e[u],u);V.isUndefined(h)&&d!==a||(r[u]=h)}),r}const Zb=t=>{const e=ws({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=e;if(e.headers=o=Ct.from(o),e.url=Yb(Jb(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),V.isFormData(r)){if(it.hasStandardBrowserEnv||it.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(V.isFunction(r.getHeaders)){const l=r.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([u,d])=>{c.includes(u.toLowerCase())&&o.set(u,d)})}}if(it.hasStandardBrowserEnv&&(n&&V.isFunction(n)&&(n=n(e)),n||n!==!1&&FD(e.url))){const l=s&&i&&LD.read(i);l&&o.set(s,l)}return e},$D=typeof XMLHttpRequest<"u",zD=$D&&function(t){return new Promise(function(r,n){const s=Zb(t);let i=s.data;const o=Ct.from(s.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=s,u,d,h,g,p;function y(){g&&g(),p&&p(),s.cancelToken&&s.cancelToken.unsubscribe(u),s.signal&&s.signal.removeEventListener("abort",u)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function m(){if(!v)return;const x=Ct.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),b={data:!a||a==="text"||a==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:x,config:t,request:v};Qb(function(k){r(k),y()},function(k){n(k),y()},b),v=null}"onloadend"in v?v.onloadend=m:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(m)},v.onabort=function(){v&&(n(new ue("Request aborted",ue.ECONNABORTED,t,v)),v=null)},v.onerror=function(_){const b=_&&_.message?_.message:"Network Error",C=new ue(b,ue.ERR_NETWORK,t,v);C.event=_||null,n(C),v=null},v.ontimeout=function(){let _=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const b=s.transitional||Gb;s.timeoutErrorMessage&&(_=s.timeoutErrorMessage),n(new ue(_,b.clarifyTimeoutError?ue.ETIMEDOUT:ue.ECONNABORTED,t,v)),v=null},i===void 0&&o.setContentType(null),"setRequestHeader"in v&&V.forEach(o.toJSON(),function(_,b){v.setRequestHeader(b,_)}),V.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),a&&a!=="json"&&(v.responseType=s.responseType),c&&([h,p]=jc(c,!0),v.addEventListener("progress",h)),l&&v.upload&&([d,g]=jc(l),v.upload.addEventListener("progress",d),v.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(u=x=>{v&&(n(!x||x.type?new Fi(null,t,v):x),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(u),s.signal&&(s.signal.aborted?u():s.signal.addEventListener("abort",u)));const w=MD(s.url);if(w&&it.protocols.indexOf(w)===-1){n(new ue("Unsupported protocol "+w+":",ue.ERR_BAD_REQUEST,t));return}v.send(i||null)})},BD=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s;const i=function(c){if(!s){s=!0,a();const u=c instanceof Error?c:this.reason;n.abort(u instanceof ue?u:new Fi(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,i(new ue(`timeout ${e} of ms exceeded`,ue.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),t=null)};t.forEach(c=>c.addEventListener("abort",i));const{signal:l}=n;return l.unsubscribe=()=>V.asap(a),l}},WD=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},HD=async function*(t,e){for await(const r of VD(t))yield*WD(r,e)},VD=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},E0=(t,e,r,n)=>{const s=HD(t,e);let i=0,o,a=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await s.next();if(c){a(),l.close();return}let d=u.byteLength;if(r){let h=i+=d;r(h)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),s.return()}},{highWaterMark:2})},T0=64*1024,{isFunction:tl}=V,UD=(({Request:t,Response:e})=>({Request:t,Response:e}))(V.global),{ReadableStream:j0,TextEncoder:N0}=V.global,O0=(t,...e)=>{try{return!!t(...e)}catch{return!1}},XD=t=>{t=V.merge.call({skipUndefined:!0},UD,t);const{fetch:e,Request:r,Response:n}=t,s=e?tl(e):typeof fetch=="function",i=tl(r),o=tl(n);if(!s)return!1;const a=s&&tl(j0),l=s&&(typeof N0=="function"?(p=>y=>p.encode(y))(new N0):async p=>new Uint8Array(await new r(p).arrayBuffer())),c=i&&a&&O0(()=>{let p=!1;const y=new r(it.origin,{body:new j0,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!y}),u=o&&a&&O0(()=>V.isReadableStream(new n("").body)),d={stream:u&&(p=>p.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!d[p]&&(d[p]=(y,v)=>{let m=y&&y[p];if(m)return m.call(y);throw new ue(`Response type '${p}' is not supported`,ue.ERR_NOT_SUPPORT,v)})});const h=async p=>{if(p==null)return 0;if(V.isBlob(p))return p.size;if(V.isSpecCompliantForm(p))return(await new r(it.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(V.isArrayBufferView(p)||V.isArrayBuffer(p))return p.byteLength;if(V.isURLSearchParams(p)&&(p=p+""),V.isString(p))return(await l(p)).byteLength},g=async(p,y)=>{const v=V.toFiniteNumber(p.getContentLength());return v??h(y)};return async p=>{let{url:y,method:v,data:m,signal:w,cancelToken:x,timeout:_,onDownloadProgress:b,onUploadProgress:C,responseType:k,headers:S,withCredentials:P="same-origin",fetchOptions:O}=Zb(p),F=e||fetch;k=k?(k+"").toLowerCase():"text";let A=BD([w,x&&x.toAbortSignal()],_),L=null;const E=A&&A.unsubscribe&&(()=>{A.unsubscribe()});let M;try{if(C&&c&&v!=="get"&&v!=="head"&&(M=await g(S,m))!==0){let H=new r(y,{method:"POST",body:m,duplex:"half"}),U;if(V.isFormData(m)&&(U=H.headers.get("content-type"))&&S.setContentType(U),H.body){const[G,X]=S0(M,jc(C0(C)));m=E0(H.body,T0,G,X)}}V.isString(P)||(P=P?"include":"omit");const N=i&&"credentials"in r.prototype,I={...O,signal:A,method:v.toUpperCase(),headers:S.normalize().toJSON(),body:m,duplex:"half",credentials:N?P:void 0};L=i&&new r(y,I);let j=await(i?F(L,O):F(y,I));const D=u&&(k==="stream"||k==="response");if(u&&(b||D&&E)){const H={};["status","statusText","headers"].forEach(Q=>{H[Q]=j[Q]});const U=V.toFiniteNumber(j.headers.get("content-length")),[G,X]=b&&S0(U,jc(C0(b),!0))||[];j=new n(E0(j.body,T0,G,()=>{X&&X(),E&&E()}),H)}k=k||"text";let z=await d[V.findKey(d,k)||"text"](j,p);return!D&&E&&E(),await new Promise((H,U)=>{Qb(H,U,{data:z,headers:Ct.from(j.headers),status:j.status,statusText:j.statusText,config:p,request:L})})}catch(N){throw E&&E(),N&&N.name==="TypeError"&&/Load failed|fetch/i.test(N.message)?Object.assign(new ue("Network Error",ue.ERR_NETWORK,p,L),{cause:N.cause||N}):ue.from(N,N&&N.code,p,L)}}},YD=new Map,e1=t=>{let e=t?t.env:{};const{fetch:r,Request:n,Response:s}=e,i=[n,s,r];let o=i.length,a=o,l,c,u=YD;for(;a--;)l=i[a],c=u.get(l),c===void 0&&u.set(l,c=a?new Map:XD(e)),u=c;return c};e1();const Jh={http:uD,xhr:zD,fetch:{get:e1}};V.forEach(Jh,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const P0=t=>`- ${t}`,GD=t=>V.isFunction(t)||t===null||t===!1,t1={getAdapter:(t,e)=>{t=V.isArray(t)?t:[t];const{length:r}=t;let n,s;const i={};for(let o=0;o<r;o++){n=t[o];let a;if(s=n,!GD(n)&&(s=Jh[(a=String(n)).toLowerCase()],s===void 0))throw new ue(`Unknown adapter '${a}'`);if(s&&(V.isFunction(s)||(s=s.get(e))))break;i[a||"#"+o]=s}if(!s){const o=Object.entries(i).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=r?o.length>1?`since :
`+o.map(P0).join(`
`):" "+P0(o[0]):"as no adapter specified";throw new ue("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return s},adapters:Jh};function Cd(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Fi(null,t)}function M0(t){return Cd(t),t.headers=Ct.from(t.headers),t.data=Sd.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),t1.getAdapter(t.adapter||_a.adapter,t)(t).then(function(n){return Cd(t),n.data=Sd.call(t,t.transformResponse,n),n.headers=Ct.from(n.headers),n},function(n){return Kb(n)||(Cd(t),n&&n.response&&(n.response.data=Sd.call(t,t.transformResponse,n.response),n.response.headers=Ct.from(n.response.headers))),Promise.reject(n)})}const r1="1.12.2",Su={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Su[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const D0={};Su.transitional=function(e,r,n){function s(i,o){return"[Axios v"+r1+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,a)=>{if(e===!1)throw new ue(s(o," has been removed"+(r?" in "+r:"")),ue.ERR_DEPRECATED);return r&&!D0[o]&&(D0[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(i,o,a):!0}};Su.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function qD(t,e,r){if(typeof t!="object")throw new ue("options must be an object",ue.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const i=n[s],o=e[i];if(o){const a=t[i],l=a===void 0||o(a,i,t);if(l!==!0)throw new ue("option "+i+" must be "+l,ue.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ue("Unknown option "+i,ue.ERR_BAD_OPTION)}}const Ul={assertOptions:qD,validators:Su},wr=Ul.validators;let ls=class{constructor(e){this.defaults=e||{},this.interceptors={request:new b0,response:new b0}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=ws(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:i}=r;n!==void 0&&Ul.assertOptions(n,{silentJSONParsing:wr.transitional(wr.boolean),forcedJSONParsing:wr.transitional(wr.boolean),clarifyTimeoutError:wr.transitional(wr.boolean)},!1),s!=null&&(V.isFunction(s)?r.paramsSerializer={serialize:s}:Ul.assertOptions(s,{encode:wr.function,serialize:wr.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ul.assertOptions(r,{baseUrl:wr.spelling("baseURL"),withXsrfToken:wr.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&V.merge(i.common,i[r.method]);i&&V.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),r.headers=Ct.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(l=l&&y.synchronous,a.unshift(y.fulfilled,y.rejected))});const c=[];this.interceptors.response.forEach(function(y){c.push(y.fulfilled,y.rejected)});let u,d=0,h;if(!l){const p=[M0.bind(this),void 0];for(p.unshift(...a),p.push(...c),h=p.length,u=Promise.resolve(r);d<h;)u=u.then(p[d++],p[d++]);return u}h=a.length;let g=r;for(;d<h;){const p=a[d++],y=a[d++];try{g=p(g)}catch(v){y.call(this,v);break}}try{u=M0.call(this,g)}catch(p){return Promise.reject(p)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=ws(this.defaults,e);const r=Jb(e.baseURL,e.url,e.allowAbsoluteUrls);return Yb(r,e.params,e.paramsSerializer)}};V.forEach(["delete","get","head","options"],function(e){ls.prototype[e]=function(r,n){return this.request(ws(n||{},{method:e,url:r,data:(n||{}).data}))}});V.forEach(["post","put","patch"],function(e){function r(n){return function(i,o,a){return this.request(ws(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ls.prototype[e]=r(),ls.prototype[e+"Form"]=r(!0)});let KD=class n1{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(s=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](s);n._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{n.subscribe(a),i=a}).then(s);return o.cancel=function(){n.unsubscribe(i)},o},e(function(i,o,a){n.reason||(n.reason=new Fi(i,o,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new n1(function(s){e=s}),cancel:e}}};function QD(t){return function(r){return t.apply(null,r)}}function JD(t){return V.isObject(t)&&t.isAxiosError===!0}const Zh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zh).forEach(([t,e])=>{Zh[e]=t});function s1(t){const e=new ls(t),r=Fb(ls.prototype.request,e);return V.extend(r,ls.prototype,e,{allOwnKeys:!0}),V.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return s1(ws(t,s))},r}const $e=s1(_a);$e.Axios=ls;$e.CanceledError=Fi;$e.CancelToken=KD;$e.isCancel=Kb;$e.VERSION=r1;$e.toFormData=_u;$e.AxiosError=ue;$e.Cancel=$e.CanceledError;$e.all=function(e){return Promise.all(e)};$e.spread=QD;$e.isAxiosError=JD;$e.mergeConfig=ws;$e.AxiosHeaders=Ct;$e.formToJSON=t=>qb(V.isHTMLForm(t)?new FormData(t):t);$e.getAdapter=t1.getAdapter;$e.HttpStatusCode=Zh;$e.default=$e;const{Axios:d5,AxiosError:h5,CanceledError:f5,isCancel:g5,CancelToken:p5,VERSION:m5,all:y5,Cancel:x5,isAxiosError:v5,spread:w5,toFormData:b5,AxiosHeaders:_5,HttpStatusCode:S5,formToJSON:C5,getAdapter:k5,mergeConfig:E5}=$e;class ZD{constructor(){Hi(this,"http");Hi(this,"baseUrl");Hi(this,"ws",null);Hi(this,"wsCallbacks",new Map);this.baseUrl="http://localhost:8001/api",this.http=$e.create({baseURL:this.baseUrl,timeout:3e5,headers:{"Content-Type":"application/json"}}),this.setupHttpInterceptors()}setupHttpInterceptors(){this.http.interceptors.request.use(e=>{var r;return console.log(`Making ${(r=e.method)==null?void 0:r.toUpperCase()} request to ${e.url}`),e},e=>(console.error("Request error:",e),Promise.reject(e))),this.http.interceptors.response.use(e=>(console.log(`Response from ${e.config.url}:`,e.status),e),e=>{var r;return console.error("Response error:",((r=e.response)==null?void 0:r.data)||e.message),Promise.reject(e)})}async getWorkflows(){return(await this.http.get("/workflow/")).data}async getWorkflow(e){return(await this.http.get(`/workflow/${e}`)).data}async createWorkflow(e){return(await this.http.post("/workflow/",e)).data}async updateWorkflow(e,r){return(await this.http.put(`/workflow/${e}`,r)).data}async deleteWorkflow(e){await this.http.delete(`/workflow/${e}`)}async exportWorkflow(e){return(await this.http.post(`/workflow/${e}/export`)).data}async importWorkflow(e){return(await this.http.post("/workflow/import",e)).data}async getNodeDefinitions(){return(await this.http.get("/nodes/definitions")).data}async getNodeDefinition(e){return(await this.http.get(`/nodes/definitions/${e}`)).data}async getNodeCategories(){return(await this.http.get("/nodes/categories")).data}async getNodesByCategory(e){return(await this.http.get(`/nodes/by-category/${e}`)).data}async validateConnection(e,r,n,s){return(await this.http.post("/nodes/validate-connection",{source_node_type:e,target_node_type:r,source_port:n,target_port:s})).data}async startExecution(e){return(await this.http.post(`/execution/start/${e}`)).data}async stopExecution(e){await this.http.post(`/execution/stop/${e}`)}async getExecution(e){return(await this.http.get(`/execution/${e}`)).data}async listExecutions(){return(await this.http.get("/execution/")).data}async resumeExecution(e){await this.http.post(`/execution/${e}/resume`)}async startNodeExecution(e,r){const n=r?`/execution/start-node/${e}?input_dir=${encodeURIComponent(r)}`:`/execution/start-node/${e}`;return(await this.http.post(n)).data}async listGPUs(){return(await this.http.get("/gpu/list")).data}async assignGPUToNode(e,r){return(await this.http.post(`/gpu/assign/${e}`,{node_id:r})).data}async getGPUMemoryInfo(e){return(await this.http.get(`/gpu/memory/${e}`)).data}async resetGPU(e){return(await this.http.post(`/gpu/reset/${e}`)).data}async getGPUProcesses(){return(await this.http.get("/gpu/processes")).data}async healthCheck(){return(await this.http.get("/health")).data}async getGPUs(){return(await this.http.get("/gpu/gpus")).data}async getGPUStatus(){return(await this.http.get("/gpu/gpus/status")).data}async getGPU(e){return(await this.http.get(`/gpu/gpus/${e}`)).data}async getGPUsByType(e){return(await this.http.get(`/gpu/gpus/type/${e}`)).data}async getAvailableGPUs(){return(await this.http.get("/gpu/gpus/available")).data}async reserveGPU(e,r){return(await this.http.post(`/gpu/gpus/${e}/reserve`,{node_id:r})).data}async releaseGPU(e,r){return(await this.http.post(`/gpu/gpus/${e}/release`,{node_id:r})).data}async getSystemInfo(){return(await this.http.get("/gpu/gpus/system/info")).data}async getErrors(e){return(await this.http.get("/errors/errors",{params:e})).data}async getErrorSummary(){return(await this.http.get("/errors/errors/summary")).data}async getError(e){return(await this.http.get(`/errors/errors/${e}`)).data}async retryError(e){return(await this.http.post(`/errors/errors/${e}/retry`)).data}async clearErrors(e=24){return(await this.http.delete("/errors/errors",{params:{older_than_hours:e}})).data}async getNodeErrors(e,r=50){return(await this.http.get(`/errors/errors/node/${e}`,{params:{limit:r}})).data}async getWorkflowErrors(e,r=100){return(await this.http.get(`/errors/errors/workflow/${e}`,{params:{limit:r}})).data}async getRecentErrors(e=1){return(await this.http.get("/errors/errors/recent",{params:{hours:e}})).data}async getErrorStats(){return(await this.http.get("/errors/errors/stats")).data}connectWebSocket(){return new Promise((e,r)=>{try{const n="ws://localhost:8001/ws";this.ws=new WebSocket(n),this.ws.onopen=()=>{console.log("WebSocket connected"),e()},this.ws.onmessage=s=>{try{const i=JSON.parse(s.data);this.handleWebSocketMessage(i)}catch(i){console.error("Failed to parse WebSocket message:",i)}},this.ws.onclose=s=>{console.log("WebSocket disconnected",s.code,s.reason),this.ws=null},this.ws.onerror=s=>{var i;console.error("WebSocket error:",s),((i=this.ws)==null?void 0:i.readyState)===WebSocket.CONNECTING&&r(s)}}catch(n){r(n)}})}disconnectWebSocket(){this.ws&&(this.ws.close(),this.ws=null)}handleWebSocketMessage(e){const{type:r}=e;switch(r){case"node_update":const n=this.wsCallbacks.get("node_update");n&&n(e);break;case"execution_update":const s=this.wsCallbacks.get("execution_update");s&&s(e);break;case"log_message":const i=this.wsCallbacks.get("log_message");i&&i(e);break;default:console.log("Unknown WebSocket message type:",r)}}onWebSocketMessage(e,r){this.wsCallbacks.set(e,r)}offWebSocketMessage(e){this.wsCallbacks.delete(e)}isWebSocketConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}async saveNodePreset(e){return(await this.http.post("/presets/",e)).data}async listNodePresets(){return(await this.http.get("/presets/")).data}async getNodePreset(e){return(await this.http.get(`/presets/${e}`)).data}async updateNodePreset(e,r){return(await this.http.put(`/presets/${e}`,r)).data}async deleteNodePreset(e){await this.http.delete(`/presets/${e}`)}async getPresetsByType(e){return(await this.http.get(`/presets/by-type/${e}`)).data}async loadPresetIntoWorkflow(e,r){return(await this.http.post(`/presets/${e}/load-into-workflow`,{position:r})).data}async detectFaces(e,r){return(await this.http.post(`/nodes/${e}/detect-faces`,r)).data}async loadSegmentationModel(e){return(await this.http.post(`/nodes/${e}/load-segmentation-model`)).data}async generateMasks(e,r){return(await this.http.post(`/nodes/${e}/generate-masks`,r)).data}async embedPolygons(e,r){return(await this.http.post(`/nodes/${e}/embed-polygons`,r)).data}async getFaceImages(e,r){return(await this.http.get(`/nodes/${e}/face-images`,{params:{input_dir:r}})).data}async createDetectionProfile(e,r,n){return(await this.http.post(`/nodes/${e}/detection-profiles`,{name:r,settings:n})).data}async listDetectionProfiles(e){return(await this.http.get(`/nodes/${e}/detection-profiles`)).data}async deleteDetectionProfile(e,r){return(await this.http.delete(`/nodes/${e}/detection-profiles/${r}`)).data}async resetDetectionProfile(e,r){return(await this.http.put(`/nodes/${e}/detection-profiles/${r}/reset`)).data}async updateParentFrames(e,r,n){return(await this.http.post(`/nodes/${e}/update-parent-frames`,{input_dir:r,parent_frame_folder:n})).data}async getNodeProgress(e){return(await this.http.get(`/nodes/${e}/progress`)).data}async importFaceData(e,r){return(await this.http.post(`/nodes/${e}/import-face-data`,{input_dir:r})).data}async copyEmbeddedData(e,r,n,s,i){return(await this.http.post(`/nodes/${e}/copy-embedded-data`,{input_dir:r,faces_folder:n,only_parent_data:s,recalculate:i})).data}async trainXSeg(e,r,n){return(await this.http.post(`/nodes/${e}/xseg/train`,{input_dir:r,xseg_model_path:n})).data}async applyXSeg(e,r,n){return(await this.http.post(`/nodes/${e}/xseg/apply`,{input_dir:r,xseg_model_path:n})).data}async getXSegStatus(e){return(await this.http.get(`/nodes/${e}/xseg/status`)).data}async saveSegmentation(e,r,n,s){return(await this.http.post("/face-editor/save-segmentation",{face_id:r,input_dir:n,segmentation_polygons:s})).data}async importDFLFaceData(e,r){return(await this.http.post("/face-editor/import-face-data",{node_id:e,input_dir:r})).data}async embedMasks(e,r,n=1,s){return(await this.http.post("/face-editor/embed-masks",{node_id:e,input_dir:r,eyebrow_expand_mod:n,face_ids:s})).data}async streamFaceImages(e,r,n,s,i){var o;try{const a=`${this.baseUrl}/nodes/${e}/face-images-stream?input_dir=${encodeURIComponent(r)}`;console.log("Starting streaming from:",a);const l=await fetch(a);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const c=(o=l.body)==null?void 0:o.getReader();if(!c)throw new Error("No response body reader available");const u=new TextDecoder;let d="",h=0;const g=setTimeout(()=>{console.warn("Streaming timeout reached, calling onComplete"),s()},3e4);for(;;){const{done:p,value:y}=await c.read();if(p){console.log("Streaming completed normally"),clearTimeout(g);break}d+=u.decode(y,{stream:!0});const v=d.split(`
`);d=v.pop()||"";for(const m of v)if(m.startsWith("data: "))try{const w=JSON.parse(m.slice(6));if(w.type==="face")console.log("Received face data:",w.data.filename),h++,n(w.data);else if(w.type==="count")console.log(`Total faces to load: ${w.total}`);else if(w.type==="complete"){console.log("Streaming completed"),clearTimeout(g),s();return}else if(w.type==="error"){console.error("Streaming error:",w.message),clearTimeout(g),i(w.message);return}}catch(w){console.error("Error parsing streaming data:",w)}}h>0&&(console.log("Streaming ended with",h,"faces loaded"),s())}catch(a){console.error("Streaming API error:",a),i(a instanceof Error?a.message:"Unknown error")}}}const ce=new ZD,e3={custom:CM},t3={},r3=()=>{const{nodes:t,edges:e,setNodes:r,setEdges:n,addNode:s,addEdge:i,removeNode:o,removeEdge:a,setSelectedNode:l}=vt(),c=mu(),u=T.useRef(null),[d,h]=T.useState({visible:!1,x:0,y:0,presets:[]}),g=t.map(O=>({id:O.id,type:"custom",position:O.position,data:{...O,onSelect:()=>l(O),onUpdate:F=>{vt.getState().updateNode(O.id,F)}}})),p=e.map(O=>({id:O.id,source:O.source,target:O.target,sourceHandle:O.sourceHandle,targetHandle:O.targetHandle,type:"smoothstep",markerEnd:{type:Jo.ArrowClosed,width:20,height:20,color:"#3b82f6"},style:{strokeWidth:2,stroke:"#3b82f6"}})),y=T.useCallback(O=>{const F={id:`edge-${Date.now()}`,source:O.source,target:O.target,sourceHandle:O.sourceHandle,targetHandle:O.targetHandle};i(F)},[i]),v=T.useCallback(O=>{O.forEach(F=>{if(F.type==="position"&&F.position){const A=F.id,L=F.position;vt.getState().updateNode(A,{position:L})}})},[]),m=T.useCallback(O=>{console.log("Edge changes:",O)},[]),w=T.useCallback((O,F)=>{const A=t.find(L=>L.id===F.id);A&&l(A)},[t,l]),x=T.useCallback(()=>{l(null)},[l]),_=T.useCallback((O,F)=>{t.find(L=>L.id===F.id)&&vt.getState().updateNode(F.id,{position:F.position})},[t]),b=T.useCallback(O=>{var M;O.preventDefault();const F=(M=u.current)==null?void 0:M.getBoundingClientRect();if(!F||!c)return;const A=O.dataTransfer.getData("application/reactflow");if(!A)return;const L=c.screenToFlowPosition({x:O.clientX-F.left,y:O.clientY-F.top}),E={id:`node-${Date.now()}`,type:A,position:L,parameters:{},status:"idle",progress:0,message:"",inputs:{},outputs:{}};s(E)},[c,s]),C=T.useCallback(O=>{O.preventDefault(),O.dataTransfer.dropEffect="move"},[]),k=T.useCallback(async O=>{O.preventDefault();try{const F=await ce.listNodePresets();h({visible:!0,x:O.clientX,y:O.clientY,presets:F})}catch(F){console.error("Failed to load presets for context menu:",F)}},[]),S=T.useCallback(async O=>{if(c)try{const F=c.screenToFlowPosition({x:d.x,y:d.y}),A=await ce.loadPresetIntoWorkflow(O.id,F);s(A),h({...d,visible:!1})}catch(F){console.error("Failed to load preset into workflow:",F)}},[c,d,s]),P=T.useCallback(()=>{h({...d,visible:!1})},[d]);return f.jsxs("div",{className:"flex-1",ref:u,children:[f.jsxs(zP,{nodes:g,edges:p,onNodesChange:v,onEdgesChange:m,onConnect:y,onNodeClick:w,onPaneClick:x,onNodeDragStop:_,onDrop:b,onDragOver:C,onPaneContextMenu:k,nodeTypes:e3,edgeTypes:t3,fitView:!0,attributionPosition:"bottom-left",children:[f.jsx(JP,{}),f.jsx(dM,{nodeStrokeColor:O=>O.type==="input"?"#0041d0":O.type==="output"?"#ff0072":"#1a192b",nodeColor:O=>O.type==="input"?"#0041d0":O.type==="output"?"#ff0072":"#1a192b",nodeBorderRadius:2}),f.jsx(UP,{variant:Qr.Dots,gap:12,size:1})]}),d.visible&&f.jsxs("div",{className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg py-2 min-w-48 transition-colors duration-300",style:{left:d.x,top:d.y},children:[f.jsx("div",{className:"px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-600 transition-colors duration-300",children:"Load Preset"}),d.presets.length===0?f.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300",children:"No presets available"}):d.presets.map(O=>f.jsxs("button",{onClick:()=>S(O),className:"w-full px-3 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:[f.jsx("div",{className:"font-medium",children:O.name}),O.description&&f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate transition-colors duration-300",children:O.description}),f.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 transition-colors duration-300",children:O.nodeType})]},O.id))]}),d.visible&&f.jsx("div",{className:"fixed inset-0 z-40",onClick:P})]})},n3=()=>{const[t,e]=T.useState([]),[r,n]=T.useState([]),[s,i]=T.useState("All"),[o,a]=T.useState(!0);T.useEffect(()=>{l()},[]);const l=async()=>{try{a(!0);const g=await ce.getNodeDefinitions(),p=await ce.getNodeCategories();e(g),n(["All",...p])}catch(g){console.error("Failed to load node definitions:",g)}finally{a(!1)}},c=(g,p)=>{g.dataTransfer.setData("application/reactflow",p),g.dataTransfer.effectAllowed="move"},u=s==="All"?t:t.filter(g=>g.category===s),d=g=>{switch(g){case"video_input":return"🎥";case"image_input":return"🖼️";case"extract_faces":return"👤";case"train_model":return"🧠";case"merge_faces":return"🔄";case"video_output":return"📹";case"image_output":return"🖼️";case"xseg_editor":return"✂️";case"denoise":return"🔧";case"enhance_faces":return"✨";default:return"📦"}},h=g=>{switch(g){case"video_input":case"image_input":return"bg-blue-100 border-blue-300";case"extract_faces":case"train_model":case"merge_faces":return"bg-green-100 border-green-300";case"video_output":case"image_output":return"bg-purple-100 border-purple-300";case"xseg_editor":case"denoise":case"enhance_faces":return"bg-yellow-100 border-yellow-300";default:return"bg-gray-100 border-gray-300"}};return o?f.jsx("div",{className:"flex-1 flex items-center justify-center",children:f.jsx("div",{className:"text-gray-500",children:"Loading nodes..."})}):f.jsxs("div",{className:"flex-1 flex flex-col",children:[f.jsx("div",{className:"p-4 border-b border-gray-200",children:f.jsx("select",{value:s,onChange:g=>i(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:r.map(g=>f.jsx("option",{value:g,children:g},g))})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[u.map(g=>f.jsxs("div",{className:`p-3 rounded-lg border-2 cursor-move hover:shadow-md transition-shadow ${h(g.type)}`,draggable:!0,onDragStart:p=>c(p,g.type),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-lg",children:d(g.type)}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"font-medium text-sm text-gray-800 truncate",children:g.name}),f.jsx("div",{className:"text-xs text-gray-600 truncate",children:g.description})]})]}),f.jsxs("div",{className:"mt-2 flex justify-between text-xs text-gray-500",children:[f.jsxs("span",{children:[g.inputs.length," inputs"]}),f.jsxs("span",{children:[g.outputs.length," outputs"]})]})]},g.id)),u.length===0&&f.jsx("div",{className:"text-center text-gray-500 py-8",children:"No nodes found in this category"})]})]})},i1=({selectedGPU:t,onGPUChange:e,disabled:r=!1,className:n=""})=>{const[s,i]=T.useState([]),[o,a]=T.useState(!0),[l,c]=T.useState(null);T.useEffect(()=>{u()},[]);const u=async()=>{try{a(!0),c(null);const p=await ce.getGPUs();i(p)}catch(p){c("Failed to load GPU information"),console.error("Error loading GPUs:",p)}finally{a(!1)}},d=p=>{switch(p){case"nvidia":return"🟢";case"amd":return"🔴";case"intel":return"🔵";case"cpu":return"⚙️";default:return"❓"}},h=p=>p>=1024?`${(p/1024).toFixed(1)} GB`:`${p} MB`,g=p=>p.is_available?p.utilization>80?"text-yellow-500":p.utilization>50?"text-orange-500":"text-green-500":"text-red-500";return o?f.jsxs("div",{className:`flex items-center space-x-2 ${n}`,children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:"Loading GPUs..."})]}):l?f.jsxs("div",{className:`flex items-center space-x-2 ${n}`,children:[f.jsx("span",{className:"text-red-500 dark:text-red-400",children:"⚠️"}),f.jsx("span",{className:"text-sm text-red-600 dark:text-red-400 transition-colors duration-300",children:l}),f.jsx("button",{onClick:u,className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline transition-colors duration-300",children:"Retry"})]}):f.jsxs("div",{className:`space-y-2 ${n}`,children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"GPU Device"}),f.jsxs("select",{value:t||"",onChange:p=>e(p.target.value?parseInt(p.target.value):null),disabled:r,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300",children:[f.jsx("option",{value:"",children:"Select GPU..."}),s.map(p=>f.jsxs("option",{value:p.id,disabled:!p.is_available,children:[d(p.type)," ",p.name,!p.is_available&&" (Unavailable)"]},p.id))]}),t&&f.jsx("div",{className:"mt-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-md transition-colors duration-300",children:(()=>{const p=s.find(y=>y.id===t);return p?f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[d(p.type)," ",p.name]}),f.jsxs("span",{className:`text-sm font-medium transition-colors duration-300 ${g(p)}`,children:[p.utilization,"% utilized"]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600 dark:text-gray-400 transition-colors duration-300",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Memory:"})," ",h(p.memory_free)," / ",h(p.memory_total)," free"]}),p.temperature&&f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Temp:"})," ",p.temperature,"°C"]}),p.power_usage&&f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Power:"})," ",p.power_usage,"W"]}),p.driver_version&&f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Driver:"})," ",p.driver_version]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${p.memory_used/p.memory_total*100}%`}})})]}):null})()}),f.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[f.jsxs("span",{children:[s.length," GPU",s.length!==1?"s":""," detected"]}),f.jsx("button",{onClick:u,className:"text-blue-600 hover:text-blue-800 underline",children:"Refresh"})]})]})},o1=({value:t,onChange:e,placeholder:r="Select a file...",filters:n=[{name:"All Files",extensions:["*"]}],className:s="",disabled:i=!1})=>{const[o,a]=T.useState(null),[l,c]=T.useState({});T.useEffect(()=>{t?u(t):(a(null),c({}))},[t]);const u=async p=>{try{if(window.electronAPI&&window.electronAPI.pathExists){const y=await window.electronAPI.pathExists(p),v=y.exists?await window.electronAPI.getFileStats(p):null;a(y.exists),c({exists:y.exists,size:v==null?void 0:v.size})}else a(!0),c({exists:!0})}catch(y){console.warn("Path validation error (fallback to valid):",y),a(!0),c({exists:!0})}},d=async()=>{try{if(window.electronAPI&&window.electronAPI.showOpenDialog){const p=await window.electronAPI.showOpenDialog({title:"Select File",filters:n,properties:["openFile"]});!p.canceled&&p.filePaths.length>0&&e(p.filePaths[0])}else{const p=document.createElement("input");p.type="file",p.accept=n.map(y=>y.extensions.map(v=>`.${v}`).join(",")).join(","),p.onchange=y=>{var m;const v=(m=y.target.files)==null?void 0:m[0];v&&e(v.name)},p.click()}}catch(p){console.error("File picker error:",p)}},h=p=>{if(p===0)return"0 Bytes";const y=1024,v=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(p)/Math.log(y));return Number.parseFloat((p/Math.pow(y,m)).toFixed(2))+" "+v[m]},g=()=>o===!1?"border-red-500":o===!0?"border-green-500":"border-gray-300 dark:border-gray-600";return f.jsxs("div",{className:`space-y-2 ${s}`,children:[f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("input",{type:"text",value:t,onChange:p=>e(p.target.value),placeholder:r,disabled:i,className:`flex-1 px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 transition-colors duration-200 ${g()}`}),f.jsx("button",{type:"button",onClick:d,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Browse"})]}),t&&f.jsxs("div",{className:"text-xs",children:[o===!0&&f.jsxs("div",{className:"text-green-600 dark:text-green-400 flex items-center space-x-1",children:[f.jsx("span",{children:"✓"}),f.jsx("span",{children:"File exists"}),l.size&&f.jsxs("span",{children:["(",h(l.size),")"]})]}),o===!1&&f.jsxs("div",{className:"text-red-600 dark:text-red-400 flex items-center space-x-1",children:[f.jsx("span",{children:"✗"}),f.jsx("span",{children:"File not found"})]})]})]})},a1=({value:t,onChange:e,placeholder:r="Select a directory...",className:n="",disabled:s=!1})=>{const[i,o]=T.useState(null),[a,l]=T.useState({});T.useEffect(()=>{t?c(t):(o(null),l({}))},[t]);const c=async d=>{try{if(window.electronAPI&&window.electronAPI.pathExists){const h=await window.electronAPI.pathExists(d),g=h.exists?await window.electronAPI.getDirectoryStats(d):null;o(h.exists),l({exists:h.exists,fileCount:g==null?void 0:g.fileCount})}else o(!0),l({exists:!0})}catch(h){console.warn("Path validation error (fallback to valid):",h),o(!0),l({exists:!0})}},u=async()=>{try{if(window.electronAPI&&window.electronAPI.showOpenDialog){const d=await window.electronAPI.showOpenDialog({title:"Select Directory",properties:["openDirectory"]});!d.canceled&&d.filePaths.length>0&&e(d.filePaths[0])}else{const d=document.createElement("input");d.type="file",d.webkitdirectory=!0,d.onchange=h=>{const g=h.target.files;if(g&&g.length>0){const y=g[0].webkitRelativePath.split("/")[0];e(y)}},d.click()}}catch(d){console.error("Directory picker error:",d)}};return f.jsxs("div",{className:`space-y-2 ${n}`,children:[f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("input",{type:"text",value:t,onChange:d=>e(d.target.value),placeholder:r,disabled:s,className:`flex-1 px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 transition-colors duration-200 ${i===!1?"border-red-500":i===!0?"border-green-500":"border-gray-300 dark:border-gray-600"}`}),f.jsx("button",{type:"button",onClick:u,disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Browse"})]}),t&&f.jsxs("div",{className:"text-xs",children:[i===!0&&f.jsxs("div",{className:"text-green-600 dark:text-green-400 flex items-center space-x-1",children:[f.jsx("span",{children:"✓"}),f.jsx("span",{children:"Directory exists"}),a.fileCount!==void 0&&f.jsxs("span",{children:["(",a.fileCount," files)"]})]}),i===!1&&f.jsxs("div",{className:"text-red-600 dark:text-red-400 flex items-center space-x-1",children:[f.jsx("span",{children:"✗"}),f.jsx("span",{children:"Directory not found"})]})]})]})};function ef(){return ef=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ef.apply(null,arguments)}function A0(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tf(t,e){return tf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},tf(t,e)}function s3(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,tf(t,e)}var F0=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function i3(t,e){return!!(t===e||F0(t)&&F0(e))}function o3(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!i3(t[r],e[r]))return!1;return!0}function kd(t,e){e===void 0&&(e=o3);var r,n=[],s,i=!1;function o(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];return i&&r===this&&e(a,n)||(s=t.apply(this,a),i=!0,r=this,n=a),s}return o}var a3=typeof performance=="object"&&typeof performance.now=="function",L0=a3?function(){return performance.now()}:function(){return Date.now()};function R0(t){cancelAnimationFrame(t.id)}function l3(t,e){var r=L0();function n(){L0()-r>=e?t.call(null):s.id=requestAnimationFrame(n)}var s={id:requestAnimationFrame(n)};return s}var Ed=-1;function c3(t){if(t===void 0&&(t=!1),Ed===-1||t){var e=document.createElement("div"),r=e.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(e),Ed=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Ed}var Fs=null;function I0(t){if(t===void 0&&(t=!1),Fs===null||t){var e=document.createElement("div"),r=e.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),s=n.style;return s.width="100px",s.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?Fs="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?Fs="negative":Fs="positive-ascending"),document.body.removeChild(e),Fs}return Fs}var u3=150,d3=function(e){var r=e.columnIndex;e.data;var n=e.rowIndex;return n+":"+r};function h3(t){var e,r=t.getColumnOffset,n=t.getColumnStartIndexForOffset,s=t.getColumnStopIndexForStartIndex,i=t.getColumnWidth,o=t.getEstimatedTotalHeight,a=t.getEstimatedTotalWidth,l=t.getOffsetForColumnAndAlignment,c=t.getOffsetForRowAndAlignment,u=t.getRowHeight,d=t.getRowOffset,h=t.getRowStartIndexForOffset,g=t.getRowStopIndexForStartIndex,p=t.initInstanceProps,y=t.shouldResetStyleCacheOnItemSizeChange,v=t.validateProps;return e=function(m){s3(w,m);function w(_){var b;return b=m.call(this,_)||this,b._instanceProps=p(b.props,A0(b)),b._resetIsScrollingTimeoutId=null,b._outerRef=void 0,b.state={instance:A0(b),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:typeof b.props.initialScrollLeft=="number"?b.props.initialScrollLeft:0,scrollTop:typeof b.props.initialScrollTop=="number"?b.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},b._callOnItemsRendered=void 0,b._callOnItemsRendered=kd(function(C,k,S,P,O,F,A,L){return b.props.onItemsRendered({overscanColumnStartIndex:C,overscanColumnStopIndex:k,overscanRowStartIndex:S,overscanRowStopIndex:P,visibleColumnStartIndex:O,visibleColumnStopIndex:F,visibleRowStartIndex:A,visibleRowStopIndex:L})}),b._callOnScroll=void 0,b._callOnScroll=kd(function(C,k,S,P,O){return b.props.onScroll({horizontalScrollDirection:S,scrollLeft:C,scrollTop:k,verticalScrollDirection:P,scrollUpdateWasRequested:O})}),b._getItemStyle=void 0,b._getItemStyle=function(C,k){var S=b.props,P=S.columnWidth,O=S.direction,F=S.rowHeight,A=b._getItemStyleCache(y&&P,y&&O,y&&F),L=C+":"+k,E;if(A.hasOwnProperty(L))E=A[L];else{var M=r(b.props,k,b._instanceProps),N=O==="rtl";A[L]=E={position:"absolute",left:N?void 0:M,right:N?M:void 0,top:d(b.props,C,b._instanceProps),height:u(b.props,C,b._instanceProps),width:i(b.props,k,b._instanceProps)}}return E},b._getItemStyleCache=void 0,b._getItemStyleCache=kd(function(C,k,S){return{}}),b._onScroll=function(C){var k=C.currentTarget,S=k.clientHeight,P=k.clientWidth,O=k.scrollLeft,F=k.scrollTop,A=k.scrollHeight,L=k.scrollWidth;b.setState(function(E){if(E.scrollLeft===O&&E.scrollTop===F)return null;var M=b.props.direction,N=O;if(M==="rtl")switch(I0()){case"negative":N=-O;break;case"positive-descending":N=L-P-O;break}N=Math.max(0,Math.min(N,L-P));var I=Math.max(0,Math.min(F,A-S));return{isScrolling:!0,horizontalScrollDirection:E.scrollLeft<O?"forward":"backward",scrollLeft:N,scrollTop:I,verticalScrollDirection:E.scrollTop<F?"forward":"backward",scrollUpdateWasRequested:!1}},b._resetIsScrollingDebounced)},b._outerRefSetter=function(C){var k=b.props.outerRef;b._outerRef=C,typeof k=="function"?k(C):k!=null&&typeof k=="object"&&k.hasOwnProperty("current")&&(k.current=C)},b._resetIsScrollingDebounced=function(){b._resetIsScrollingTimeoutId!==null&&R0(b._resetIsScrollingTimeoutId),b._resetIsScrollingTimeoutId=l3(b._resetIsScrolling,u3)},b._resetIsScrolling=function(){b._resetIsScrollingTimeoutId=null,b.setState({isScrolling:!1},function(){b._getItemStyleCache(-1)})},b}w.getDerivedStateFromProps=function(b,C){return f3(b,C),v(b),null};var x=w.prototype;return x.scrollTo=function(b){var C=b.scrollLeft,k=b.scrollTop;C!==void 0&&(C=Math.max(0,C)),k!==void 0&&(k=Math.max(0,k)),this.setState(function(S){return C===void 0&&(C=S.scrollLeft),k===void 0&&(k=S.scrollTop),S.scrollLeft===C&&S.scrollTop===k?null:{horizontalScrollDirection:S.scrollLeft<C?"forward":"backward",scrollLeft:C,scrollTop:k,scrollUpdateWasRequested:!0,verticalScrollDirection:S.scrollTop<k?"forward":"backward"}},this._resetIsScrollingDebounced)},x.scrollToItem=function(b){var C=b.align,k=C===void 0?"auto":C,S=b.columnIndex,P=b.rowIndex,O=this.props,F=O.columnCount,A=O.height,L=O.rowCount,E=O.width,M=this.state,N=M.scrollLeft,I=M.scrollTop,j=c3();S!==void 0&&(S=Math.max(0,Math.min(S,F-1))),P!==void 0&&(P=Math.max(0,Math.min(P,L-1)));var D=o(this.props,this._instanceProps),z=a(this.props,this._instanceProps),H=z>E?j:0,U=D>A?j:0;this.scrollTo({scrollLeft:S!==void 0?l(this.props,S,k,N,this._instanceProps,U):N,scrollTop:P!==void 0?c(this.props,P,k,I,this._instanceProps,H):I})},x.componentDidMount=function(){var b=this.props,C=b.initialScrollLeft,k=b.initialScrollTop;if(this._outerRef!=null){var S=this._outerRef;typeof C=="number"&&(S.scrollLeft=C),typeof k=="number"&&(S.scrollTop=k)}this._callPropsCallbacks()},x.componentDidUpdate=function(){var b=this.props.direction,C=this.state,k=C.scrollLeft,S=C.scrollTop,P=C.scrollUpdateWasRequested;if(P&&this._outerRef!=null){var O=this._outerRef;if(b==="rtl")switch(I0()){case"negative":O.scrollLeft=-k;break;case"positive-ascending":O.scrollLeft=k;break;default:var F=O.clientWidth,A=O.scrollWidth;O.scrollLeft=A-F-k;break}else O.scrollLeft=Math.max(0,k);O.scrollTop=Math.max(0,S)}this._callPropsCallbacks()},x.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&R0(this._resetIsScrollingTimeoutId)},x.render=function(){var b=this.props,C=b.children,k=b.className,S=b.columnCount,P=b.direction,O=b.height,F=b.innerRef,A=b.innerElementType,L=b.innerTagName,E=b.itemData,M=b.itemKey,N=M===void 0?d3:M,I=b.outerElementType,j=b.outerTagName,D=b.rowCount,z=b.style,H=b.useIsScrolling,U=b.width,G=this.state.isScrolling,X=this._getHorizontalRangeToRender(),Q=X[0],B=X[1],Y=this._getVerticalRangeToRender(),K=Y[0],ne=Y[1],oe=[];if(S>0&&D)for(var ae=K;ae<=ne;ae++)for(var se=Q;se<=B;se++)oe.push(T.createElement(C,{columnIndex:se,data:E,isScrolling:H?G:void 0,key:N({columnIndex:se,data:E,rowIndex:ae}),rowIndex:ae,style:this._getItemStyle(ae,se)}));var ie=o(this.props,this._instanceProps),he=a(this.props,this._instanceProps);return T.createElement(I||j||"div",{className:k,onScroll:this._onScroll,ref:this._outerRefSetter,style:ef({position:"relative",height:O,width:U,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:P},z)},T.createElement(A||L||"div",{children:oe,ref:F,style:{height:ie,pointerEvents:G?"none":void 0,width:he}}))},x._callPropsCallbacks=function(){var b=this.props,C=b.columnCount,k=b.onItemsRendered,S=b.onScroll,P=b.rowCount;if(typeof k=="function"&&C>0&&P>0){var O=this._getHorizontalRangeToRender(),F=O[0],A=O[1],L=O[2],E=O[3],M=this._getVerticalRangeToRender(),N=M[0],I=M[1],j=M[2],D=M[3];this._callOnItemsRendered(F,A,N,I,L,E,j,D)}if(typeof S=="function"){var z=this.state,H=z.horizontalScrollDirection,U=z.scrollLeft,G=z.scrollTop,X=z.scrollUpdateWasRequested,Q=z.verticalScrollDirection;this._callOnScroll(U,G,H,Q,X)}},x._getHorizontalRangeToRender=function(){var b=this.props,C=b.columnCount,k=b.overscanColumnCount,S=b.overscanColumnsCount,P=b.overscanCount,O=b.rowCount,F=this.state,A=F.horizontalScrollDirection,L=F.isScrolling,E=F.scrollLeft,M=k||S||P||1;if(C===0||O===0)return[0,0,0,0];var N=n(this.props,E,this._instanceProps),I=s(this.props,N,E,this._instanceProps),j=!L||A==="backward"?Math.max(1,M):1,D=!L||A==="forward"?Math.max(1,M):1;return[Math.max(0,N-j),Math.max(0,Math.min(C-1,I+D)),N,I]},x._getVerticalRangeToRender=function(){var b=this.props,C=b.columnCount,k=b.overscanCount,S=b.overscanRowCount,P=b.overscanRowsCount,O=b.rowCount,F=this.state,A=F.isScrolling,L=F.verticalScrollDirection,E=F.scrollTop,M=S||P||k||1;if(C===0||O===0)return[0,0,0,0];var N=h(this.props,E,this._instanceProps),I=g(this.props,N,E,this._instanceProps),j=!A||L==="backward"?Math.max(1,M):1,D=!A||L==="forward"?Math.max(1,M):1;return[Math.max(0,N-j),Math.max(0,Math.min(O-1,I+D)),N,I]},w}(T.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},e}var f3=function(e,r){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,r.instance},g3=h3({getColumnOffset:function(e,r){var n=e.columnWidth;return r*n},getColumnWidth:function(e,r){var n=e.columnWidth;return n},getRowOffset:function(e,r){var n=e.rowHeight;return r*n},getRowHeight:function(e,r){var n=e.rowHeight;return n},getEstimatedTotalHeight:function(e){var r=e.rowCount,n=e.rowHeight;return n*r},getEstimatedTotalWidth:function(e){var r=e.columnCount,n=e.columnWidth;return n*r},getOffsetForColumnAndAlignment:function(e,r,n,s,i,o){var a=e.columnCount,l=e.columnWidth,c=e.width,u=Math.max(0,a*l-c),d=Math.min(u,r*l),h=Math.max(0,r*l-c+o+l);switch(n==="smart"&&(s>=h-c&&s<=d+c?n="auto":n="center"),n){case"start":return d;case"end":return h;case"center":var g=Math.round(h+(d-h)/2);return g<Math.ceil(c/2)?0:g>u+Math.floor(c/2)?u:g;case"auto":default:return s>=h&&s<=d?s:h>d||s<h?h:d}},getOffsetForRowAndAlignment:function(e,r,n,s,i,o){var a=e.rowHeight,l=e.height,c=e.rowCount,u=Math.max(0,c*a-l),d=Math.min(u,r*a),h=Math.max(0,r*a-l+o+a);switch(n==="smart"&&(s>=h-l&&s<=d+l?n="auto":n="center"),n){case"start":return d;case"end":return h;case"center":var g=Math.round(h+(d-h)/2);return g<Math.ceil(l/2)?0:g>u+Math.floor(l/2)?u:g;case"auto":default:return s>=h&&s<=d?s:h>d||s<h?h:d}},getColumnStartIndexForOffset:function(e,r){var n=e.columnWidth,s=e.columnCount;return Math.max(0,Math.min(s-1,Math.floor(r/n)))},getColumnStopIndexForStartIndex:function(e,r,n){var s=e.columnWidth,i=e.columnCount,o=e.width,a=r*s,l=Math.ceil((o+n-a)/s);return Math.max(0,Math.min(i-1,r+l-1))},getRowStartIndexForOffset:function(e,r){var n=e.rowHeight,s=e.rowCount;return Math.max(0,Math.min(s-1,Math.floor(r/n)))},getRowStopIndexForStartIndex:function(e,r,n){var s=e.rowHeight,i=e.rowCount,o=e.height,a=r*s,l=Math.ceil((o+n-a)/s);return Math.max(0,Math.min(i-1,r+l-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.columnWidth,e.rowHeight}});const p3=({faceImages:t,viewMode:e,onFaceSelect:r,onFaceMultiSelect:n,loading:s,nodeId:i,inputDir:o})=>{const[a,l]=T.useState(new Map),[c,u]=T.useState(new Set),d=T.useRef(null),h=T.useRef(null),[g,p]=T.useState({width:800,height:600}),y=T.useCallback(S=>`http://localhost:8001/api/nodes/${i}/face-image/${encodeURIComponent(S)}?input_dir=${encodeURIComponent(o)}`,[i,o]),v=T.useCallback(S=>{r(S)},[r]),m=T.useCallback((S,P)=>{n(S,P)},[n]),w=T.useCallback(async S=>{if(!(a.has(S)||c.has(S))){u(P=>new Set(P).add(S));try{const P=await ce.getFaceData(i,S,o);P.success&&l(O=>{const F=new Map(O);return F.set(S,{landmarks:P.landmarks,segmentation:P.segmentation}),F})}catch(P){console.error(`Failed to fetch face data for ${S}:`,P)}finally{u(P=>{const O=new Set(P);return O.delete(S),O})}}},[i,o,a,c]);T.useEffect(()=>{if(e==="segmentation"||e==="alignments"){const S=t.slice(0,20);for(const P of S)w(P.id)}},[e,t,w]),T.useEffect(()=>{const S=()=>{h.current&&p({width:h.current.offsetWidth,height:h.current.offsetHeight})};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const x=160,_=Math.max(1,Math.floor(g.width/x)),b=Math.ceil(t.length/_),C=T.useCallback((S,P)=>{const F=a.get(S.id),A=c.has(S.id);return f.jsxs("div",{className:`relative group cursor-pointer transition-all duration-200 pb-6 ${S.active?"ring-2 ring-blue-500":S.selected?"ring-2 ring-green-500":"hover:ring-1 hover:ring-gray-300 dark:hover:ring-gray-600"}`,style:{width:120},onClick:()=>v(S.id),onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),v(S.id))},tabIndex:0,role:"button","aria-label":`Face image ${S.filename}${S.hasFaceData?" with imported face data":""}`,title:S.hasFaceData?"Face data imported - blue outline indicates embedded metadata":"No face data imported",children:[f.jsxs("div",{className:`w-full bg-gray-200 dark:bg-gray-700 rounded-md overflow-hidden relative ${S.hasFaceData?"ring-2 ring-blue-400 dark:ring-blue-500":""}`,style:{height:120},children:[f.jsx("img",{src:y(S.filename),alt:S.filename,className:"w-full h-full object-cover",onError:L=>{const E=L.target;E.style.display="none";const M=E.nextElementSibling;M&&(M.style.display="flex")}}),f.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500 dark:text-gray-400 text-xs",style:{display:"none"},children:S.filename}),e==="segmentation"&&(F==null?void 0:F.segmentation)&&f.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:F.segmentation.map((L,E)=>f.jsx("polygon",{points:L.map(M=>`${M[0]},${M[1]}`).join(" "),fill:"none",stroke:"#00ff00",strokeWidth:"0.5",opacity:"0.8"},E))}),e==="alignments"&&(F==null?void 0:F.landmarks)&&f.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[F.landmarks.map((L,E)=>f.jsx("circle",{cx:L[0],cy:L[1],r:"0.5",fill:"#ff0000",opacity:"0.8"},E)),F.landmarks.length>=5&&f.jsxs(f.Fragment,{children:[f.jsx("line",{x1:F.landmarks[0][0],y1:F.landmarks[0][1],x2:F.landmarks[1][0],y2:F.landmarks[1][1],stroke:"#ff0000",strokeWidth:"0.2",opacity:"0.6"}),f.jsx("line",{x1:F.landmarks[2][0],y1:F.landmarks[2][1],x2:F.landmarks[3][0],y2:F.landmarks[3][1],stroke:"#ff0000",strokeWidth:"0.2",opacity:"0.6"}),f.jsx("line",{x1:F.landmarks[4][0],y1:F.landmarks[4][1],x2:F.landmarks[4][0],y2:F.landmarks[4][1]+2,stroke:"#ff0000",strokeWidth:"0.2",opacity:"0.6"})]})]}),A&&(e==="segmentation"||e==="alignments")&&f.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded-md",children:f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"})}),S.hasFaceData&&f.jsx("div",{className:"absolute top-1 right-1 w-3 h-3 bg-blue-500 rounded-full border border-white dark:border-gray-800 flex items-center justify-center",children:f.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"})}),f.jsx("div",{className:"absolute top-1 left-1",children:f.jsx("input",{type:"checkbox",checked:S.selected||!1,onChange:L=>{L.stopPropagation(),m(S.id,L.target.checked)},className:"w-3 h-3 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),f.jsx("div",{className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:f.jsx("button",{className:"text-yellow-500 hover:text-yellow-600 text-xs",children:"🔖"})})]}),f.jsx("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400 text-center break-all px-1",children:S.filename})]},S.id)},[y,v,m,e,a,c]),k=T.useCallback(({columnIndex:S,rowIndex:P,style:O})=>{const F=P*_+S;if(F>=t.length)return null;const A=t[F];return f.jsx("div",{style:O,children:f.jsx("div",{className:"p-2 h-full",children:C(A,F)})})},[t,_,C]);return s?f.jsx("div",{className:"flex items-center justify-center h-full",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading faces..."})]})}):t.length===0?f.jsx("div",{className:"flex items-center justify-center h-full",children:f.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[f.jsx("div",{className:"text-4xl mb-4",children:"👤"}),f.jsx("p",{className:"text-lg font-medium mb-2",children:"No faces detected"}),f.jsx("p",{className:"text-sm",children:'Click "Detect Faces" to scan the input directory'})]})}):f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-2 transition-colors duration-300",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"flex items-center space-x-4",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"View Mode:"}),f.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${e==="normal"?"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200":e==="segmentation"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300"}`,children:e==="normal"?"Normal":e==="segmentation"?"Segmentation":"Alignments"}),(e==="segmentation"||e==="alignments")&&c.size>0&&f.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Loading data for ",c.size," images..."]})]})}),f.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.length," faces loaded ",t.length>1e3&&"(virtualized)"]})]})}),f.jsx("div",{ref:h,className:"flex-1",children:f.jsx(g3,{ref:d,columnCount:_,columnWidth:x,height:g.height,rowCount:b,rowHeight:x,width:g.width,className:"bg-gray-50 dark:bg-gray-900",children:k})})]})},m3=({detectionSettings:t,onSettingsChange:e,onDetectFaces:r,onLoadSegmentationModel:n,onGenerateMasks:s,onEmbedPolygons:i,faceCount:o,loading:a,inputDir:l,onInputDirChange:c,detectionProfiles:u=["default"],selectedProfile:d="default",onProfileChange:h,onAddProfile:g,onRemoveProfile:p,onResetProfile:y,parentFrameFolder:v="",onParentFrameFolderChange:m,facesFolder:w="",onFacesFolderChange:x,onlyParentData:_=!1,onOnlyParentDataChange:b,recalculateFaceData:C=!1,onRecalculateFaceDataChange:k,onCopyEmbeddedData:S,onOpenXSegEditor:P,xsegModelPath:O="",onXsegModelPathChange:F,onTrainXSeg:A,onApplyXSeg:L,setFacesToParent:E=!1,onSetFacesToParentChange:M,onUpdateParentFrames:N,onImportFaceData:I,importProgress:j=0,importMessage:D="",isImporting:z=!1})=>{const[H,U]=T.useState("faces"),[G,X]=T.useState(!1),Q=T.useCallback((B,Y)=>{e({[B]:Y})},[e]);return G?f.jsx("div",{className:"w-12 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col transition-colors duration-300",children:f.jsx("button",{onClick:()=>X(!1),className:"p-3 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):f.jsxs("div",{className:"w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col transition-colors duration-300",children:[f.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Detection Management"}),f.jsx("button",{onClick:()=>X(!0),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),f.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{onClick:()=>U("video_frame"),className:`flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200 ${H==="video_frame"?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Video Frame"}),f.jsx("button",{onClick:()=>U("faces"),className:`flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200 ${H==="faces"?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Faces"})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:H==="faces"?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"text-center",children:f.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:["Frame count ",o]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{htmlFor:"input-dir",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:["Input Directory",globalThis.electronAPI?f.jsx("span",{className:"ml-2 text-xs text-green-600 dark:text-green-400",children:"(Electron Mode)"}):f.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400",children:"(Web Mode)"})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("input",{id:"input-dir",type:"text",value:l||"",onChange:B=>c==null?void 0:c(B.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300",placeholder:"Enter directory path..."}),f.jsx("button",{onClick:async()=>{var B;if((B=globalThis.electronAPI)!=null&&B.showOpenDialog)try{const Y=await globalThis.electronAPI.showOpenDialog({title:"Select Face Images Directory",properties:["openDirectory"],filters:[{name:"All Files",extensions:["*"]}]});!Y.canceled&&Y.filePaths&&Y.filePaths.length>0&&(c==null||c(Y.filePaths[0]))}catch(Y){console.error("Error opening directory picker:",Y);const K=document.getElementById("input-dir");K&&(K.focus(),K.select())}else{const Y=document.getElementById("input-dir");Y&&(Y.focus(),Y.select())}},className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",title:"Click to select directory (or focus input field in web mode)",children:"Browse"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Detection Profiles"}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"detection-name",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Detection Name"}),f.jsx("select",{id:"detection-name",value:d,onChange:B=>h==null?void 0:h(B.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:u.map(B=>f.jsx("option",{value:B,children:B},B))})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[f.jsx("button",{onClick:()=>{const B=prompt("Enter profile name:");B&&(g==null||g(B))},className:"px-2 py-1 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded",children:"Add Name"}),f.jsx("button",{onClick:()=>p==null?void 0:p(d),className:"px-2 py-1 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded",children:"Remove Name"}),f.jsx("button",{onClick:()=>y==null?void 0:y(d),className:"px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded col-span-2",children:"Reset Name Selected"}),f.jsx("button",{onClick:()=>{confirm("Permanently remove selected faces?")},className:"px-2 py-1 text-xs font-medium text-white bg-red-700 hover:bg-red-800 rounded col-span-2",children:"Permanently Remove Selected"})]})]}),f.jsxs("div",{className:"space-y-2 border-t border-gray-200 dark:border-gray-700 pt-3",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Embedded Detections"}),f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:E,onChange:B=>M==null?void 0:M(B.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Set faces to parent frames"})]}),f.jsx("button",{onClick:i,disabled:a||o===0,className:"w-full px-3 py-2 text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 rounded focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Embed Mask Polygons"}),f.jsx("button",{onClick:I,disabled:a||z,className:"w-full px-3 py-2 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:z?"Importing...":"Import Face Data"}),z&&j!==void 0&&f.jsxs("div",{className:"mt-3",children:[f.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-1",children:[f.jsx("span",{children:D||"Importing face data..."}),f.jsxs("span",{children:[Math.round(j),"%"]})]}),f.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-600 dark:bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${j}%`}})})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"eyebrow-expand",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Eyebrow expand mod value between 1-4"}),f.jsx("input",{id:"eyebrow-expand",type:"number",min:"1",max:"4",value:t.eyebrowExpandMod,onChange:B=>Q("eyebrowExpandMod",Number.parseInt(B.target.value,10)),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})]}),f.jsxs("div",{className:"space-y-2 border-t border-gray-200 dark:border-gray-700 pt-3",children:[f.jsx("label",{htmlFor:"faces-folder",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Faces Folder"}),f.jsxs("div",{className:"flex space-x-1",children:[f.jsx("input",{id:"faces-folder",type:"text",value:w,onChange:B=>x==null?void 0:x(B.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),f.jsx("button",{onClick:async()=>{var B;if((B=globalThis.electronAPI)!=null&&B.showOpenDialog)try{const Y=await globalThis.electronAPI.showOpenDialog({title:"Select Faces Folder",properties:["openDirectory"],filters:[{name:"All Files",extensions:["*"]}]});!Y.canceled&&Y.filePaths&&Y.filePaths.length>0&&(x==null||x(Y.filePaths[0]))}catch(Y){console.error("Error opening directory picker:",Y)}},className:"px-3 py-1 text-sm bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded",children:"📁"})]}),f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:_,onChange:B=>b==null?void 0:b(B.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Only parent data"})]}),f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:C,onChange:B=>k==null?void 0:k(B.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Recalculate face data"})]}),f.jsx("button",{onClick:S,disabled:a||!w,className:"w-full px-3 py-2 text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:"Copy Embedded Data"}),f.jsx("button",{onClick:P,className:"w-full px-3 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded",children:"Open XSeg Editor"})]}),f.jsxs("div",{className:"space-y-2 border-t border-gray-200 dark:border-gray-700 pt-3",children:[f.jsx("label",{htmlFor:"xseg-model-path",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"XSeg Model Path"}),f.jsxs("div",{className:"flex space-x-1",children:[f.jsx("input",{id:"xseg-model-path",type:"text",value:O,onChange:B=>F==null?void 0:F(B.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"}),f.jsx("button",{onClick:async()=>{var B;if((B=globalThis.electronAPI)!=null&&B.showOpenDialog)try{const Y=await globalThis.electronAPI.showOpenDialog({title:"Select XSeg Model Directory",properties:["openDirectory"],filters:[{name:"All Files",extensions:["*"]}]});!Y.canceled&&Y.filePaths&&Y.filePaths.length>0&&(F==null||F(Y.filePaths[0]))}catch(Y){console.error("Error opening directory picker:",Y)}},className:"px-3 py-1 text-sm bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded",children:"📁"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("button",{onClick:A,disabled:a||!O,className:"px-3 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:"Train XSeg"}),f.jsx("button",{onClick:L,disabled:a||!O,className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply XSeg"})]})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Video Frame Mode"}),f.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:"Process video frames"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"video-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Video Input"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("input",{id:"video-input",type:"text",placeholder:"Select video file...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"}),f.jsx("button",{className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200",children:"Browse"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"output-dir",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Output Directory"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("input",{id:"output-dir",type:"text",placeholder:"Select output directory...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300"}),f.jsx("button",{className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200",children:"Browse"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"frame-rate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Frame Rate"}),f.jsxs("select",{id:"frame-rate",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-300",children:[f.jsx("option",{value:"30",children:"30 FPS"}),f.jsx("option",{value:"24",children:"24 FPS"}),f.jsx("option",{value:"60",children:"60 FPS"})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("button",{className:"w-full px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors duration-200",children:"Extract Frames"}),f.jsx("button",{className:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200",children:"Process Video"}),f.jsx("button",{className:"w-full px-4 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors duration-200",children:"Merge Frames"})]})]})})]})},y3=({logs:t,onClearLogs:e})=>{const r=T.useRef(null);return T.useEffect(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[t]),f.jsxs("div",{className:"h-48 bg-gray-900 border-t border-gray-700 flex flex-col transition-colors duration-300",children:[f.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-200 transition-colors duration-300",children:"Console"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("span",{className:"text-xs text-gray-400",children:[t.length," messages"]}),f.jsx("button",{onClick:e,className:"px-2 py-1 text-xs font-medium text-gray-300 hover:text-white bg-gray-700 hover:bg-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-gray-500 transition-colors duration-200",children:"Clear"})]})]}),f.jsx("div",{ref:r,className:"flex-1 overflow-y-auto p-3 font-mono text-sm",children:t.length===0?f.jsx("div",{className:"text-gray-500 text-center py-4",children:"No console messages yet"}):f.jsx("div",{className:"space-y-1",children:t.map((n,s)=>{let i="text-gray-300";return n.toLowerCase().includes("error")?i="text-red-400":n.toLowerCase().includes("warning")?i="text-yellow-400":n.toLowerCase().includes("success")||n.toLowerCase().includes("loaded")||n.toLowerCase().includes("found")?i="text-green-400":(n.toLowerCase().includes("info")||n.toLowerCase().includes("scanning")||n.toLowerCase().includes("generating"))&&(i="text-blue-400"),f.jsx("div",{className:`${i} transition-colors duration-200`,children:n},`log-${s}-${n.substring(0,20)}`)})})}),f.jsx("div",{className:"px-4 py-1 bg-gray-800 border-t border-gray-700",children:f.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[f.jsx("span",{children:"Ready"}),f.jsx("span",{children:"Verbose logging enabled"})]})})]})};function R(t,e,r){return(e=function(n){var s=function(i,o){if(typeof i!="object"||!i)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var l=a.call(i,o);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}(n,"string");return typeof s=="symbol"?s:s+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$0(Object(r),!0).forEach(function(n){R(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function je(t,e){if(t==null)return{};var r,n,s=function(o,a){if(o==null)return{};var l={};for(var c in o)if({}.hasOwnProperty.call(o,c)){if(a.indexOf(c)>=0)continue;l[c]=o[c]}return l}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function Ir(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}class z0{constructor(){R(this,"browserShadowBlurConstant",1),R(this,"DPI",96),R(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),R(this,"perfLimitSizeTotal",2097152),R(this,"maxCacheSideLimit",4096),R(this,"minCacheSideLimit",256),R(this,"disableStyleCopyPaste",!1),R(this,"enableGLFiltering",!0),R(this,"textureSize",4096),R(this,"forceGLPutImageData",!1),R(this,"cachesBoundsOfCurve",!1),R(this,"fontPaths",{}),R(this,"NUM_FRACTION_DIGITS",4)}}const xe=new class extends z0{constructor(t){super(),this.configure(t)}configure(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,t)}addFonts(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=$($({},this.fontPaths),t)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>{delete this.fontPaths[t]})}clearFonts(){this.fontPaths={}}restoreDefaults(t){const e=new z0,r=(t==null?void 0:t.reduce((n,s)=>(n[s]=e[s],n),{}))||e;this.configure(r)}},Dn=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return console[t]("fabric",...r)};class Tr extends Error{constructor(e,r){super("fabric: ".concat(e),r)}}class l1 extends Tr{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class x3{}class v3 extends x3{testPrecision(e,r){const n="precision ".concat(r,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,n),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const r=e.getContext("webgl");r&&(this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(r,n)),r.getExtension("WEBGL_lose_context").loseContext(),Dn("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const w3={};let B0;const Ar=()=>B0||(B0={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new v3,dispose(){},copyPasteData:w3}),Li=()=>Ar().document,Sa=()=>Ar().window,c1=()=>{var t;return Math.max((t=xe.devicePixelRatio)!==null&&t!==void 0?t:Sa().devicePixelRatio,1)},Co=new class{constructor(){R(this,"charWidthsCache",{}),R(this,"boundsOfCurveCache",{})}getFontCache(t){let{fontFamily:e,fontStyle:r,fontWeight:n}=t;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const s=this.charWidthsCache[e],i="".concat(r.toLowerCase(),"_").concat((n+"").toLowerCase());return s[i]||(s[i]={}),s[i]}clearFontCache(t){(t=(t||"").toLowerCase())?this.charWidthsCache[t]&&delete this.charWidthsCache[t]:this.charWidthsCache={}}limitDimsByArea(t){const{perfLimitSizeTotal:e}=xe,r=Math.sqrt(e*t);return[Math.floor(r),Math.floor(e/r)]}},rf="6.7.1";function cs(){}const An=Math.PI/2,sn=2*Math.PI,Og=Math.PI/180,ht=Object.freeze([1,0,0,1,0,0]),Pg=16,gn=.4477152502,de="center",ve="left",kt="top",nf="bottom",Re="right",Et="none",Mg=/\r?\n/,u1="moving",Cu="scaling",d1="rotating",Dg="rotate",h1="skewing",sa="resizing",b3="modifyPoly",_3="modifyPath",Nc="changed",ku="scale",ft="scaleX",Rt="scaleY",Ri="skewX",Ii="skewY",Xe="fill",Tt="stroke",Oc="modified",Ls="json",Td="svg",ee=new class{constructor(){this[Ls]=new Map,this[Td]=new Map}has(t){return this[Ls].has(t)}getClass(t){const e=this[Ls].get(t);if(!e)throw new Tr("No class registered for ".concat(t));return e}setClass(t,e){e?this[Ls].set(e,t):(this[Ls].set(t.type,t),this[Ls].set(t.type.toLowerCase(),t))}getSVGClass(t){return this[Td].get(t)}setSVGClass(t,e){this[Td].set(e??t.type.toLowerCase(),t)}},Pc=new class extends Array{remove(t){const e=this.indexOf(t);e>-1&&this.splice(e,1)}cancelAll(){const t=this.splice(0);return t.forEach(e=>e.abort()),t}cancelByCanvas(t){if(!t)return[];const e=this.filter(r=>{var n;return r.target===t||typeof r.target=="object"&&((n=r.target)===null||n===void 0?void 0:n.canvas)===t});return e.forEach(r=>r.abort()),e}cancelByTarget(t){if(!t)return[];const e=this.filter(r=>r.target===t);return e.forEach(r=>r.abort()),e}};class S3{constructor(){R(this,"__eventListeners",{})}on(e,r){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[s,i]=n;this.on(s,i)}),()=>this.off(e);if(r){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(r),()=>this.off(n,r)}return()=>!1}once(e,r){if(typeof e=="object"){const n=[];return Object.entries(e).forEach(s=>{let[i,o]=s;n.push(this.once(i,o))}),()=>n.forEach(s=>s())}if(r){const n=this.on(e,function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];r.call(this,...i),n()});return n}return()=>!1}_removeEventListener(e,r){if(this.__eventListeners[e])if(r){const n=this.__eventListeners[e],s=n.indexOf(r);s>-1&&n.splice(s,1)}else this.__eventListeners[e]=[]}off(e,r){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[s,i]=n;this._removeEventListener(s,i)}):this._removeEventListener(e,r)}fire(e,r){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,r||{})}}const Xn=(t,e)=>{const r=t.indexOf(e);return r!==-1&&t.splice(r,1),t},gr=t=>{if(t===0)return 1;switch(Math.abs(t)/An){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},pr=t=>{if(t===0)return 0;const e=t/An,r=Math.sign(t);switch(e){case 1:return r;case 2:return 0;case 3:return-r}return Math.sin(t)};class W{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=r)}add(e){return new W(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new W(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new W(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new W(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new W(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new W(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new W(this.x/e.x,this.y/e.y)}scalarDivide(e){return new W(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return r=Math.max(Math.min(1,r),0),new W(this.x+(e.x-this.x)*r,this.y+(e.y-this.y)*r)}distanceFrom(e){const r=this.x-e.x,n=this.y-e.y;return Math.sqrt(r*r+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new W(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new W(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,r){return this.x=e,this.y=r,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const r=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=r,e.y=n}clone(){return new W(this.x,this.y)}rotate(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ag;const n=pr(e),s=gr(e),i=this.subtract(r);return new W(i.x*s-i.y*n,i.x*n+i.y*s).add(r)}transform(e){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new W(e[0]*this.x+e[2]*this.y+(r?0:e[4]),e[1]*this.x+e[3]*this.y+(r?0:e[5]))}}const Ag=new W(0,0),Xl=t=>!!t&&Array.isArray(t._objects);function f1(t){class e extends t{constructor(){super(...arguments),R(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];const o=this._objects.push(...s);return s.forEach(a=>this._onObjectAdded(a)),o}insertAt(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return this._objects.splice(n,0,...i),i.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){const n=this._objects,s=[];for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.forEach(l=>{const c=n.indexOf(l);c!==-1&&(n.splice(c,1),s.push(l),this._onObjectRemoved(l))}),s}forEachObject(n){this.getObjects().forEach((s,i,o)=>n(s,i,o))}getObjects(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...s))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(n,!0))}complexity(){return this._objects.reduce((n,s)=>n+=s.complexity?s.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Xn(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Xn(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==0){const o=this.findNewLowerIndex(n,i,s);return Xn(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==this._objects.length-1){const o=this.findNewUpperIndex(n,i,s);return Xn(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(Xn(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,i){let o;if(i){o=s;for(let a=s-1;a>=0;--a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=s-1;return o}findNewUpperIndex(n,s,i){let o;if(i){o=s;for(let a=s+1;a<this._objects.length;++a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=s+1;return o}collectObjects(n){let{left:s,top:i,width:o,height:a}=n,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=[],u=new W(s,i),d=u.add(new W(o,a));for(let h=this._objects.length-1;h>=0;h--){const g=this._objects[h];g.selectable&&g.visible&&(l&&g.intersectsWithRect(u,d)||g.isContainedWithinRect(u,d)||l&&g.containsPoint(u)||l&&g.containsPoint(d))&&c.push(g)}return c}}return e}class g1 extends S3{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const r in e)this.set(r,e[r])}_setObject(e){for(const r in e)this._set(r,e[r])}set(e,r){return typeof e=="object"?this._setObject(e):this._set(e,r),this}_set(e,r){this[e]=r}toggle(e){const r=this.get(e);return typeof r=="boolean"&&this.set(e,!r),this}get(e){return this[e]}}function ko(t){return Sa().requestAnimationFrame(t)}function p1(t){return Sa().cancelAnimationFrame(t)}let C3=0;const Fn=()=>C3++,Fr=()=>{const t=Li().createElement("canvas");if(!t||t.getContext===void 0)throw new Tr("Failed to create `canvas` element");return t},m1=()=>Li().createElement("img"),It=t=>{const e=Fr();return e.width=t.width,e.height=t.height,e},Fg=(t,e,r)=>t.toDataURL("image/".concat(e),r),Lg=(t,e,r)=>new Promise((n,s)=>{t.toBlob(n,"image/".concat(e),r)}),Le=t=>t*Og,Lr=t=>t/Og,y1=t=>t.every((e,r)=>e===ht[r]),nt=(t,e,r)=>new W(t).transform(e,r),Dt=t=>{const e=1/(t[0]*t[3]-t[1]*t[2]),r=[e*t[3],-e*t[1],-e*t[2],e*t[0],0,0],{x:n,y:s}=new W(t[4],t[5]).transform(r,!0);return r[4]=-n,r[5]=-s,r},We=(t,e,r)=>[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],r?0:t[0]*e[4]+t[2]*e[5]+t[4],r?0:t[1]*e[4]+t[3]*e[5]+t[5]],Eu=(t,e)=>t.reduceRight((r,n)=>n&&r?We(n,r,e):n||r,void 0)||ht.concat(),x1=t=>{let[e,r]=t;return Math.atan2(r,e)},Ti=t=>{const e=x1(t),r=Math.pow(t[0],2)+Math.pow(t[1],2),n=Math.sqrt(r),s=(t[0]*t[3]-t[2]*t[1])/n,i=Math.atan2(t[0]*t[2]+t[1]*t[3],r);return{angle:Lr(e),scaleX:n,scaleY:s,skewX:Lr(i),skewY:0,translateX:t[4]||0,translateY:t[5]||0}},$i=function(t){return[1,0,0,1,t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function ks(){let{angle:t=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:r=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=Le(t),s=gr(n),i=pr(n);return[s,i,-i,s,e?e-(s*e-i*r):0,r?r-(i*e+s*r):0]}const Tu=function(t){return[t,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,0,0]},v1=t=>Math.tan(Le(t)),Rg=t=>[1,0,v1(t),1,0,0],Ig=t=>[1,v1(t),0,1,0,0],Ca=t=>{let{scaleX:e=1,scaleY:r=1,flipX:n=!1,flipY:s=!1,skewX:i=0,skewY:o=0}=t,a=Tu(n?-e:e,s?-r:r);return i&&(a=We(a,Rg(i),!0)),o&&(a=We(a,Ig(o),!0)),a},w1=t=>{const{translateX:e=0,translateY:r=0,angle:n=0}=t;let s=$i(e,r);n&&(s=We(s,ks({angle:n})));const i=Ca(t);return y1(i)||(s=We(s,i)),s},Eo=function(t){let{signal:e,crossOrigin:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,s){if(e&&e.aborted)return s(new l1("loadImage"));const i=m1();let o;e&&(o=function(l){i.src="",s(l)},e.addEventListener("abort",o,{once:!0}));const a=function(){i.onload=i.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),n(i)};t?(i.onload=a,i.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),s(new Tr("Error loading ".concat(i.src)))},r&&(i.crossOrigin=r),i.src=t):a()})},ji=function(t){let{signal:e,reviver:r=cs}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(t.map(o=>ee.getClass(o.type).fromObject(o,{signal:e}).then(a=>(r(o,a),i.push(a),a)))).then(n).catch(o=>{i.forEach(a=>{a.dispose&&a.dispose()}),s(o)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},ka=function(t){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,n)=>{const s=[];e&&e.addEventListener("abort",n,{once:!0});const i=Object.values(t).map(a=>a&&a.type&&ee.has(a.type)?ji([a],{signal:e}).then(l=>{let[c]=l;return s.push(c),c}):a),o=Object.keys(t);Promise.all(i).then(a=>a.reduce((l,c,u)=>(l[o[u]]=c,l),{})).then(r).catch(a=>{s.forEach(l=>{l.dispose&&l.dispose()}),n(a)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},Es=function(t){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,r)=>(r in t&&(e[r]=t[r]),e),{})},$g=(t,e)=>Object.keys(t).reduce((r,n)=>(e(t[n],n,t)&&(r[n]=t[n]),r),{}),_e=(t,e)=>parseFloat(Number(t).toFixed(e)),Ni=t=>"matrix("+t.map(e=>_e(e,xe.NUM_FRACTION_DIGITS)).join(" ")+")",Ut=t=>!!t&&t.toLive!==void 0,W0=t=>!!t&&typeof t.toObject=="function",H0=t=>!!t&&t.offsetX!==void 0&&"source"in t,Yn=t=>!!t&&"multiSelectionStacking"in t;function b1(t){const e=t&&or(t);let r=0,n=0;if(!t||!e)return{left:r,top:n};let s=t;const i=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(r=o.scrollLeft||i.scrollLeft||0,n=o.scrollTop||i.scrollTop||0):(r+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:r,top:n}}const or=t=>t.ownerDocument||null,_1=t=>{var e;return((e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},S1=function(t,e,r){let{width:n,height:s}=r,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;t.width=n,t.height=s,i>1&&(t.setAttribute("width",(n*i).toString()),t.setAttribute("height",(s*i).toString()),e.scale(i,i))},sf=(t,e)=>{let{width:r,height:n}=e;r&&(t.style.width=typeof r=="number"?"".concat(r,"px"):r),n&&(t.style.height=typeof n=="number"?"".concat(n,"px"):n)};function V0(t){return t.onselectstart!==void 0&&(t.onselectstart=()=>!1),t.style.userSelect=Et,t}class C1{constructor(e){R(this,"_originalCanvasStyle",void 0),R(this,"lower",void 0);const r=this.createLowerCanvas(e);this.lower={el:r,ctx:r.getContext("2d")}}createLowerCanvas(e){const r=(n=e)&&n.getContext!==void 0?e:e&&Li().getElementById(e)||Fr();var n;if(r.hasAttribute("data-fabric"))throw new Tr("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=r.style.cssText,r.setAttribute("data-fabric","main"),r.classList.add("lower-canvas"),r}cleanupDOM(e){let{width:r,height:n}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(r)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,r){const{el:n,ctx:s}=this.lower;S1(n,s,e,r)}setCSSDimensions(e){sf(this.lower.el,e)}calcOffset(){return function(e){var r;const n=e&&or(e),s={left:0,top:0};if(!n)return s;const i=((r=_1(e))===null||r===void 0?void 0:r.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let o={left:0,top:0};const a=n.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const l=b1(e);return{left:o.left+l.left-(a.clientLeft||0)+s.left,top:o.top+l.top-(a.clientTop||0)+s.top}}(this.lower.el)}dispose(){Ar().dispose(this.lower.el),delete this.lower}}const k3={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...ht]};class Ea extends f1(g1){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Ea.ownDefaults}constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(r),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new C1(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];const i=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Dn("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?c1():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,r){return this.setDimensions({width:e},r)}setHeight(e,r){return this.setDimensions({height:e},r)}_setDimensionsImpl(e){let{cssOnly:r=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r){const s=$({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,r){this._setDimensionsImpl(e,r),r&&r.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,r){const n=e,s=[...this.viewportTransform],i=nt(e,Dt(s));s[0]=r,s[3]=r;const o=nt(i,s);s[4]+=n.x-o.x,s[5]+=n.y-o.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new W(0,0),e)}absolutePan(e){const r=[...this.viewportTransform];return r[4]=-e.x,r[5]=-e.y,this.setViewportTransform(r)}relativePan(e){return this.absolutePan(new W(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=ko(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,r=this.height,n=Dt(this.viewportTransform),s=nt({x:0,y:0},n),i=nt({x:e,y:r},n),o=s.min(i),a=s.max(i);return this.vptCoords={tl:o,tr:new W(a.x,o.y),bl:new W(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(p1(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,r){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,r),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,r){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",r.transform(e),e.scale(1/r.zoomX,1/r.zoomY),e.drawImage(r._cacheCanvas,-r.cacheTranslationX,-r.cacheTranslationY),e.restore()}_renderObjects(e,r){for(let n=0,s=r.length;n<s;++n)r[n]&&r[n].render(e)}_renderBackgroundOrOverlay(e,r){const n=this["".concat(r,"Color")],s=this["".concat(r,"Image")],i=this.viewportTransform,o=this["".concat(r,"Vpt")];if(!n&&!s)return;const a=Ut(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?n.toLive(e):n,o&&e.transform(...i),a){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const l=n.gradientTransform||n.patternTransform;l&&e.transform(...l)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:l}=this;this.skipOffscreen=o,o&&e.transform(...i),s.render(e),this.skipOffscreen=l,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new W(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new W(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new W(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new W(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new W(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return nt(this.getCenterPoint(),Dt(this.viewportTransform))}_centerObject(e,r){e.setXY(r,de,de),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,r){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,e,r):null;return $($($({version:rf},Es(this,r)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,r))},this.__serializeBgOverlay(e,r)),s?{clipPath:s}:null)}_toObject(e,r,n){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[r](n);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,r){const n={},s=this.backgroundImage,i=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return Ut(o)?o.excludeFromExport||(n.background=o.toObject(r)):o&&(n.background=o),Ut(a)?a.excludeFromExport||(n.overlay=a.toObject(r)):a&&(n.overlay=a),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,e,r)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,e,r)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;e.reviver=r;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",r),this._setSVGObjects(n,r),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",r),n.push("</svg>"),n.join("")}_setSVGPreamble(e,r){r.suppressPreamble||e.push('<?xml version="1.0" encoding="',r.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,r){const n=r.width||"".concat(this.width),s=r.height||"".concat(this.height),i=xe.NUM_FRACTION_DIGITS,o=r.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const l=this.viewportTransform;a='viewBox="'.concat(_e(-l[4]/l[0],i)," ").concat(_e(-l[5]/l[3],i)," ").concat(_e(this.width/l[0],i)," ").concat(_e(this.height/l[3],i),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",rf,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(r),`</defs>
`)}createSVGClipPathMarkup(e){const r=this.clipPath;return r?(r.clipPathId="CLIPPATH_".concat(Fn()),'<clipPath id="'.concat(r.clipPathId,`" >
`).concat(r.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const r=this["".concat(e,"Color")];if(Ut(r)){const n=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return r.toSVG(i,{additionalTransform:n?Ni(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],r={},n=xe.fontPaths;this._objects.forEach(function i(o){e.push(o),Xl(o)&&o._objects.forEach(i)}),e.forEach(i=>{if(!(o=i)||typeof o._renderText!="function")return;var o;const{styles:a,fontFamily:l}=i;!r[l]&&n[l]&&(r[l]=!0,a&&Object.values(a).forEach(c=>{Object.values(c).forEach(u=>{let{fontFamily:d=""}=u;!r[d]&&n[d]&&(r[d]=!0)})}))});const s=Object.keys(r).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(n[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,r){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,r)})}_setSVGObject(e,r,n){e.push(r.toSVG(n))}_setSVGBgOverlayImage(e,r,n){const s=this[r];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(n))}_setSVGBgOverlayColor(e,r){const n=this["".concat(r,"Color")];if(n)if(Ut(n)){const s=n.repeat||"",i=this.width,o=this.height,a=this["".concat(r,"Vpt")]?Ni(Dt(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(i/2,",").concat(o/2,')" x="').concat(n.offsetX-i/2,'" y="').concat(n.offsetY-o/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!H0(n)?i:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!H0(n)?o:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,r){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Tr("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[],backgroundImage:o,background:a,overlayImage:l,overlay:c,clipPath:u}=s,d=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([ji(i,{reviver:r,signal:n}),ka({backgroundImage:o,backgroundColor:a,overlayImage:l,overlayColor:c,clipPath:u},{signal:n})]).then(h=>{let[g,p]=h;return this.clear(),this.add(...g),this.set(s),this.set(p),this.renderOnAddRemove=d,this})}clone(e){const r=this.toObject(e);return this.cloneWithoutData().loadFromJSON(r)}cloneWithoutData(){const e=It(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:r="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,o=s*(i?this.getRetinaScaling():1);return Fg(this.toCanvasElement(o,e),r,n)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:r="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,o=s*(i?this.getRetinaScaling():1);return Lg(this.toCanvasElement(o,e),r,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:r,height:n,left:s,top:i,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(r||this.width)*e,l=(n||this.height)*e,c=this.getZoom(),u=this.width,d=this.height,h=this.skipControlsDrawing,g=c*e,p=this.viewportTransform,y=[g,0,0,g,(p[4]-(s||0))*e,(p[5]-(i||0))*e],v=this.enableRetinaScaling,m=It({width:a,height:l}),w=o?this._objects.filter(x=>o(x)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=y,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),w),this.viewportTransform=p,this.width=u,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=v,this.skipControlsDrawing=h,m}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Pc.cancelByCanvas(this),this.disposed=!0,new Promise((e,r)=>{const n=()=>{this.destroy(),e(!0)};n.kill=r,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}R(Ea,"ownDefaults",k3);const E3=["touchstart","touchmove","touchend"],k1=t=>{const e=b1(t.target),r=function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n}(t);return new W(r.clientX+e.left,r.clientY+e.top)},Mc=t=>E3.includes(t.type)||t.pointerType==="touch",U0=t=>{t.preventDefault(),t.stopPropagation()},Pr=t=>{let e=0,r=0,n=0,s=0;for(let i=0,o=t.length;i<o;i++){const{x:a,y:l}=t[i];(a>n||!i)&&(n=a),(a<e||!i)&&(e=a),(l>s||!i)&&(s=l),(l<r||!i)&&(r=l)}return{left:e,top:r,width:n-e,height:s-r}},T3=["translateX","translateY","scaleX","scaleY"],E1=(t,e)=>Oi(t,We(e,t.calcOwnMatrix())),Oi=(t,e)=>{const r=Ti(e),{translateX:n,translateY:s,scaleX:i,scaleY:o}=r,a=je(r,T3),l=new W(n,s);t.flipX=!1,t.flipY=!1,Object.assign(t,a),t.set({scaleX:i,scaleY:o}),t.setPositionByOrigin(l,de,de)},T1=t=>{t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},zg=t=>({scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}),ju=(t,e,r)=>{const n=t/2,s=e/2,i=[new W(-n,-s),new W(n,-s),new W(-n,s),new W(n,s)].map(a=>a.transform(r)),o=Pr(i);return new W(o.width,o.height)},Ta=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ht;return We(Dt(arguments.length>1&&arguments[1]!==void 0?arguments[1]:ht),t)},us=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ht,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ht;return t.transform(Ta(e,r))},j1=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ht,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ht;return t.transform(Ta(e,r),!0)},of=(t,e,r)=>{const n=Ta(e,r);return Oi(t,We(n,t.calcOwnMatrix())),n},N1=(t,e)=>{var r;const{transform:{target:n}}=e;(r=n.canvas)===null||r===void 0||r.fire("object:".concat(t),$($({},e),{},{target:n})),n.fire(t,e)},j3={left:-.5,top:-.5,center:0,bottom:.5,right:.5},ze=t=>typeof t=="string"?j3[t]:t-.5,Dc="not-allowed";function O1(t){return ze(t.originX)===ze(de)&&ze(t.originY)===ze(de)}function X0(t){return .5-ze(t)}const hr=(t,e)=>t[e],P1=(t,e,r,n)=>({e:t,transform:e,pointer:new W(r,n)});function M1(t,e){const r=t.getTotalAngle()+Lr(Math.atan2(e.y,e.x))+360;return Math.round(r%360/45)}function Bg(t,e,r,n,s){var i;let{target:o,corner:a}=t;const l=o.controls[a],c=((i=o.canvas)===null||i===void 0?void 0:i.getZoom())||1,u=o.padding/c,d=function(h,g,p,y){const v=h.getRelativeCenterPoint(),m=p!==void 0&&y!==void 0?h.translateToGivenOrigin(v,de,de,p,y):new W(h.left,h.top);return(h.angle?g.rotate(-Le(h.angle),v):g).subtract(m)}(o,new W(n,s),e,r);return d.x>=u&&(d.x-=u),d.x<=-u&&(d.x+=u),d.y>=u&&(d.y-=u),d.y<=u&&(d.y+=u),d.x-=l.offsetX,d.y-=l.offsetY,d}const N3=(t,e,r,n)=>{const{target:s,offsetX:i,offsetY:o}=e,a=r-i,l=n-o,c=!hr(s,"lockMovementX")&&s.left!==a,u=!hr(s,"lockMovementY")&&s.top!==l;return c&&s.set(ve,a),u&&s.set(kt,l),(c||u)&&N1(u1,P1(t,e,r,n)),c||u},Y0={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},jd=(t,e,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t),G0=(t,e,r,n)=>{t/=255,e/=255,r/=255;const s=Math.max(t,e,r),i=Math.min(t,e,r);let o,a;const l=(s+i)/2;if(s===i)o=a=0;else{const c=s-i;switch(a=l>.5?c/(2-s-i):c/(s+i),s){case t:o=(e-r)/c+(e<r?6:0);break;case e:o=(r-t)/c+2;break;case r:o=(t-e)/c+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),n]},q0=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(t)/(t.endsWith("%")?100:1)},rl=t=>Math.min(Math.round(t),255).toString(16).toUpperCase().padStart(2,"0"),K0=t=>{let[e,r,n,s=1]=t;const i=Math.round(.3*e+.59*r+.11*n);return[i,i,i,s]};class we{constructor(e){if(R(this,"isUnrecognised",!1),e)if(e instanceof we)this.setSource([...e._source]);else if(Array.isArray(e)){const[r,n,s,i=1]=e;this.setSource([r,n,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in Y0&&(e=Y0[e]),e==="transparent"?[255,255,255,0]:we.sourceFromHex(e)||we.sourceFromRgb(e)||we.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,r,n]=this.getSource();return"rgb(".concat(e,",").concat(r,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,r,n]=G0(...this.getSource());return"hsl(".concat(e,",").concat(r,"%,").concat(n,"%)")}toHsla(){const[e,r,n,s]=G0(...this.getSource());return"hsla(".concat(e,",").concat(r,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,r,n,s]=this.getSource();return"".concat(rl(e)).concat(rl(r)).concat(rl(n)).concat(rl(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(K0(this.getSource())),this}toBlackWhite(e){const[r,,,n]=K0(this.getSource()),s=r<(e||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(e){e instanceof we||(e=new we(e));const r=this.getSource(),n=e.getSource(),[s,i,o]=r.map((a,l)=>Math.round(.5*a+.5*n[l]));return this.setSource([s,i,o,r[3]]),this}static fromRgb(e){return we.fromRgba(e)}static fromRgba(e){return new we(we.sourceFromRgb(e))}static sourceFromRgb(e){const r=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(r){const[n,s,i]=r.slice(1,4).map(o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[n,s,i,q0(r[4])]}}static fromHsl(e){return we.fromHsla(e)}static fromHsla(e){return new we(we.sourceFromHsl(e))}static sourceFromHsl(e){const r=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!r)return;const n=(we.parseAngletoDegrees(r[1])%360+360)%360/360,s=parseFloat(r[2])/100,i=parseFloat(r[3])/100;let o,a,l;if(s===0)o=a=l=i;else{const c=i<=.5?i*(s+1):i+s-i*s,u=2*i-c;o=jd(u,c,n+1/3),a=jd(u,c,n),l=jd(u,c,n-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*l),q0(r[4])]}static fromHex(e){return new we(we.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const r=e.slice(e.indexOf("#")+1);let n;n=r.length<=4?r.split("").map(l=>l+l):r.match(/.{2}/g);const[s,i,o,a=255]=n.map(l=>parseInt(l,16));return[s,i,o,a/255]}}static parseAngletoDegrees(e){const r=e.toLowerCase(),n=parseFloat(r);return r.includes("rad")?Lr(n):r.includes("turn")?360*n:n}}const ds=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pg;const r=/\D{0,2}$/.exec(t),n=parseFloat(t),s=xe.DPI;switch(r==null?void 0:r[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*e;default:return n}},D1=t=>{const[e,r]=t.trim().split(" "),[n,s]=(i=e)&&i!==Et?[i.slice(1,4),i.slice(5,8)]:i===Et?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:r||"meet",alignX:n,alignY:s}},ia=function(t,e){let r,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)r="url(#SVGID_".concat(e.id,")");else{const i=new we(e),o=i.getAlpha();r=i.toRgb(),o!==1&&(n=o.toString())}else r="none";return s?"".concat(t,": ").concat(r,"; ").concat(n?"".concat(t,"-opacity: ").concat(n,"; "):""):"".concat(t,'="').concat(r,'" ').concat(n?"".concat(t,'-opacity="').concat(n,'" '):"")};class A1{getSvgStyles(e){const r=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):Et,i=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),h=ia(Xe,this.fill);return[ia(Tt,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",h,"fill-rule: ",r,"; ","opacity: ",c,";",d,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(Ni(n));return"".concat(s).concat(r,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:r,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,r?r(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:r,reviver:n,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=r?"":'style="'.concat(this.getSvgStyles(),'" '),a=s?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,d=this.stroke,h=this.fill,g=this.shadow,p=[],y=e.indexOf("COMMON_PARTS");let v;l&&(l.clipPathId="CLIPPATH_".concat(Fn()),v='<clipPath id="'.concat(l.clipPathId,`" >
`).concat(l.toClipPathSVG(n),`</clipPath>
`)),u&&p.push("<g ",a,this.getSvgCommons(),` >
`),p.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);const m=[o,c,r?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[y]=m,Ut(h)&&p.push(h.toSVG(this)),Ut(d)&&p.push(d.toSVG(this)),g&&p.push(g.toSVG(this)),l&&p.push(v),p.push(e.join("")),p.push(`</g>
`),u&&p.push(`</g>
`),n?n(p.join("")):p.join("")}addPaintOrder(){return this.paintFirst!==Xe?' paint-order="'.concat(this.paintFirst,'" '):""}}function Nu(t){return new RegExp("^("+t.join("|")+")\\b","i")}const bs="textDecorationThickness",F1=["fontSize","fontWeight","fontFamily","fontStyle"],L1=["underline","overline","linethrough"],R1=[...F1,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],I1=[...R1,...L1,"textBackgroundColor","direction",bs],O3=[...F1,...L1,Tt,"strokeWidth",Xe,"deltaY","textBackgroundColor",bs],P3={_reNewline:Mg,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:ve,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:ve,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[bs]:66.667},Er="justify",Ac="justify-left",To="justify-right",jo="justify-center";var Q0,J0,Z0;const cr=String.raw(Q0||(Q0=Ir(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),Nd=String.raw(J0||(J0=Ir(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),M3=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+cr+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+cr+"))?\\s+(.*)"),D3={cx:ve,x:ve,r:"radius",cy:kt,y:kt,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":bs},Od="font-size",Pd="clip-path";Nu(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);Nu(["symbol","image","marker","pattern","view","svg"]);const ey=Nu(["symbol","g","a","svg","clipPath","defs"]);new RegExp(String.raw(Z0||(Z0=Ir(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),cr,Nd,cr,Nd,cr,Nd,cr));const A3=new W(1,0),$1=new W,Wg=(t,e)=>t.rotate(e),Fc=(t,e)=>new W(e).subtract(t),Lc=t=>t.distanceFrom($1),Rc=(t,e)=>Math.atan2(ci(t,e),B1(t,e)),z1=t=>Rc(A3,t),Ou=t=>t.eq($1)?t:t.scalarDivide(Lc(t)),Hg=function(t){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Ou(new W(-t.y,t.x).scalarMultiply(e?1:-1))},ci=(t,e)=>t.x*e.y-t.y*e.x,B1=(t,e)=>t.x*e.x+t.y*e.y,af=(t,e,r)=>{if(t.eq(e)||t.eq(r))return!0;const n=ci(e,r),s=ci(e,t),i=ci(r,t);return n>=0?s>=0&&i<=0:!(s<=0&&i>=0)},ty="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",ry=new RegExp("(?:\\s|^)"+ty+ty+"("+cr+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Jr{constructor(e){const r=typeof e=="string"?Jr.parseShadow(e):e;Object.assign(this,Jr.ownDefaults,r),this.id=Fn()}static parseShadow(e){const r=e.trim(),[,n=0,s=0,i=0]=(ry.exec(r)||[]).map(o=>parseFloat(o)||0);return{color:(r.replace(ry,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const r=Wg(new W(this.offsetX,this.offsetY),Le(-e.angle)),n=new we(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*_e((Math.abs(r.x)+this.blur)/e.width,xe.NUM_FRACTION_DIGITS)+20,i=100*_e((Math.abs(r.y)+this.blur)/e.height,xe.NUM_FRACTION_DIGITS)+20),e.flipX&&(r.x*=-1),e.flipY&&(r.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(_e(this.blur?this.blur/2:0,xe.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(_e(r.x,xe.NUM_FRACTION_DIGITS),'" dy="').concat(_e(r.y,xe.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},r=Jr.ownDefaults;return this.includeDefaultValues?e:$g(e,(n,s)=>n!==r[s])}static async fromObject(e){return new this(e)}}R(Jr,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),R(Jr,"type","shadow"),ee.setClass(Jr,"shadow");const _s=(t,e,r)=>Math.max(t,Math.min(e,r)),F3=[kt,ve,ft,Rt,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Ri,Ii],ln=[Xe,Tt,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],L3={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:ve,originY:kt,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Xe,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Md=(t,e,r,n)=>(t<Math.abs(e)?(t=e,n=r/4):n=e===0&&t===0?r/sn*Math.asin(1):r/sn*Math.asin(e/t),{a:t,c:e,p:r,s:n}),ny=(t,e,r,n,s)=>t*Math.pow(2,10*(n-=1))*Math.sin((n*s-e)*sn/r),W1=(t,e,r,n)=>-r*Math.cos(t/n*An)+r+e,lf=(t,e,r,n)=>(t/=n)<1/2.75?r*(7.5625*t*t)+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e,sy=(t,e,r,n)=>r-lf(n-t,0,r,n)+e;var R3=Object.freeze({__proto__:null,defaultEasing:W1,easeInBack:function(t,e,r,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return r*(t/=n)*t*((s+1)*t-s)+e},easeInBounce:sy,easeInCirc:(t,e,r,n)=>-r*(Math.sqrt(1-(t/=n)*t)-1)+e,easeInCubic:(t,e,r,n)=>r*(t/n)**3+e,easeInElastic:(t,e,r,n)=>{const s=r;let i=0;if(t===0)return e;if((t/=n)===1)return e+r;i||(i=.3*n);const{a:o,s:a,p:l}=Md(s,r,i,1.70158);return-ny(o,a,l,t,n)+e},easeInExpo:(t,e,r,n)=>t===0?e:r*2**(10*(t/n-1))+e,easeInOutBack:function(t,e,r,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(t/=n/2)<1?r/2*(t*t*((1+(s*=1.525))*t-s))+e:r/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+e},easeInOutBounce:(t,e,r,n)=>t<n/2?.5*sy(2*t,0,r,n)+e:.5*lf(2*t-n,0,r,n)+.5*r+e,easeInOutCirc:(t,e,r,n)=>(t/=n/2)<1?-r/2*(Math.sqrt(1-t**2)-1)+e:r/2*(Math.sqrt(1-(t-=2)*t)+1)+e,easeInOutCubic:(t,e,r,n)=>(t/=n/2)<1?r/2*t**3+e:r/2*((t-2)**3+2)+e,easeInOutElastic:(t,e,r,n)=>{const s=r;let i=0;if(t===0)return e;if((t/=n/2)===2)return e+r;i||(i=n*(.3*1.5));const{a:o,s:a,p:l,c}=Md(s,r,i,1.70158);return t<1?-.5*ny(o,a,l,t,n)+e:o*Math.pow(2,-10*(t-=1))*Math.sin((t*n-a)*sn/l)*.5+c+e},easeInOutExpo:(t,e,r,n)=>t===0?e:t===n?e+r:(t/=n/2)<1?r/2*2**(10*(t-1))+e:r/2*-(2**(-10*--t)+2)+e,easeInOutQuad:(t,e,r,n)=>(t/=n/2)<1?r/2*t**2+e:-r/2*(--t*(t-2)-1)+e,easeInOutQuart:(t,e,r,n)=>(t/=n/2)<1?r/2*t**4+e:-r/2*((t-=2)*t**3-2)+e,easeInOutQuint:(t,e,r,n)=>(t/=n/2)<1?r/2*t**5+e:r/2*((t-2)**5+2)+e,easeInOutSine:(t,e,r,n)=>-r/2*(Math.cos(Math.PI*t/n)-1)+e,easeInQuad:(t,e,r,n)=>r*(t/=n)*t+e,easeInQuart:(t,e,r,n)=>r*(t/=n)*t**3+e,easeInQuint:(t,e,r,n)=>r*(t/n)**5+e,easeInSine:(t,e,r,n)=>-r*Math.cos(t/n*An)+r+e,easeOutBack:function(t,e,r,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return r*((t=t/n-1)*t*((s+1)*t+s)+1)+e},easeOutBounce:lf,easeOutCirc:(t,e,r,n)=>r*Math.sqrt(1-(t=t/n-1)*t)+e,easeOutCubic:(t,e,r,n)=>r*((t/n-1)**3+1)+e,easeOutElastic:(t,e,r,n)=>{const s=r;let i=0;if(t===0)return e;if((t/=n)===1)return e+r;i||(i=.3*n);const{a:o,s:a,p:l,c}=Md(s,r,i,1.70158);return o*2**(-10*t)*Math.sin((t*n-a)*sn/l)+c+e},easeOutExpo:(t,e,r,n)=>t===n?e+r:r*-(2**(-10*t/n)+1)+e,easeOutQuad:(t,e,r,n)=>-r*(t/=n)*(t-2)+e,easeOutQuart:(t,e,r,n)=>-r*((t=t/n-1)*t**3-1)+e,easeOutQuint:(t,e,r,n)=>r*((t/n-1)**5+1)+e,easeOutSine:(t,e,r,n)=>r*Math.sin(t/n*An)+e});const I3=()=>!1;class Vg{constructor(e){let{startValue:r,byValue:n,duration:s=500,delay:i=0,easing:o=W1,onStart:a=cs,onChange:l=cs,onComplete:c=cs,abort:u=I3,target:d}=e;R(this,"_state","pending"),R(this,"durationProgress",0),R(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=o,this._onStart=a,this._onChange=l,this._onComplete=c,this._abort=u,this.target=d,this.startValue=r,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=r=>{this._state==="pending"&&(this.startTime=r||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>ko(e),this.delay):ko(e)}tick(e){const r=(e||+new Date)-this.startTime,n=Math.min(r,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:i}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):r>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),ko(this.tick)))}register(){Pc.push(this)}unregister(){Pc.remove(this)}abort(){this._state="aborted",this.unregister()}}const $3=["startValue","endValue"];class z3 extends Vg{constructor(e){let{startValue:r=0,endValue:n=100}=e;super($($({},je(e,$3)),{},{startValue:r,byValue:n-r}))}calculate(e){const r=this.easing(e,this.startValue,this.byValue,this.duration);return{value:r,valueProgress:Math.abs((r-this.startValue)/this.byValue)}}}const B3=["startValue","endValue"];class W3 extends Vg{constructor(e){let{startValue:r=[0],endValue:n=[100]}=e;super($($({},je(e,B3)),{},{startValue:r,byValue:n.map((s,i)=>s-r[i])}))}calculate(e){const r=this.startValue.map((n,s)=>this.easing(e,n,this.byValue[s],this.duration,s));return{value:r,valueProgress:Math.abs((r[0]-this.startValue[0])/this.byValue[0])}}}const H3=["startValue","endValue","easing","onChange","onComplete","abort"],V3=(t,e,r,n)=>e+r*(1-Math.cos(t/n*An)),Dd=t=>t&&((e,r,n)=>t(new we(e).toRgba(),r,n));class U3 extends Vg{constructor(e){let{startValue:r,endValue:n,easing:s=V3,onChange:i,onComplete:o,abort:a}=e,l=je(e,H3);const c=new we(r).getSource(),u=new we(n).getSource();super($($({},l),{},{startValue:c,byValue:u.map((d,h)=>d-c[h]),easing:s,onChange:Dd(i),onComplete:Dd(o),abort:Dd(a)}))}calculate(e){const[r,n,s,i]=this.startValue.map((a,l)=>this.easing(e,a,this.byValue[l],this.duration,l)),o=[...[r,n,s].map(Math.round),_s(0,i,1)];return{value:o,valueProgress:o.map((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0).find(a=>a!==0)||0}}}function Ug(t){const e=(r=>Array.isArray(r.startValue)||Array.isArray(r.endValue))(t)?new W3(t):new z3(t);return e.start(),e}function H1(t){const e=new U3(t);return e.start(),e}class Oe{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(r=>r.eq(e))}append(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.points=this.points.concat(r.filter(s=>!this.includes(s))),this}static isPointContained(e,r,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(r.eq(n))return e.eq(r);if(r.x===n.x)return e.x===r.x&&(s||e.y>=Math.min(r.y,n.y)&&e.y<=Math.max(r.y,n.y));if(r.y===n.y)return e.y===r.y&&(s||e.x>=Math.min(r.x,n.x)&&e.x<=Math.max(r.x,n.x));{const i=Fc(r,n),o=Fc(r,e).divide(i);return s?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,r){const n=new W(e).setX(Math.min(e.x-1,...r.map(i=>i.x)));let s=0;for(let i=0;i<r.length;i++){const o=this.intersectSegmentSegment(r[i],r[(i+1)%r.length],e,n);if(o.includes(e))return!0;s+=+(o.status==="Intersection")}return s%2==1}static intersectLineLine(e,r,n,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=r.x-e.x,l=r.y-e.y,c=s.x-n.x,u=s.y-n.y,d=e.x-n.x,h=e.y-n.y,g=c*h-u*d,p=a*h-l*d,y=u*a-c*l;if(y!==0){const v=g/y,m=p/y;return(i||0<=v&&v<=1)&&(o||0<=m&&m<=1)?new Oe("Intersection").append(new W(e.x+v*a,e.y+v*l)):new Oe}if(g===0||p===0){const v=i||o||Oe.isPointContained(e,n,s)||Oe.isPointContained(r,n,s)||Oe.isPointContained(n,e,r)||Oe.isPointContained(s,e,r);return new Oe(v?"Coincident":void 0)}return new Oe("Parallel")}static intersectSegmentLine(e,r,n,s){return Oe.intersectLineLine(e,r,n,s,!1,!0)}static intersectSegmentSegment(e,r,n,s){return Oe.intersectLineLine(e,r,n,s,!1,!1)}static intersectLinePolygon(e,r,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new Oe,o=n.length;for(let a,l,c,u=0;u<o;u++){if(a=n[u],l=n[(u+1)%o],c=Oe.intersectLineLine(e,r,a,l,s,!1),c.status==="Coincident")return c;i.append(...c.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,r,n){return Oe.intersectLinePolygon(e,r,n,!1)}static intersectPolygonPolygon(e,r){const n=new Oe,s=e.length,i=[];for(let o=0;o<s;o++){const a=e[o],l=e[(o+1)%s],c=Oe.intersectSegmentPolygon(a,l,r);c.status==="Coincident"?(i.push(c),n.append(a,l)):n.append(...c.points)}return i.length>0&&i.length===e.length?new Oe("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,r,n){const s=r.min(n),i=r.max(n),o=new W(i.x,s.y),a=new W(s.x,i.y);return Oe.intersectPolygonPolygon(e,[s,o,i,a])}}class X3 extends g1{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?nt(e,this.group.calcTransformMatrix()):e}setXY(e,r,n){this.group&&(e=nt(e,Dt(this.group.calcTransformMatrix()))),this.setRelativeXY(e,r,n)}getRelativeXY(){return new W(this.left,this.top)}setRelativeXY(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,r,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:r,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,r,n,s];if(this.group){const o=this.group.calcTransformMatrix();return i.map(a=>nt(a,o))}return i}intersectsWithRect(e,r){return Oe.intersectPolygonRectangle(this.getCoords(),e,r).status==="Intersection"}intersectsWithObject(e){const r=Oe.intersectPolygonPolygon(this.getCoords(),e.getCoords());return r.status==="Intersection"||r.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(r=>e.containsPoint(r))}isContainedWithinRect(e,r){const{left:n,top:s,width:i,height:o}=this.getBoundingRect();return n>=e.x&&n+i<=r.x&&s>=e.y&&s+o<=r.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return Oe.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:r}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=r.x&&n.x>=e.x&&n.y<=r.y&&n.y>=e.y)||!!this.intersectsWithRect(e,r)||this.containsPoint(e.midPointFrom(r))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:r}=this.canvas.vptCoords;return this.intersectsWithRect(e,r)?!0:this.getCoords().every(n=>(n.x>=r.x||n.x<=e.x)&&(n.y>=r.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(r))}getBoundingRect(){return Pr(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(ft,e),this._set(Rt,e),this.setCoords()}scaleToWidth(e){const r=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/r)}scaleToHeight(e){const r=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/r)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Lr(x1(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||ht.concat()}calcACoords(){const e=ks({angle:this.angle}),{x:r,y:n}=this.getRelativeCenterPoint(),s=$i(r,n),i=We(s,e),o=this._getTransformedDimensions(),a=o.x/2,l=o.y/2;return{tl:nt({x:-a,y:-l},i),tr:nt({x:a,y:-l},i),bl:nt({x:-a,y:l},i),br:nt({x:a,y:l},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=[];return!e&&this.group&&(r=this.group.transformMatrixKey(e)),r.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,ze(this.originX),ze(this.originY)),r}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=this.calcOwnMatrix();if(e||!this.group)return r;const n=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,o)=>i===n[o])?s.value:(this.group&&(r=We(this.group.calcTransformMatrix(!1),r)),this.matrixCache={key:n,value:r},r)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),r=this.ownMatrixCache;if(r&&r.key===e)return r.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=w1(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new W(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=$({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=r.strokeWidth;let s=n,i=0;this.strokeUniform&&(s=0,i=n);const o=r.width+s,a=r.height+s;let l;return l=r.skewX===0&&r.skewY===0?new W(o*r.scaleX,a*r.scaleY):ju(o,a,Ca(r)),l.scalarAdd(i)}translateToGivenOrigin(e,r,n,s,i){let o=e.x,a=e.y;const l=ze(s)-ze(r),c=ze(i)-ze(n);if(l||c){const u=this._getTransformedDimensions();o+=l*u.x,a+=c*u.y}return new W(o,a)}translateToCenterPoint(e,r,n){if(r===de&&n===de)return e;const s=this.translateToGivenOrigin(e,r,n,de,de);return this.angle?s.rotate(Le(this.angle),e):s}translateToOriginPoint(e,r,n){const s=this.translateToGivenOrigin(e,de,de,r,n);return this.angle?s.rotate(Le(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?nt(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new W(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,r){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,r)}setPositionByOrigin(e,r,n){const s=this.translateToCenterPoint(e,r,n),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),ve,kt)}}const Y3=["type"],G3=["extraParam"];let Br=class Yl extends X3{static getDefaults(){return Yl.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Dn("warn","Setting type has no effect",e)}constructor(e){super(),R(this,"_cacheContext",null),Object.assign(this,Yl.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Fr(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const r=e.width,n=e.height,s=xe.maxCacheSideLimit,i=xe.minCacheSideLimit;if(r<=s&&n<=s&&r*n<=xe.perfLimitSizeTotal)return r<i&&(e.width=i),n<i&&(e.height=i),e;const o=r/n,[a,l]=Co.limitDimsByArea(o),c=_s(i,a,s),u=_s(i,l,s);return r>c&&(e.zoomX/=r/c,e.width=c,e.capped=!0),n>u&&(e.zoomY/=n/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),r=this._getTransformedDimensions({skewX:0,skewY:0}),n=r.x*e.x/this.scaleX,s=r.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:n,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,r=this._cacheContext,{width:n,height:s,zoomX:i,zoomY:o,x:a,y:l}=this._limitCacheSize(this._getCacheCanvasDimensions()),c=n!==e.width||s!==e.height,u=this.zoomX!==i||this.zoomY!==o;if(!e||!r)return!1;if(c||u){n!==e.width||s!==e.height?(e.width=n,e.height=s):(r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,e.width,e.height));const d=a/2,h=l/2;return this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-h)+h,r.translate(this.cacheTranslationX,this.cacheTranslationY),r.scale(i,o),this.zoomX=i,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const r=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!r);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new W(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Ti(this.calcTransformMatrix());return new W(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const r=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(r*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,r){e!==ft&&e!==Rt||(r=this._constrainScale(r)),e===ft&&r<0?(this.flipX=!this.flipX,r*=-1):e==="scaleY"&&r<0?(this.flipY=!this.flipY,r*=-1):e!=="shadow"||!r||r instanceof Jr||(r=new Jr(r));const n=this[e]!==r;return this[e]=r,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:r,zoomY:n,cacheTranslationX:s,cacheTranslationY:i}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:r,zoomY:n,cacheTranslationX:s,cacheTranslationY:i,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Tt&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,r,n){e.save(),r.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,r,n){const s=this.fill,i=this.stroke;r?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=s,this.stroke=i}createClipPathLayer(e,r){const n=It(r),s=n.getContext("2d");if(s.translate(r.cacheTranslationX,r.cacheTranslationY),s.scale(r.zoomX,r.zoomY),e._cacheCanvas=n,r.parentClipPaths.forEach(i=>{i.transform(s)}),r.parentClipPaths.push(e),e.absolutePositioned){const i=Dt(this.calcTransformMatrix());s.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return e.transform(s),e.drawObject(s,!0,r),n}_drawClipPath(e,r,n){if(!r)return;r._transformDone=!0;const s=this.createClipPathLayer(r,n);this.drawClipPathOnCache(e,r,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const r=this._cacheCanvas,n=this._cacheContext;return!(!r||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(r&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r.width,r.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const r=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,r){const n=r.stroke;n&&(e.lineWidth=r.strokeWidth,e.lineCap=r.strokeLineCap,e.lineDashOffset=r.strokeDashOffset,e.lineJoin=r.strokeLineJoin,e.miterLimit=r.strokeMiterLimit,Ut(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=r.stroke)}_setFillStyles(e,r){let{fill:n}=r;n&&(Ut(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,r){r&&r.length!==0&&e.setLineDash(r)}_setShadow(e){if(!this.shadow)return;const r=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,o]=(n==null?void 0:n.viewportTransform)||ht,a=i*s,l=o*s,c=r.nonScaling?new W(1,1):this.getObjectScaling();e.shadowColor=r.color,e.shadowBlur=r.blur*xe.browserShadowBlurConstant*(a+l)*(c.x+c.y)/4,e.shadowOffsetX=r.offsetX*a*c.x,e.shadowOffsetY=r.offsetY*l*c.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,r){if(!Ut(r))return{offsetX:0,offsetY:0};const n=r.gradientTransform||r.patternTransform,s=-this.width/2+r.offsetX||0,i=-this.height/2+r.offsetY||0;return r.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===Tt?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const r=this.getObjectScaling();e.scale(1/r.x,1/r.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,r){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),o=s.x/this.scaleX/i,a=s.y/this.scaleY/i,l=It({width:Math.ceil(o),height:Math.ceil(a)}),c=l.getContext("2d");c&&(c.beginPath(),c.moveTo(0,0),c.lineTo(o,0),c.lineTo(o,a),c.lineTo(0,a),c.closePath(),c.translate(o/2,a/2),c.scale(s.zoomX/this.scaleX/i,s.zoomY/this.scaleY/i),this._applyPatternGradientTransform(c,r),c.fillStyle=r.toLive(e),c.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(i*this.scaleX/s.zoomX,i*this.scaleY/s.zoomY),e.strokeStyle=(n=c.createPattern(l,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new W(this.left+this.width/2,this.top+this.height/2)}clone(e){const r=this.toObject(e);return this.constructor.fromObject(r)}cloneAsImage(e){const r=this.toCanvasElement(e);return new(ee.getClass("image"))(r)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=zg(this),n=this.group,s=this.shadow,i=Math.abs,o=e.enableRetinaScaling?c1():1,a=(e.multiplier||1)*o,l=e.canvasProvider||(w=>new Ea(w,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&T1(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&of(this,this.getViewportTransform()),this.setCoords();const c=Fr(),u=this.getBoundingRect(),d=this.shadow,h=new W;if(d){const w=d.blur,x=d.nonScaling?new W(1,1):this.getObjectScaling();h.x=2*Math.round(i(d.offsetX)+w)*i(x.x),h.y=2*Math.round(i(d.offsetY)+w)*i(x.y)}const g=u.width+h.x,p=u.height+h.y;c.width=Math.ceil(g),c.height=Math.ceil(p);const y=l(c);e.format==="jpeg"&&(y.backgroundColor="#fff"),this.setPositionByOrigin(new W(y.width/2,y.height/2),de,de);const v=this.canvas;y._objects=[this],this.set("canvas",y),this.setCoords();const m=y.toCanvasElement(a||1,e);return this.set("canvas",v),this.shadow=s,n&&(this.group=n),this.set(r),this.setCoords(),y._objects=[],y.destroy(),m}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Fg(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Lg(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.includes(this.constructor.type)||r.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:r,originX:n,originY:s}=this;if(r){const{x:i,y:o}=this.getRelativeCenterPoint();this.originX=de,this.originY=de,this.left=i,this.top=o}if(this.set("angle",e),r){const{x:i,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=i,this.top=o,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Pc.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Ar().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,r){return Object.entries(e).reduce((n,s)=>{let[i,o]=s;return n[i]=this._animate(i,o,r),n},{})}_animate(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:o,startValue:a,onChange:l,onComplete:c}=n,u=$($({},n),{},{target:this,startValue:a??s.reduce((d,h)=>d[h],this),endValue:r,abort:o==null?void 0:o.bind(this),onChange:(d,h,g)=>{s.reduce((p,y,v)=>(v===s.length-1&&(p[y]=d),p[y]),this),l&&l(d,h,g)},onComplete:(d,h,g)=>{this.setCoords(),c&&c(d,h,g)}});return i?H1(u):Ug(u)}isDescendantOf(e){const{parent:r,group:n}=this;return r===e||n===e||!!r&&r.isDescendantOf(e)||!!n&&n!==r&&n.isDescendantOf(e)}getAncestors(){const e=[];let r=this;do r=r.parent,r&&e.push(r);while(r);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const r=this.getAncestors(),n=e.getAncestors();if(r.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let s,i=0;i<r.length;i++){if(s=r[i],s===e)return{fork:[this,...r.slice(0,i)],otherFork:[],common:r.slice(i)};for(let o=0;o<n.length;o++){if(this===n[o])return{fork:[],otherFork:[e,...n.slice(0,o)],common:[this,...r]};if(s===n[o])return{fork:[this,...r.slice(0,i)],otherFork:[e,...n.slice(0,o)],common:r.slice(i)}}}return{fork:[this,...r],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const r=this.findCommonAncestors(e);return r&&!!r.common.length}isInFrontOf(e){if(this===e)return;const r=this.findCommonAncestors(e);if(r.fork.includes(e))return!0;if(r.otherFork.includes(this))return!1;const n=r.common[0]||this.canvas;if(!n)return;const s=r.fork.pop(),i=r.otherFork.pop(),o=n._objects.indexOf(s),a=n._objects.indexOf(i);return o>-1&&o>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Yl.customProperties,this.constructor.customProperties||[]);let r;const n=xe.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:o,shadow:a,strokeDashArray:l,left:c,top:u,originX:d,originY:h,width:g,height:p,strokeWidth:y,strokeLineCap:v,strokeDashOffset:m,strokeLineJoin:w,strokeUniform:x,strokeMiterLimit:_,scaleX:b,scaleY:C,angle:k,flipX:S,flipY:P,opacity:O,visible:F,backgroundColor:A,fillRule:L,paintFirst:E,globalCompositeOperation:M,skewX:N,skewY:I}=this;s&&!s.excludeFromExport&&(r=s.toObject(e.concat("inverted","absolutePositioned")));const j=z=>_e(z,n),D=$($({},Es(this,e)),{},{type:this.constructor.type,version:rf,originX:d,originY:h,left:j(c),top:j(u),width:j(g),height:j(p),fill:W0(i)?i.toObject():i,stroke:W0(o)?o.toObject():o,strokeWidth:j(y),strokeDashArray:l&&l.concat(),strokeLineCap:v,strokeDashOffset:m,strokeLineJoin:w,strokeUniform:x,strokeMiterLimit:j(_),scaleX:j(b),scaleY:j(C),angle:j(k),flipX:S,flipY:P,opacity:j(O),shadow:a&&a.toObject(),visible:F,backgroundColor:A,fillRule:L,paintFirst:E,globalCompositeOperation:M,skewX:j(N),skewY:j(I)},r?{clipPath:r}:null);return this.includeDefaultValues?D:this._removeDefaultValues(D)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const r=this.constructor.getDefaults(),n=Object.keys(r).length>0?r:Object.getPrototypeOf(this);return $g(e,(s,i)=>{if(i===ve||i===kt||i==="type")return!0;const o=n[i];return s!==o&&!(Array.isArray(s)&&Array.isArray(o)&&s.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let r=je(e,Y3),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,i=je(n,G3);return ka(r,i).then(o=>s?(delete o[s],new this(r[s],o)):new this(o))}static fromObject(e,r){return this._fromObject(e,r)}};R(Br,"stateProperties",F3),R(Br,"cacheProperties",ln),R(Br,"ownDefaults",L3),R(Br,"type","FabricObject"),R(Br,"colorProperties",[Xe,Tt,"backgroundColor"]),R(Br,"customProperties",[]),ee.setClass(Br),ee.setClass(Br,"object");const zi=(t,e,r)=>(n,s,i,o)=>{const a=e(n,s,i,o);return a&&N1(t,$($({},P1(n,s,i,o)),r)),a};function Bi(t){return(e,r,n,s)=>{const{target:i,originX:o,originY:a}=r,l=i.getRelativeCenterPoint(),c=i.translateToOriginPoint(l,o,a),u=t(e,r,n,s);return i.setPositionByOrigin(c,r.originX,r.originY),u}}const iy=zi(sa,Bi((t,e,r,n)=>{const s=Bg(e,e.originX,e.originY,r,n);if(ze(e.originX)===ze(de)||ze(e.originX)===ze(Re)&&s.x<0||ze(e.originX)===ze(ve)&&s.x>0){const{target:i}=e,o=i.strokeWidth/(i.strokeUniform?i.scaleX:1),a=O1(e)?2:1,l=i.width,c=Math.abs(s.x*a/i.scaleX)-o;return i.set("width",Math.max(c,1)),l!==i.width}return!1}));function q3(t,e,r,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,o=this.sizeY||n.cornerSize||s.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,l=a?Tt:Xe,c=!a&&(n.cornerStrokeColor||s.cornerStrokeColor);let u,d=e,h=r;t.save(),t.fillStyle=n.cornerColor||s.cornerColor||"",t.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",i>o?(u=i,t.scale(1,o/i),h=r*i/o):o>i?(u=o,t.scale(i/o,1),d=e*o/i):u=i,t.beginPath(),t.arc(d,h,u/2,0,sn,!1),t[l](),c&&t.stroke(),t.restore()}function K3(t,e,r,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,o=this.sizeY||n.cornerSize||s.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,l=a?Tt:Xe,c=!a&&(n.cornerStrokeColor||s.cornerStrokeColor),u=i/2,d=o/2;t.save(),t.fillStyle=n.cornerColor||s.cornerColor||"",t.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",t.translate(e,r);const h=s.getTotalAngle();t.rotate(Le(h)),t["".concat(l,"Rect")](-u,-d,i,o),c&&t.strokeRect(-u,-d,i,o),t.restore()}class Wt{constructor(e){R(this,"visible",!0),R(this,"actionName",ku),R(this,"angle",0),R(this,"x",0),R(this,"y",0),R(this,"offsetX",0),R(this,"offsetY",0),R(this,"sizeX",0),R(this,"sizeY",0),R(this,"touchSizeX",0),R(this,"touchSizeY",0),R(this,"cursorStyle","crosshair"),R(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,r,n,s){var i;let{tl:o,tr:a,br:l,bl:c}=s;return((i=r.canvas)===null||i===void 0?void 0:i.getActiveObject())===r&&r.isControlVisible(e)&&Oe.isPointInPolygon(n,[o,a,l,c])}getActionHandler(e,r,n){return this.actionHandler}getMouseDownHandler(e,r,n){return this.mouseDownHandler}getMouseUpHandler(e,r,n){return this.mouseUpHandler}cursorStyleHandler(e,r,n){return r.cursorStyle}getActionName(e,r,n){return r.actionName}getVisibility(e,r){var n,s;return(n=(s=e._controlsVisibility)===null||s===void 0?void 0:s[r])!==null&&n!==void 0?n:this.visible}setVisibility(e,r,n){this.visible=e}positionHandler(e,r,n,s){return new W(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(r)}calcCornerCoords(e,r,n,s,i,o){const a=Eu([$i(n,s),ks({angle:e}),Tu((i?this.touchSizeX:this.sizeX)||r,(i?this.touchSizeY:this.sizeY)||r)]);return{tl:new W(-.5,-.5).transform(a),tr:new W(.5,-.5).transform(a),br:new W(.5,.5).transform(a),bl:new W(-.5,.5).transform(a)}}render(e,r,n,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?q3.call(this,e,r,n,s,i):K3.call(this,e,r,n,s,i)}}const Q3=(t,e,r)=>r.lockRotation?Dc:e.cursorStyle,J3=zi(d1,Bi((t,e,r,n)=>{let{target:s,ex:i,ey:o,theta:a,originX:l,originY:c}=e;const u=s.translateToOriginPoint(s.getRelativeCenterPoint(),l,c);if(hr(s,"lockRotation"))return!1;const d=Math.atan2(o-u.y,i-u.x),h=Math.atan2(n-u.y,r-u.x);let g=Lr(h-d+a);if(s.snapAngle&&s.snapAngle>0){const y=s.snapAngle,v=s.snapThreshold||y,m=Math.ceil(g/y)*y,w=Math.floor(g/y)*y;Math.abs(g-w)<v?g=w:Math.abs(g-m)<v&&(g=m)}g<0&&(g=360+g),g%=360;const p=s.angle!==g;return s.angle=g,p}));function V1(t,e){const r=e.canvas,n=t[r.uniScaleKey];return r.uniformScaling&&!n||!r.uniformScaling&&n}function U1(t,e,r){const n=hr(t,"lockScalingX"),s=hr(t,"lockScalingY");if(n&&s||!e&&(n||s)&&r||n&&e==="x"||s&&e==="y")return!0;const{width:i,height:o,strokeWidth:a}=t;return i===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}const Z3=["e","se","s","sw","w","nw","n","ne","e"],co=(t,e,r)=>{const n=V1(t,r);if(U1(r,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return Dc;const s=M1(r,e);return"".concat(Z3[s],"-resize")};function Xg(t,e,r,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,o=s.by,a=V1(t,i);let l,c,u,d,h,g;if(U1(i,o,a))return!1;if(e.gestureScale)c=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(l=Bg(e,e.originX,e.originY,r,n),h=o!=="y"?Math.sign(l.x||e.signX||1):1,g=o!=="x"?Math.sign(l.y||e.signY||1):1,e.signX||(e.signX=h),e.signY||(e.signY=g),hr(i,"lockScalingFlip")&&(e.signX!==h||e.signY!==g))return!1;if(d=i._getTransformedDimensions(),a&&!o){const v=Math.abs(l.x)+Math.abs(l.y),{original:m}=e,w=v/(Math.abs(d.x*m.scaleX/i.scaleX)+Math.abs(d.y*m.scaleY/i.scaleY));c=m.scaleX*w,u=m.scaleY*w}else c=Math.abs(l.x*i.scaleX/d.x),u=Math.abs(l.y*i.scaleY/d.y);O1(e)&&(c*=2,u*=2),e.signX!==h&&o!=="y"&&(e.originX=X0(e.originX),c*=-1,e.signX=h),e.signY!==g&&o!=="x"&&(e.originY=X0(e.originY),u*=-1,e.signY=g)}const p=i.scaleX,y=i.scaleY;return o?(o==="x"&&i.set(ft,c),o==="y"&&i.set(Rt,u)):(!hr(i,"lockScalingX")&&i.set(ft,c),!hr(i,"lockScalingY")&&i.set(Rt,u)),p!==i.scaleX||y!==i.scaleY}const nl=zi(Cu,Bi((t,e,r,n)=>Xg(t,e,r,n))),eA=zi(Cu,Bi((t,e,r,n)=>Xg(t,e,r,n,{by:"x"}))),tA=zi(Cu,Bi((t,e,r,n)=>Xg(t,e,r,n,{by:"y"}))),rA=["target","ex","ey","skewingSide"],Ad={x:{counterAxis:"y",scale:ft,skew:Ri,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Rt,skew:Ii,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},nA=["ns","nesw","ew","nwse"],sA=(t,e,r)=>{if(e.x!==0&&hr(r,"lockSkewingY")||e.y!==0&&hr(r,"lockSkewingX"))return Dc;const n=M1(r,e)%4;return"".concat(nA[n],"-resize")};function X1(t,e,r,n,s){const{target:i}=r,{counterAxis:o,origin:a,lockSkewing:l,skew:c,flip:u}=Ad[t];if(hr(i,l))return!1;const{origin:d,flip:h}=Ad[o],g=ze(r[d])*(i[h]?-1:1),p=-Math.sign(g)*(i[u]?-1:1),y=.5*-((i[c]===0&&Bg(r,de,de,n,s)[t]>0||i[c]>0?1:-1)*p)+.5;return zi(h1,Bi((m,w,x,_)=>function(b,C,k){let{target:S,ex:P,ey:O,skewingSide:F}=C,A=je(C,rA);const{skew:L}=Ad[b],E=k.subtract(new W(P,O)).divide(new W(S.scaleX,S.scaleY))[b],M=S[L],N=A[L],I=Math.tan(Le(N)),j=b==="y"?S._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:S._getTransformedDimensions({scaleX:1,scaleY:1}).y,D=2*E*F/Math.max(j,1)+I,z=Lr(Math.atan(D));S.set(L,z);const H=M!==S[L];if(H&&b==="y"){const{skewX:U,scaleX:G}=S,X=S._getTransformedDimensions({skewY:M}),Q=S._getTransformedDimensions(),B=U!==0?X.x/Q.x:1;B!==1&&S.set(ft,B*G)}return H}(t,w,new W(x,_))))(e,$($({},r),{},{[a]:y,skewingSide:p}),n,s)}const iA=(t,e,r,n)=>X1("x",t,e,r,n),oA=(t,e,r,n)=>X1("y",t,e,r,n);function Pu(t,e){return t[e.canvas.altActionKey]}const sl=(t,e,r)=>{const n=Pu(t,r);return e.x===0?n?Ri:Rt:e.y===0?n?Ii:ft:""},Js=(t,e,r)=>Pu(t,r)?sA(0,e,r):co(t,e,r),oy=(t,e,r,n)=>Pu(t,e.target)?oA(t,e,r,n):eA(t,e,r,n),ay=(t,e,r,n)=>Pu(t,e.target)?iA(t,e,r,n):tA(t,e,r,n),Y1=()=>({ml:new Wt({x:-.5,y:0,cursorStyleHandler:Js,actionHandler:oy,getActionName:sl}),mr:new Wt({x:.5,y:0,cursorStyleHandler:Js,actionHandler:oy,getActionName:sl}),mb:new Wt({x:0,y:.5,cursorStyleHandler:Js,actionHandler:ay,getActionName:sl}),mt:new Wt({x:0,y:-.5,cursorStyleHandler:Js,actionHandler:ay,getActionName:sl}),tl:new Wt({x:-.5,y:-.5,cursorStyleHandler:co,actionHandler:nl}),tr:new Wt({x:.5,y:-.5,cursorStyleHandler:co,actionHandler:nl}),bl:new Wt({x:-.5,y:.5,cursorStyleHandler:co,actionHandler:nl}),br:new Wt({x:.5,y:.5,cursorStyleHandler:co,actionHandler:nl}),mtr:new Wt({x:0,y:-.5,actionHandler:J3,cursorStyleHandler:Q3,offsetY:-40,withConnection:!0,actionName:Dg})}),aA=()=>({mr:new Wt({x:.5,y:0,actionHandler:iy,cursorStyleHandler:Js,actionName:sa}),ml:new Wt({x:-.5,y:0,actionHandler:iy,cursorStyleHandler:Js,actionName:sa})}),lA=()=>$($({},Y1()),aA());class oa extends Br{static getDefaults(){return $($({},super.getDefaults()),oa.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),oa.ownDefaults),this.setOptions(e)}static createControls(){return{controls:Y1()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const r=e._currentTransform,n=r.target,s=r.action;if(this===n&&s&&s.startsWith(ku))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[i,o]=n[s],a=this.controls[i];if(a.shouldActivate(i,this,e,r?o.touchCorner:o.corner))return this.__corner=i,{key:i,control:a,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),r=this.getCenterPoint(),n=$i(r.x,r.y),s=ks({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=We(n,s),o=We(e,i),a=We(o,[1/e[0],0,0,1/e[3],0,0]),l=this.group?Ti(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));const c=this._calculateCurrentDimensions(l),u={};return this.forEachControl((d,h)=>{const g=d.positionHandler(c,a,this,d);u[h]=Object.assign(g,this._calcCornerCoords(d,g))}),u}_calcCornerCoords(e,r){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,r.x,r.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,r.x,r.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const r in this.controls)e(this.controls[r],r,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const r=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(r.x,r.y),e.scale(1/s[0],1/s[3]),e.rotate(Le(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,r){e.strokeRect(-r.x/2,-r.y/2,r.x,r.y)}_drawBorders(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=$({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,r),s.hasControls&&this.drawControlsConnectingLines(e,r),e.restore()}_renderControls(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,i=$({hasBorders:n,hasControls:s},r),o=this.getViewportTransform(),a=i.hasBorders,l=i.hasControls,c=We(o,this.calcTransformMatrix()),u=Ti(c);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(Le(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,r),l&&this.drawControls(e,r),e.restore()}drawBorders(e,r,n){let s;if(n&&n.forActiveSelection||this.group){const i=ju(this.width,this.height,Ca(r)),o=this.isStrokeAccountedForInDimensions()?Ag:(this.strokeUniform?new W().scalarAdd(this.canvas?this.canvas.getZoom():1):new W(r.scaleX,r.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,n)}drawControlsConnectingLines(e,r){let n=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(n=!0,e.moveTo(s.x*r.x,s.y*r.y),e.lineTo(s.x*r.x+s.offsetX,s.y*r.y+s.offsetY))}),n&&e.stroke()}drawControls(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:o}=this,a=$({cornerStrokeColor:s,cornerDashArray:i,cornerColor:o},r);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((l,c)=>{if(l.getVisibility(this,c)){const u=this.oCoords[c];l.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,r){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=r}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(r=>{let[n,s]=r;return this.setControlVisible(n,s)})}clearContextTop(e){if(!this.canvas)return;const r=this.canvas.contextTop;if(!r)return;const n=this.canvas.viewportTransform;r.save(),r.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(r);const s=this.width+4,i=this.height+4;return r.clearRect(-s/2,-i/2,s,i),e||r.restore(),r}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function G1(t,e){return e.forEach(r=>{Object.getOwnPropertyNames(r.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))})}),t}R(oa,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class ot extends oa{}G1(ot,[A1]),ee.setClass(ot),ee.setClass(ot,"object");const q1=(t,e,r,n)=>{const s=2*(n=Math.round(n))+1,{data:i}=t.getImageData(e-n,r-n,s,s);for(let o=3;o<i.length;o+=4)if(i[o]>0)return!1;return!0};class K1{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new W(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new W(1/this.options.scaleX,1/this.options.scaleY):new W(1,1)}createSideVector(e,r){const n=Fc(e,r);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,r,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,r,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const r=new W(e);return r.y+=r.x*Math.tan(Le(this.options.skewY)),r.x+=r.y*Math.tan(Le(this.options.skewX)),r}scaleUnitVector(e,r){return e.multiply(this.strokeUniformScalar).scalarMultiply(r)}}const cA=new W;class ui extends K1{static getOrthogonalRotationFactor(e,r){const n=r?Rc(e,r):z1(e);return Math.abs(n)<An?-1:1}constructor(e,r,n,s){super(s),R(this,"AB",void 0),R(this,"AC",void 0),R(this,"alpha",void 0),R(this,"bisector",void 0),this.A=new W(e),this.B=new W(r),this.C=new W(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Rc(this.AB,this.AC),this.bisector=Ou(Wg(this.AB.eq(cA)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,r),i=Hg(s),o=ui.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,n*o)}projectBevel(){const e=[];return(this.alpha%sn==0?[this.B]:[this.B,this.C]).forEach(r=>{e.push(this.projectOrthogonally(this.A,r)),e.push(this.projectOrthogonally(this.A,r,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],r=Math.abs(this.alpha),n=1/Math.sin(r/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),i=this.options.strokeUniform?Lc(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Lc(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,r){const n=[],s=new W(ui.getOrthogonalRotationFactor(this.bisector),ui.getOrthogonalRotationFactor(new W(this.bisector.y,this.bisector.x)));return[new W(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new W(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{af(i,e,r)&&n.push(this.A.add(i))}),n}projectRoundWithSkew(e,r){const n=[],{skewX:s,skewY:i,scaleX:o,scaleY:a,strokeUniform:l}=this.options,c=new W(Math.tan(Le(s)),Math.tan(Le(i))),u=this.strokeProjectionMagnitude,d=l?u/a/Math.sqrt(1/a**2+1/o**2*c.y**2):u/Math.sqrt(1+c.y**2),h=new W(Math.sqrt(Math.max(u**2-d**2,0)),d),g=l?u/Math.sqrt(1+c.x**2*(1/a)**2/(1/o+1/o*c.x*c.y)**2):u/Math.sqrt(1+c.x**2/(1+c.x*c.y)**2),p=new W(g,Math.sqrt(Math.max(u**2-g**2,0)));return[p,p.scalarMultiply(-1),h,h.scalarMultiply(-1)].map(y=>this.applySkew(l?y.multiply(this.strokeUniformScalar):y)).forEach(y=>{af(y,e,r)&&n.push(this.applySkew(this.A).add(y))}),n}projectRound(){const e=[];e.push(...this.projectBevel());const r=this.alpha%sn==0,n=this.applySkew(this.A),s=e[r?0:2].subtract(n),i=e[r?1:0].subtract(n),o=r?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=ci(s,o)>0,l=a?s:i,c=a?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(l,c)):e.push(...this.projectRoundNoSkew(l,c)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class ly extends K1{constructor(e,r,n){super(n),this.A=new W(e),this.T=new W(r)}calcOrthogonalProjection(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,r);return this.scaleUnitVector(Hg(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const r=new W(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(r)),this.applySkew(this.A.subtract(r)))}else e.push(...new ui(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const r=new W(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(r),this.A.subtract(r))}else{const r=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(Ou(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);e.push(s.add(r),s.subtract(r))}return e.map(r=>this.applySkew(r))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const Q1=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(t.length===0)return n;const s=t.reduce((i,o)=>(i[i.length-1].eq(o)||i.push(new W(o)),i),[new W(t[0])]);if(s.length===1)r=!0;else if(!r){const i=s[0],o=((a,l)=>{for(let c=a.length-1;c>=0;c--)if(l(a[c],c,a))return c;return-1})(s,a=>!a.eq(i));s.splice(o+1)}return s.forEach((i,o,a)=>{let l,c;o===0?(c=a[1],l=r?i:a[a.length-1]):o===a.length-1?(l=a[o-1],c=r?i:a[0]):(l=a[o-1],c=a[o+1]),r&&a.length===1?n.push(...new ly(i,i,e).project()):!r||o!==0&&o!==a.length-1?n.push(...new ui(i,l,c,e).project()):n.push(...new ly(i,o===0?c:l,e).project())}),n},Yg=t=>{const e={};return Object.keys(t).forEach(r=>{e[r]={},Object.keys(t[r]).forEach(n=>{e[r][n]=$({},t[r][n])})}),e},J1=t=>t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let to;const Mu=t=>{if(to||to||(to="Intl"in Sa()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),to){const e=to.segment(t);return Array.from(e).map(r=>{let{segment:n}=r;return n})}return uA(t)},uA=t=>{const e=[];for(let r,n=0;n<t.length;n++)(r=dA(t,n))!==!1&&e.push(r);return e},dA=(t,e)=>{const r=t.charCodeAt(e);if(isNaN(r))return"";if(r<55296||r>57343)return t.charAt(e);if(55296<=r&&r<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";const s=t.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=t.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1};var hA=Object.freeze({__proto__:null,capitalize:function(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(t.charAt(0).toUpperCase()).concat(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:J1,graphemeSplit:Mu});const Du=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.textDecorationThickness!==e.textDecorationThickness||t.textBackgroundColor!==e.textBackgroundColor||t.deltaY!==e.deltaY||r&&(t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough)},Z1=(t,e)=>{const r=e.split(`
`),n=[];let s=-1,i={};t=Yg(t);for(let o=0;o<r.length;o++){const a=Mu(r[o]);if(t[o])for(let l=0;l<a.length;l++){s++;const c=t[o][l];c&&Object.keys(c).length>0&&(Du(i,c,!0)?n.push({start:s,end:s+1,style:c}):n[n.length-1].end++),i=c||{}}else s+=a.length,i={}}return n},e_=(t,e)=>{if(!Array.isArray(t))return Yg(t);const r=e.split(Mg),n={};let s=-1,i=0;for(let o=0;o<r.length;o++){const a=Mu(r[o]);for(let l=0;l<a.length;l++)s++,t[i]&&t[i].start<=s&&s<t[i].end&&(n[o]=n[o]||{},n[o][l]=$({},t[i].style),s===t[i].end-1&&i++)}return n},$n=["display","transform",Xe,"fill-opacity","fill-rule","opacity",Tt,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function cy(t,e){const r=t.nodeName,n=t.getAttribute("class"),s=t.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+r,"i"),e=e.replace(o,""),s&&e.length&&(o=new RegExp("#"+s+i,"i"),e=e.replace(o,"")),n&&e.length){const a=n.split(" ");for(let l=a.length;l--;)o=new RegExp("\\."+a[l]+i,"i"),e=e.replace(o,"")}return e.length===0}function fA(t,e){let r=!0;const n=cy(t,e.pop());return n&&e.length&&(r=function(s,i){let o,a=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)a&&(o=i.pop()),a=cy(s=s.parentElement,o);return i.length===0}(t,e)),n&&r&&e.length===0}const gA=t=>{var e;return(e=D3[t])!==null&&e!==void 0?e:t},pA=new RegExp("(".concat(cr,")"),"gi"),mA=t=>t.replace(pA," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var uy,dy,hy,fy,gy,py,my;const ut="(".concat(cr,")"),yA=String.raw(uy||(uy=Ir(["(skewX)(",")"],["(skewX)\\(","\\)"])),ut),xA=String.raw(dy||(dy=Ir(["(skewY)(",")"],["(skewY)\\(","\\)"])),ut),vA=String.raw(hy||(hy=Ir(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),ut,ut,ut),wA=String.raw(fy||(fy=Ir(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),ut,ut),bA=String.raw(gy||(gy=Ir(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),ut,ut),_A=String.raw(py||(py=Ir(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),ut,ut,ut,ut,ut,ut),Gg="(?:".concat(_A,"|").concat(bA,"|").concat(vA,"|").concat(wA,"|").concat(yA,"|").concat(xA,")"),SA="(?:".concat(Gg,"*)"),CA=String.raw(my||(my=Ir(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),SA),kA=new RegExp(CA),EA=new RegExp(Gg),TA=new RegExp(Gg,"g");function cf(t){const e=[];if(!(t=mA(t).replace(/\s*([()])\s*/gi,"$1"))||t&&!kA.test(t))return[...ht];for(const r of t.matchAll(TA)){const n=EA.exec(r[0]);if(!n)continue;let s=ht;const i=n.filter(p=>!!p),[,o,...a]=i,[l,c,u,d,h,g]=a.map(p=>parseFloat(p));switch(o){case"translate":s=$i(l,c);break;case Dg:s=ks({angle:l},{x:c,y:u});break;case ku:s=Tu(l,c);break;case Ri:s=Rg(l);break;case Ii:s=Ig(l);break;case"matrix":s=[l,c,u,d,h,g]}e.push(s)}return Eu(e)}function jA(t,e,r,n){const s=Array.isArray(e);let i,o=e;if(t!==Xe&&t!==Tt||e!==Et){if(t==="strokeUniform")return e==="non-scaling-stroke";if(t==="strokeDashArray")o=e===Et?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(t==="transformMatrix")o=r&&r.transformMatrix?We(r.transformMatrix,cf(e)):cf(e);else if(t==="visible")o=e!==Et&&e!=="hidden",r&&r.visible===!1&&(o=!1);else if(t==="opacity")o=parseFloat(e),r&&r.opacity!==void 0&&(o*=r.opacity);else if(t==="textAnchor")o=e==="start"?ve:e==="end"?Re:de;else if(t==="charSpacing"||t===bs)i=ds(e,n)/n*1e3;else if(t==="paintFirst"){const a=e.indexOf(Xe),l=e.indexOf(Tt);o=Xe,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(o=Tt)}else{if(t==="href"||t==="xlink:href"||t==="font"||t==="id")return e;if(t==="imageSmoothing")return e==="optimizeQuality";i=s?e.map(ds):ds(e,n)}}else o="";return!s&&isNaN(i)?o:i}function NA(t,e){const r=t.match(M3);if(!r)return;const n=r[1],s=r[3],i=r[4],o=r[5],a=r[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=ds(i)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function OA(t,e){t.replace(/;\s*$/,"").split(";").forEach(r=>{if(!r)return;const[n,s]=r.split(":");e[n.trim().toLowerCase()]=s.trim()})}function PA(t){const e={},r=t.getAttribute("style");return r&&(typeof r=="string"?OA(r,e):function(n,s){Object.entries(n).forEach(i=>{let[o,a]=i;a!==void 0&&(s[o.toLowerCase()]=a)})}(r,e)),e}const MA={stroke:"strokeOpacity",fill:"fillOpacity"};function cn(t,e,r){if(!t)return{};let n,s={},i=Pg;t.parentNode&&ey.test(t.parentNode.nodeName)&&(s=cn(t.parentElement,e,r),s.fontSize&&(n=i=ds(s.fontSize)));const o=$($($({},e.reduce((c,u)=>{const d=t.getAttribute(u);return d&&(c[u]=d),c},{})),function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(const h in u)fA(c,h.split(" "))&&(d=$($({},d),u[h]));return d}(t,r)),PA(t));o[Pd]&&t.setAttribute(Pd,o[Pd]),o[Od]&&(n=ds(o[Od],i),o[Od]="".concat(n));const a={};for(const c in o){const u=gA(c),d=jA(u,o[c],s,n);a[u]=d}a&&a.font&&NA(a.font,a);const l=$($({},s),a);return ey.test(t.nodeName)?l:function(c){const u=ot.getDefaults();return Object.entries(MA).forEach(d=>{let[h,g]=d;if(c[g]===void 0||c[h]==="")return;if(c[h]===void 0){if(!u[h])return;c[h]=u[h]}if(c[h].indexOf("url(")===0)return;const p=new we(c[h]);c[h]=p.setAlpha(_e(p.getAlpha()*c[g],2)).toRgba()}),c}(l)}const DA=["left","top","width","height","visible"],t_=["rx","ry"];class Sr extends ot{static getDefaults(){return $($({},super.getDefaults()),Sr.ownDefaults)}constructor(e){super(),Object.assign(this,Sr.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:r}=this;e&&!r?this.ry=e:r&&!e&&(this.rx=r)}_render(e){const{width:r,height:n}=this,s=-r/2,i=-n/2,o=this.rx?Math.min(this.rx,r/2):0,a=this.ry?Math.min(this.ry,n/2):0,l=o!==0||a!==0;e.beginPath(),e.moveTo(s+o,i),e.lineTo(s+r-o,i),l&&e.bezierCurveTo(s+r-gn*o,i,s+r,i+gn*a,s+r,i+a),e.lineTo(s+r,i+n-a),l&&e.bezierCurveTo(s+r,i+n-gn*a,s+r-gn*o,i+n,s+r-o,i+n),e.lineTo(s+o,i+n),l&&e.bezierCurveTo(s+gn*o,i+n,s,i+n-gn*a,s,i+n-a),e.lineTo(s,i+a),l&&e.bezierCurveTo(s,i+gn*a,s+gn*o,i,s+o,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...t_,...e])}_toSVG(){const{width:e,height:r,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-r/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(r,`" />
`)]}static async fromElement(e,r,n){const s=cn(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:o=0,width:a=0,height:l=0,visible:c=!0}=s,u=je(s,DA);return new this($($($({},r),u),{},{left:i,top:o,width:a,height:l,visible:!!(c&&a&&l)}))}}R(Sr,"type","Rect"),R(Sr,"cacheProperties",[...ln,...t_]),R(Sr,"ownDefaults",{rx:0,ry:0}),R(Sr,"ATTRIBUTE_NAMES",[...$n,"x","y","rx","ry","width","height"]),ee.setClass(Sr),ee.setSVGClass(Sr);const Gr="initialization",Ic="added",qg="removed",$c="imperative",r_=(t,e)=>{const{strokeUniform:r,strokeWidth:n,width:s,height:i,group:o}=e,a=o&&o!==t?Ta(o.calcTransformMatrix(),t.calcTransformMatrix()):null,l=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),c=!e.isStrokeAccountedForInDimensions(),u=r&&c?j1(new W(n,n),void 0,t.calcTransformMatrix()):Ag,d=!r&&c?n:0,h=ju(s+d,i+d,Eu([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[l.subtract(h),l.add(h)]};class Au{calcLayoutResult(e,r){if(this.shouldPerformLayout(e))return this.calcBoundingBox(r,e)}shouldPerformLayout(e){let{type:r,prevStrategy:n,strategy:s}=e;return r===Gr||r===$c||!!n&&s!==n}shouldLayoutClipPath(e){let{type:r,target:{clipPath:n}}=e;return r!==Gr&&n&&!n.absolutePositioned}getInitialSize(e,r){return r.size}calcBoundingBox(e,r){const{type:n,target:s}=r;if(n===$c&&r.overrides)return r.overrides;if(e.length===0)return;const{left:i,top:o,width:a,height:l}=Pr(e.map(d=>r_(s,d)).reduce((d,h)=>d.concat(h),[])),c=new W(a,l),u=new W(i,o).add(c.scalarDivide(2));if(n===Gr){const d=this.getInitialSize(r,{size:c,center:u});return{center:u,relativeCorrection:new W(0,0),size:d}}return{center:u.transform(s.calcOwnMatrix()),size:c}}}R(Au,"type","strategy");class uf extends Au{shouldPerformLayout(e){return!0}}R(uf,"type","fit-content"),ee.setClass(uf);const AA=["strategy"],FA=["target","strategy","bubbles","prevStrategy"],n_="layoutManager";class aa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new uf;R(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const r=$($({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(r);const n=this.getLayoutResult(r);n&&this.commitLayout(r,n),this.onAfterLayout(r,n),this._prevLayoutStrategy=r.strategy}attachHandlers(e,r){const{target:n}=r;return[Oc,u1,sa,d1,Cu,h1,Nc,b3,_3].map(s=>e.on(s,i=>this.performLayout(s===Oc?{type:"object_modified",trigger:s,e:i,target:n}:{type:"object_modifying",trigger:s,e:i,target:n})))}subscribe(e,r){this.unsubscribe(e,r);const n=this.attachHandlers(e,r);this._subscriptions.set(e,n)}unsubscribe(e,r){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(r=>this.unsubscribe(r,e))}subscribeTargets(e){e.targets.forEach(r=>this.subscribe(r,e))}onBeforeLayout(e){const{target:r,type:n}=e,{canvas:s}=r;if(n===Gr||n===Ic?this.subscribeTargets(e):n===qg&&this.unsubscribeTargets(e),r.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:r,context:e}),n===$c&&e.deep){const i=je(e,AA);r.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout($($({},i),{},{bubbles:!1,target:o})))}}getLayoutResult(e){const{target:r,strategy:n,type:s}=e,i=n.calcLayoutResult(e,r.getObjects());if(!i)return;const o=s===Gr?new W:r.getRelativeCenterPoint(),{center:a,correction:l=new W,relativeCorrection:c=new W}=i,u=o.subtract(a).add(l).transform(s===Gr?ht:Dt(r.calcOwnMatrix()),!0).add(c);return{result:i,prevCenter:o,nextCenter:a,offset:u}}commitLayout(e,r){const{target:n}=e,{result:{size:s},nextCenter:i}=r;var o,a;n.set({width:s.x,height:s.y}),this.layoutObjects(e,r),e.type===Gr?n.set({left:(o=e.x)!==null&&o!==void 0?o:i.x+s.x*ze(n.originX),top:(a=e.y)!==null&&a!==void 0?a:i.y+s.y*ze(n.originY)}):(n.setPositionByOrigin(i,de,de),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,r){const{target:n}=e;n.forEachObject(s=>{s.group===n&&this.layoutObject(e,r,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,r,n.clipPath)}layoutObject(e,r,n){let{offset:s}=r;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(e,r){const{target:n,strategy:s,bubbles:i,prevStrategy:o}=e,a=je(e,FA),{canvas:l}=n;n.fire("layout:after",{context:e,result:r}),l&&l.fire("object:layout:after",{context:e,result:r,target:n});const c=n.parent;i&&c!=null&&c.layoutManager&&((a.path||(a.path=[])).push(n),c.layoutManager.performLayout($($({},a),{},{target:c}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(r=>r.forEach(n=>n())),e.clear()}toObject(){return{type:n_,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}ee.setClass(aa,n_);const LA=["type","objects","layoutManager"];class RA extends aa{performLayout(){}}class Mr extends f1(ot){static getDefaults(){return $($({},super.getDefaults()),Mr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),R(this,"_activeObjects",[]),R(this,"__objectSelectionTracker",void 0),R(this,"__objectSelectionDisposer",void 0),Object.assign(this,Mr.ownDefaults),this.setOptions(r),this.groupInit(e,r)}groupInit(e,r){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(n=r.layoutManager)!==null&&n!==void 0?n:new aa,this.layoutManager.performLayout({type:Gr,target:this,targets:[...e],x:r.left,y:r.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Dn("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Dn("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((r,n,s)=>this.canEnterGroup(r)&&s.indexOf(r)===n)}add(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(r),i=super.add(...s);return this._onAfterObjectsChange(Ic,s),i}insertAt(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(n),o=super.insertAt(e,...i);return this._onAfterObjectsChange(Ic,i),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(qg,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,r){this.exitGroup(e,r),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,r){this.layoutManager.performLayout({type:e,targets:r,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,r){const n=this[e];return super._set(e,r),e==="canvas"&&n!==r&&(this._objects||[]).forEach(s=>{s._set(e,r)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,r){let{target:n}=r;const s=this._activeObjects;if(e)s.push(n),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(n);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,r){e&&this._watchObject(!1,r),e?(r.on("selected",this.__objectSelectionTracker),r.on("deselected",this.__objectSelectionDisposer)):(r.off("selected",this.__objectSelectionTracker),r.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,r){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,r)}_enterGroup(e,r){r&&Oi(e,We(Dt(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,r){this._exitGroup(e,r),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,r){e._set("group",void 0),r||(Oi(e,We(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=ot.prototype.shouldCache.call(this);if(e){for(let r=0;r<this._objects.length;r++)if(this._objects[r].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,r,n){this._renderBackground(e);for(let i=0;i<this._objects.length;i++){var s;const o=this._objects[i];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...Dt(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout($({target:this,type:$c},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,r){const n=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=n;const o=s[e||"toObject"](r);return s.includeDefaultValues=i,o})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const r=this.layoutManager.toObject();return $($($({},super.toObject(["subTargetCheck","interactive",...e])),r.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:r}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const r=Sr.prototype._toSVG.call(this),n=r.indexOf("COMMON_PARTS");r[n]='for="group" ';const s=r.join("");return e?e(s):s}_toSVG(e){const r=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&r.push("		",n);for(let s=0;s<this._objects.length;s++)r.push("		",this._objects[s].toSVG(e));return r.push(`</g>
`),r}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",r=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),r].join("")}toClipPathSVG(e){const r=[],n=this._createSVGBgRect(e);n&&r.push("	",n);for(let s=0;s<this._objects.length;s++)r.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(r,{reviver:e})}static fromObject(e,r){let{type:n,objects:s=[],layoutManager:i}=e,o=je(e,LA);return Promise.all([ji(s,r),ka(o,r)]).then(a=>{let[l,c]=a;const u=new this(l,$($($({},o),c),{},{layoutManager:new RA}));if(i){const d=ee.getClass(i.type),h=ee.getClass(i.strategy);u.layoutManager=new d(new h)}else u.layoutManager=new aa;return u.layoutManager.subscribeTargets({type:Gr,target:u,targets:u.getObjects()}),u.setCoords(),u})}}R(Mr,"type","Group"),R(Mr,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),ee.setClass(Mr);const s_=(t,e)=>Math.min(e.width/t.width,e.height/t.height),i_=(t,e)=>Math.max(e.width/t.width,e.height/t.height),df="\\s*,?\\s*",ro="".concat(df,"(").concat(cr,")"),IA="".concat(ro).concat(ro).concat(ro).concat(df,"([01])").concat(df,"([01])").concat(ro).concat(ro),$A={m:"l",M:"L"},zA=(t,e,r,n,s,i,o,a,l,c,u)=>{const d=gr(t),h=pr(t),g=gr(e),p=pr(e),y=r*s*g-n*i*p+o,v=n*s*g+r*i*p+a;return["C",c+l*(-r*s*h-n*i*d),u+l*(-n*s*h+r*i*d),y+l*(r*s*p+n*i*g),v+l*(n*s*p-r*i*g),y,v]},yy=(t,e,r,n)=>{const s=Math.atan2(e,t),i=Math.atan2(n,r);return i>=s?i-s:2*Math.PI-(s-i)};function hf(t,e,r,n,s,i,o,a){let l;if(xe.cachesBoundsOfCurve&&(l=[...arguments].join(),Co.boundsOfCurveCache[l]))return Co.boundsOfCurveCache[l];const c=Math.sqrt,u=Math.abs,d=[],h=[[0,0],[0,0]];let g=6*t-12*r+6*s,p=-3*t+9*r-9*s+3*o,y=3*r-3*t;for(let _=0;_<2;++_){if(_>0&&(g=6*e-12*n+6*i,p=-3*e+9*n-9*i+3*a,y=3*n-3*e),u(p)<1e-12){if(u(g)<1e-12)continue;const P=-y/g;0<P&&P<1&&d.push(P);continue}const b=g*g-4*y*p;if(b<0)continue;const C=c(b),k=(-g+C)/(2*p);0<k&&k<1&&d.push(k);const S=(-g-C)/(2*p);0<S&&S<1&&d.push(S)}let v=d.length;const m=v,w=a_(t,e,r,n,s,i,o,a);for(;v--;){const{x:_,y:b}=w(d[v]);h[0][v]=_,h[1][v]=b}h[0][m]=t,h[1][m]=e,h[0][m+1]=o,h[1][m+1]=a;const x=[new W(Math.min(...h[0]),Math.min(...h[1])),new W(Math.max(...h[0]),Math.max(...h[1]))];return xe.cachesBoundsOfCurve&&(Co.boundsOfCurveCache[l]=x),x}const BA=(t,e,r)=>{let[n,s,i,o,a,l,c,u]=r;const d=((h,g,p,y,v,m,w)=>{if(p===0||y===0)return[];let x=0,_=0,b=0;const C=Math.PI,k=w*Og,S=pr(k),P=gr(k),O=.5*(-P*h-S*g),F=.5*(-P*g+S*h),A=p**2,L=y**2,E=F**2,M=O**2,N=A*L-A*E-L*M;let I=Math.abs(p),j=Math.abs(y);if(N<0){const oe=Math.sqrt(1-N/(A*L));I*=oe,j*=oe}else b=(v===m?-1:1)*Math.sqrt(N/(A*E+L*M));const D=b*I*F/j,z=-b*j*O/I,H=P*D-S*z+.5*h,U=S*D+P*z+.5*g;let G=yy(1,0,(O-D)/I,(F-z)/j),X=yy((O-D)/I,(F-z)/j,(-O-D)/I,(-F-z)/j);m===0&&X>0?X-=2*C:m===1&&X<0&&(X+=2*C);const Q=Math.ceil(Math.abs(X/C*2)),B=[],Y=X/Q,K=8/3*Math.sin(Y/4)*Math.sin(Y/4)/Math.sin(Y/2);let ne=G+Y;for(let oe=0;oe<Q;oe++)B[oe]=zA(G,ne,P,S,I,j,H,U,K,x,_),x=B[oe][5],_=B[oe][6],G=ne,ne+=Y;return B})(c-t,u-e,s,i,a,l,o);for(let h=0,g=d.length;h<g;h++)d[h][1]+=t,d[h][2]+=e,d[h][3]+=t,d[h][4]+=e,d[h][5]+=t,d[h][6]+=e;return d},o_=t=>{let e=0,r=0,n=0,s=0;const i=[];let o,a=0,l=0;for(const c of t){const u=[...c];let d;switch(u[0]){case"l":u[1]+=e,u[2]+=r;case"L":e=u[1],r=u[2],d=["L",e,r];break;case"h":u[1]+=e;case"H":e=u[1],d=["L",e,r];break;case"v":u[1]+=r;case"V":r=u[1],d=["L",e,r];break;case"m":u[1]+=e,u[2]+=r;case"M":e=u[1],r=u[2],n=u[1],s=u[2],d=["M",e,r];break;case"c":u[1]+=e,u[2]+=r,u[3]+=e,u[4]+=r,u[5]+=e,u[6]+=r;case"C":a=u[3],l=u[4],e=u[5],r=u[6],d=["C",u[1],u[2],a,l,e,r];break;case"s":u[1]+=e,u[2]+=r,u[3]+=e,u[4]+=r;case"S":o==="C"?(a=2*e-a,l=2*r-l):(a=e,l=r),e=u[3],r=u[4],d=["C",a,l,u[1],u[2],e,r],a=d[3],l=d[4];break;case"q":u[1]+=e,u[2]+=r,u[3]+=e,u[4]+=r;case"Q":a=u[1],l=u[2],e=u[3],r=u[4],d=["Q",a,l,e,r];break;case"t":u[1]+=e,u[2]+=r;case"T":o==="Q"?(a=2*e-a,l=2*r-l):(a=e,l=r),e=u[1],r=u[2],d=["Q",a,l,e,r];break;case"a":u[6]+=e,u[7]+=r;case"A":BA(e,r,u).forEach(h=>i.push(h)),e=u[6],r=u[7];break;case"z":case"Z":e=n,r=s,d=["Z"]}d?(i.push(d),o=d[0]):o=""}return i},zc=(t,e,r,n)=>Math.sqrt((r-t)**2+(n-e)**2),a_=(t,e,r,n,s,i,o,a)=>l=>{const c=l**3,u=(g=>3*g**2*(1-g))(l),d=(g=>3*g*(1-g)**2)(l),h=(g=>(1-g)**3)(l);return new W(o*c+s*u+r*d+t*h,a*c+i*u+n*d+e*h)},l_=t=>t**2,c_=t=>2*t*(1-t),u_=t=>(1-t)**2,WA=(t,e,r,n,s,i,o,a)=>l=>{const c=l_(l),u=c_(l),d=u_(l),h=3*(d*(r-t)+u*(s-r)+c*(o-s)),g=3*(d*(n-e)+u*(i-n)+c*(a-i));return Math.atan2(g,h)},HA=(t,e,r,n,s,i)=>o=>{const a=l_(o),l=c_(o),c=u_(o);return new W(s*a+r*l+t*c,i*a+n*l+e*c)},VA=(t,e,r,n,s,i)=>o=>{const a=1-o,l=2*(a*(r-t)+o*(s-r)),c=2*(a*(n-e)+o*(i-n));return Math.atan2(c,l)},xy=(t,e,r)=>{let n=new W(e,r),s=0;for(let i=1;i<=100;i+=1){const o=t(i/100);s+=zc(n.x,n.y,o.x,o.y),n=o}return s},UA=(t,e)=>{let r,n=0,s=0,i={x:t.x,y:t.y},o=$({},i),a=.01,l=0;const c=t.iterator,u=t.angleFinder;for(;s<e&&a>1e-4;)o=c(n),l=n,r=zc(i.x,i.y,o.x,o.y),r+s>e?(n-=a,a/=2):(i=o,n+=a,s+=r);return $($({},o),{},{angle:u(l)})},Kg=t=>{let e,r,n=0,s=0,i=0,o=0,a=0;const l=[];for(const c of t){const u={x:s,y:i,command:c[0],length:0};switch(c[0]){case"M":r=u,r.x=o=s=c[1],r.y=a=i=c[2];break;case"L":r=u,r.length=zc(s,i,c[1],c[2]),s=c[1],i=c[2];break;case"C":e=a_(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),r=u,r.iterator=e,r.angleFinder=WA(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),r.length=xy(e,s,i),s=c[5],i=c[6];break;case"Q":e=HA(s,i,c[1],c[2],c[3],c[4]),r=u,r.iterator=e,r.angleFinder=VA(s,i,c[1],c[2],c[3],c[4]),r.length=xy(e,s,i),s=c[3],i=c[4];break;case"Z":r=u,r.destX=o,r.destY=a,r.length=zc(s,i,o,a),s=o,i=a}n+=r.length,l.push(r)}return l.push({length:n,x:s,y:i}),l},d_=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Kg(t),n=0;for(;e-r[n].length>0&&n<r.length-2;)e-=r[n].length,n++;const s=r[n],i=e/s.length,o=t[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return $($({},new W(s.x,s.y).lerp(new W(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return $($({},new W(s.x,s.y).lerp(new W(o[1],o[2]),i)),{},{angle:Math.atan2(o[2]-s.y,o[1]-s.x)});case"C":case"Q":return UA(s,e)}},XA=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),vy=new RegExp(IA,"g"),YA=new RegExp(cr,"gi"),GA={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h_=t=>{var e;const r=[],n=(e=t.match(XA))!==null&&e!==void 0?e:[];for(const s of n){const i=s[0];if(i==="z"||i==="Z"){r.push([i]);continue}const o=GA[i.toLowerCase()];let a=[];if(i==="a"||i==="A"){vy.lastIndex=0;for(let l=null;l=vy.exec(s);)a.push(...l.slice(1))}else a=s.match(YA)||[];for(let l=0;l<a.length;l+=o){const c=new Array(o),u=$A[i];c[0]=l>0&&u?u:i;for(let d=0;d<o;d++)c[d+1]=parseFloat(a[l+d]);r.push(c)}}return r},qA=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=new W(t[0]),n=new W(t[1]),s=1,i=0;const o=[],a=t.length,l=a>2;let c;for(l&&(s=t[2].x<n.x?-1:t[2].x===n.x?0:1,i=t[2].y<n.y?-1:t[2].y===n.y?0:1),o.push(["M",r.x-s*e,r.y-i*e]),c=1;c<a;c++){if(!r.eq(n)){const u=r.midPointFrom(n);o.push(["Q",r.x,r.y,u.x,u.y])}r=t[c],c+1<t.length&&(n=t[c+1])}return l&&(s=r.x>t[c-2].x?1:r.x===t[c-2].x?0:-1,i=r.y>t[c-2].y?1:r.y===t[c-2].y?0:-1),o.push(["L",r.x+s*e,r.y+i*e]),o},f_=(t,e)=>t.map(r=>r.map((n,s)=>s===0||e===void 0?n:_e(n,e)).join(" ")).join(" ");function Bc(t,e){const r=t.style;r&&e&&(typeof e=="string"?r.cssText+=";"+e:Object.entries(e).forEach(n=>{let[s,i]=n;return r.setProperty(s,i)}))}const KA=(t,e)=>Math.floor(Math.random()*(e-t+1))+t;function QA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=e.onComplete||cs,n=new(Sa()).XMLHttpRequest,s=e.signal,i=function(){n.abort()},o=function(){s&&s.removeEventListener("abort",i),n.onerror=n.ontimeout=cs};if(s&&s.aborted)throw new l1("request");return s&&s.addEventListener("abort",i,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(o(),r(n),n.onreadystatechange=cs)},n.onerror=n.ontimeout=o,n.open("get",t,!0),n.send(),n}const JA=(t,e)=>{let r=t._findCenterFromElement();t.transformMatrix&&((n=>{if(n.transformMatrix){const{scaleX:s,scaleY:i,angle:o,skewX:a}=Ti(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(ft,s),n.set(Rt,i),n.angle=o,n.skewX=a,n.skewY=0}})(t),r=r.transform(t.transformMatrix)),delete t.transformMatrix,e&&(t.scaleX*=e.scaleX,t.scaleY*=e.scaleY,t.cropX=e.cropX,t.cropY=e.cropY,r.x+=e.offsetLeft,r.y+=e.offsetTop,t.width=e.width,t.height=e.height),t.setPositionByOrigin(r,de,de)};var uo=Object.freeze({__proto__:null,addTransformToObject:E1,animate:Ug,animateColor:H1,applyTransformToObject:Oi,calcAngleBetweenVectors:Rc,calcDimensionsMatrix:Ca,calcPlaneChangeMatrix:Ta,calcVectorRotation:z1,cancelAnimFrame:p1,capValue:_s,composeMatrix:w1,copyCanvasElement:t=>{var e;const r=It(t);return(e=r.getContext("2d"))===null||e===void 0||e.drawImage(t,0,0),r},cos:gr,createCanvasElement:Fr,createImage:m1,createRotateMatrix:ks,createScaleMatrix:Tu,createSkewXMatrix:Rg,createSkewYMatrix:Ig,createTranslateMatrix:$i,createVector:Fc,crossProduct:ci,degreesToRadians:Le,dotProduct:B1,ease:R3,enlivenObjectEnlivables:ka,enlivenObjects:ji,findScaleToCover:i_,findScaleToFit:s_,getBoundsOfCurve:hf,getOrthonormalVector:Hg,getPathSegmentsInfo:Kg,getPointOnPath:d_,getPointer:k1,getRandomInt:KA,getRegularPolygonPath:(t,e)=>{const r=2*Math.PI/t;let n=-An;t%2==0&&(n+=r/2);const s=new Array(t+1);for(let i=0;i<t;i++){const o=i*r+n,{x:a,y:l}=new W(gr(o),pr(o)).scalarMultiply(e);s[i]=[i===0?"M":"L",a,l]}return s[t]=["Z"],s},getSmoothPathFromPoints:qA,getSvgAttributes:t=>{const e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:Ou,groupSVGElements:(t,e)=>t&&t.length===1?t[0]:new Mr(t,e),hasStyleChanged:Du,invertTransform:Dt,isBetweenVectors:af,isIdentityMatrix:y1,isTouchEvent:Mc,isTransparent:q1,joinPath:f_,loadImage:Eo,magnitude:Lc,makeBoundingBoxFromPoints:Pr,makePathSimpler:o_,matrixToSVG:Ni,mergeClipPaths:(t,e)=>{var r;let n=t,s=e;n.inverted&&!s.inverted&&(n=e,s=t),of(s,(r=s.group)===null||r===void 0?void 0:r.calcTransformMatrix(),n.calcTransformMatrix());const i=n.inverted&&s.inverted;return i&&(n.inverted=s.inverted=!1),new Mr([n],{clipPath:s,inverted:i})},multiplyTransformMatrices:We,multiplyTransformMatrixArray:Eu,parsePath:h_,parsePreserveAspectRatioAttribute:D1,parseUnit:ds,pick:Es,projectStrokeOnPoints:Q1,qrDecompose:Ti,radiansToDegrees:Lr,removeFromArray:Xn,removeTransformFromObject:(t,e)=>{const r=Dt(e),n=We(r,t.calcOwnMatrix());Oi(t,n)},removeTransformMatrixForSvgParsing:JA,request:QA,requestAnimFrame:ko,resetObjectTransform:T1,rotatePoint:(t,e,r)=>t.rotate(r,e),rotateVector:Wg,saveObjectTransform:zg,sendObjectToPlane:of,sendPointToPlane:us,sendVectorToPlane:j1,setStyle:Bc,sin:pr,sizeAfterTransform:ju,string:hA,stylesFromArray:e_,stylesToArray:Z1,toBlob:Lg,toDataURL:Fg,toFixed:_e,transformPath:(t,e,r)=>(r&&(e=We(e,[1,0,0,1,-r.x,-r.y])),t.map(n=>{const s=[...n];for(let i=1;i<n.length-1;i+=2){const{x:o,y:a}=nt({x:n[i],y:n[i+1]},e);s[i]=o,s[i+1]=a}return s})),transformPoint:nt});class ZA extends C1{constructor(e){let{allowTouchScrolling:r=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),R(this,"upper",void 0),R(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:r}),this.applyCanvasStyle(i,{allowTouchScrolling:r,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(n),s.parentNode&&s.parentNode.replaceChild(o,s),o.append(s,i),this.container=o}createUpperCanvas(){const{el:e}=this.lower,r=Fr();return r.className=e.className,r.classList.remove("lower-canvas"),r.classList.add("upper-canvas"),r.setAttribute("data-fabric","top"),r.style.cssText=e.style.cssText,r.setAttribute("draggable","true"),r}createContainerElement(){const e=Li().createElement("div");return e.setAttribute("data-fabric","wrapper"),Bc(e,{position:"relative"}),V0(e),e}applyCanvasStyle(e,r){const{styles:n,allowTouchScrolling:s}=r;Bc(e,$($({},n),{},{"touch-action":s?"manipulation":Et})),V0(e)}setDimensions(e,r){super.setDimensions(e,r);const{el:n,ctx:s}=this.upper;S1(n,s,e,r)}setCSSDimensions(e){super.setCSSDimensions(e),sf(this.upper.el,e),sf(this.container,e)}cleanupDOM(e){const r=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),r.removeChild(s),r.removeChild(n),r.parentNode&&r.parentNode.replaceChild(n,r)}dispose(){super.dispose(),Ar().dispose(this.upper.el),delete this.upper,delete this.container}}class Fu extends Ea{constructor(){super(...arguments),R(this,"targets",[]),R(this,"_hoveredTargets",[]),R(this,"_objectsToRender",void 0),R(this,"_currentTransform",null),R(this,"_groupSelector",null),R(this,"contextTopDirty",!1)}static getDefaults(){return $($({},super.getDefaults()),Fu.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new ZA(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(r=>!r.group&&r!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const r=this.getRetinaScaling(),n=Math.ceil((2*e+1)*r);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(r,r)}isTargetTransparent(e,r,n){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-r+s,-n+s),i.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=o,i.restore();const a=Math.round(s*this.getRetinaScaling());return q1(i,a,a,a)}_isSelectionKeyPressed(e){const r=this.selectionKey;return!!r&&(Array.isArray(r)?!!r.find(n=>!!n&&e[n]===!0):e[r])}_shouldClearSelection(e,r){const n=this.getActiveObjects(),s=this._activeObject;return!!(!r||r&&s&&n.length>1&&n.indexOf(r)===-1&&s!==r&&!this._isSelectionKeyPressed(e)||r&&!r.evented||r&&!r.selectable&&s&&s!==r)}_shouldCenterTransform(e,r,n){if(!e)return;let s;return r===ku||r===ft||r===Rt||r===sa?s=this.centeredScaling||e.centeredScaling:r===Dg&&(s=this.centeredRotation||e.centeredRotation),s?!n:n}_getOriginFromCorner(e,r){const n={x:e.originX,y:e.originY};return r&&(["ml","tl","bl"].includes(r)?n.x=Re:["mr","tr","br"].includes(r)&&(n.x=ve),["tl","mt","tr"].includes(r)?n.y=nf:["bl","mb","br"].includes(r)&&(n.y=kt)),n}_setupCurrentTransform(e,r,n){var s;const i=r.group?us(this.getScenePoint(e),void 0,r.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=r.getActiveControl()||{},l=n&&a?(s=a.getActionHandler(e,r,a))===null||s===void 0?void 0:s.bind(a):N3,c=((g,p,y,v)=>{if(!p||!g)return"drag";const m=v.controls[p];return m.getActionName(y,m,v)})(n,o,e,r),u=e[this.centeredKey],d=this._shouldCenterTransform(r,c,u)?{x:de,y:de}:this._getOriginFromCorner(r,o),h={target:r,action:c,actionHandler:l,actionPerformed:!1,corner:o,scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,offsetX:i.x-r.left,offsetY:i.y-r.top,originX:d.x,originY:d.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:Le(r.angle),width:r.width,height:r.height,shiftKey:e.shiftKey,altKey:u,original:$($({},zg(r)),{},{originX:d.x,originY:d.y})};this._currentTransform=h,this.fire("before:transform",{e,transform:h})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:r,y:n,deltaX:s,deltaY:i}=this._groupSelector,o=new W(r,n).transform(this.viewportTransform),a=new W(r+s,n+i).transform(this.viewportTransform),l=this.selectionLineWidth/2;let c=Math.min(o.x,a.x),u=Math.min(o.y,a.y),d=Math.max(o.x,a.x),h=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(c,u,d-c,h-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,c+=l,u+=l,d-=l,h-=l,ot.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(c,u,d-c,h-u))}findTarget(e){if(this.skipTargetFind)return;const r=this.getViewportPoint(e),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(r,Mc(e))||s.length>1&&this.searchPossibleTargets([n],r))return n;if(n===this.searchPossibleTargets([n],r)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,r);return e[this.altSelectionKey]&&o&&o!==n?(this.targets=i,n):o}return n}}return this.searchPossibleTargets(this._objects,r)}_pointIsInObjectSelectionArea(e,r){let n=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[o,a,l,c]=n,u=Math.atan2(a.y-o.y,a.x-o.x),d=gr(u)*i,h=pr(u)*i,g=d+h,p=d-h;n=[new W(o.x-p,o.y-g),new W(a.x+g,a.y-p),new W(l.x+p,l.y+g),new W(c.x-g,c.y+p)]}return Oe.isPointInPolygon(r,n)}_checkTarget(e,r){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,us(r,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,r.x,r.y)))}_searchPossibleTargets(e,r){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,r)){if(Xl(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,r);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,r){const n=this._searchPossibleTargets(e,r);if(n&&Xl(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const o=s[i];if(!Xl(o)||!o.interactive)return o}return s[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let i=k1(e),o=s.width||0,a=s.height||0;o&&a||(kt in s&&nf in s&&(a=Math.abs(s.top-s.bottom)),Re in s&&ve in s&&(o=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,r||(i=us(i,void 0,this.viewportTransform));const l=this.getRetinaScaling();l!==1&&(i.x/=l,i.y/=l);const c=o===0||a===0?new W(1,1):new W(n.width/o,n.height/a);return i.multiply(c)}_setDimensionsImpl(e,r){this._resetTransformEventData(),super._setDimensionsImpl(e,r),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Fr(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Yn(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,r){let n=!1,s=!1;const i=this.getActiveObjects(),o=[],a=[];e.forEach(l=>{i.includes(l)||(n=!0,l.fire("deselected",{e:r,target:l}),a.push(l))}),i.forEach(l=>{e.includes(l)||(n=!0,l.fire("selected",{e:r,target:l}),o.push(l))}),e.length>0&&i.length>0?(s=!0,n&&this.fire("selection:updated",{e:r,selected:o,deselected:a})):i.length>0?(s=!0,this.fire("selection:created",{e:r,selected:o})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:r,deselected:a})),s&&(this._objectsToRender=void 0)}setActiveObject(e,r){const n=this.getActiveObjects(),s=this._setActiveObject(e,r);return this._fireSelectionEvents(n,r),s}_setActiveObject(e,r){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(r,e)&&this._activeObject)&&!e.onSelect({e:r})&&(this._activeObject=e,Yn(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,r){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:r})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),Yn(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const r=this.getActiveObjects(),n=this.getActiveObject();r.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(r,e),s}endCurrentTransform(e){const r=this._currentTransform;this._finalizeCurrentTransform(e),r&&r.target&&(r.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const r=this._currentTransform,n=r.target,s={e,target:n,transform:r,action:r.action};n._scaling&&(n._scaling=!1),n.setCoords(),r.actionPerformed&&(this.fire("object:modified",s),n.fire(Oc,s))}setViewportTransform(e){super.setViewportTransform(e);const r=this._activeObject;r&&r.setCoords()}destroy(){const e=this._activeObject;Yn(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const r=this._activeObject;r&&r._renderControls(e)}_toObject(e,r,n){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,r,n);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:r}=e;if(r&&Yn(r)&&this._activeObject===r){const n=Es(e,["angle","flipX","flipY",ve,ft,Rt,Ri,Ii,kt]);return E1(e,r.calcOwnMatrix()),n}return{}}_setSVGObject(e,r,n){const s=this._realizeGroupTransformOnObject(r);super._setSVGObject(e,r,n),r.set(s)}}R(Fu,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class eF{constructor(e){R(this,"targets",[]),R(this,"__disposer",void 0);const r=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},n=e.upperCanvasEl;n.addEventListener("click",r),this.__disposer=()=>n.removeEventListener("click",r)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Xn(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var r;!((r=this.target)===null||r===void 0)&&r.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const tF=["target","oldTarget","fireCanvas","e"],jt={passive:!1},Rs=(t,e)=>{const r=t.getViewportPoint(e),n=t.getScenePoint(e);return{viewportPoint:r,scenePoint:n,pointer:r,absolutePointer:n}},pn=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.addEventListener(...r)},Bt=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.removeEventListener(...r)},rF={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class ff extends Fu{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),R(this,"_isClick",void 0),R(this,"textEditingManager",new eF(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(r=>{this[r]=this[r].bind(this)}),this.addOrRemove(pn,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,r){const n=this.upperCanvasEl,s=this._getEventPrefix();e(_1(n),"resize",this._onResize),e(n,s+"down",this._onMouseDown),e(n,"".concat(s,"move"),this._onMouseMove,jt),e(n,"".concat(s,"out"),this._onMouseOut),e(n,"".concat(s,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"click",this._onClick),e(n,"dblclick",this._onClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,jt)}removeListeners(){this.addOrRemove(Bt,"remove");const e=this._getEventPrefix(),r=or(this.upperCanvasEl);Bt(r,"".concat(e,"up"),this._onMouseUp),Bt(r,"touchend",this._onTouchEnd,jt),Bt(r,"".concat(e,"move"),this._onMouseMove,jt),Bt(r,"touchmove",this._onMouseMove,jt),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const r=this._hoveredTarget,n=$({e},Rs(this,e));this.fire("mouse:out",$($({},n),{},{target:r})),this._hoveredTarget=void 0,r&&r.fire("mouseout",$({},n)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",$($({},n),{},{target:s})),s&&s.fire("mouseout",$({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",$({e},Rs(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const r=this.getActiveObject();if(r&&r.onDragStart(e)){this._dragSource=r;const n={e,target:r};return this.fire("dragstart",n),r.fire("dragstart",n),void pn(this.upperCanvasEl,"drag",this._onDragProgress)}U0(e)}_renderDragEffects(e,r,n){let s=!1;const i=this._dropTarget;i&&i!==r&&i!==n&&(i.clearContextTop(),s=!0),r==null||r.clearContextTop(),n!==r&&(n==null||n.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),r&&(o.save(),r.transform(o),r.renderDragSourceEffect(e),o.restore(),s=!0),n&&(o.save(),n.transform(o),n.renderDropTargetEffect(e),o.restore(),s=!0),o.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const r=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Et,n=r?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:r,dropTarget:n};Bt(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const r={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",r),this._dragSource&&this._dragSource.fire("drag",r)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const r="dragover",{target:n,targets:s}=this.findDragTargets(e),i=this._dragSource,o={e,target:n,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let a;this.fire(r,o),this._fireEnterLeaveEvents(n,o),n&&(n.canDrop(e)&&(a=n),n.fire(r,o));for(let l=0;l<s.length;l++){const c=s[l];c.canDrop(e)&&(a=c),c.fire(r,o)}this._renderDragEffects(e,i,a),this._dropTarget=a}_onDragEnter(e){const{target:r,targets:n}=this.findDragTargets(e),s={e,target:r,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(r,s)}_onDragLeave(e){const r={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",r),this._fireEnterLeaveEvents(void 0,r),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:r,targets:n}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",$({e,target:r,subTargets:n,dragSource:this._dragSource},Rs(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const r=this.findTarget(e),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:r,subTargets:n});return this.stopContextMenu&&U0(e),this._basicEventHandler("contextmenu",s),!1}_onClick(e){const r=e.detail;r>3||r<2||(this._cacheTransformEventData(e),r==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),r==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const r=e.changedTouches;return r?r[0]&&r[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let r=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(r=!0),r&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,i=this._getEventPrefix(),o=or(s);pn(o,"touchend",this._onTouchEnd,jt),r&&pn(o,"touchmove",this._onMouseMove,jt),Bt(s,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const r=this.upperCanvasEl,n=this._getEventPrefix();Bt(r,"".concat(n,"move"),this._onMouseMove,jt);const s=or(r);pn(s,"".concat(n,"up"),this._onMouseUp),pn(s,"".concat(n,"move"),this._onMouseMove,jt)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const r=this._getEventPrefix(),n=or(this.upperCanvasEl);Bt(n,"touchend",this._onTouchEnd,jt),Bt(n,"touchmove",this._onMouseMove,jt),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{pn(this.upperCanvasEl,"".concat(r,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const r=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const s=or(this.upperCanvasEl);Bt(s,"".concat(n,"up"),this._onMouseUp),Bt(s,"".concat(n,"move"),this._onMouseMove,jt),pn(r,"".concat(n,"move"),this._onMouseMove,jt)}}_onMouseMove(e){const r=this.getActiveObject();!this.allowTouchScrolling&&(!r||!r.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const r=this.getActiveObject();return!!r!=!!e||r&&e&&r!==e}__onMouseUp(e){var r;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,s=this._isClick,i=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,l,c=!1;if(n&&(this._finalizeCurrentTransform(e),c=n.actionPerformed),!s){const u=i===this._activeObject;this.handleSelection(e),c||(c=this._shouldRender(i)||!u&&i===this._activeObject)}if(i){const u=i.findControl(this.getViewportPoint(e),Mc(e)),{key:d,control:h}=u||{};if(l=d,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),c=!0;else if(h){const g=h.getMouseUpHandler(e,i,h);g&&(a=this.getScenePoint(e),g.call(h,e,n,a.x,a.y))}i.isMoving=!1}if(n&&(n.target!==i||n.corner!==l)){const u=n.target&&n.target.controls[n.corner],d=u&&u.getMouseUpHandler(e,n.target,u);a=a||this.getScenePoint(e),d&&d.call(u,e,n,a.x,a.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),c?this.requestRenderAll():s||(r=this._activeObject)!==null&&r!==void 0&&r.isEditing||this.renderTop()}_basicEventHandler(e,r){const{target:n,subTargets:s=[]}=r;this.fire(e,r),n&&n.fire(e,r);for(let i=0;i<s.length;i++)s[i]!==n&&s[i].fire(e,r);return r}_handleEvent(e,r,n){const s=this._target,i=this.targets||[],o=$($($({e,target:s,subTargets:i},Rs(this,e)),{},{transform:this._currentTransform},r==="up:before"||r==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),r==="down:before"||r==="down"?n:{});this.fire("mouse:".concat(r),o),s&&s.fire("mouse".concat(r),o);for(let a=0;a<i.length;a++)i[a]!==s&&i[a].fire("mouse".concat(r),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const r=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(r,{e,pointer:r}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const r=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(r,{e,pointer:r})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const r=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:r}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let r=this._target,n=!!r&&r===this._activeObject;const{button:s}=e;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"down",{alreadySelected:n}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(r),o=!1;if(this.handleMultiSelection(e,r)?(r=this._activeObject,o=!0,i=!0):this._shouldClearSelection(e,r)&&this.discardActiveObject(e),this.selection&&(!r||!r.selectable&&!r.isEditing&&r!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(n=!!r&&r===this._activeObject,r){r.selectable&&r.activeOn==="down"&&this.setActiveObject(r,e);const a=r.findControl(this.getViewportPoint(e),Mc(e));if(r===this._activeObject&&(a||!o)){this._setupCurrentTransform(e,r,n);const l=a?a.control:void 0,c=this.getScenePoint(e),u=l&&l.getMouseDownHandler(e,r,l);u&&u.call(l,e,this._currentTransform,c.x,c.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:n}),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=us(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const r=this._groupSelector;if(r){const n=this.getScenePoint(e);r.deltaX=n.x-r.x,r.deltaY=n.y-r.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,r){const n=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:r,oldTarget:n,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e,target:i[a],oldTarget:s[a]});this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,r){const n=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",$($({},r),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",$($({},r),{},{target:i[a],oldTarget:s[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,r){let{target:n,oldTarget:s,fireCanvas:i,e:o}=r,a=je(r,tF);const{targetIn:l,targetOut:c,canvasIn:u,canvasOut:d}=rF[e],h=s!==n;if(s&&h){const g=$($({},a),{},{e:o,target:s,nextTarget:n},Rs(this,o));i&&this.fire(d,g),s.fire(c,g)}if(n&&h){const g=$($({},a),{},{e:o,target:n,previousTarget:s},Rs(this,o));i&&this.fire(u,g),n.fire(l,g)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const r=this.getScenePoint(e),n=this._currentTransform,s=n.target,i=s.group?us(r,void 0,s.group.calcTransformMatrix()):r;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,i),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,r,n){const{action:s,actionHandler:i,target:o}=r,a=!!i&&i(e,r,n.x,n.y);a&&o.setCoords(),s==="drag"&&a&&(r.target.isMoving=!0,this.setCursor(r.target.moveCursor||this.moveCursor)),r.actionPerformed=r.actionPerformed||a}_setCursorFromEvent(e,r){if(!r)return void this.setCursor(this.defaultCursor);let n=r.hoverCursor||this.hoverCursor;const s=Yn(this._activeObject)?this._activeObject:null,i=(!s||r.group!==s)&&r.findControl(this.getViewportPoint(e));if(i){const o=i.control;this.setCursor(o.cursorStyleHandler(e,o,r))}else r.subTargetCheck&&this.targets.concat().reverse().map(o=>{n=o.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,r){const n=this._activeObject,s=Yn(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&r&&r.selectable&&(n!==r||s)&&(s||!r.isDescendantOf(n)&&!n.isDescendantOf(r))&&!r.onSelect({e})&&!n.getActiveControl()){if(s){const i=n.getObjects();if(r===n){const o=this.getViewportPoint(e);if(!(r=this.searchPossibleTargets(i,o)||this.searchPossibleTargets(this._objects,o))||!r.selectable)return!1}r.group===n?(n.remove(r),this._hoveredTarget=r,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(r),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{n.isEditing&&n.exitEditing();const i=new(ee.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(n,r),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:r,y:n,deltaX:s,deltaY:i}=this._groupSelector,o=new W(r,n),a=o.add(new W(s,i)),l=o.min(a),c=o.max(a).subtract(l),u=this.collectObjects({left:l.x,top:l.y,width:c.x,height:c.y},{includeIntersecting:!this.selectionFullyContained}),d=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(h=>!h.onSelect({e})).reverse():u;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){const h=ee.getClass("ActiveSelection");this.setActiveObject(new h(d,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const g_={x1:0,y1:0,x2:0,y2:0},nF=$($({},g_),{},{r1:0,r2:0}),Zs=(t,e)=>isNaN(t)&&typeof e=="number"?e:t,sF=/^(\d+\.\d+)%|(\d+)%$/;function p_(t){return t&&sF.test(t)}function m_(t,e){const r=typeof t=="number"?t:typeof t=="string"?parseFloat(t)/(p_(t)?100:1):NaN;return _s(0,Zs(r,e),1)}const iF=/\s*;\s*/,oF=/\s*:\s*/;function aF(t,e){let r,n;const s=t.getAttribute("style");if(s){const o=s.split(iF);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[l,c]=o[a].split(oF).map(u=>u.trim());l==="stop-color"?r=c:l==="stop-opacity"&&(n=c)}}const i=new we(r||t.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:m_(t.getAttribute("offset"),0),color:i.toRgb(),opacity:Zs(parseFloat(n||t.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function lF(t,e){const r=[],n=t.getElementsByTagName("stop"),s=m_(e,1);for(let i=n.length;i--;)r.push(aF(n[i],s));return r}function y_(t){return t.nodeName==="linearGradient"||t.nodeName==="LINEARGRADIENT"?"linear":"radial"}function x_(t){return t.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Zt(t,e){return t.getAttribute(e)}function cF(t,e){return function(r,n){let s,{width:i,height:o,gradientUnits:a}=n;return Object.keys(r).reduce((l,c)=>{const u=r[c];return u==="Infinity"?s=1:u==="-Infinity"?s=0:(s=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&p_(u)&&(s*=.01,a==="pixels"&&(c!=="x1"&&c!=="x2"&&c!=="r2"||(s*=i),c!=="y1"&&c!=="y2"||(s*=o)))),l[c]=s,l},{})}(y_(t)==="linear"?function(r){return{x1:Zt(r,"x1")||0,y1:Zt(r,"y1")||0,x2:Zt(r,"x2")||"100%",y2:Zt(r,"y2")||0}}(t):function(r){return{x1:Zt(r,"fx")||Zt(r,"cx")||"50%",y1:Zt(r,"fy")||Zt(r,"cy")||"50%",r1:0,x2:Zt(r,"cx")||"50%",y2:Zt(r,"cy")||"50%",r2:Zt(r,"r")||"50%"}}(t),$($({},e),{},{gradientUnits:x_(t)}))}class il{constructor(e){const{type:r="linear",gradientUnits:n="pixels",coords:s={},colorStops:i=[],offsetX:o=0,offsetY:a=0,gradientTransform:l,id:c}=e||{};Object.assign(this,{type:r,gradientUnits:n,coords:$($({},r==="radial"?nF:g_),s),colorStops:i,offsetX:o,offsetY:a,gradientTransform:l,id:c?"".concat(c,"_").concat(Fn()):Fn()})}addColorStop(e){for(const r in e){const n=new we(e[r]);this.colorStops.push({offset:parseFloat(r),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return $($({},Es(this,e)),{},{type:this.type,coords:$({},this.coords),colorStops:this.colorStops.map(r=>$({},r)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():ht.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(d=>$({},d)).sort((d,h)=>d.offset-h.offset);let a=-this.offsetX,l=-this.offsetY;var c;i==="objectBoundingBox"?(a/=e.width,l/=e.height):(a+=e.width/2,l+=e.height/2),(c=e)&&typeof c._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,l-=e.pathOffset.y),s[4]-=a,s[5]-=l;const u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(r?r+" ":"").concat(Ni(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:d,y1:h,x2:g,y2:p}=this.coords;n.push("<linearGradient ",u,' x1="',d,'" y1="',h,'" x2="',g,'" y2="',p,`">
`)}else if(this.type==="radial"){const{x1:d,y1:h,x2:g,y2:p,r1:y,r2:v}=this.coords,m=y>v;n.push("<radialGradient ",u,' cx="',m?d:g,'" cy="',m?h:p,'" r="',m?y:v,'" fx="',m?g:d,'" fy="',m?p:h,`">
`),m&&(o.reverse(),o.forEach(x=>{x.offset=1-x.offset}));const w=Math.min(y,v);if(w>0){const x=w/Math.max(y,v);o.forEach(_=>{_.offset+=x*(1-_.offset)})}}return o.forEach(d=>{let{color:h,offset:g,opacity:p}=d;n.push("<stop ",'offset="',100*g+"%",'" style="stop-color:',h,p!==void 0?";stop-opacity: "+p:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:r,y1:n,x2:s,y2:i,r1:o,r2:a}=this.coords,l=this.type==="linear"?e.createLinearGradient(r,n,s,i):e.createRadialGradient(r,n,o,s,i,a);return this.colorStops.forEach(c=>{let{color:u,opacity:d,offset:h}=c;l.addColorStop(h,d!==void 0?new we(u).setAlpha(d).toRgba():u)}),l}static async fromObject(e){const{colorStops:r,gradientTransform:n}=e;return new this($($({},e),{},{colorStops:r?r.map(s=>$({},s)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,r,n){const s=x_(e),i=r._findCenterFromElement();return new this($({id:e.getAttribute("id")||void 0,type:y_(e),coords:cF(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:lF(e,n.opacity),gradientUnits:s,gradientTransform:cf(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:r.width/2-i.x,offsetY:r.height/2-i.y}:{offsetX:0,offsetY:0}))}}R(il,"type","Gradient"),ee.setClass(il,"gradient"),ee.setClass(il,"linear"),ee.setClass(il,"radial");const uF=["type","source","patternTransform"];class Fd{get type(){return"pattern"}set type(e){Dn("warn","Setting type has no effect",e)}constructor(e){R(this,"repeat","repeat"),R(this,"offsetX",0),R(this,"offsetY",0),R(this,"crossOrigin",""),this.id=Fn(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:r,crossOrigin:n}=this;return $($({},Es(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:r,crossOrigin:n,offsetX:_e(this.offsetX,xe.NUM_FRACTION_DIGITS),offsetY:_e(this.offsetY,xe.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:r,height:n}=e;const{source:s,repeat:i,id:o}=this,a=Zs(this.offsetX/r,0),l=Zs(this.offsetY/n,0),c=i==="repeat-y"||i==="no-repeat"?1+Math.abs(a||0):Zs(s.width/r,0),u=i==="repeat-x"||i==="no-repeat"?1+Math.abs(l||0):Zs(s.height/n,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(l,'" width="').concat(c,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,r){let{type:n,source:s,patternTransform:i}=e,o=je(e,uF);const a=await Eo(s,$($({},r),{},{crossOrigin:o.crossOrigin}));return new this($($({},o),{},{patternTransform:i&&i.slice(0),source:a}))}}R(Fd,"type","Pattern"),ee.setClass(Fd),ee.setClass(Fd,"pattern");const dF=["path","left","top"],hF=["d"];class Gn extends ot{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:i}=r,o=je(r,dF);super(),Object.assign(this,Gn.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof s=="number"&&this.set(ve,s),typeof i=="number"&&this.set(kt,i)}_setPath(e,r){this.path=o_(Array.isArray(e)?e:h_(e)),this.setBoundingBox(r)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new W(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const r=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+r,s[2]+n);break;case"M":e.moveTo(s[1]+r,s[2]+n);break;case"C":e.bezierCurveTo(s[1]+r,s[2]+n,s[3]+r,s[4]+n,s[5]+r,s[6]+n);break;case"Q":e.quadraticCurveTo(s[1]+r,s[2]+n,s[3]+r,s[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject(e)),{},{path:this.path.map(r=>r.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const r=this.toObject(e);return this.sourcePath&&(delete r.path,r.sourcePath=this.sourcePath),r}_toSVG(){const e=f_(this.path,xe.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=xe.NUM_FRACTION_DIGITS;return" translate(".concat(_e(-this.pathOffset.x,e),", ").concat(_e(-this.pathOffset.y,e),")")}toClipPathSVG(e){const r=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:r})}toSVG(e){const r=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:r})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:r,height:n,pathOffset:s}=this._calcDimensions();this.set({width:r,height:n,pathOffset:s}),e&&this.setPositionByOrigin(s,de,de)}_calcBoundsFromPath(){const e=[];let r=0,n=0,s=0,i=0;for(const o of this.path)switch(o[0]){case"L":s=o[1],i=o[2],e.push({x:r,y:n},{x:s,y:i});break;case"M":s=o[1],i=o[2],r=s,n=i;break;case"C":e.push(...hf(s,i,o[1],o[2],o[3],o[4],o[5],o[6])),s=o[5],i=o[6];break;case"Q":e.push(...hf(s,i,o[1],o[2],o[1],o[2],o[3],o[4])),s=o[3],i=o[4];break;case"Z":s=r,i=n}return Pr(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return $($({},e),{},{pathOffset:new W(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,r,n){const s=cn(e,this.ATTRIBUTE_NAMES,n),{d:i}=s;return new this(i,$($($({},je(s,hF)),r),{},{left:void 0,top:void 0}))}}R(Gn,"type","Path"),R(Gn,"cacheProperties",[...ln,"path","fillRule"]),R(Gn,"ATTRIBUTE_NAMES",[...$n,"d"]),ee.setClass(Gn),ee.setSVGClass(Gn);const fF=["left","top","radius"],v_=["radius","startAngle","endAngle","counterClockwise"];class Cr extends ot{static getDefaults(){return $($({},super.getDefaults()),Cr.ownDefaults)}constructor(e){super(),Object.assign(this,Cr.ownDefaults),this.setOptions(e)}_set(e,r){return super._set(e,r),e==="radius"&&this.setRadius(r),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Le(this.startAngle),Le(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(ft)}getRadiusY(){return this.get("radius")*this.get(Rt)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...v_,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:r}=this,n=Le(this.startAngle),s=Le(this.endAngle),i=gr(n)*r,o=pr(n)*r,a=gr(s)*r,l=pr(s)*r,c=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(o," A ").concat(r," ").concat(r," 0 ").concat(c," ").concat(u," ").concat(a," ").concat(l,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,r,n){const s=cn(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:o=0,radius:a=0}=s;return new this($($({},je(s,fF)),{},{radius:a,left:i-a,top:o-a}))}static fromObject(e){return super._fromObject(e)}}R(Cr,"type","Circle"),R(Cr,"cacheProperties",[...ln,...v_]),R(Cr,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),R(Cr,"ATTRIBUTE_NAMES",["cx","cy","r",...$n]),ee.setClass(Cr),ee.setSVGClass(Cr);const gF=["x1","y1","x2","y2"],pF=["x1","y1","x2","y2"],gf=["x1","x2","y1","y2"];class qn extends ot{constructor(){let[e,r,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,qn.ownDefaults),this.setOptions(i),this.x1=e,this.x2=n,this.y1=r,this.y2=s,this._setWidthHeight();const{left:o,top:a}=i;typeof o=="number"&&this.set(ve,o),typeof a=="number"&&this.set(kt,a)}_setWidthHeight(){const{x1:e,y1:r,x2:n,y2:s}=this;this.width=Math.abs(n-e),this.height=Math.abs(s-r);const{left:i,top:o,width:a,height:l}=Pr([{x:e,y:r},{x:n,y:s}]),c=new W(i+a/2,o+l/2);this.setPositionByOrigin(c,de,de)}_set(e,r){return super._set(e,r),gf.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const r=this.calcLinePoints();e.moveTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var s;Ut(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new W((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:r,y1:n,y2:s,width:i,height:o}=this,a=e<=r?-1:1,l=n<=s?-1:1;return{x1:a*i/2,x2:a*-i/2,y1:l*o/2,y2:l*-o/2}}_toSVG(){const{x1:e,x2:r,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(r,'" y2="').concat(s,`" />
`)]}static async fromElement(e,r,n){const s=cn(e,this.ATTRIBUTE_NAMES,n),{x1:i=0,y1:o=0,x2:a=0,y2:l=0}=s;return new this([i,o,a,l],je(s,gF))}static fromObject(e){let{x1:r,y1:n,x2:s,y2:i}=e,o=je(e,pF);return this._fromObject($($({},o),{},{points:[r,n,s,i]}),{extraParam:"points"})}}R(qn,"type","Line"),R(qn,"cacheProperties",[...ln,...gf]),R(qn,"ATTRIBUTE_NAMES",$n.concat(gf)),ee.setClass(qn),ee.setSVGClass(qn);class ts extends ot{static getDefaults(){return $($({},super.getDefaults()),ts.ownDefaults)}constructor(e){super(),Object.assign(this,ts.ownDefaults),this.setOptions(e)}_render(e){const r=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-r,n),e.lineTo(0,-n),e.lineTo(r,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,r=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(r,",0 ").concat(-r,",").concat(e," ").concat(r),'" />']}}R(ts,"type","Triangle"),R(ts,"ownDefaults",{width:100,height:100}),ee.setClass(ts),ee.setSVGClass(ts);const w_=["rx","ry"];class Vr extends ot{static getDefaults(){return $($({},super.getDefaults()),Vr.ownDefaults)}constructor(e){super(),Object.assign(this,Vr.ownDefaults),this.setOptions(e)}_set(e,r){switch(super._set(e,r),e){case"rx":this.rx=r,this.set("width",2*r);break;case"ry":this.ry=r,this.set("height",2*r)}return this}getRx(){return this.get("rx")*this.get(ft)}getRy(){return this.get("ry")*this.get(Rt)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...w_,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,sn,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,r,n){const s=cn(e,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function mF(t){if(!t)return[];const e=t.replace(/,/g," ").trim().split(/\s+/),r=[];for(let n=0;n<e.length;n+=2)r.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return r}R(Vr,"type","Ellipse"),R(Vr,"cacheProperties",[...ln,...w_]),R(Vr,"ownDefaults",{rx:0,ry:0}),R(Vr,"ATTRIBUTE_NAMES",[...$n,"cx","cy","rx","ry"]),ee.setClass(Vr),ee.setSVGClass(Vr);const yF=["left","top"],b_={exactBoundingBox:!1};class nr extends ot{static getDefaults(){return $($({},super.getDefaults()),nr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),R(this,"strokeDiff",void 0),Object.assign(this,nr.ownDefaults),this.setOptions(r),this.points=e;const{left:n,top:s}=r;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(ve,n),typeof s=="number"&&this.set(kt,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return Q1(this.points,e,this.isOpen())}_calcDimensions(e){e=$({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const r=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(c=>c.projectedPoint):this.points;if(r.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new W,strokeOffset:new W,strokeDiff:new W};const n=Pr(r),s=Ca($($({},e),{},{scaleX:1,scaleY:1})),i=Pr(this.points.map(c=>nt(c,s,!0))),o=new W(this.scaleX,this.scaleY);let a=n.left+n.width/2,l=n.top+n.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(Le(this.skewX)),l-=a*Math.tan(Le(this.skewY))),$($({},n),{},{pathOffset:new W(a,l),strokeOffset:new W(i.left,i.top).subtract(new W(n.left,n.top)).multiply(o),strokeDiff:new W(n.width,n.height).subtract(new W(i.width,i.height)).multiply(o)})}_findCenterFromElement(){const e=Pr(this.points);return new W(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:r,top:n,width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}),e&&this.setPositionByOrigin(new W(r+s/2,n+i/2),de,de)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new W(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var r,n;const{width:a,height:l}=this._calcDimensions(e);o=new W((r=e.width)!==null&&r!==void 0?r:a,(n=e.height)!==null&&n!==void 0?n:l)}else{var s,i;o=new W((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return o.multiply(new W(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,r){const n=this.initialized&&this[e]!==r,s=super._set(e,r);return this.exactBoundingBox&&n&&((e===ft||e===Rt)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject(e)),{},{points:this.points.map(r=>{let{x:n,y:s}=r;return{x:n,y:s}})})}_toSVG(){const e=[],r=this.pathOffset.x,n=this.pathOffset.y,s=xe.NUM_FRACTION_DIGITS;for(let i=0,o=this.points.length;i<o;i++)e.push(_e(this.points[i].x-r,s),",",_e(this.points[i].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const r=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(r&&!isNaN(this.points[r-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-s);for(let i=0;i<r;i++){const o=this.points[i];e.lineTo(o.x-n,o.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,r,n){return new this(mF(e.getAttribute("points")),$($({},je(cn(e,this.ATTRIBUTE_NAMES,n),yF)),r))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}R(nr,"ownDefaults",b_),R(nr,"type","Polyline"),R(nr,"layoutProperties",[Ri,Ii,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),R(nr,"cacheProperties",[...ln,"points"]),R(nr,"ATTRIBUTE_NAMES",[...$n]),ee.setClass(nr),ee.setSVGClass(nr);class ho extends nr{isOpen(){return!1}}R(ho,"ownDefaults",b_),R(ho,"type","Polygon"),ee.setClass(ho),ee.setSVGClass(ho);class __ extends ot{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const r=e===void 0?this.styles:{line:this.styles[e]};for(const n in r)for(const s in r[n])for(const i in r[n][s])return!1;return!0}styleHas(e,r){if(!this.styles||r!==void 0&&!this.styles[r])return!1;const n=r===void 0?this.styles:{0:this.styles[r]};for(const s in n)for(const i in n[s])if(n[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const r=this.styles;let n,s,i=0,o=!0,a=0;for(const l in r){n=0;for(const c in r[l]){const u=r[l][c]||{};i++,u[e]!==void 0?(s?u[e]!==s&&(o=!1):s=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?n++:delete r[l][c]}n===0&&delete r[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;o&&i===a&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const r=this.styles;let n,s,i;for(s in r){for(i in n=r[s],n)delete n[i][e],Object.keys(n[i]).length===0&&delete n[i];Object.keys(n).length===0&&delete r[s]}}_extendStyles(e,r){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const i=$g($($({},this._getStyleDeclaration(n,s)),r),o=>o!==void 0);this._setStyleDeclaration(n,s,i)}getSelectionStyles(e,r,n){const s=[];for(let i=e;i<(r||e);i++)s.push(this.getStyleAtPosition(i,n));return s}getStyleAtPosition(e,r){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);return r?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(e,r,n){for(let s=r;s<(n||r);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,r){var n;const s=this.styles&&this.styles[e];return s&&(n=s[r])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,r){return $($({},Es(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,r))}_setStyleDeclaration(e,r,n){this.styles[e][r]=n}_deleteStyleDeclaration(e,r){delete this.styles[e][r]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}R(__,"_styleProperties",O3);const xF=/  +/g,vF=/"/g;function Ld(t,e,r,n,s){return"		".concat(function(i,o){let{left:a,top:l,width:c,height:u}=o,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xe.NUM_FRACTION_DIGITS;const h=ia(Xe,i,!1),[g,p,y,v]=[a,l,c,u].map(m=>_e(m,d));return"<rect ".concat(h,' x="').concat(g,'" y="').concat(p,'" width="').concat(y,'" height="').concat(v,'"></rect>')}(t,{left:e,top:r,width:n,height:s}),`
`)}const wF=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Rd;class ct extends __{static getDefaults(){return $($({},super.getDefaults()),ct.ownDefaults)}constructor(e,r){super(),R(this,"__charBounds",[]),Object.assign(this,ct.ownDefaults),this.setOptions(r),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=Kg(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Er)&&this.enlargeSpaces()}enlargeSpaces(){let e,r,n,s,i,o,a;for(let l=0,c=this._textLines.length;l<c;l++)if((this.textAlign===Er||l!==c-1&&!this.isEndOfWrapping(l))&&(s=0,i=this._textLines[l],r=this.getLineWidth(l),r<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){n=a.length,e=(this.width-r)/n;for(let u=0;u<=i.length;u++)o=this.__charBounds[l][u],this._reSpaceAndTab.test(i[u])?(o.width+=e,o.kernedWidth+=e,o.left+=s,s+=e):o.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,r){const n=r?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(e<=n[s].length)return{lineIndex:s,charIndex:e};e-=n[s].length+this.missingNewlineOffset(s,r)}return{lineIndex:s-1,charIndex:n[s-1].length<e?n[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),r=this.fontSize;return e.width+=r*e.zoomX,e.height+=r*e.zoomY,e}_render(e){const r=this.path;r&&!r.isNotVisible()&&r._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===Tt?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,r,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case de:e.textBaseline="middle";break;case"ascender":e.textBaseline=kt;break;case"descender":e.textBaseline=nf}e.font=this._getFontDeclaration(r,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let r=1,n=this._textLines.length;r<n;r++){const s=this.getLineWidth(r);s>e&&(e=s)}return e}_renderTextLine(e,r,n,s,i,o){this._renderChars(e,r,n,s,i,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const r=e.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,o=this._textLines.length;i<o;i++){const a=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=a;continue}const l=this._textLines[i].length,c=this._getLineLeftOffset(i);let u,d,h=0,g=0,p=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let y=0;y<l;y++){const v=this.__charBounds[i][y];d=this.getValueOfPropertyAt(i,y,"textBackgroundColor"),this.path?(e.save(),e.translate(v.renderLeft,v.renderTop),e.rotate(v.angle),e.fillStyle=d,d&&e.fillRect(-v.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),v.width,a/this.lineHeight),e.restore()):d!==p?(u=n+c+g,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=p,p&&e.fillRect(u,s,h,a/this.lineHeight),g=v.left,h=v.width,p=d):h+=v.kernedWidth}d&&!this.path&&(u=n+c+g,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=d,e.fillRect(u,s,h,a/this.lineHeight)),s+=a}e.fillStyle=r,this._removeShadow(e)}_measureChar(e,r,n,s){const i=Co.getFontCache(r),o=this._getFontDeclaration(r),a=n+e,l=n&&o===this._getFontDeclaration(s),c=r.fontSize/this.CACHE_FONT_SIZE;let u,d,h,g;if(n&&i[n]!==void 0&&(h=i[n]),i[e]!==void 0&&(g=u=i[e]),l&&i[a]!==void 0&&(d=i[a],g=d-h),u===void 0||h===void 0||d===void 0){const p=function(){return Rd||(Rd=It({width:0,height:0}).getContext("2d")),Rd}();this._setTextStyles(p,r,!0),u===void 0&&(g=u=p.measureText(e).width,i[e]=u),h===void 0&&l&&n&&(h=p.measureText(n).width,i[n]=h),l&&d===void 0&&(d=p.measureText(a).width,i[a]=d,g=d-h)}return{width:u*c,kernedWidth:g*c}}getHeightOfChar(e,r){return this.getValueOfPropertyAt(e,r,"fontSize")}measureLine(e){const r=this._measureLine(e);return this.charSpacing!==0&&(r.width-=this._getWidthOfCharSpacing()),r.width<0&&(r.width=0),r}_measureLine(e){let r,n,s=0;const i=this.pathSide===Re,o=this.path,a=this._textLines[e],l=a.length,c=new Array(l);this.__charBounds[e]=c;for(let u=0;u<l;u++){const d=a[u];n=this._getGraphemeBox(d,e,u,r),c[u]=n,s+=n.kernedWidth,r=d}if(c[l]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0;const d=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case ve:u=i?d-s:0;break;case de:u=(d-s)/2;break;case Re:u=i?0:d-s}u+=this.pathStartOffset*(i?-1:1);for(let h=i?l-1:0;i?h>=0:h<l;i?h--:h++)n=c[h],u>d?u%=d:u<0&&(u+=d),this._setGraphemeOnPath(u,n),u+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,r){const n=e+r.kernedWidth/2,s=this.path,i=d_(s.path,n,s.segmentsInfo);r.renderLeft=i.x-s.pathOffset.x,r.renderTop=i.y-s.pathOffset.y,r.angle=i.angle+(this.pathSide===Re?Math.PI:0)}_getGraphemeBox(e,r,n,s,i){const o=this.getCompleteStyleDeclaration(r,n),a=s?this.getCompleteStyleDeclaration(r,n-1):{},l=this._measureChar(e,o,s,a);let c,u=l.kernedWidth,d=l.width;this.charSpacing!==0&&(c=this._getWidthOfCharSpacing(),d+=c,u+=c);const h={width:d,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(n>0&&!i){const g=this.__charBounds[r][n-1];h.left=g.left+g.width+l.kernedWidth-l.width}return h}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let r=this.getHeightOfChar(e,0);for(let n=1,s=this._textLines[e].length;n<s;n++)r=Math.max(this.getHeightOfChar(e,n),r);return this.__lineHeights[e]=r*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,r=0;for(let n=0,s=this._textLines.length;n<s;n++)e=this.getHeightOfLine(n),r+=n===s-1?e/this.lineHeight:e;return r}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,r){e.save();let n=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){const l=this.getHeightOfLine(o),c=l/this.lineHeight,u=this._getLineLeftOffset(o);this._renderTextLine(r,e,this._textLines[o],s+u,i+n+c,o),n+=l}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Xe))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,r,n,s,i,o){const a=this.getHeightOfLine(o),l=this.textAlign.includes(Er),c=this.path,u=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!c,d=this.direction==="ltr",h=this.direction==="ltr"?1:-1,g=r.direction;let p,y,v,m,w,x="",_=0;if(r.save(),g!==this.direction&&(r.canvas.setAttribute("dir",d?"ltr":"rtl"),r.direction=d?"ltr":"rtl",r.textAlign=d?ve:Re),i-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,r,o,0,n.join(""),s,i),void r.restore();for(let b=0,C=n.length-1;b<=C;b++)m=b===C||this.charSpacing||c,x+=n[b],v=this.__charBounds[o][b],_===0?(s+=h*(v.kernedWidth-v.width),_+=v.width):_+=v.kernedWidth,l&&!m&&this._reSpaceAndTab.test(n[b])&&(m=!0),m||(p=p||this.getCompleteStyleDeclaration(o,b),y=this.getCompleteStyleDeclaration(o,b+1),m=Du(p,y,!1)),m&&(c?(r.save(),r.translate(v.renderLeft,v.renderTop),r.rotate(v.angle),this._renderChar(e,r,o,b,x,-_/2,0),r.restore()):(w=s,this._renderChar(e,r,o,b,x,w,i)),x="",p=y,s+=h*_,_=0);r.restore()}_applyPatternGradientTransformText(e){const r=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=It({width:r,height:n}),i=s.getContext("2d");return s.width=r,s.height=n,i.beginPath(),i.moveTo(0,0),i.lineTo(r,0),i.lineTo(r,n),i.lineTo(0,n),i.closePath(),i.translate(r/2,n/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(s,"no-repeat")}handleFiller(e,r,n){let s,i;return Ut(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[r]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:i}):(e[r]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[r]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,r){let{stroke:n,strokeWidth:s}=r;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,r){let{fill:n}=r;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,r,n,s,i,o,a){const l=this._getStyleDeclaration(n,s),c=this.getCompleteStyleDeclaration(n,s),u=e==="fillText"&&c.fill,d=e==="strokeText"&&c.stroke&&c.strokeWidth;if(d||u){if(r.save(),r.font=this._getFontDeclaration(c),l.textBackgroundColor&&this._removeShadow(r),l.deltaY&&(a+=l.deltaY),u){const h=this._setFillStyles(r,c);r.fillText(i,o-h.offsetX,a-h.offsetY)}if(d){const h=this._setStrokeStyles(r,c);r.strokeText(i,o-h.offsetX,a-h.offsetY)}r.restore()}}setSuperscript(e,r){this._setScript(e,r,this.superscript)}setSubscript(e,r){this._setScript(e,r,this.subscript)}_setScript(e,r,n){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),o=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),a={fontSize:i*n.size,deltaY:o+i*n.baseline};this.setSelectionStyles(a,e,r)}_getLineLeftOffset(e){const r=this.getLineWidth(e),n=this.width-r,s=this.textAlign,i=this.direction,o=this.isEndOfWrapping(e);let a=0;return s===Er||s===jo&&!o||s===To&&!o||s===Ac&&!o?0:(s===de&&(a=n/2),s===Re&&(a=n),s===jo&&(a=n/2),s===To&&(a=n),i==="rtl"&&(s===Re||s===Er||s===To?a=0:s===ve||s===Ac?a=-n:s!==de&&s!==jo||(a=-n/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:r}=this.measureLine(e);return this.__lineWidths[e]=r,r}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,r,n){var s;return(s=this._getStyleDeclaration(e,r)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(e,r){if(!this[r]&&!this.styleHas(r))return;let n=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,o=this._getWidthOfCharSpacing(),a=r==="linethrough"?.5:r==="overline"?1:0,l=this.offsets[r];for(let c=0,u=this._textLines.length;c<u;c++){const d=this.getHeightOfLine(c);if(!this[r]&&!this.styleHas(r,c)){n+=d;continue}const h=this._textLines[c],g=d/this.lineHeight,p=this._getLineLeftOffset(c);let y=0,v=0,m=this.getValueOfPropertyAt(c,0,r),w=this.getValueOfPropertyAt(c,0,Xe),x=this.getValueOfPropertyAt(c,0,bs),_=m,b=w,C=x;const k=n+g*(1-this._fontSizeFraction);let S=this.getHeightOfChar(c,0),P=this.getValueOfPropertyAt(c,0,"deltaY");for(let A=0,L=h.length;A<L;A++){const E=this.__charBounds[c][A];_=this.getValueOfPropertyAt(c,A,r),b=this.getValueOfPropertyAt(c,A,Xe),C=this.getValueOfPropertyAt(c,A,bs);const M=this.getHeightOfChar(c,A),N=this.getValueOfPropertyAt(c,A,"deltaY");if(i&&_&&b){const I=this.fontSize*C/1e3;e.save(),e.fillStyle=w,e.translate(E.renderLeft,E.renderTop),e.rotate(E.angle),e.fillRect(-E.kernedWidth/2,l*M+N-a*I,E.kernedWidth,I),e.restore()}else if((_!==m||b!==w||M!==S||C!==x||N!==P)&&v>0){const I=this.fontSize*x/1e3;let j=s+p+y;this.direction==="rtl"&&(j=this.width-j-v),m&&w&&x&&(e.fillStyle=w,e.fillRect(j,k+l*S+P-a*I,v,I)),y=E.left,v=E.width,m=_,x=C,w=b,S=M,P=N}else v+=E.kernedWidth}let O=s+p+y;this.direction==="rtl"&&(O=this.width-O-v),e.fillStyle=b;const F=this.fontSize*C/1e3;_&&b&&C&&e.fillRect(O,k+l*S+P-a*F,v-o,F),n+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:r=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||ct.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[r,n,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return Mu(e)}_splitTextIntoLines(e){const r=e.split(this._reNewline),n=new Array(r.length),s=[`
`];let i=[];for(let o=0;o<r.length;o++)n[o]=this.graphemeSplit(r[o]),i=i.concat(n[o],s);return i.pop(),{_unwrappedLines:n,lines:r,graphemeText:i,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $($({},super.toObject([...I1,...e])),{},{styles:Z1(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,r){const{textLayoutProperties:n}=this.constructor;super.set(e,r);let s=!1,i=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),s=s||n.includes(o),i=i||o==="path";else s=n.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,r,n){const s=cn(e,ct.ATTRIBUTE_NAMES,n),i=$($({},r),s),{textAnchor:o=ve,textDecoration:a="",dx:l=0,dy:c=0,top:u=0,left:d=0,fontSize:h=Pg,strokeWidth:g=1}=i,p=je(i,wF),y=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),$({left:d+l,top:u+c,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:h},p)),v=y.getScaledHeight()/y.height,m=((y.height+y.strokeWidth)*y.lineHeight-y.height)*v,w=y.getScaledHeight()+m;let x=0;return o===de&&(x=y.getScaledWidth()/2),o===Re&&(x=y.getScaledWidth()),y.set({left:y.left-x,top:y.top-(w-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:g}),y}static fromObject(e){return this._fromObject($($({},e),{},{styles:e_(e.styles||{},e.text)}),{extraParam:"text"})}}R(ct,"textLayoutProperties",R1),R(ct,"cacheProperties",[...ln,...I1]),R(ct,"ownDefaults",P3),R(ct,"type","Text"),R(ct,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),R(ct,"ATTRIBUTE_NAMES",$n.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),G1(ct,[class extends A1{_toSVG(){const t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(t){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0}),r=this.path;return r?e+r._createBaseSVGMarkup(r._toSVG(),{reviver:t,withShadow:!0,additionalTransform:Ni(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(t){let{textBgRects:e,textSpans:r}=t;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(vF,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",r.join(""),`</text>
`]}_getSVGTextAndBg(t,e){const r=[],n=[];let s,i=t;this.backgroundColor&&n.push(...Ld(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)s=this._getLineLeftOffset(o),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,e+s,i),this._setSVGTextLineText(r,o,e+s,i),i+=this.getHeightOfLine(o);return{textSpans:r,textBgRects:n}}_createTextCharSpan(t,e,r,n,s){const i=xe.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(e,t!==t.trim()||!!t.match(xF)),a=o?'style="'.concat(o,'"'):"",l=e.deltaY,c=l?' dy="'.concat(_e(l,i),'" '):"",{angle:u,renderLeft:d,renderTop:h,width:g}=s;let p="";if(d!==void 0){const y=g/2;u&&(p=' rotate="'.concat(_e(Lr(u),i),'"'));const v=ks({angle:Lr(u)});v[4]=d,v[5]=h;const m=new W(-y,0).transform(v);r=m.x,n=m.y}return'<tspan x="'.concat(_e(r,i),'" y="').concat(_e(n,i),'" ').concat(c).concat(p).concat(a,">").concat(J1(t),"</tspan>")}_setSVGTextLineText(t,e,r,n){const s=this.getHeightOfLine(e),i=this.textAlign.includes(Er),o=this._textLines[e];let a,l,c,u,d,h="",g=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,y=o.length-1;p<=y;p++)d=p===y||this.charSpacing||this.path,h+=o[p],c=this.__charBounds[e][p],g===0?(r+=c.kernedWidth-c.width,g+=c.width):g+=c.kernedWidth,i&&!d&&this._reSpaceAndTab.test(o[p])&&(d=!0),d||(a=a||this.getCompleteStyleDeclaration(e,p),l=this.getCompleteStyleDeclaration(e,p+1),d=Du(a,l,!0)),d&&(u=this._getStyleDeclaration(e,p),t.push(this._createTextCharSpan(h,u,r,n,c)),h="",a=l,this.direction==="rtl"?r-=g:r+=g,g=0)}_setSVGTextLineBg(t,e,r,n){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let o,a=0,l=0,c=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<s.length;u++){const{left:d,width:h,kernedWidth:g}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==c?(c&&t.push(...Ld(c,r+l,n,a,i)),l=d,a=h,c=o):a+=g}o&&t.push(...Ld(c,r+l,n,a,i))}_getSVGLineTopOffset(t){let e,r=0;for(e=0;e<t;e++)r+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:r,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(t){return"".concat(super.getSvgStyles(t)," text-decoration-thickness: ").concat(_e(this.textDecorationThickness*this.getObjectScaling().y/10,xe.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(t,e){const{fontFamily:r,strokeWidth:n,stroke:s,fill:i,fontSize:o,fontStyle:a,fontWeight:l,deltaY:c,textDecorationThickness:u,linethrough:d,overline:h,underline:g}=t,p=this.getSvgTextDecoration({underline:g??this.underline,overline:h??this.overline,linethrough:d??this.linethrough}),y=u||this.textDecorationThickness;return[s?ia(Tt,s):"",n?"stroke-width: ".concat(n,"; "):"",r?"font-family: ".concat(r.includes("'")||r.includes('"')?r:"'".concat(r,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",p?"text-decoration: ".concat(p,"; text-decoration-thickness: ").concat(_e(y*this.getObjectScaling().y/10,xe.NUM_FRACTION_DIGITS),"%; "):"",i?ia(Xe,i):"",c?"baseline-shift: ".concat(-c,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(t){return["overline","underline","line-through"].filter(e=>t[e.replace("-","")]).join(" ")}}]),ee.setClass(ct),ee.setSVGClass(ct);class bF{constructor(e){R(this,"target",void 0),R(this,"__mouseDownInPlace",!1),R(this,"__dragStartFired",!1),R(this,"__isDraggingOver",!1),R(this,"__dragStartSelection",void 0),R(this,"__dragImageDisposer",void 0),R(this,"_dispose",void 0),this.target=e;const r=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{r.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){const r=this.target,n=r.getSelectionStartFromPointer(e);return r.isEditing&&n>=r.selectionStart&&n<=r.selectionEnd&&r.selectionStart<r.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const r=this.isActive();return r&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,r}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,r){var n;let{selectionStart:s,selectionEnd:i}=r;const o=this.target,a=o.canvas,l=new W(o.flipX?-1:1,o.flipY?-1:1),c=o._getCursorBoundaries(s),u=new W(c.left+c.leftOffset,c.top+c.topOffset).multiply(l).transform(o.calcTransformMatrix()),d=a.getScenePoint(e).subtract(u),h=o.getCanvasRetinaScaling(),g=o.getBoundingRect(),p=u.subtract(new W(g.left,g.top)),y=a.viewportTransform,v=p.add(d).transform(y,!0),m=o.backgroundColor,w=Yg(o.styles);o.backgroundColor="";const x={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(x,0,s),o.setSelectionStyles(x,i,o.text.length),o.dirty=!0;const _=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=m,o.styles=w,o.dirty=!0,Bc(_,{position:"fixed",left:"".concat(-_.width,"px"),border:Et,width:"".concat(_.width/h,"px"),height:"".concat(_.height/h,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{_.remove()},or(e.target||this.target.hiddenTextarea).body.appendChild(_),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(_,v.x,v.y)}onDragStart(e){this.__dragStartFired=!0;const r=this.target,n=this.isActive();if(n&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:r.selectionStart,selectionEnd:r.selectionEnd},i=r._text.slice(s.selectionStart,s.selectionEnd).join(""),o=$({text:r.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:r.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return r.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const r=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return r<n.selectionStart||r>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:r}=e;const n=this.targetCanDrop(r);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:r}=e,n=this.targetCanDrop(r);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(r.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var r;const{e:n}=e,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let i=(r=n.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain");if(i&&!s){const o=this.target,a=o.canvas;let l=o.getSelectionStartFromPointer(n);const{styles:c}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},u=i[Math.max(0,i.length-1)],d=0;if(this.__dragStartSelection){const h=this.__dragStartSelection.selectionStart,g=this.__dragStartSelection.selectionEnd;l>h&&l<=g?l=h:l>g&&(l-=g-h),o.removeChars(h,g),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[l])||l===o._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(i,c,l),a.setActiveObject(o),o.enterEditing(n),o.selectionStart=Math.min(l+d,o._text.length),o.selectionEnd=Math.min(o.selectionStart+i.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(Nc,{index:l+d,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:r}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,i=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,l=((n=r.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||Et;l===Et?(s.selectionStart=o,s.selectionEnd=a,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),l==="move"&&(s.removeChars(o,a),s.selectionStart=s.selectionEnd=o,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Nc,{index:o,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const wy=/[ \n\.,;!\?\-]/;class _F extends ct{constructor(){super(...arguments),R(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:r,duration:n,delay:s,onComplete:i}=e;return Ug({startValue:this._currentCursorOpacity,endValue:r,duration:n,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(r=>{r&&!r.isDone()&&(e=!0,r.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let r=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)r++,n--;for(;/\S/.test(this._text[n])&&n>-1;)r++,n--;return e-r}findWordBoundaryRight(e){let r=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)r++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)r++,n++;return e+r}findLineBoundaryLeft(e){let r=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)r++,n--;return e-r}findLineBoundaryRight(e){let r=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)r++,n++;return e+r}searchWordBoundary(e,r){const n=this._text;let s=e>0&&this._reSpace.test(n[e])&&(r===-1||!Mg.test(n[e-1]))?e-1:e,i=n[s];for(;s>0&&s<n.length&&!wy.test(i);)s+=r,i=n[s];return r===-1&&wy.test(i)&&s++,s}selectWord(e){var r;e=(r=e)!==null&&r!==void 0?r:this.selectionStart;const n=this.searchWordBoundary(e,-1),s=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var r;e=(r=e)!==null&&r!==void 0?r:this.selectionStart;const n=this.findLineBoundaryLeft(e),s=this.findLineBoundaryRight(e);this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const r=this.hiddenTextarea;or(r).activeElement!==r&&r.focus();const n=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==i||s!==n&&i!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,r,n){const s=n.slice(0,e),i=this.graphemeSplit(s).length;if(e===r)return{selectionStart:i,selectionEnd:i};const o=n.slice(e,r);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,r,n){const s=n.slice(0,e).join("").length;return e===r?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(e,r).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const r=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=r.selectionEnd,this.inCompositionMode||(this.selectionStart=r.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,r=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex,o=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,a=r.leftOffset,l=this.getCanvasRetinaScaling(),c=this.canvas.upperCanvasEl,u=c.width/l,d=c.height/l,h=u-o,g=d-o,p=new W(r.left+a,r.top+r.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new W(c.clientWidth/u,c.clientHeight/d));return p.x<0&&(p.x=0),p.x>h&&(p.x=h),p.y<0&&(p.y=0),p.y>g&&(p.y=g),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Oc),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,r){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:o}=this.get2DCursorLocation(r,!0);if(n!==i){if(this.styles[n])for(let a=s;a<this._unwrappedTextLines[n].length;a++)delete this.styles[n][a];if(this.styles[i])for(let a=o;a<this._unwrappedTextLines[i].length;a++){const l=this.styles[i][a];l&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+a-o]=l)}for(let a=n+1;a<=i;a++)delete this.styles[a];this.shiftLineStyles(i,n-i)}else if(this.styles[n]){const a=this.styles[n],l=o-s;for(let c=s;c<o;c++)delete a[c];for(const c in this.styles[n]){const u=parseInt(c,10);u>=o&&(a[u-l]=a[c],delete a[c])}}}shiftLineStyles(e,r){const n=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+r]=n[i],n[i-r]||delete this.styles[i])}}insertNewlineStyleObject(e,r,n,s){const i={},o=this._unwrappedTextLines[e].length,a=o===r;let l=!1;n||(n=1),this.shiftLineStyles(e,n);const c=this.styles[e]?this.styles[e][r===0?r:r-1]:void 0;for(const d in this.styles[e]){const h=parseInt(d,10);h>=r&&(l=!0,i[h-r]=this.styles[e][d],a&&r===0||delete this.styles[e][d])}let u=!1;for(l&&!a&&(this.styles[e+n]=i,u=!0),(u||o>r)&&n--;n>0;)s&&s[n-1]?this.styles[e+n]={0:$({},s[n-1])}:c?this.styles[e+n]={0:$({},c)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,r,n,s){this.styles||(this.styles={});const i=this.styles[e],o=i?$({},i):{};n||(n=1);for(const l in o){const c=parseInt(l,10);c>=r&&(i[c+n]=o[c],o[c-n]||delete i[c])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][r+n]=$({},s[n]));return}if(!i)return;const a=i[r?r-1:1];for(;a&&n--;)this.styles[e][r+n]=$({},a)}insertNewStyleBlock(e,r,n){const s=this.get2DCursorLocation(r,!0),i=[0];let o,a=0;for(let l=0;l<e.length;l++)e[l]===`
`?(a++,i[a]=0):i[a]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),a&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],a),o=1;o<a;o++)i[o]>0?this.insertCharStyleObject(s.lineIndex+o,0,i[o],n):n&&this.styles[s.lineIndex+o]&&n[0]&&(this.styles[s.lineIndex+o][0]=n[0]),n=n&&n.slice(i[o]+1);i[o]>0&&this.insertCharStyleObject(s.lineIndex+o,0,i[o],n)}removeChars(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,r),this._text.splice(e,r-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,n,r),this._text=[...this._text.slice(0,n),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,r,n){n<=e?(r===e?this._selectionDirection=ve:this._selectionDirection===Re&&(this._selectionDirection=ve,this.selectionEnd=e),this.selectionStart=n):n>e&&n<r?this._selectionDirection===Re?this.selectionEnd=n:this.selectionStart=n:(r===e?this._selectionDirection=Re:this._selectionDirection===ve&&(this._selectionDirection=Re,this.selectionStart=r),this.selectionEnd=n)}}class SF extends _F{initHiddenTextarea(){const e=this.canvas&&or(this.canvas.getElement())||Li(),r=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[a,l]=o;return r.setAttribute(a,l)});const{top:n,left:s,fontSize:i}=this._calcTextareaPosition();r.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(r),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,l]=o;return r.addEventListener(a,this[l].bind(this))}),this.hiddenTextarea=r}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const r=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in r)this[r[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const r=this.fromPaste,{value:n,selectionStart:s,selectionEnd:i}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(Nc),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const a=this._splitTextIntoLines(n).graphemeText,l=this._text.length,c=a.length,u=this.selectionStart,d=this.selectionEnd,h=u!==d;let g,p,y,v,m=c-l;const w=this.fromStringToGraphemeSelection(s,i,n),x=u>w.selectionStart;h?(p=this._text.slice(u,d),m+=d-u):c<l&&(p=x?this._text.slice(d+m,d):this._text.slice(u,u-m));const _=a.slice(w.selectionEnd-m,w.selectionEnd);if(p&&p.length&&(_.length&&(g=this.getSelectionStyles(u,u+1,!1),g=_.map(()=>g[0])),h?(y=u,v=d):x?(y=d-p.length,v=d):(y=d,v=d+p.length),this.removeStyleFromTo(y,v)),_.length){const{copyPasteData:b}=Ar();r&&_.join("")===b.copiedText&&!xe.disableStyleCopyPaste&&(g=b.copiedTextStyle),this.insertNewStyleBlock(_,u,g)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:r}=e;const{selectionStart:n,selectionEnd:s}=r;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Ar();e.copiedText=this.getSelectedText(),xe.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,r){let n,s=this._getLineLeftOffset(e);return r>0&&(n=this.__charBounds[e][r-1],s+=n.left+n.width),s}getDownCursorOffset(e,r){const n=this._getSelectionForOffset(e,r),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i+1,a);return this._textLines[i].slice(o).length+l+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,r){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&r?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,r){const n=this._getSelectionForOffset(e,r),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-n;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i-1,a),c=this._textLines[i].slice(0,o),u=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+l-c.length+(1-u)}_getIndexOnLine(e,r){const n=this._textLines[e];let s,i,o=this._getLineLeftOffset(e),a=0;for(let l=0,c=n.length;l<c;l++)if(s=this.__charBounds[e][l].width,o+=s,o>r){i=!0;const u=o-s,d=o,h=Math.abs(u-r);a=Math.abs(d-r)<h?l:l-1;break}return i||(a=n.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,r){const n=this["get".concat(e,"CursorOffset")](r,this._selectionDirection===Re);if(r.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=_s(0,this.selectionStart,s),this.selectionEnd=_s(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const r=this._selectionDirection===ve?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,r),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,r,n){let s;if(e.altKey)s=this["findWordBoundary".concat(n)](this[r]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[r]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[r])}return s!==void 0&&this[r]!==s&&(this[r]=s,!0)}_moveLeft(e,r){return this._move(e,r,"Left")}_moveRight(e,r){return this._move(e,r,"Right")}moveCursorLeftWithoutShift(e){let r=!0;return this._selectionDirection=ve,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(r=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,r}moveCursorLeftWithShift(e){return this._selectionDirection===Re&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=ve,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,r){const n="moveCursor".concat(e).concat(r.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](r)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===ve&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Re,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let r=!0;return this._selectionDirection=Re,this.selectionStart===this.selectionEnd?(r=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,r}}const by=t=>!!t.button;class CF extends SF{constructor(){super(...arguments),R(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new bF(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:r,alreadySelected:n}=e;this.canvas&&this.editable&&!by(r)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(r)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(r)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(e){let{e:r,transform:n}=e;const s=this.draggableTextDelegate.end(r);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||by(r)||s||this.selected&&!this.getActiveControl()&&(this.enterEditing(r),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const r=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,s,r):(this.selectionStart=r,this.selectionEnd=r),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const r=this.canvas.getScenePoint(e).transform(Dt(this.calcTransformMatrix())).add(new W(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,i=0;for(let c=0;c<this._textLines.length&&n<=r.y;c++)n+=this.getHeightOfLine(c),i=c,c>0&&(s+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));let o=Math.abs(this._getLineLeftOffset(i));const a=this._textLines[i].length,l=this.__charBounds[i];for(let c=0;c<a;c++){const u=o+l[c].kernedWidth;if(r.x<=u){Math.abs(r.x-u)<=Math.abs(r.x-o)&&s++;break}o=u,s++}return Math.min(this.flipX?a-s:s,this._text.length)}}const ol="moveCursorUp",al="moveCursorDown",ll="moveCursorLeft",cl="moveCursorRight",ul="exitEditing",_y=(t,e)=>{const r=e.getRetinaScaling();t.setTransform(r,0,0,r,0,0);const n=e.viewportTransform;t.transform(n[0],n[1],n[2],n[3],n[4],n[5])},kF=$({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:ul,27:ul,33:ol,34:al,35:cl,36:ll,37:ll,38:ol,39:cl,40:al},keysMapRtl:{9:ul,27:ul,33:ol,34:al,35:ll,36:cl,37:cl,38:ol,39:ll,40:al},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class qr extends CF{static getDefaults(){return $($({},super.getDefaults()),qr.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,r){super(e,$($({},qr.ownDefaults),r)),this.initBehavior()}_set(e,r){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=r,this):(e==="canvas"&&(this.canvas instanceof ff&&this.canvas.textEditingManager.remove(this),r instanceof ff&&r.textEditingManager.add(this)),super._set(e,r))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,r){this[e]!==r&&(this._fireSelectionChanged(),this[e]=r),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,r,n)}setSelectionStyles(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,r,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,r=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,r)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const r=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=r,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const r=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),s=n.length>0;let i,o=e;if(s){i=It(e.canvas),o=i.getContext("2d"),_y(o,this.canvas);const a=this.calcTransformMatrix();o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,r):this.renderCursor(o,r),s)for(const a of n){const l=a.clipPath,c=It(e.canvas),u=c.getContext("2d");if(_y(u,this.canvas),!l.absolutePositioned){const d=a.calcTransformMatrix();u.transform(d[0],d[1],d[2],d[3],d[4],d[5])}l.transform(u),l.drawObject(u,!0,{}),this.drawClipPathOnCache(o,l,c)}s&&(e.setTransform(1,0,0,1,0,0),e.drawImage(i,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let r=this;for(;r;)r.clipPath&&e.push(r),r=r.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,r=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,r);return{left:n,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,r){return r?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let r=0,n=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let c=0;c<i;c++)r+=this.getHeightOfLine(c);const o=this._getLineLeftOffset(i),a=this.__charBounds[i][s];a&&(n=a.left),this.charSpacing!==0&&s===this._textLines[i].length&&(n-=this._getWidthOfCharSpacing());const l={top:r,left:o+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===Re||this.textAlign===Er||this.textAlign===To?l.left*=-1:this.textAlign===ve||this.textAlign===Ac?l.left=o-(n>0?n:0):this.textAlign!==de&&this.textAlign!==jo||(l.left=o-(n>0?n:0))),l}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,r){this._renderCursor(e,r,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex>0?n.charIndex-1:0,o=this.getValueOfPropertyAt(s,i,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,c=this.getValueOfPropertyAt(s,i,"deltaY"),u=r.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,i,"fill"),opacity:this._currentCursorOpacity,left:r.left+r.leftOffset-l/2,top:u+r.top+c,width:l,height:o}}_renderCursor(e,r,n){const{color:s,opacity:i,left:o,top:a,width:l,height:c}=this.getCursorRenderingData(n,r);e.fillStyle=s,e.globalAlpha=i,e.fillRect(o,a,l,c)}renderSelection(e,r){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,r)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const r=this.getSelectionStartFromPointer(e);this.renderCursorAt(r)}_renderSelection(e,r,n){const s=r.selectionStart,i=r.selectionEnd,o=this.textAlign.includes(Er),a=this.get2DCursorLocation(s),l=this.get2DCursorLocation(i),c=a.lineIndex,u=l.lineIndex,d=a.charIndex<0?0:a.charIndex,h=l.charIndex<0?0:l.charIndex;for(let g=c;g<=u;g++){const p=this._getLineLeftOffset(g)||0;let y=this.getHeightOfLine(g),v=0,m=0,w=0;if(g===c&&(m=this.__charBounds[c][d].left),g>=c&&g<u)w=o&&!this.isEndOfWrapping(g)?this.width:this.getLineWidth(g)||5;else if(g===u)if(h===0)w=this.__charBounds[u][h].left;else{const k=this._getWidthOfCharSpacing();w=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-k}v=y,(this.lineHeight<1||g===u&&this.lineHeight>1)&&(y/=this.lineHeight);let x=n.left+p+m,_=y,b=0;const C=w-m;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",_=1,b=y):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Re||this.textAlign===Er||this.textAlign===To?x=this.width-x-C:this.textAlign===ve||this.textAlign===Ac?x=n.left+p-w:this.textAlign!==de&&this.textAlign!==jo||(x=n.left+p-w)),e.fillRect(x,n.top+n.topOffset+b,C,_),n.topOffset+=v}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Xe)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),r=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:r}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}R(qr,"ownDefaults",kF),R(qr,"type","IText"),ee.setClass(qr),ee.setClass(qr,"i-text");class rs extends qr{static getDefaults(){return $($({},super.getDefaults()),rs.ownDefaults)}constructor(e,r){super(e,$($({},rs.ownDefaults),r))}static createControls(){return{controls:lA()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Er)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let r=0,n=0,s=0;const i={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[s]===`
`&&o>0?(n=0,s++,r++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&o>0&&(n++,s++),i[o]={line:r,offset:n},s+=e.graphemeLines[o].length,n+=e.graphemeLines[o].length;return i}styleHas(e,r){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[r];n&&(r=n.line)}return super.styleHas(e,r)}isEmptyStyles(e){if(!this.styles)return!0;let r,n=0,s=e+1,i=!1;const o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,n=o.offset),a&&(s=a.line,i=s===e,r=a.offset);const l=e===void 0?this.styles:{line:this.styles[e]};for(const c in l)for(const u in l[c]){const d=parseInt(u,10);if(d>=n&&(!i||d<r))for(const h in l[c][u])return!1}return!0}_getStyleDeclaration(e,r){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,r=n.offset+r}return super._getStyleDeclaration(e,r)}_setStyleDeclaration(e,r,n){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+r,n)}_deleteStyleDeclaration(e,r){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+r)}_getLineStyle(e){const r=this._styleMap[e];return!!this.styles[r.line]}_setLineStyle(e){const r=this._styleMap[e];super._setLineStyle(r.line)}_wrapText(e,r){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<n.wordsData.length;i++)s.push(...this._wrapLine(i,r,n));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const r=this.splitByGrapheme,n=r?"":" ";let s=0;return{wordsData:e.map((i,o)=>{let a=0;const l=r?this.graphemeSplit(i):this.wordSplit(i);return l.length===0?[{word:[],width:0}]:l.map(c=>{const u=r?[c]:this.graphemeSplit(c),d=this._measureWord(u,o,a);return s=Math.max(d,s),a+=u.length+n.length,{word:u,width:d}})}),largestWordWidth:s}}_measureWord(e,r){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let o=0,a=e.length;o<a;o++)i+=this._getGraphemeBox(e[o],r,o+s,n,!0).kernedWidth,n=e[o];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,r,n){let{largestWordWidth:s,wordsData:i}=n,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,c=[],u=l?"":" ";let d=0,h=[],g=0,p=0,y=!0;r-=o;const v=Math.max(r,s,this.dynamicMinWidth),m=i[e];let w;for(g=0,w=0;w<m.length;w++){const{word:x,width:_}=m[w];g+=x.length,d+=p+_-a,d>v&&!y?(c.push(h),h=[],d=_,y=!0):d+=a,y||l||h.push(u),h=h.concat(x),p=l?0:this._measureWord([u],e,g),g++,y=!1}return w&&c.push(h),s+o>this.dynamicMinWidth&&(this.dynamicMinWidth=s-a+o),c}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,r){return this.splitByGrapheme&&!r?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const r=super._splitTextIntoLines(e),n=this._wrapText(r.lines,this.width),s=new Array(n.length);for(let i=0;i<n.length;i++)s[i]=n[i].join("");return r.lines=s,r.graphemeLines=n,r}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const r in this._styleMap){const n=parseInt(r,10);if(this._textLines[n]){const s=this._styleMap[r].line;e.set("".concat(s),!0)}}for(const r in this.styles)e.has(r)||delete this.styles[r]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}R(rs,"type","Textbox"),R(rs,"textLayoutProperties",[...qr.textLayoutProperties,"width"]),R(rs,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),ee.setClass(rs);class Sy extends Au{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,r){const{target:n}=e,{clipPath:s,group:i}=n;if(!s||!this.shouldPerformLayout(e))return;const{width:o,height:a}=Pr(r_(n,s)),l=new W(o,a);if(s.absolutePositioned)return{center:us(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:l};{const c=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:u=new W,correction:d=new W}=this.calcBoundingBox(r,e)||{};return{center:u.add(c),correction:d.subtract(c),size:l}}return{center:n.getRelativeCenterPoint().add(c),size:l}}}}R(Sy,"type","clip-path"),ee.setClass(Sy);class Cy extends Au{getInitialSize(e,r){let{target:n}=e,{size:s}=r;return new W(n.width||s.x,n.height||s.y)}}R(Cy,"type","fixed"),ee.setClass(Cy);class EF extends aa{subscribeTargets(e){const r=e.target;e.targets.reduce((n,s)=>(s.parent&&n.add(s.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[r]})})}unsubscribeTargets(e){const r=e.target,n=r.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!n.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[r]})})}}class ns extends Mr{static getDefaults(){return $($({},super.getDefaults()),ns.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,ns.ownDefaults),this.setOptions(r);const{left:n,top:s,layoutManager:i}=r;this.groupInit(e,{left:n,top:s,layoutManager:i??new EF})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...r):r.forEach(s=>{const i=this._objects.findIndex(a=>a.isInFrontOf(s)),o=i===-1?this.size():i;this.insertAt(o,s)})}canEnterGroup(e){return this.getObjects().some(r=>r.isDescendantOf(e)||e.isDescendantOf(r))?(Dn("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,r){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,r)}exitGroup(e,r){this._exitGroup(e,r),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,r){super._onAfterObjectsChange(e,r);const n=new Set;r.forEach(s=>{const{parent:i}=s;i&&n.add(i)}),e===qg?n.forEach(s=>{s._onAfterObjectsChange(Ic,r)}):n.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,r,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=$($({hasControls:!1},n),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,r),e.restore()}}R(ns,"type","ActiveSelection"),R(ns,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),ee.setClass(ns),ee.setClass(ns,"activeSelection");class TF{constructor(){R(this,"resources",{})}applyFilters(e,r,n,s,i){const o=i.getContext("2d");if(!o)return;o.drawImage(r,0,0,n,s);const a={sourceWidth:n,sourceHeight:s,imageData:o.getImageData(0,0,n,s),originalEl:r,originalImageData:o.getImageData(0,0,n,s),canvasEl:i,ctx:o,filterBackend:this};e.forEach(c=>{c.applyTo(a)});const{imageData:l}=a;return l.width===n&&l.height===s||(i.width=l.width,i.height=l.height),o.putImageData(l,0,0),a}}class S_{constructor(){let{tileSize:e=xe.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};R(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),R(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,r){this.dispose(),this.createWebGLCanvas(e,r)}createWebGLCanvas(e,r){const n=It({width:e,height:r}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(e,r,n,s,i,o){const a=this.gl,l=i.getContext("2d");if(!a||!l)return;let c;o&&(c=this.getCachedTexture(o,r));const u={originalWidth:r.width||r.naturalWidth||0,originalHeight:r.height||r.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:a,sourceTexture:this.createTexture(a,n,s,c?void 0:r),targetTexture:this.createTexture(a,n,s),originalTexture:c||this.createTexture(a,n,s,c?void 0:r),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},d=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,d),e.forEach(h=>{h&&h.applyTo(u)}),function(h){const g=h.targetCanvas,p=g.width,y=g.height,v=h.destinationWidth,m=h.destinationHeight;p===v&&y===m||(g.width=v,g.height=m)}(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(d),l.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,r,n,s,i){const{NEAREST:o,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:c,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:g,TEXTURE_WRAP_T:p}=e,y=e.createTexture();return e.bindTexture(a,y),e.texParameteri(a,d,i||o),e.texParameteri(a,h,i||o),e.texParameteri(a,g,u),e.texParameteri(a,p,u),s?e.texImage2D(a,0,l,l,c,s):e.texImage2D(a,0,l,r,n,0,l,c,null),y}getCachedTexture(e,r,n){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,r.width,r.height,r,n);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,r){const n=e.canvas,s=r.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const o=n.height-s.height;i.drawImage(n,0,o,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,r){const n=r.targetCanvas.getContext("2d"),s=r.destinationWidth,i=r.destinationHeight,o=s*i*4;if(!n)return;const a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,a);const c=new ImageData(l,s,i);n.putImageData(c,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,r={renderer:"",vendor:""};if(!e)return r;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const s=e.getParameter(n.UNMASKED_RENDERER_WEBGL),i=e.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(r.renderer=s.toLowerCase()),i&&(r.vendor=i.toLowerCase())}return this.gpuInfo=r,r}}let Id;function jF(){const{WebGLProbe:t}=Ar();return t.queryWebGL(Fr()),xe.enableGLFiltering&&t.isSupported(xe.textureSize)?new S_({tileSize:xe.textureSize}):new TF}function $d(){return!Id&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Id=jF()),Id}const NF=["filters","resizeFilter","src","crossOrigin","type"],C_=["cropX","cropY"];class Ot extends ot{static getDefaults(){return $($({},super.getDefaults()),Ot.ownDefaults)}constructor(e,r){super(),R(this,"_lastScaleX",1),R(this,"_lastScaleY",1),R(this,"_filterScalingX",1),R(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Ot.ownDefaults),this.setOptions(r),this.cacheKey="texture".concat(Fn()),this.setElement(typeof e=="string"?(this.canvas&&or(this.canvas.getElement())||Li()).getElementById(e):e,r)}getElement(){return this._element}setElement(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),(r=e.classList)===null||r===void 0||r.add(Ot.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const r=$d(!1);r instanceof S_&&r.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const r=this[e];r&&Ar().dispose(r),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const r=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-r,-n),e.lineTo(r,-n),e.lineTo(r,n),e.lineTo(-r,n),e.lineTo(-r,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const r=[];return this.filters.forEach(n=>{n&&r.push(n.toObject())}),$($({},super.toObject([...C_,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:r},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],r=this._element,n=-this.width/2,s=-this.height/2;let i=[],o=[],a="",l="";if(!r)return[];if(this.hasCrop()){const c=Fn();i.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(r.width||r.naturalWidth,'" height="').concat(r.height||r.naturalHeight,'"').concat(l).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const c=this.fill;this.fill=null,o=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=c}return i=this.paintFirst!==Xe?i.concat(o,e):i.concat(e,o),i}getSrc(e){const r=e?this._element:this._originalElement;return r?r.toDataURL?r.toDataURL():this.srcFromAttribute?r.getAttribute("src")||"":r.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:r,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Eo(e,{crossOrigin:r,signal:n}).then(s=>{r!==void 0&&this.set({crossOrigin:r}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,r=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,i=n.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>r&&i>r)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const a=It(o),{width:l,height:c}=o;this._element=a,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,$d().applyFilters([e],o,l,c,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const r=this._originalElement,n=r.naturalWidth||r.width,s=r.naturalHeight||r.height;if(this._element===this._originalElement){const i=It({width:n,height:s});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);$d().applyFilters(e,this._originalElement,n,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const r=this._element;if(!r)return;const n=this._filterScalingX,s=this._filterScalingY,i=this.width,o=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),c=r.naturalWidth||r.width,u=r.naturalHeight||r.height,d=a*n,h=l*s,g=Math.min(i*n,c-d),p=Math.min(o*s,u-h),y=-i/2,v=-o/2,m=Math.min(i,c/n-a),w=Math.min(o,u/s-l);r&&e.drawImage(r,d,h,g,p,y,v,m,w)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=r||n.height}parsePreserveAspectRatioAttribute(){const e=D1(this.preserveAspectRatio||""),r=this.width,n=this.height,s={width:r,height:n};let i,o=this._element.width,a=this._element.height,l=1,c=1,u=0,d=0,h=0,g=0;return!e||e.alignX===Et&&e.alignY===Et?(l=r/o,c=n/a):(e.meetOrSlice==="meet"&&(l=c=s_(this._element,s),i=(r-o*l)/2,e.alignX==="Min"&&(u=-i),e.alignX==="Max"&&(u=i),i=(n-a*c)/2,e.alignY==="Min"&&(d=-i),e.alignY==="Max"&&(d=i)),e.meetOrSlice==="slice"&&(l=c=i_(this._element,s),i=o-r/l,e.alignX==="Mid"&&(h=i/2),e.alignX==="Max"&&(h=i),i=a-n/c,e.alignY==="Mid"&&(g=i/2),e.alignY==="Max"&&(g=i),o=r/l,a=n/c)),{width:o,height:a,scaleX:l,scaleY:c,offsetLeft:u,offsetTop:d,cropX:h,cropY:g}}static fromObject(e,r){let{filters:n,resizeFilter:s,src:i,crossOrigin:o,type:a}=e,l=je(e,NF);return Promise.all([Eo(i,$($({},r),{},{crossOrigin:o})),n&&ji(n,r),s&&ji([s],r),ka(l,r)]).then(c=>{let[u,d=[],[h]=[],g={}]=c;return new this(u,$($({},l),{},{src:i,filters:d,resizeFilter:h},g))})}static fromURL(e){let{crossOrigin:r=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return Eo(e,{crossOrigin:r,signal:n}).then(i=>new this(i,s))}static async fromElement(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=cn(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"]||s.href,r,s).catch(i=>(Dn("log","Unable to parse Image",i),null))}}R(Ot,"type","Image"),R(Ot,"cacheProperties",[...ln,...C_]),R(Ot,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),R(Ot,"CSS_CANVAS","canvas-img"),R(Ot,"ATTRIBUTE_NAMES",[...$n,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),ee.setClass(Ot),ee.setSVGClass(Ot);Nu(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Lu=t=>t.webgl!==void 0,Qg="precision highp float",OF=`
    `.concat(Qg,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),PF=["type"],MF=["type"],DF=new RegExp(Qg,"g");class Ye{get type(){return this.constructor.type}constructor(){let e=je(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},PF);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return OF}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=Ar();s!=="highp"&&(r=r.replace(DF,Qg.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!i||!o||!a)throw new Tr("Vertex, fragment shader or program creation error");if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Tr("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(o,r),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Tr("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,i),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Tr('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const l=this.getUniformLocations(e,a)||{};return l.uStepW=e.getUniformLocation(a,"uStepW"),l.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:l}}getAttributeLocations(e,r){return{aPosition:e.getAttribLocation(r,"aPosition")}}getUniformLocations(e,r){const n=this.constructor.uniformLocations,s={};for(let i=0;i<n.length;i++)s[n[i]]=e.getUniformLocation(r,n[i]);return s}sendAttributeData(e,r,n){const s=r.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const r=e.context;if(e.passes>1){const n=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===s||(r.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(r,n,s)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.targetTexture,0)}else r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish()}_swapTextures(e){e.passes--,e.pass++;const r=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=r}isNeutralState(e){return!1}applyTo(e){Lu(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const r=this.getCacheKey();return e.programCache[r]||(e.programCache[r]=this.createProgram(e.context)),e.programCache[r]}applyToWebGL(e){const r=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?r.bindTexture(r.TEXTURE_2D,e.originalTexture):r.bindTexture(r.TEXTURE_2D,e.sourceTexture),r.useProgram(n.program),this.sendAttributeData(r,n.attributeLocations,e.aPosition),r.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),r.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(r,n.uniformLocations),r.viewport(0,0,e.destinationWidth,e.destinationHeight),r.drawArrays(r.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,r,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,r),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,r){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:r,sourceHeight:n}=e,s=It({width:r,height:n});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return $({type:this.type},e.reduce((r,n)=>(r[n]=this[n],r),{}))}toJSON(){return this.toObject()}static async fromObject(e,r){return new this(je(e,MF))}}R(Ye,"type","BaseFilter"),R(Ye,"uniformLocations",[]);const AF={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class dl extends Ye{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(AF[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:r}}=e;const n=new we(this.color).getSource(),s=this.alpha,i=n[0]*s,o=n[1]*s,a=n[2]*s,l=1-s;for(let c=0;c<r.length;c+=4){const u=r[c],d=r[c+1],h=r[c+2];let g,p,y;switch(this.mode){case"multiply":g=u*i/255,p=d*o/255,y=h*a/255;break;case"screen":g=255-(255-u)*(255-i)/255,p=255-(255-d)*(255-o)/255,y=255-(255-h)*(255-a)/255;break;case"add":g=u+i,p=d+o,y=h+a;break;case"difference":g=Math.abs(u-i),p=Math.abs(d-o),y=Math.abs(h-a);break;case"subtract":g=u-i,p=d-o,y=h-a;break;case"darken":g=Math.min(u,i),p=Math.min(d,o),y=Math.min(h,a);break;case"lighten":g=Math.max(u,i),p=Math.max(d,o),y=Math.max(h,a);break;case"overlay":g=i<128?2*u*i/255:255-2*(255-u)*(255-i)/255,p=o<128?2*d*o/255:255-2*(255-d)*(255-o)/255,y=a<128?2*h*a/255:255-2*(255-h)*(255-a)/255;break;case"exclusion":g=i+u-2*i*u/255,p=o+d-2*o*d/255,y=a+h-2*a*h/255;break;case"tint":g=i+u*l,p=o+d*l,y=a+h*l}r[c]=g,r[c+1]=p,r[c+2]=y}}sendUniformData(e,r){const n=new we(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(r.uColor,n)}}R(dl,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),R(dl,"type","BlendColor"),R(dl,"uniformLocations",["uColor"]),ee.setClass(dl);const FF={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},LF=["type","image"];class hl extends Ye{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return FF[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const r=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(r,n,r.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(r,r.TEXTURE1)}createTexture(e,r){return e.getCachedTexture(r.cacheKey,r.getElement())}calculateMatrix(){const e=this.image,{width:r,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/r,-e.top/n,1]}applyTo2d(e){let{imageData:{data:r,width:n,height:s},filterBackend:{resources:i}}=e;const o=this.image;i.blendImage||(i.blendImage=Fr());const a=i.blendImage,l=a.getContext("2d");a.width!==n||a.height!==s?(a.width=n,a.height=s):l.clearRect(0,0,n,s),l.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),l.drawImage(o.getElement(),0,0,n,s);const c=l.getImageData(0,0,n,s).data;for(let u=0;u<r.length;u+=4){const d=r[u],h=r[u+1],g=r[u+2],p=r[u+3],y=c[u],v=c[u+1],m=c[u+2],w=c[u+3];switch(this.mode){case"multiply":r[u]=d*y/255,r[u+1]=h*v/255,r[u+2]=g*m/255,r[u+3]=p*w/255;break;case"mask":r[u+3]=w}}}sendUniformData(e,r){const n=this.calculateMatrix();e.uniform1i(r.uImage,1),e.uniformMatrix3fv(r.uTransformMatrix,!1,n)}toObject(){return $($({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,r){let{type:n,image:s}=e,i=je(e,LF);return Ot.fromObject(s,r).then(o=>new this($($({},i),{},{image:o})))}}R(hl,"type","BlendImage"),R(hl,"defaults",{mode:"multiply",alpha:1}),R(hl,"uniformLocations",["uTransformMatrix","uImage"]),ee.setClass(hl);class fl extends Ye{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){Lu(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:r,width:n,height:s}}=e;this.aspectRatio=n/s,this.horizontal=!0;let i=this.getBlurValue()*n;const o=new Uint8ClampedArray(r),a=15,l=4*n;for(let c=0;c<r.length;c+=4){let u=0,d=0,h=0,g=0,p=0;const y=c-c%l,v=y+l;for(let m=-14;m<a;m++){const w=m/a,x=4*Math.floor(i*w),_=1-Math.abs(w);let b=c+x;b<y?b=y:b>v&&(b=v);const C=r[b+3]*_;u+=r[b]*C,d+=r[b+1]*C,h+=r[b+2]*C,g+=C,p+=_}o[c]=u/g,o[c+1]=d/g,o[c+2]=h/g,o[c+3]=g/p}this.horizontal=!1,i=this.getBlurValue()*s;for(let c=0;c<o.length;c+=4){let u=0,d=0,h=0,g=0,p=0;const y=c%l,v=o.length-l+y;for(let m=-14;m<a;m++){const w=m/a,x=Math.floor(i*w)*l,_=1-Math.abs(w);let b=c+x;b<y?b=y:b>v&&(b=v);const C=o[b+3]*_;u+=o[b]*C,d+=o[b+1]*C,h+=o[b+2]*C,g+=C,p+=_}r[c]=u/g,r[c+1]=d/g,r[c+2]=h/g,r[c+3]=g/p}}sendUniformData(e,r){const n=this.chooseRightDelta();e.uniform2fv(r.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:r,aspectRatio:n}=this;return r?n>1&&(e=1/n):n<1&&(e=n),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}R(fl,"type","Blur"),R(fl,"defaults",{blur:0}),R(fl,"uniformLocations",["uDelta"]),ee.setClass(fl);class gl extends Ye{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=Math.round(255*this.brightness);for(let s=0;s<r.length;s+=4)r[s]+=n,r[s+1]+=n,r[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,r){e.uniform1f(r.uBrightness,this.brightness)}}R(gl,"type","Brightness"),R(gl,"defaults",{brightness:0}),R(gl,"uniformLocations",["uBrightness"]),ee.setClass(gl);const k_={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class ei extends Ye{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const r=e.imageData.data,n=this.matrix,s=this.colorsOnly;for(let i=0;i<r.length;i+=4){const o=r[i],a=r[i+1],l=r[i+2];if(r[i]=o*n[0]+a*n[1]+l*n[2]+255*n[4],r[i+1]=o*n[5]+a*n[6]+l*n[7]+255*n[9],r[i+2]=o*n[10]+a*n[11]+l*n[12]+255*n[14],!s){const c=r[i+3];r[i]+=c*n[3],r[i+1]+=c*n[8],r[i+2]+=c*n[13],r[i+3]=o*n[15]+a*n[16]+l*n[17]+c*n[18]+255*n[19]}}}sendUniformData(e,r){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(r.uColorMatrix,!1,s),e.uniform4fv(r.uConstants,i)}toObject(){return $($({},super.toObject()),{},{matrix:[...this.matrix]})}}function Ts(t,e){var r;const n=(R(r=class extends ei{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",t),R(r,"defaults",{colorsOnly:!1,matrix:e}),r);return ee.setClass(n,t),n}R(ei,"type","ColorMatrix"),R(ei,"defaults",k_),R(ei,"uniformLocations",["uColorMatrix","uConstants"]),ee.setClass(ei);Ts("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Ts("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Ts("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Ts("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Ts("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Ts("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Ts("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class ky extends Ye{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Lu(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(r=>{r.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,r){return Promise.all((e.subFilters||[]).map(n=>ee.getClass(n.type).fromObject(n,r))).then(n=>new this({subFilters:n}))}}R(ky,"type","Composed"),ee.setClass(ky);class pl extends Ye{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:r}}=e;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let i=0;i<r.length;i+=4)r[i]=s*(r[i]-128)+128,r[i+1]=s*(r[i+1]-128)+128,r[i+2]=s*(r[i+2]-128)+128}sendUniformData(e,r){e.uniform1f(r.uContrast,this.contrast)}}R(pl,"type","Contrast"),R(pl,"defaults",{contrast:0}),R(pl,"uniformLocations",["uContrast"]),ee.setClass(pl);const RF={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class ml extends Ye{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return RF[this.getCacheKey()]}applyTo2d(e){const r=e.imageData,n=r.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),o=Math.floor(i/2),a=r.width,l=r.height,c=e.ctx.createImageData(a,l),u=c.data,d=this.opaque?1:0;let h,g,p,y,v,m,w,x,_,b,C,k,S;for(C=0;C<l;C++)for(b=0;b<a;b++){for(v=4*(C*a+b),h=0,g=0,p=0,y=0,S=0;S<i;S++)for(k=0;k<i;k++)w=C+S-o,m=b+k-o,w<0||w>=l||m<0||m>=a||(x=4*(w*a+m),_=s[S*i+k],h+=n[x]*_,g+=n[x+1]*_,p+=n[x+2]*_,d||(y+=n[x+3]*_));u[v]=h,u[v+1]=g,u[v+2]=p,u[v+3]=d?n[v+3]:y}e.imageData=c}sendUniformData(e,r){e.uniform1fv(r.uMatrix,this.matrix)}toObject(){return $($({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}R(ml,"type","Convolute"),R(ml,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),R(ml,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),ee.setClass(ml);const E_="Gamma";class yl extends Ye{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:r}}=e;const n=this.gamma,s=1/n[0],i=1/n[1],o=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,s),a.g[l]=255*Math.pow(l/255,i),a.b[l]=255*Math.pow(l/255,o);for(let l=0;l<r.length;l+=4)r[l]=a.r[r[l]],r[l+1]=a.g[r[l+1]],r[l+2]=a.b[r[l+2]]}sendUniformData(e,r){e.uniform3fv(r.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:E_,gamma:this.gamma.concat()}}}R(yl,"type",E_),R(yl,"defaults",{gamma:[1,1,1]}),R(yl,"uniformLocations",["uGamma"]),ee.setClass(yl);const IF={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class xl extends Ye{applyTo2d(e){let{imageData:{data:r}}=e;for(let n,s=0;s<r.length;s+=4){const i=r[s],o=r[s+1],a=r[s+2];switch(this.mode){case"average":n=(i+o+a)/3;break;case"lightness":n=(Math.min(i,o,a)+Math.max(i,o,a))/2;break;case"luminosity":n=.21*i+.72*o+.07*a}r[s+2]=r[s+1]=r[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return IF[this.mode]}sendUniformData(e,r){e.uniform1i(r.uMode,1)}isNeutralState(){return!1}}R(xl,"type","Grayscale"),R(xl,"defaults",{mode:"average"}),R(xl,"uniformLocations",["uMode"]),ee.setClass(xl);const $F=$($({},k_),{},{rotation:0});class zd extends ei{calculateMatrix(){const e=this.rotation*Math.PI,r=gr(e),n=pr(e),s=1/3,i=Math.sqrt(s)*n,o=1-r;this.matrix=[r+o/3,s*o-i,s*o+i,0,0,s*o+i,r+s*o,s*o-i,0,0,s*o-i,s*o+i,r+s*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}R(zd,"type","HueRotation"),R(zd,"defaults",$F),ee.setClass(zd);class vl extends Ye{applyTo2d(e){let{imageData:{data:r}}=e;for(let n=0;n<r.length;n+=4)r[n]=255-r[n],r[n+1]=255-r[n+1],r[n+2]=255-r[n+2],this.alpha&&(r[n+3]=255-r[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,r){e.uniform1i(r.uInvert,Number(this.invert)),e.uniform1i(r.uAlpha,Number(this.alpha))}}R(vl,"type","Invert"),R(vl,"defaults",{alpha:!1,invert:!0}),R(vl,"uniformLocations",["uInvert","uAlpha"]),ee.setClass(vl);class wl extends Ye{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=this.noise;for(let s=0;s<r.length;s+=4){const i=(.5-Math.random())*n;r[s]+=i,r[s+1]+=i,r[s+2]+=i}}sendUniformData(e,r){e.uniform1f(r.uNoise,this.noise/255),e.uniform1f(r.uSeed,Math.random())}isNeutralState(){return this.noise===0}}R(wl,"type","Noise"),R(wl,"defaults",{noise:0}),R(wl,"uniformLocations",["uNoise","uSeed"]),ee.setClass(wl);class bl extends Ye{applyTo2d(e){let{imageData:{data:r,width:n,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let o=0;o<n;o+=this.blocksize){const a=4*i*n+4*o,l=r[a],c=r[a+1],u=r[a+2],d=r[a+3];for(let h=i;h<Math.min(i+this.blocksize,s);h++)for(let g=o;g<Math.min(o+this.blocksize,n);g++){const p=4*h*n+4*g;r[p]=l,r[p+1]=c,r[p+2]=u,r[p+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,r){e.uniform1f(r.uBlocksize,this.blocksize)}}R(bl,"type","Pixelate"),R(bl,"defaults",{blocksize:4}),R(bl,"uniformLocations",["uBlocksize"]),ee.setClass(bl);class _l extends Ye{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=255*this.distance,s=new we(this.color).getSource(),i=[s[0]-n,s[1]-n,s[2]-n],o=[s[0]+n,s[1]+n,s[2]+n];for(let a=0;a<r.length;a+=4){const l=r[a],c=r[a+1],u=r[a+2];l>i[0]&&c>i[1]&&u>i[2]&&l<o[0]&&c<o[1]&&u<o[2]&&(r[a+3]=0)}}sendUniformData(e,r){const n=new we(this.color).getSource(),s=this.distance,i=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],o=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];e.uniform4fv(r.uLow,i),e.uniform4fv(r.uHigh,o)}}R(_l,"type","RemoveColor"),R(_l,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),R(_l,"uniformLocations",["uLow","uHigh"]),ee.setClass(_l);class Sl extends Ye{sendUniformData(e,r){e.uniform2fv(r.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(r.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),r=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let i=1;i<=n;i++)s[i-1]=e(i*r);return s}generateShader(e){const r=new Array(e);for(let n=1;n<=e;n++)r[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(r.map((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Lu(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return r=>{if(r>=e||r<=-e)return 0;if(r<11920929e-14&&r>-11920929e-14)return 1;const n=(r*=Math.PI)/e;return Math.sin(r)/r*Math.sin(n)/n}}applyTo2d(e){const r=e.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const i=r.width,o=r.height,a=Math.round(i*n),l=Math.round(o*s);let c;c=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,o,a,l):this.resizeType==="hermite"?this.hermiteFastResize(e,i,o,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,o,a,l):this.resizeType==="lanczos"?this.lanczosResize(e,i,o,a,l):new ImageData(a,l),e.imageData=c}sliceByTwo(e,r,n,s,i){const o=e.imageData,a=.5;let l=!1,c=!1,u=r*a,d=n*a;const h=e.filterBackend.resources;let g=0,p=0;const y=r;let v=0;h.sliceByTwo||(h.sliceByTwo=Fr());const m=h.sliceByTwo;(m.width<1.5*r||m.height<n)&&(m.width=1.5*r,m.height=n);const w=m.getContext("2d");for(w.clearRect(0,0,1.5*r,n),w.putImageData(o,0,0),s=Math.floor(s),i=Math.floor(i);!l||!c;)r=u,n=d,s<Math.floor(u*a)?u=Math.floor(u*a):(u=s,l=!0),i<Math.floor(d*a)?d=Math.floor(d*a):(d=i,c=!0),w.drawImage(m,g,p,r,n,y,v,u,d),g=y,p=v,v+=d;return w.getImageData(g,p,s,i)}lanczosResize(e,r,n,s,i){const o=e.imageData.data,a=e.ctx.createImageData(s,i),l=a.data,c=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,d=this.rcpScaleY,h=2/this.rcpScaleX,g=2/this.rcpScaleY,p=Math.ceil(u*this.lanczosLobes/2),y=Math.ceil(d*this.lanczosLobes/2),v={},m={x:0,y:0},w={x:0,y:0};return function x(_){let b,C,k,S,P,O,F,A,L,E,M;for(m.x=(_+.5)*u,w.x=Math.floor(m.x),b=0;b<i;b++){for(m.y=(b+.5)*d,w.y=Math.floor(m.y),P=0,O=0,F=0,A=0,L=0,C=w.x-p;C<=w.x+p;C++)if(!(C<0||C>=r)){E=Math.floor(1e3*Math.abs(C-m.x)),v[E]||(v[E]={});for(let N=w.y-y;N<=w.y+y;N++)N<0||N>=n||(M=Math.floor(1e3*Math.abs(N-m.y)),v[E][M]||(v[E][M]=c(Math.sqrt(Math.pow(E*h,2)+Math.pow(M*g,2))/1e3)),k=v[E][M],k>0&&(S=4*(N*r+C),P+=k,O+=k*o[S],F+=k*o[S+1],A+=k*o[S+2],L+=k*o[S+3]))}S=4*(b*s+_),l[S]=O/P,l[S+1]=F/P,l[S+2]=A/P,l[S+3]=L/P}return++_<s?x(_):a}(0)}bilinearFiltering(e,r,n,s,i){let o,a,l,c,u,d,h,g,p,y,v,m,w,x=0;const _=this.rcpScaleX,b=this.rcpScaleY,C=4*(r-1),k=e.imageData.data,S=e.ctx.createImageData(s,i),P=S.data;for(h=0;h<i;h++)for(g=0;g<s;g++)for(u=Math.floor(_*g),d=Math.floor(b*h),p=_*g-u,y=b*h-d,w=4*(d*r+u),v=0;v<4;v++)o=k[w+v],a=k[w+4+v],l=k[w+C+v],c=k[w+C+4+v],m=o*(1-p)*(1-y)+a*p*(1-y)+l*y*(1-p)+c*p*y,P[x++]=m;return S}hermiteFastResize(e,r,n,s,i){const o=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(o/2),c=Math.ceil(a/2),u=e.imageData.data,d=e.ctx.createImageData(s,i),h=d.data;for(let g=0;g<i;g++)for(let p=0;p<s;p++){const y=4*(p+g*s);let v=0,m=0,w=0,x=0,_=0,b=0,C=0;const k=(g+.5)*a;for(let S=Math.floor(g*a);S<(g+1)*a;S++){const P=Math.abs(k-(S+.5))/c,O=(p+.5)*o,F=P*P;for(let A=Math.floor(p*o);A<(p+1)*o;A++){let L=Math.abs(O-(A+.5))/l;const E=Math.sqrt(F+L*L);E>1&&E<-1||(v=2*E*E*E-3*E*E+1,v>0&&(L=4*(A+S*r),C+=v*u[L+3],w+=v,u[L+3]<255&&(v=v*u[L+3]/250),x+=v*u[L],_+=v*u[L+1],b+=v*u[L+2],m+=v))}}h[y]=x/m,h[y+1]=_/m,h[y+2]=b/m,h[y+3]=C/w}return d}}R(Sl,"type","Resize"),R(Sl,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),R(Sl,"uniformLocations",["uDelta","uTaps"]),ee.setClass(Sl);class Cl extends Ye{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=-this.saturation;for(let s=0;s<r.length;s+=4){const i=r[s],o=r[s+1],a=r[s+2],l=Math.max(i,o,a);r[s]+=l!==i?(l-i)*n:0,r[s+1]+=l!==o?(l-o)*n:0,r[s+2]+=l!==a?(l-a)*n:0}}sendUniformData(e,r){e.uniform1f(r.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}R(Cl,"type","Saturation"),R(Cl,"defaults",{saturation:0}),R(Cl,"uniformLocations",["uSaturation"]),ee.setClass(Cl);class kl extends Ye{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=-this.vibrance;for(let s=0;s<r.length;s+=4){const i=r[s],o=r[s+1],a=r[s+2],l=Math.max(i,o,a),c=(i+o+a)/3,u=2*Math.abs(l-c)/255*n;r[s]+=l!==i?(l-i)*u:0,r[s+1]+=l!==o?(l-o)*u:0,r[s+2]+=l!==a?(l-a)*u:0}}sendUniformData(e,r){e.uniform1f(r.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}R(kl,"type","Vibrance"),R(kl,"defaults",{vibrance:0}),R(kl,"uniformLocations",["uVibrance"]),ee.setClass(kl);function zF(t,e){return new ff(t,{selection:!0,preserveObjectStacking:!0,...e})}async function BF(t,e,r){return new Promise((n,s)=>{Ot.fromURL(e,i=>{if(!i){s(new Error("Failed to load image"));return}const o=Math.min(t.width/i.width,t.height/i.height);i.set({scaleX:o,scaleY:o,selectable:!1,evented:!1,...r}),t.add(i),t.sendToBack(i),t.renderAll(),n(i)},{crossOrigin:"anonymous"})})}function T_(t,e,r){const n=new ho(e,{fill:"rgba(0, 123, 255, 0.3)",stroke:"rgba(0, 123, 255, 0.8)",strokeWidth:2,objectCaching:!1,transparentCorners:!1,cornerColor:"rgba(0, 123, 255, 1)",cornerSize:8,hasControls:!0,hasBorders:!0,lockRotation:!0,lockScalingFlip:!0,...r});return t.add(n),t.setActiveObject(n),t.renderAll(),n}function WF(t,e){t.set({points:e}),t.setCoords()}function Ey(t,e,r){const n=t.points||[],s=t.calcTransformMatrix();return n.map(i=>{const o=uo.transformPoint(i,s);return[o.x/e,o.y/r]})}function Ty(t,e,r,n,s){const i=e.map(([o,a])=>({x:o*r,y:a*n}));return T_(t,i,s)}function HF(t,e,r,n,s){const{color:i="#FF5722",radius:o=3}=s||{},a=e.map(([c,u])=>new Cr({left:c*r,top:u*n,radius:o,fill:i,stroke:i,strokeWidth:1,selectable:!1,evented:!1,originX:"center",originY:"center"})),l=new Mr(a,{selectable:!1,evented:!1});return t.add(l),t.renderAll(),l}function Bd(t){const e=t.points||[],r={};e.forEach((n,s)=>{r[`p${s}`]=new Wt({positionHandler:(i,o,a)=>{const l=a,c=l.points||[];if(s<c.length){const u=c[s].x-l.pathOffset.x,d=c[s].y-l.pathOffset.y;return uo.transformPoint({x:u,y:d},uo.multiplyTransformMatrices(l.canvas.viewportTransform,l.calcTransformMatrix()))}return{x:0,y:0}},actionHandler:(i,o,a,l)=>{const c=o.target,u=c.points||[],d=c.calcTransformMatrix(),h=uo.invertTransform(d),g=uo.transformPoint({x:a,y:l},h);return s<u.length&&(u[s].x=g.x+c.pathOffset.x,u[s].y=g.y+c.pathOffset.y),!0},cursorStyle:"pointer",actionName:"modifyPolygon",render:(i,o,a,l,c)=>{i.save(),i.fillStyle="#007bff",i.strokeStyle="#ffffff",i.lineWidth=2,i.beginPath(),i.arc(o,a,5,0,2*Math.PI),i.fill(),i.stroke(),i.restore()}})}),t.controls=r,t.hasControls=!0,t.setCoords()}function VF(t,e,r,n){if(e<=1)return t;const s=n*.3,i=e*n*.02;return t.map(o=>o.y<s?{x:o.x,y:Math.max(0,o.y-i)}:o)}const UF=({imagePath:t,initialPolygon:e,landmarks:r,eyebrowExpandMod:n=1,onPolygonChange:s,onSave:i,readOnly:o=!1,width:a=800,height:l=600})=>{const c=T.useRef(null),u=T.useRef(null),d=T.useRef(null),h=T.useRef(null),g=T.useRef(null),[p,y]=T.useState(!1),[v,m]=T.useState([]),[w,x]=T.useState("select"),[_,b]=T.useState(!1);T.useEffect(()=>{if(!c.current||u.current)return;const E=zF(c.current,{width:a,height:l,backgroundColor:"#1e1e1e"});return u.current=E,t&&C(),()=>{E.dispose(),u.current=null}},[]);const C=T.useCallback(async()=>{if(u.current)try{const E=await BF(u.current,t,{crossOrigin:"anonymous"});if(h.current=E,e&&e.length>0){const M=E.width*E.scaleX,N=E.height*E.scaleY,I=Ty(u.current,e,M,N,{selectable:!o,evented:!o});d.current=I,o||Bd(I),I.on("modified",()=>{S()})}r&&r.length>0&&k()}catch(E){console.error("Failed to load image:",E)}},[t,e,r,o]),k=T.useCallback(()=>{if(!u.current||!h.current||!r)return;const E=h.current.width*h.current.scaleX,M=h.current.height*h.current.scaleY;if(g.current&&u.current.remove(g.current),_){const N=HF(u.current,r,E,M,{color:"#FF5722",radius:2});g.current=N}},[r,_]),S=T.useCallback(()=>{if(!d.current||!h.current)return;const E=h.current.width*h.current.scaleX,M=h.current.height*h.current.scaleY,N=Ey(d.current,E,M);s&&s(N)},[s]),P=T.useCallback(E=>{if(w!=="draw"||!u.current||o)return;const M=u.current.getPointer(E.e),N={x:M.x,y:M.y};m(I=>{const j=[...I,N];if(j.length>=3){d.current&&u.current.remove(d.current);const D=T_(u.current,j,{selectable:!1,evented:!1});d.current=D}return j})},[w,o]),O=T.useCallback(()=>{!d.current||v.length<3||(d.current.set({selectable:!0,evented:!0}),Bd(d.current),d.current.on("modified",()=>{S()}),y(!1),m([]),x("select"),S())},[v,S]),F=T.useCallback(()=>{var j;if(!d.current||!h.current||n<=1)return;const E=d.current.points||[],M=h.current.width*h.current.scaleX,N=h.current.height*h.current.scaleY,I=VF(E,n,M,N);WF(d.current,I),(j=u.current)==null||j.renderAll(),S()},[n,S]),A=T.useCallback(()=>{if(!u.current||!h.current||!e)return;d.current&&u.current.remove(d.current);const E=h.current.width*h.current.scaleX,M=h.current.height*h.current.scaleY,N=Ty(u.current,e,E,M,{selectable:!o,evented:!o});d.current=N,o||Bd(N),N.on("modified",()=>{S()}),S()},[e,o,S]),L=T.useCallback(()=>{if(!d.current||!h.current||!i)return;const E=h.current.width*h.current.scaleX,M=h.current.height*h.current.scaleY,N=Ey(d.current,E,M);i(N)},[i]);return T.useEffect(()=>{if(!u.current)return;const E=u.current;return E.on("mouse:down",P),()=>{E.off("mouse:down",P)}},[P]),T.useEffect(()=>{k()},[_,k]),f.jsxs("div",{className:"segmentation-editor",children:[f.jsxs("div",{className:"editor-toolbar bg-gray-800 p-2 flex gap-2 items-center",children:[f.jsx("button",{className:`px-3 py-1 rounded ${w==="select"?"bg-blue-600":"bg-gray-700"}`,onClick:()=>x("select"),disabled:o,children:"Select"}),f.jsx("button",{className:`px-3 py-1 rounded ${w==="draw"?"bg-blue-600":"bg-gray-700"}`,onClick:()=>x("draw"),disabled:o,children:"Draw"}),w==="draw"&&v.length>=3&&f.jsx("button",{className:"px-3 py-1 rounded bg-green-600",onClick:O,children:"Complete"}),f.jsx("div",{className:"border-l border-gray-600 h-6 mx-2"}),f.jsx("button",{className:"px-3 py-1 rounded bg-gray-700",onClick:A,disabled:o||!e,children:"Reset"}),f.jsxs("button",{className:"px-3 py-1 rounded bg-purple-600",onClick:F,disabled:o||n<=1,children:["Apply Eyebrow Expansion (",n,"x)"]}),f.jsx("div",{className:"border-l border-gray-600 h-6 mx-2"}),f.jsxs("label",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:_,onChange:E=>b(E.target.checked)}),f.jsx("span",{className:"text-sm",children:"Show Landmarks"})]}),f.jsx("div",{className:"ml-auto flex gap-2",children:f.jsx("button",{className:"px-4 py-1 rounded bg-blue-600 hover:bg-blue-700",onClick:L,disabled:o,children:"Save"})})]}),f.jsx("div",{className:"canvas-container bg-gray-900 flex items-center justify-center",style:{height:l+40},children:f.jsx("canvas",{ref:c})}),w==="draw"&&f.jsx("div",{className:"editor-help bg-gray-800 p-2 text-sm text-gray-300",children:'Click to add points. Need at least 3 points to create a polygon. Click "Complete" when done.'})]})},XF=({faceImage:t,faceImages:e,onClose:r,onUpdateFace:n,nodeId:s,inputDir:i,eyebrowExpandMod:o=1})=>{const[a,l]=T.useState("segmentation"),[c,u]=T.useState(t==null?void 0:t.segmentationPolygon),[d,h]=T.useState(t==null?void 0:t.landmarks),[g,p]=T.useState(!1),[y,v]=T.useState(0);T.useEffect(()=>{if(t&&e.length>0){const k=e.findIndex(S=>S.id===t.id);k>=0&&v(k)}},[t,e]),T.useEffect(()=>{t&&m()},[t]);const m=async()=>{var k;if(t)try{const S=await ce.getFaceData(s,t.id,i);S.success&&(u(((k=S.segmentation)==null?void 0:k[0])||t.segmentationPolygon),h(S.landmarks||t.landmarks))}catch(S){console.error("Failed to load face data:",S),u(t.segmentationPolygon),h(t.landmarks)}},w=T.useCallback(k=>{u(k)},[]),x=T.useCallback(async k=>{if(t){p(!0);try{await ce.saveSegmentation(s,t.id,i,[k]),n(t.id,{segmentationPolygon:k}),console.log("Segmentation saved successfully")}catch(S){console.error("Failed to save segmentation:",S)}finally{p(!1)}}},[t,s,i,n]),_=T.useCallback(()=>{t&&m()},[t,m]),b=T.useCallback(()=>{if(y>0){const k=e[y-1];k&&n(k.id,{active:!0})}},[y,e,n]),C=T.useCallback(()=>{if(y<e.length-1){const k=e[y+1];k&&n(k.id,{active:!0})}},[y,e,n]);return T.useEffect(()=>{const k=S=>{S.key==="ArrowLeft"?b():S.key==="ArrowRight"?C():S.key==="Escape"&&r()};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[b,C,r]),t?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-6xl h-full max-h-[90vh] flex flex-col transition-colors duration-300",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300",children:["Face Editor: ",t.filename]}),f.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1 transition-colors duration-300",children:[f.jsx("button",{onClick:()=>l("landmarks"),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors duration-200 ${a==="landmarks"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"Landmarks"}),f.jsx("button",{onClick:()=>l("segmentation"),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors duration-200 ${a==="segmentation"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"Segmentation"})]})]}),f.jsx("button",{onClick:r,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a==="segmentation"&&f.jsx("div",{className:"flex-1",children:f.jsx(UF,{imagePath:t.filePath,initialPolygon:c,landmarks:d,eyebrowExpandMod:o,onPolygonChange:w,onSave:x,width:1e3,height:700})}),a==="landmarks"&&f.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-100 dark:bg-gray-900 p-4",children:f.jsx("div",{className:"relative",children:f.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[f.jsx("img",{src:t.filePath,alt:t.filename,className:"max-w-full max-h-full object-contain",style:{maxHeight:"700px"}}),d&&f.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:d.map((k,S)=>f.jsx("circle",{cx:k[0]*100,cy:k[1]*100,r:"0.5",fill:"#ff0000",opacity:"0.8"},`landmark-${S}`))})]})})})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:b,className:"px-3 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors duration-200",children:"← Previous"}),f.jsx("button",{onClick:C,className:"px-3 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors duration-200",children:"Next →"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[y+1," / ",e.length]}),f.jsx("button",{onClick:_,className:"px-3 py-1 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors duration-200",disabled:g,children:"Reset"}),g&&f.jsxs("div",{className:"flex items-center text-sm text-blue-600",children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Saving..."]})]})]})]})}):null},j_=()=>{var Ps,Wn,$r,un;const{activeNodeInSingleMode:t,selectedNode:e,updateNode:r}=vt(),n=t||e,[s,i]=T.useState([]),[o,a]=T.useState({faceType:"full_face",detectionModel:"VGGFace2",similarityThreshold:.6,eyebrowExpandMod:1}),[l,c]=T.useState("normal"),[u,d]=T.useState(!1),[h,g]=T.useState(!0),[p,y]=T.useState(null),[v,m]=T.useState(!1),[w,x]=T.useState([]),[_,b]=T.useState(["default"]),[C,k]=T.useState("default"),[S,P]=T.useState(""),[O,F]=T.useState(""),[A,L]=T.useState(""),[E,M]=T.useState(!1),[N,I]=T.useState(!1),[j,D]=T.useState(!1),[z,H]=T.useState(0),[U,G]=T.useState(""),[X,Q]=T.useState(!1);T.useEffect(()=>{n!=null&&n.parameters&&a({faceType:n.parameters.face_type||"full_face",detectionModel:n.parameters.detection_model||"VGGFace2",similarityThreshold:n.parameters.similarity_threshold||.6,eyebrowExpandMod:n.parameters.eyebrow_expand_mod||1})},[n]);const B=T.useCallback(J=>{const Z=new Date().toLocaleTimeString();x(le=>[...le,`[${Z}] ${J}`])},[]);T.useEffect(()=>{var Z,le,me;console.log("useEffect triggered with input_dir:",(Z=n==null?void 0:n.parameters)==null?void 0:Z.input_dir),console.log("useEffect dependencies:",{input_dir:(le=n==null?void 0:n.parameters)==null?void 0:le.input_dir,nodeId:n==null?void 0:n.id,detectionSettings:o});const J=async()=>{var Ms;if(!((Ms=n==null?void 0:n.parameters)!=null&&Ms.input_dir))return;const Qt=n.parameters.input_dir;console.log("Loading existing images from:",Qt),B(`Loading existing images from: ${Qt}`);try{m(!0),i([]);const xr=await ce.getFaceImages(n.id,Qt);if(xr.success){console.log("Received all face images:",xr.face_images.length),B(`Loaded ${xr.face_images.length} face images`);const Ru=(xr.face_images||[]).sort((Wi,Iu)=>Wi.filename.localeCompare(Iu.filename)).map(Wi=>({...Wi,hasFaceData:!1}));i(Ru),m(!1)}else B(`Error loading images: ${xr.message||"Unknown error"}`),m(!1)}catch(xr){console.error("Error loading existing images:",xr),B(`Error loading images: ${xr}`),m(!1)}};(me=n==null?void 0:n.parameters)!=null&&me.input_dir&&J()},[(Ps=n==null?void 0:n.parameters)==null?void 0:Ps.input_dir,n==null?void 0:n.id,B]);const Y=T.useCallback(async()=>{var J;if(n){m(!0),B("Starting face detection...");try{const Z=(J=n.parameters)==null?void 0:J.input_dir;if(!Z){B("Error: No input directory specified");return}B(`Scanning directory: ${Z}`),i([]);const le=await ce.detectFaces(n.id,{input_dir:Z,face_type:o.faceType,detection_model:o.detectionModel,similarity_threshold:o.similarityThreshold});if(le.success){const me=(le.face_images||[]).sort((Qt,Ms)=>Qt.filename.localeCompare(Ms.filename)).map(Qt=>({...Qt,hasFaceData:!1}));i(me),B(`Found ${me.length} face images`)}else B(`Error: ${le.message||"Unknown error"}`)}catch(Z){B(`Error: ${Z}`)}finally{m(!1)}}},[n,o,B]),K=T.useCallback(async()=>{if(n){m(!0),B("Loading BiSeNet segmentation model...");try{const J=await ce.loadSegmentationModel(n.id);J.success?B("BiSeNet model loaded successfully"):B(`Error loading model: ${J.error}`)}catch(J){B(`Error: ${J}`)}finally{m(!1)}}},[n,B]),ne=T.useCallback(async()=>{if(n){m(!0),B("Generating segmentation masks...");try{const J=await ce.generateMasks(n.id,{face_images:s,eyebrow_expand_mod:o.eyebrowExpandMod});J.success?(B(`Generated masks for ${J.processed_count||0} faces`),J.face_data&&i(Z=>Z.map(le=>{const me=J.face_data[le.id];return me?{...le,segmentationPolygon:me.segmentation_polygon}:le}))):B(`Error: ${J.error}`)}catch(J){B(`Error: ${J}`)}finally{m(!1)}}},[n,o.eyebrowExpandMod,B]),oe=T.useCallback(async()=>{var le;if(!((le=n==null?void 0:n.parameters)!=null&&le.input_dir)){B("Error: No input directory specified");return}const J=s.filter(me=>me.selected),Z=J.length>0?J.map(me=>me.id):void 0;m(!0),B(`Embedding mask polygons ${Z?`for ${Z.length} selected faces`:"for all faces"}...`);try{const me=await ce.embedMasks(n.id,n.parameters.input_dir,o.eyebrowExpandMod,Z);me.success?(B(`Embed complete: ${me.success_count} succeeded, ${me.failure_count} failed`),B("Images ready for DFL training!")):B(`Error: ${me.message}`)}catch(me){B(`Error embedding polygons: ${me}`)}finally{m(!1)}},[n,s,o.eyebrowExpandMod,B]),ae=T.useCallback(J=>{y(J),i(Z=>Z.map(le=>({...le,active:le.id===J})))},[]),se=T.useCallback((J,Z)=>{i(le=>le.map(me=>me.id===J?{...me,selected:Z}:me))},[]),ie=T.useCallback(J=>{a(Z=>({...Z,...J})),n&&r(n.id,{parameters:{...n.parameters,...J}})},[n,r]),he=T.useCallback(()=>{x([])},[]),pe=T.useCallback(async J=>{if(n)try{const Z=await ce.createDetectionProfile(n.id,J,o);Z.success?(b(le=>[...le,J]),B(`Detection profile '${J}' created`)):B(`Error creating profile: ${Z.message}`)}catch(Z){B(`Error: ${Z}`)}},[n,o,B]),Se=T.useCallback(async J=>{if(n)try{const Z=await ce.deleteDetectionProfile(n.id,J);Z.success?(b(le=>le.filter(me=>me!==J)),C===J&&k("default"),B(`Detection profile '${J}' deleted`)):B(`Error deleting profile: ${Z.message}`)}catch(Z){B(`Error: ${Z}`)}},[n,C,B]),Ge=T.useCallback(async J=>{if(n)try{const Z=await ce.resetDetectionProfile(n.id,J);Z.success?B(`Detection profile '${J}' reset to defaults`):B(`Error resetting profile: ${Z.message}`)}catch(Z){B(`Error: ${Z}`)}},[n,B]),Kt=T.useCallback(async()=>{var J;if(!(!n||!S)){m(!0),B("Updating parent frame references...");try{const Z=await ce.updateParentFrames(n.id,((J=n.parameters)==null?void 0:J.input_dir)||"",S);Z.success?B(`Updated ${Z.files_updated} files`):B(`Error: ${Z.message}`)}catch(Z){B(`Error: ${Z}`)}finally{m(!1)}}},[n,S,B]),js=T.useCallback(async()=>{var Z;if(!n)return;m(!0),Q(!0),H(0),G("Starting import..."),B("Importing face data..."),B("This may take several minutes for large datasets...");const J=setInterval(async()=>{try{const le=await ce.getNodeProgress(n.id);le.success&&le.progress!==void 0&&(H(le.progress),G(le.message||"Processing images..."))}catch{}},1e3);try{const le=await ce.importFaceData(n.id,((Z=n.parameters)==null?void 0:Z.input_dir)||"");clearInterval(J),le.success?(H(100),G("Import completed!"),B(`Imported ${le.faces_imported} faces (${le.faces_with_data} had embedded data)`),B(`Landmarks found: ${le.faces_with_landmarks||0}`),B(`Segmentation polygons found: ${le.faces_with_segmentation||0}`),B(`Total images processed: ${le.total_images}`),i(me=>me.map(Qt=>({...Qt,hasFaceData:!0}))),B("Face thumbnails now show blue outline indicating imported face data")):(G("Import failed"),B(`Error: ${le.message}`))}catch(le){clearInterval(J),G("Import failed"),B(`Error: ${le}`)}finally{m(!1),setTimeout(()=>{Q(!1),H(0),G("")},2e3)}},[n,B]),Ns=T.useCallback(async()=>{var J;if(!(!n||!O)){m(!0),B("Copying embedded data...");try{const Z=await ce.copyEmbeddedData(n.id,((J=n.parameters)==null?void 0:J.input_dir)||"",O,E,N);Z.success?B(`Copied ${Z.files_copied} files`):B(`Error: ${Z.message}`)}catch(Z){B(`Error: ${Z}`)}finally{m(!1)}}},[n,O,E,N,B]),Os=T.useCallback(async()=>{var J;if(!(!n||!A)){m(!0),B("Training XSeg model...");try{const Z=await ce.trainXSeg(n.id,((J=n.parameters)==null?void 0:J.input_dir)||"",A);Z.success?B(`XSeg training started: ${Z.model_path}`):B(`Error: ${Z.message}`)}catch(Z){B(`Error: ${Z}`)}finally{m(!1)}}},[n,A,B]),zn=T.useCallback(async()=>{var J;if(!(!n||!A)){m(!0),B("Applying XSeg model...");try{const Z=await ce.applyXSeg(n.id,((J=n.parameters)==null?void 0:J.input_dir)||"",A);Z.success?B(`Generated ${Z.masks_generated} masks`):B(`Error: ${Z.message}`)}catch(Z){B(`Error: ${Z}`)}finally{m(!1)}}},[n,A,B]),Bn=T.useCallback(()=>{B("Opening XSeg Editor...")},[B]);return f.jsxs("div",{className:"h-full w-full flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:[f.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3 transition-colors duration-300",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Advanced Face Editor"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>c("normal"),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors duration-200 ${l==="normal"?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Normal"}),f.jsx("button",{onClick:()=>c("segmentation"),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors duration-200 ${l==="segmentation"?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Show Segmentation"}),f.jsx("button",{onClick:()=>c("alignments"),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors duration-200 ${l==="alignments"?"bg-purple-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Show Alignments"})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>d(!u),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors duration-200 ${u?"bg-orange-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Console"}),f.jsxs("button",{onClick:()=>g(!h),className:"px-3 py-1 text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors duration-200",children:[h?"Hide":"Show"," Panel"]})]})]})}),f.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[f.jsx("div",{className:"flex-1 overflow-hidden",children:f.jsx(p3,{faceImages:s,viewMode:l,onFaceSelect:ae,onFaceMultiSelect:se,loading:v,nodeId:(n==null?void 0:n.id)||"",inputDir:((Wn=n==null?void 0:n.parameters)==null?void 0:Wn.input_dir)||""})}),h&&f.jsx(m3,{detectionSettings:o,onSettingsChange:ie,onDetectFaces:Y,onLoadSegmentationModel:K,onGenerateMasks:ne,onEmbedPolygons:oe,faceCount:s.length,loading:v,inputDir:($r=n==null?void 0:n.parameters)==null?void 0:$r.input_dir,onInputDirChange:J=>{console.log("Input directory changed to:",J),n&&(console.log("Updating node:",n.id,"with input_dir:",J),r(n.id,{parameters:{...n.parameters,input_dir:J}}))},detectionProfiles:_,selectedProfile:C,onProfileChange:k,onAddProfile:pe,onRemoveProfile:Se,onResetProfile:Ge,parentFrameFolder:S,onParentFrameFolderChange:P,facesFolder:O,onFacesFolderChange:F,onlyParentData:E,onOnlyParentDataChange:M,recalculateFaceData:N,onRecalculateFaceDataChange:I,onCopyEmbeddedData:Ns,onOpenXSegEditor:Bn,xsegModelPath:A,onXsegModelPathChange:L,onTrainXSeg:Os,onApplyXSeg:zn,setFacesToParent:j,onSetFacesToParentChange:D,onUpdateParentFrames:Kt,onImportFaceData:js,importProgress:z,importMessage:U,isImporting:X})]}),u&&f.jsx(y3,{logs:w,onClearLogs:he}),p&&n&&f.jsx(XF,{faceImage:s.find(J=>J.id===p),faceImages:s,nodeId:n.id,inputDir:((un=n.parameters)==null?void 0:un.input_dir)||"",eyebrowExpandMod:o.eyebrowExpandMod,onClose:()=>y(null),onUpdateFace:(J,Z)=>{i(le=>le.map(me=>me.id===J?{...me,...Z}:me))}})]})},YF=()=>{const{selectedNode:t,updateNode:e,nodeDefinitions:r}=vt(),[n,s]=T.useState(null),[i,o]=T.useState(!1);T.useEffect(()=>{t&&a()},[t]);const a=async()=>{if(t)try{o(!0);const d=await ce.getNodeDefinition(t.type);s(d)}catch(d){console.error("Failed to load node definition:",d)}finally{o(!1)}},l=(d,h)=>{if(!t)return;const g={...t.parameters,[d]:h};e(t.id,{parameters:g})},c=async()=>{var d;if(t)try{o(!0);const h=t.type==="xseg_editor"||t.type==="advanced_face_editor"?(d=t.parameters)==null?void 0:d.input_dir:void 0,g=await ce.startNodeExecution(t.id,h);console.log("Single node execution started:",g)}catch(h){console.error("Failed to start single node execution:",h)}finally{o(!1)}},u=(d,h)=>{const g=(t==null?void 0:t.parameters[d])??h.default;switch(h.type){case"string":return f.jsx("input",{type:"text",value:g||"",onChange:p=>l(d,p.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 transition-colors duration-200",placeholder:h.description});case"number":return f.jsx("input",{type:"number",value:g||h.default||0,min:h.min,max:h.max,onChange:p=>l(d,Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-200"});case"boolean":return f.jsxs("label",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"checkbox",checked:g||!1,onChange:p=>l(d,p.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 bg-white dark:bg-gray-700 transition-colors duration-200"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 transition-colors duration-200",children:h.description})]});case"select":return f.jsx("select",{value:g||h.default||"",onChange:p=>l(d,p.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-200",children:h.options.map(p=>f.jsx("option",{value:p,children:p},p))});case"gpu":return f.jsx(i1,{selectedGPU:g||null,onGPUChange:p=>l(d,p),className:"w-full"});case"file-path":return f.jsx(o1,{value:g||"",onChange:p=>l(d,p),placeholder:h.description,filters:h.filters||[{name:"All Files",extensions:["*"]}],className:"w-full"});case"directory-path":return f.jsx(a1,{value:g||"",onChange:p=>l(d,p),placeholder:h.description,className:"w-full"});default:return f.jsx("input",{type:"text",value:g||"",onChange:p=>l(d,p.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 transition-colors duration-200",placeholder:h.description})}};return t?i?f.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400 transition-colors duration-300",children:"Loading node definition..."}):n?f.jsx("div",{className:"h-full flex flex-col",children:(t==null?void 0:t.type)==="xseg_editor"?f.jsx(j_,{}):f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-4 transition-colors duration-300",children:[f.jsx("h3",{className:"font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:n.name}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 transition-colors duration-300",children:n.description}),f.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:"Status:"}),f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium transition-colors duration-300 ${t.status==="idle"?"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200":t.status==="running"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300":t.status==="completed"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":t.status==="error"?"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300"}`,children:t.status})]}),t.progress>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-1 transition-colors duration-300",children:[f.jsx("span",{children:"Progress"}),f.jsxs("span",{children:[Math.round(t.progress),"%"]})]}),f.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 transition-colors duration-300",children:f.jsx("div",{className:"bg-blue-600 dark:bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${t.progress}%`}})})]}),t.message&&f.jsx("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:t.message})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Parameters"}),f.jsx("button",{onClick:c,disabled:i||!t,className:"px-3 py-1 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:i?"Executing...":"Execute Node"})]}),Object.entries(n.parameters).map(([d,h])=>f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:d.replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase())}),u(d,h),h.description&&f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 transition-colors duration-300",children:h.description})]},d))]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Connections"}),n.inputs.length>0&&f.jsxs("div",{children:[f.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 transition-colors duration-300",children:"Inputs"}),f.jsx("div",{className:"space-y-2",children:n.inputs.map(d=>f.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded transition-colors duration-300",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 transition-colors duration-300",children:d.label}),f.jsx("span",{className:`px-2 py-1 rounded text-xs transition-colors duration-300 ${t.inputs[d.id]?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}`,children:t.inputs[d.id]?"Connected":"Not connected"})]},d.id))})]}),n.outputs.length>0&&f.jsxs("div",{children:[f.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 transition-colors duration-300",children:"Outputs"}),f.jsx("div",{className:"space-y-2",children:n.outputs.map(d=>f.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded transition-colors duration-300",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 transition-colors duration-300",children:d.label}),f.jsx("span",{className:`px-2 py-1 rounded text-xs transition-colors duration-300 ${t.outputs[d.id]?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}`,children:t.outputs[d.id]?"Generated":"Not generated"})]},d.id))})]})]})]})}):f.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400 transition-colors duration-300",children:"Node definition not found"}):f.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400 transition-colors duration-300",children:"Select a node to edit its parameters"})},GF=()=>{const{currentWorkflow:t,isExecuting:e,setIsExecuting:r,setExecution:n,nodes:s,saveWorkflowToFile:i,loadWorkflowFromFile:o,loadTemplate:a}=vt(),[l,c]=T.useState(!1),u=t&&s.length>0&&!e,d=async()=>{if(!(!t||!u))try{c(!0),r(!0);const m=await ce.startExecution(t.id);n(m),console.log("Workflow execution started:",m)}catch(m){console.error("Failed to start workflow execution:",m),r(!1)}finally{c(!1)}},h=async()=>{if(e)try{c(!0),r(!1),console.log("Workflow execution stopped")}catch(m){console.error("Failed to stop workflow execution:",m)}finally{c(!1)}},g=async()=>{try{c(!0),await i(),console.log("Workflow saved to file successfully")}catch(m){console.error("Failed to save workflow to file:",m)}finally{c(!1)}},p=async()=>{try{c(!0),await o(),console.log("Workflow loaded from file successfully")}catch(m){console.error("Failed to load workflow from file:",m)}finally{c(!1)}},y=async()=>{try{c(!0),await a("basic-face-swap"),console.log("Template loaded successfully")}catch(m){console.error("Failed to load template:",m)}finally{c(!1)}},v=()=>{vt.getState().createNewWorkflow()};return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:v,disabled:l,className:"px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors duration-200",children:"New"}),f.jsx("button",{onClick:y,disabled:l,className:"px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors duration-200",children:"Template"}),f.jsx("button",{onClick:p,disabled:l,className:"px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors duration-200",children:"Load"}),f.jsx("button",{onClick:g,disabled:l||!t,className:"px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors duration-200",children:"Save As"}),e?f.jsx("button",{onClick:h,disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 dark:bg-red-700 border border-transparent rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50 transition-colors duration-200",children:l?"Stopping...":"Stop Workflow"}):f.jsx("button",{onClick:d,disabled:l||!u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-700 border border-transparent rounded-md hover:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:l?"Starting...":"Run Workflow"}),e&&f.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-600 dark:text-blue-400 transition-colors duration-300",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-600 dark:bg-blue-400 rounded-full animate-pulse"}),f.jsx("span",{children:"Executing..."})]})]})},qF=()=>{const{execution:t,isExecuting:e}=vt(),[r,n]=T.useState(!1);return!e&&!t?null:f.jsxs("div",{className:"border-t border-gray-200 bg-white",children:[f.jsxs("div",{className:"px-4 py-3 cursor-pointer hover:bg-gray-50",onClick:()=>n(!r),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`w-3 h-3 rounded-full ${(t==null?void 0:t.status)==="running"?"bg-blue-500 animate-pulse":(t==null?void 0:t.status)==="completed"?"bg-green-500":(t==null?void 0:t.status)==="error"?"bg-red-500":(t==null?void 0:t.status)==="paused"?"bg-yellow-500":"bg-gray-400"}`}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Workflow Execution"}),f.jsxs("p",{className:"text-xs text-gray-600",children:[(t==null?void 0:t.status)==="running"&&"Running...",(t==null?void 0:t.status)==="completed"&&"Completed",(t==null?void 0:t.status)==="error"&&"Error",(t==null?void 0:t.status)==="paused"&&"Paused",(t==null?void 0:t.status)==="idle"&&"Idle"]})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[t&&f.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(t.progress),"%"]}),f.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),t&&t.progress>0&&f.jsx("div",{className:"mt-2",children:f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${t.status==="completed"?"bg-green-500":t.status==="error"?"bg-red-500":t.status==="paused"?"bg-yellow-500":"bg-blue-500"}`,style:{width:`${t.progress}%`}})})})]}),r&&t&&f.jsx("div",{className:"px-4 pb-4 border-t border-gray-200",children:f.jsxs("div",{className:"space-y-3",children:[t.current_node&&f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Current Node"}),f.jsx("p",{className:"text-sm text-gray-600",children:t.current_node})]}),t.message&&f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Message"}),f.jsx("p",{className:"text-sm text-gray-600",children:t.message})]}),t.error&&f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium text-red-700",children:"Error"}),f.jsx("p",{className:"text-sm text-red-600",children:t.error})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.started_at&&f.jsxs("div",{children:[f.jsx("span",{className:"font-medium text-gray-700",children:"Started:"}),f.jsx("p",{className:"text-gray-600",children:new Date(t.started_at).toLocaleTimeString()})]}),t.completed_at&&f.jsxs("div",{children:[f.jsx("span",{className:"font-medium text-gray-700",children:"Completed:"}),f.jsx("p",{className:"text-gray-600",children:new Date(t.completed_at).toLocaleTimeString()})]})]})]})})]})},KF=()=>{const[t,e]=T.useState([]),[r,n]=T.useState("all"),[s,i]=T.useState(!0),[o,a]=T.useState(!1);T.useEffect(()=>{const d=y=>{if(y.type==="log_message"){const v={id:`log-${Date.now()}-${Math.random()}`,timestamp:y.timestamp||new Date().toISOString(),level:y.level||"info",node_id:y.node_id,message:y.message};e(m=>[...m,v])}},h=y=>{console.error("WebSocket error:",y),a(!1)};ce.connectWebSocket(d,h);const p=setInterval(()=>{const y=ce.socket;y&&y.readyState===WebSocket.OPEN?a(!0):a(!1)},1e3);return()=>{clearInterval(p),ce.disconnectWebSocket()}},[]);const l=t.filter(d=>r==="all"||d.level===r),c=d=>{switch(d){case"error":return"text-red-600 bg-red-50";case"warn":return"text-yellow-600 bg-yellow-50";case"info":return"text-blue-600 bg-blue-50";case"debug":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},u=()=>{e([])};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"p-4 border-b border-gray-200",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Logs"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:`w-2 h-2 rounded-full ${o?"bg-green-500":"bg-red-500"}`}),f.jsx("span",{className:"text-xs text-gray-600",children:o?"Connected":"Disconnected"})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("select",{value:r,onChange:d=>n(d.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[f.jsx("option",{value:"all",children:"All"}),f.jsx("option",{value:"info",children:"Info"}),f.jsx("option",{value:"warn",children:"Warning"}),f.jsx("option",{value:"error",children:"Error"}),f.jsx("option",{value:"debug",children:"Debug"})]}),f.jsxs("label",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[f.jsx("input",{type:"checkbox",checked:s,onChange:d=>i(d.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),f.jsx("span",{children:"Auto-scroll"})]}),f.jsx("button",{onClick:u,className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800",children:"Clear"})]})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:l.length===0?f.jsx("div",{className:"text-center text-gray-500 py-8",children:"No logs available"}):l.map(d=>f.jsxs("div",{className:`p-2 rounded text-xs font-mono ${d.level==="error"?"bg-red-50 border-l-2 border-red-500":d.level==="warn"?"bg-yellow-50 border-l-2 border-yellow-500":"bg-gray-50"}`,children:[f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx("span",{className:`px-1 py-0.5 rounded text-xs font-medium ${c(d.level)}`,children:d.level.toUpperCase()}),f.jsx("span",{className:"text-gray-500",children:new Date(d.timestamp).toLocaleTimeString()}),d.node_id&&f.jsxs("span",{className:"text-gray-500",children:["[",d.node_id,"]"]})]}),f.jsx("div",{className:"mt-1 text-gray-800",children:d.message})]},d.id))})]})},QF=({className:t="",refreshInterval:e=5e3})=>{const[r,n]=T.useState([]),[s,i]=T.useState(!0),[o,a]=T.useState(null),[l,c]=T.useState(null);T.useEffect(()=>{u();const v=setInterval(u,e);return()=>clearInterval(v)},[e]);const u=async()=>{try{a(null);const v=await ce.getGPUStatus();n(v.gpus),c(new Date)}catch(v){a("Failed to load GPU status"),console.error("Error loading GPU status:",v)}finally{i(!1)}},d=v=>{switch(v){case"nvidia":return"🟢";case"amd":return"🔴";case"intel":return"🔵";case"cpu":return"⚙️";default:return"❓"}},h=v=>{switch(v){case"nvidia":return"border-green-200 bg-green-50";case"amd":return"border-red-200 bg-red-50";case"intel":return"border-blue-200 bg-blue-50";case"cpu":return"border-gray-200 bg-gray-50";default:return"border-gray-200 bg-gray-50"}},g=v=>v>=1024?`${(v/1024).toFixed(1)} GB`:`${v} MB`,p=v=>v>80?"text-red-600":v>50?"text-yellow-600":"text-green-600",y=v=>v?v>80?"text-red-600":v>60?"text-yellow-600":"text-green-600":"text-gray-500";return s&&r.length===0?f.jsx("div",{className:`p-4 ${t}`,children:f.jsxs("div",{className:"flex items-center justify-center h-32",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),f.jsx("span",{className:"ml-2 text-gray-600",children:"Loading GPU status..."})]})}):f.jsxs("div",{className:`space-y-4 ${t}`,children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"GPU Monitor"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[l&&f.jsxs("span",{className:"text-xs text-gray-500",children:["Last update: ",l.toLocaleTimeString()]}),f.jsx("button",{onClick:u,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"Refresh"})]})]}),o&&f.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"text-red-500",children:"⚠️"}),f.jsx("span",{className:"ml-2 text-sm text-red-700",children:o})]})}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(v=>f.jsxs("div",{className:`p-4 border rounded-lg ${h(v.type)} ${v.is_available?"":"opacity-50"}`,children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-lg",children:d(v.type)}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-gray-900",children:v.name}),f.jsx("p",{className:"text-xs text-gray-600 capitalize",children:v.type})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("div",{className:`text-lg font-semibold ${p(v.utilization)}`,children:[v.utilization,"%"]}),f.jsx("div",{className:"text-xs text-gray-500",children:"Utilization"})]})]}),f.jsxs("div",{className:"mb-3",children:[f.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[f.jsx("span",{children:"Utilization"}),f.jsxs("span",{children:[v.utilization,"%"]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${v.utilization>80?"bg-red-500":v.utilization>50?"bg-yellow-500":"bg-green-500"}`,style:{width:`${v.utilization}%`}})})]}),f.jsxs("div",{className:"mb-3",children:[f.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[f.jsx("span",{children:"Memory"}),f.jsxs("span",{children:[g(v.memory_used)," / ",g(v.memory_total)]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${v.memory_used/v.memory_total*100}%`}})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[v.temperature&&f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Temp:"}),f.jsxs("span",{className:`ml-1 ${y(v.temperature)}`,children:[v.temperature,"°C"]})]}),v.power_usage&&f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Power:"}),f.jsxs("span",{className:"ml-1",children:[v.power_usage,"W"]})]}),v.driver_version&&f.jsxs("div",{className:"col-span-2",children:[f.jsx("span",{className:"font-medium",children:"Driver:"}),f.jsx("span",{className:"ml-1",children:v.driver_version})]}),v.cuda_version&&f.jsxs("div",{className:"col-span-2",children:[f.jsx("span",{className:"font-medium",children:"CUDA:"}),f.jsx("span",{className:"ml-1",children:v.cuda_version})]})]}),!v.is_available&&f.jsx("div",{className:"mt-2 text-xs text-red-600 font-medium",children:"⚠️ GPU Unavailable"})]},v.id))}),r.length===0&&!s&&f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx("p",{children:"No GPUs detected"}),f.jsx("p",{className:"text-sm",children:"Make sure GPU drivers are installed"})]})]})},JF=({error:t,isOpen:e,onClose:r,onRetry:n})=>{if(!e||!t)return null;const s=l=>{switch(l){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},i=l=>{switch(l){case"critical":return"🚨";case"high":return"⚠️";case"medium":return"⚡";case"low":return"ℹ️";default:return"❓"}},o=l=>l.toLocaleString(),a=t.recoverable&&t.retry_count<t.max_retries;return f.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:f.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[f.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:r}),f.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[f.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"text-2xl mr-3",children:i(t.severity)}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Error Details"}),f.jsx("p",{className:"text-sm text-gray-500",children:o(t.timestamp)})]})]}),f.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:f.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),f.jsx("div",{className:"bg-white px-4 pb-4 sm:p-6 sm:pt-0",children:f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:`p-4 rounded-lg border ${s(t.severity)}`,children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("h4",{className:"font-medium capitalize",children:[t.severity," Error"]}),f.jsx("span",{className:"text-sm capitalize",children:t.category})]}),f.jsx("p",{className:"text-sm font-medium",children:t.message})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Error ID"}),f.jsx("p",{className:"text-sm text-gray-900 font-mono bg-gray-100 p-2 rounded",children:t.id})]}),t.node_id&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node ID"}),f.jsx("p",{className:"text-sm text-gray-900 font-mono bg-gray-100 p-2 rounded",children:t.node_id})]}),t.workflow_id&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workflow ID"}),f.jsx("p",{className:"text-sm text-gray-900 font-mono bg-gray-100 p-2 rounded",children:t.workflow_id})]}),t.execution_id&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Execution ID"}),f.jsx("p",{className:"text-sm text-gray-900 font-mono bg-gray-100 p-2 rounded",children:t.execution_id})]})]}),t.recoverable&&f.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-blue-900",children:"Recoverable Error"}),f.jsxs("p",{className:"text-sm text-blue-700",children:["Retry attempts: ",t.retry_count," / ",t.max_retries]})]}),a&&n&&f.jsx("button",{onClick:()=>n(t.id),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors",children:"Retry"})]})}),Object.keys(t.details).length>0&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Details"}),f.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:f.jsx("pre",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:JSON.stringify(t.details,null,2)})})]}),t.stack_trace&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stack Trace"}),f.jsx("div",{className:"bg-gray-900 text-green-400 border border-gray-200 rounded-lg p-4 max-h-64 overflow-y-auto",children:f.jsx("pre",{className:"text-xs whitespace-pre-wrap font-mono",children:t.stack_trace})})]})]})}),f.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:f.jsx("button",{onClick:r,className:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Close"})})]})]})})},ZF=({className:t="",refreshInterval:e=1e4})=>{const[r,n]=T.useState([]),[s,i]=T.useState(!0),[o,a]=T.useState(null),[l,c]=T.useState(null),[u,d]=T.useState(!1),[h,g]=T.useState({});T.useEffect(()=>{p();const b=setInterval(p,e);return()=>clearInterval(b)},[e,h]);const p=async()=>{try{a(null);const b=await ce.getErrors({severity:h.severity,category:h.category,node_id:h.nodeId,limit:50});n(b)}catch(b){a("Failed to load errors"),console.error("Error loading errors:",b)}finally{i(!1)}},y=b=>{c(b),d(!0)},v=async b=>{try{await ce.retryError(b),p(),d(!1)}catch(C){console.error("Failed to retry error:",C)}},m=b=>{switch(b){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},w=b=>{switch(b){case"critical":return"🚨";case"high":return"⚠️";case"medium":return"⚡";case"low":return"ℹ️";default:return"❓"}},x=b=>new Date(b).toLocaleString(),_=(b,C=100)=>b.length>C?`${b.substring(0,C)}...`:b;return s&&r.length===0?f.jsx("div",{className:`p-4 ${t}`,children:f.jsxs("div",{className:"flex items-center justify-center h-32",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),f.jsx("span",{className:"ml-2 text-gray-600",children:"Loading errors..."})]})}):f.jsxs("div",{className:`space-y-4 ${t}`,children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Error Monitor"}),f.jsx("div",{className:"flex items-center space-x-2",children:f.jsx("button",{onClick:p,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"Refresh"})})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsxs("select",{value:h.severity||"",onChange:b=>g({...h,severity:b.target.value||void 0}),className:"text-xs border border-gray-300 rounded px-2 py-1",children:[f.jsx("option",{value:"",children:"All Severities"}),f.jsx("option",{value:"critical",children:"Critical"}),f.jsx("option",{value:"high",children:"High"}),f.jsx("option",{value:"medium",children:"Medium"}),f.jsx("option",{value:"low",children:"Low"})]}),f.jsxs("select",{value:h.category||"",onChange:b=>g({...h,category:b.target.value||void 0}),className:"text-xs border border-gray-300 rounded px-2 py-1",children:[f.jsx("option",{value:"",children:"All Categories"}),f.jsx("option",{value:"validation",children:"Validation"}),f.jsx("option",{value:"execution",children:"Execution"}),f.jsx("option",{value:"resource",children:"Resource"}),f.jsx("option",{value:"network",children:"Network"}),f.jsx("option",{value:"permission",children:"Permission"}),f.jsx("option",{value:"configuration",children:"Configuration"}),f.jsx("option",{value:"dependency",children:"Dependency"})]})]}),o&&f.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"text-red-500",children:"⚠️"}),f.jsx("span",{className:"ml-2 text-sm text-red-700",children:o})]})}),f.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r.map(b=>f.jsx("div",{onClick:()=>y(b),className:`p-3 border rounded-lg cursor-pointer hover:shadow-md transition-shadow ${m(b.severity)}`,children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx("span",{className:"text-sm",children:w(b.severity)}),f.jsx("span",{className:"text-sm font-medium capitalize",children:b.severity}),f.jsxs("span",{className:"text-xs opacity-75 capitalize",children:["(",b.category,")"]})]}),f.jsx("p",{className:"text-sm font-medium mb-1",children:_(b.message)}),f.jsxs("div",{className:"flex items-center space-x-4 text-xs opacity-75",children:[f.jsx("span",{children:x(b.timestamp)}),b.node_id&&f.jsxs("span",{children:["Node: ",b.node_id]}),b.workflow_id&&f.jsxs("span",{children:["Workflow: ",b.workflow_id]}),b.recoverable&&f.jsxs("span",{className:"text-green-600",children:["Retry: ",b.retry_count,"/",b.max_retries]})]})]}),f.jsx("div",{className:"flex-shrink-0 ml-2",children:f.jsx("svg",{className:"h-4 w-4 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},b.id))}),r.length===0&&!s&&f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx("p",{children:"No errors found"}),f.jsx("p",{className:"text-sm",children:"All systems are running smoothly!"})]}),f.jsx(JF,{error:l,isOpen:u,onClose:()=>{d(!1),c(null)},onRetry:v})]})},e5=({notification:t,onClose:e})=>{const[r,n]=T.useState(!1),[s,i]=T.useState(!1);T.useEffect(()=>{const u=setTimeout(()=>n(!0),10);return()=>clearTimeout(u)},[]),T.useEffect(()=>{if(t.duration&&t.duration>0){const u=setTimeout(()=>{o()},t.duration);return()=>clearTimeout(u)}},[t.duration]);const o=()=>{i(!0),setTimeout(()=>{e(t.id)},300)},a=()=>{switch(t.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"ℹ️"}},l=()=>{switch(t.type){case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200";case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800 text-yellow-800 dark:text-yellow-200";case"info":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200";default:return"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-800 dark:text-gray-200"}},c=(u="secondary")=>{const d="px-3 py-1 text-xs font-medium rounded-md transition-colors duration-200";switch(u){case"primary":return`${d} bg-blue-600 dark:bg-blue-700 text-white hover:bg-blue-700 dark:hover:bg-blue-800`;case"danger":return`${d} bg-red-600 dark:bg-red-700 text-white hover:bg-red-700 dark:hover:bg-red-800`;case"secondary":default:return`${d} bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500`}};return f.jsx("div",{className:`
        max-w-sm w-full border rounded-lg shadow-lg p-4 mb-3 transition-all duration-300 ease-in-out
        ${l()}
        ${r&&!s?"translate-x-0 opacity-100":"translate-x-full opacity-0"}
      `,children:f.jsxs("div",{className:"flex items-start",children:[f.jsx("div",{className:"flex-shrink-0 mr-3",children:f.jsx("span",{className:"text-lg",children:a()})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"text-sm font-medium",children:t.title}),f.jsxs("button",{onClick:o,className:"ml-2 flex-shrink-0 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200",children:[f.jsx("span",{className:"sr-only",children:"Close"}),f.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),f.jsx("p",{className:"mt-1 text-sm opacity-90",children:t.message}),t.actions&&t.actions.length>0&&f.jsx("div",{className:"mt-3 flex space-x-2",children:t.actions.map((u,d)=>f.jsx("button",{onClick:u.action,className:c(u.style),children:u.label},d))}),f.jsx("div",{className:"mt-2 text-xs opacity-75 dark:opacity-60 transition-opacity duration-300",children:t.timestamp.toLocaleTimeString()})]})]})})},t5=({notifications:t,onClose:e})=>t.length===0?null:f.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(r=>f.jsx(e5,{notification:r,onClose:e},r.id))}),Wc=Eg()(Db((t,e)=>({theme:"system",isDark:!1,setTheme:r=>{t({theme:r});const n=document.documentElement,s=r==="dark"||r==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches;t({isDark:s}),s?n.classList.add("dark"):n.classList.remove("dark")},toggleTheme:()=>{const n=e().theme==="light"?"dark":"light";e().setTheme(n)}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{if(t){const e=document.documentElement,r=t.theme==="dark"||t.theme==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches;r?e.classList.add("dark"):e.classList.remove("dark"),t.isDark=r}}}));typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{const{theme:e}=Wc.getState();if(e==="system"){const r=document.documentElement;t.matches?r.classList.add("dark"):r.classList.remove("dark"),Wc.setState({isDark:t.matches})}});const r5=({className:t="",showLabel:e=!1})=>{const{theme:r,setTheme:n,isDark:s}=Wc(),i=[{value:"light",label:"Light",icon:"☀️"},{value:"dark",label:"Dark",icon:"🌙"},{value:"system",label:"System",icon:"💻"}],o=a=>{n(a)};return f.jsxs("div",{className:`flex items-center space-x-2 ${t}`,children:[e&&f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Theme:"}),f.jsx("div",{className:"flex bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:i.map(a=>f.jsxs("button",{onClick:()=>o(a.value),className:`
              flex items-center space-x-1 px-3 py-1 rounded-md text-sm font-medium transition-all duration-200
              ${r===a.value?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}
            `,title:`Switch to ${a.label} theme`,children:[f.jsx("span",{className:"text-sm",children:a.icon}),f.jsx("span",{className:"hidden sm:inline",children:a.label})]},a.value))})]})},n5=()=>{const{viewMode:t,setViewMode:e}=vt(),r=n=>{e(n)};return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Mode:"}),f.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1 transition-colors duration-300",children:[f.jsxs("button",{onClick:()=>r("workflow"),className:`px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 ${t==="workflow"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[f.jsx("span",{className:"mr-1",children:"🔗"}),"Workflow"]}),f.jsxs("button",{onClick:()=>r("single-node"),className:`px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 ${t==="single-node"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[f.jsx("span",{className:"mr-1",children:"⚙️"}),"Single Node"]})]})]})},s5=()=>{const{activeNodeInSingleMode:t}=vt(),[e,r]=T.useState([]),[n,s]=T.useState(!1),[i,o]=T.useState(!1),[a,l]=T.useState(""),[c,u]=T.useState(""),[d,h]=T.useState(null);T.useEffect(()=>{g()},[]);const g=async()=>{try{s(!0);const w=await ce.listNodePresets();r(w)}catch(w){console.error("Failed to load presets:",w)}finally{s(!1)}},p=async()=>{if(!(!t||!a.trim()))try{s(!0);const w={id:`preset-${Date.now()}`,name:a.trim(),description:c.trim()||void 0,nodeType:t.type,parameters:{...t.parameters},created_at:new Date().toISOString(),updated_at:new Date().toISOString()};await ce.saveNodePreset(w),await g(),o(!1),l(""),u("")}catch(w){console.error("Failed to save preset:",w)}finally{s(!1)}},y=async w=>{try{s(!0);const x=await ce.loadNodePreset(w);if(t){const _={...t,parameters:{...x.parameters}};vt.getState().setActiveNodeInSingleMode(_)}}catch(x){console.error("Failed to load preset:",x)}finally{s(!1)}},v=async w=>{if(confirm("Are you sure you want to delete this preset?"))try{s(!0),await ce.deleteNodePreset(w),await g()}catch(x){console.error("Failed to delete preset:",x)}finally{s(!1)}},m=t?e.filter(w=>w.nodeType===t.type):e;return f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Save Current Configuration"}),i?f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"preset-name",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:"Preset Name"}),f.jsx("input",{id:"preset-name",type:"text",value:a,onChange:w=>l(w.target.value),placeholder:"Enter preset name...",className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-200"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"preset-description",className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:"Description (optional)"}),f.jsx("textarea",{id:"preset-description",value:c,onChange:w=>u(w.target.value),placeholder:"Enter description...",rows:2,className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-200"})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{onClick:p,disabled:n||!a.trim(),className:"flex-1 px-3 py-1 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded focus:outline-none focus:ring-1 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:n?"Saving...":"Save"}),f.jsx("button",{onClick:()=>{o(!1),l(""),u("")},className:"flex-1 px-3 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded focus:outline-none focus:ring-1 focus:ring-gray-500 transition-colors duration-200",children:"Cancel"})]})]}):f.jsx("button",{onClick:()=>o(!0),disabled:!t,className:"w-full px-3 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Save as Preset"})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Load Preset"}),n?f.jsx("div",{className:"text-center py-4",children:f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})}):m.length>0?f.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400 text-sm",children:t?`No presets found for ${t.type}`:"No presets available"}):f.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.map(w=>f.jsx("div",{className:`p-3 rounded-lg border transition-colors duration-200 cursor-pointer ${d===w.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"}`,onClick:()=>h(w.id),children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h5",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate transition-colors duration-300",children:w.name}),w.description&&f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2 transition-colors duration-300",children:w.description}),f.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 transition-colors duration-300",children:new Date(w.created_at).toLocaleDateString()})]}),f.jsxs("div",{className:"flex space-x-1 ml-2",children:[f.jsx("button",{onClick:x=>{x.stopPropagation(),y(w.id)},className:"p-1 text-blue-600 hover:text-blue-700 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded transition-colors duration-200",title:"Load preset",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),f.jsx("button",{onClick:x=>{x.stopPropagation(),v(w.id)},className:"p-1 text-red-600 hover:text-red-700 hover:bg-red-100 dark:hover:bg-red-900/30 rounded transition-colors duration-200",title:"Delete preset",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},w.id))})]}),d&&f.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-200 dark:border-gray-600",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Workflow Integration"}),f.jsx("button",{onClick:()=>{console.log("Load preset into workflow:",d)},className:"w-full px-3 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors duration-200",children:"Load into Workflow"})]})]})},i5=()=>{const{activeNodeInSingleMode:t,setActiveNodeInSingleMode:e,createNodeForSingleMode:r,nodeDefinitions:n}=vt(),[s,i]=T.useState(null),[o,a]=T.useState(!1),[l,c]=T.useState(null),u=v=>{switch(v){case"idle":return"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200";case"running":return"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300";case"completed":return"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300";case"error":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300";default:return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300"}};T.useEffect(()=>{if(!t&&n.length>0){const v=n.find(w=>w.id==="advanced_face_editor"),m=v?v.type:n[0].type;c(m),r(m)}},[t,n,r]),T.useEffect(()=>{l&&d()},[l]);const d=async()=>{if(l)try{a(!0);const v=await ce.getNodeDefinition(l);i(v)}catch(v){console.error("Failed to load node definition:",v)}finally{a(!1)}},h=v=>{c(v),r(v)},g=(v,m)=>{if(!t)return;const w={...t.parameters,[v]:m};e({...t,parameters:w})},p=async()=>{var v;if(t)try{a(!0);const m=t.type==="xseg_editor"||t.type==="advanced_face_editor"?(v=t.parameters)==null?void 0:v.input_dir:void 0,w=await ce.startNodeExecution(t.id,m);console.log("Single node execution started:",w)}catch(m){console.error("Failed to start single node execution:",m)}finally{a(!1)}},y=(v,m)=>{const w=(t==null?void 0:t.parameters[v])??m.default;switch(m.type){case"string":return f.jsx("input",{type:"text",value:w||"",onChange:x=>g(v,x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 transition-colors duration-200",placeholder:m.description});case"number":return f.jsx("input",{type:"number",value:w||m.default||0,min:m.min,max:m.max,onChange:x=>g(v,Number(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-200"});case"boolean":return f.jsxs("label",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"checkbox",checked:w||!1,onChange:x=>g(v,x.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 bg-white dark:bg-gray-700 transition-colors duration-200"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 transition-colors duration-200",children:m.description})]});case"select":return f.jsx("select",{value:w||m.default||"",onChange:x=>g(v,x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-200",children:m.options.map(x=>f.jsx("option",{value:x,children:x},x))});case"gpu":return f.jsx(i1,{selectedGPU:w||null,onGPUChange:x=>g(v,x),className:"w-full"});case"file-path":return f.jsx(o1,{value:w||"",onChange:x=>g(v,x),placeholder:m.description,filters:m.filters||[{name:"All Files",extensions:["*"]}],className:"w-full"});case"directory-path":return f.jsx(a1,{value:w||"",onChange:x=>g(v,x),placeholder:m.description,className:"w-full"});default:return f.jsx("input",{type:"text",value:w||"",onChange:x=>g(v,x.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 transition-colors duration-200",placeholder:m.description})}};return o?f.jsx("div",{className:"flex items-center justify-center h-full",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading node definition..."})]})}):f.jsxs("div",{className:"h-full w-full flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:[f.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 transition-colors duration-300",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Single Node Mode"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("label",{htmlFor:"node-type-selector",className:"text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:"Node Type:"}),f.jsx("select",{id:"node-type-selector",value:l||"",onChange:v=>h(v.target.value),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors duration-200",children:n.length===0?f.jsx("option",{value:"",children:"Loading node types..."}):f.jsxs(f.Fragment,{children:[f.jsx("option",{value:"",children:"Select a node type..."}),n.map(v=>f.jsx("option",{value:v.type,children:v.name},v.id))]})})]})]}),f.jsx("button",{onClick:p,disabled:o||!t,className:"px-6 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:o?"Executing...":"Execute Node"})]})}),f.jsx("div",{className:"flex-1 flex overflow-hidden",children:(t==null?void 0:t.type)==="xseg_editor"?f.jsx(j_,{}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s&&t?f.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 transition-colors duration-300",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 mb-2 transition-colors duration-300",children:s.name}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 transition-colors duration-300",children:s.description}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:"Status:"}),f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium transition-colors duration-300 ${u(t.status)}`,children:t.status})]}),t.progress>0&&f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:"Progress:"}),f.jsx("div",{className:"w-32 bg-gray-200 dark:bg-gray-700 rounded-full h-2 transition-colors duration-300",children:f.jsx("div",{className:"bg-blue-600 dark:bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${t.progress}%`}})}),f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:[Math.round(t.progress),"%"]})]})]}),t.message&&f.jsx("div",{className:"mt-3 text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300",children:t.message})]}),f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700 transition-colors duration-300",children:[f.jsx("h4",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 mb-4 transition-colors duration-300",children:"Parameters"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(s.parameters).map(([v,m])=>f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors duration-300",children:v.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())}),y(v,m),m.description&&f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 transition-colors duration-300",children:m.description})]},v))})]})]}):n.length===0?f.jsx("div",{className:"flex items-center justify-center h-full",children:f.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[f.jsx("p",{children:"Loading node definitions..."}),f.jsx("p",{className:"text-sm mt-2",children:"Please wait while we load available node types."})]})}):f.jsx("div",{className:"flex items-center justify-center h-full",children:f.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400",children:f.jsx("p",{children:"Select a node type to get started"})})})}),f.jsxs("div",{className:"w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col transition-colors duration-300",children:[f.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:f.jsx("h3",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Presets"})}),f.jsx("div",{className:"flex-1 overflow-y-auto",children:f.jsx(s5,{})})]})]})})]})},o5=Eg((t,e)=>({notifications:[],addNotification:r=>{const n={...r,id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};t(s=>({notifications:[...s.notifications,n]})),n.duration&&n.duration>0&&setTimeout(()=>{e().removeNotification(n.id)},n.duration)},removeNotification:r=>{t(n=>({notifications:n.notifications.filter(s=>s.id!==r)}))},clearAllNotifications:()=>{t({notifications:[]})},clearNotificationsByType:r=>{t(n=>({notifications:n.notifications.filter(s=>s.type!==r)}))}}));function a5(){const{selectedNode:t,updateNodeStatus:e,setExecution:r,viewMode:n,setNodeDefinitions:s}=vt(),{notifications:i,removeNotification:o}=o5(),{setTheme:a}=Wc(),[l,c]=T.useState("editor");T.useEffect(()=>{var g;const h=localStorage.getItem("theme-storage");if(h)try{const p=JSON.parse(h);(g=p.state)!=null&&g.theme&&a(p.state.theme)}catch(p){console.error("Failed to parse saved theme:",p),a("system")}else a("system")},[a]),T.useEffect(()=>{(async()=>{try{const g=await ce.getNodeDefinitions();s(g)}catch(g){console.error("Failed to load node definitions:",g)}})()},[s]),T.useEffect(()=>{const h=async()=>{try{await ce.connectWebSocket(),ce.onWebSocketMessage("node_update",p=>{const{node_id:y,data:v}=p;e(y,v.status,v.progress,v.message)}),ce.onWebSocketMessage("execution_update",p=>{const{data:y}=p;r(y)}),ce.onWebSocketMessage("log_message",p=>{const{node_id:y,level:v,message:m}=p;console.log(`[${v}] Node ${y}: ${m}`)})}catch(p){console.warn("Failed to connect to WebSocket, retrying in 5 seconds...",p),setTimeout(()=>{h()},5e3)}},g=setTimeout(()=>{h()},2e3);return()=>{clearTimeout(g),ce.disconnectWebSocket()}},[e,r]);const u=[{id:"editor",label:"Node Editor",icon:"⚙️"},{id:"logs",label:"Logs",icon:"📋"},{id:"gpu",label:"GPU Monitor",icon:"🖥️"},{id:"errors",label:"Error Monitor",icon:"🚨"}],d=()=>{switch(l){case"editor":return t?f.jsx(YF,{}):f.jsx("div",{className:"p-4 text-center text-gray-500",children:"Select a node to edit its parameters"});case"logs":return f.jsx(KF,{});case"gpu":return f.jsx(QF,{});case"errors":return f.jsx(ZF,{});default:return null}};return f.jsx(jb,{children:f.jsxs("div",{className:"h-screen flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors duration-300",children:[f.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3 transition-colors duration-300",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h1",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"DeepFaceLab Workflow Editor"}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx(r5,{}),f.jsx(n5,{}),f.jsx(GF,{})]})]})}),f.jsx("div",{className:"flex-1 flex overflow-hidden",children:n==="workflow"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col transition-colors duration-300",children:[f.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:f.jsx("h2",{className:"text-lg font-medium text-gray-800 dark:text-gray-100 transition-colors duration-300",children:"Nodes"})}),f.jsx(n3,{})]}),f.jsx("div",{className:"flex-1 flex flex-col",children:f.jsx(r3,{})}),f.jsxs("div",{className:"w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col transition-colors duration-300",children:[f.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:u.map(h=>f.jsxs("button",{onClick:()=>c(h.id),className:`flex-1 px-3 py-2 text-sm font-medium border-b-2 transition-all duration-200 ${l===h.id?"border-blue-500 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[f.jsx("span",{className:"mr-1",children:h.icon}),h.label]},h.id))}),f.jsx("div",{className:"flex-1 overflow-y-auto",children:d()})]})]}):f.jsx(i5,{})}),f.jsx(qF,{}),f.jsx(t5,{notifications:i,onClose:o})]})})}Wd.createRoot(document.getElementById("root")).render(f.jsx(vf.StrictMode,{children:f.jsx(a5,{})}));
